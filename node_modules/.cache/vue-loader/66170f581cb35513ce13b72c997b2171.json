{"remainingRequest":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\product-definition\\pd-framework-def\\pd-attr-def\\base-attr-def\\preservation\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\product-definition\\pd-framework-def\\pd-attr-def\\base-attr-def\\preservation\\index.vue","mtime":1609847106840},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\babel-loader\\lib\\index.js","mtime":1706753193796},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1706753190941}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpsZXQgX3RoaXM7DQppbXBvcnQge2FkZFByZXNlcnZhdGlvbn0gZnJvbSAnQC9hcGkvYmFzaWNpbmZvL1Byb2R1Y3RBdHRyaWJ1dGVEZWZpbml0aW9uJw0KZXhwb3J0IGRlZmF1bHQgew0KICBmaWx0ZXJzOiB7fSwNCiAgbmFtZTogInByZXNlcnZhdGlvbiIsDQogIHByb3BzOiB7DQogICAgc2VsUE86IHsNCiAgICAgIHR5cGU6IEFycmF5LA0KICAgICAgZGVmYXVsdDogW10sDQogICAgfSwNCiAgICBwb09wdGlvbnM6IHsNCiAgICAgIHR5cGU6IEFycmF5LA0KICAgICAgZGVmYXVsdDogW10sDQogICAgfSwNCiAgICBkZWZhdWx0U2VsUG86IHsNCiAgICAgIHR5cGU6IEFycmF5LA0KICAgICAgZGVmYXVsdDogW10sDQogICAgfQ0KICB9LA0KICBkYXRhKCkgew0KICAgIF90aGlzID0gdGhpczsNCiAgICByZXR1cm4gew0KICAgICAgcGR0ZW1wUGRJbmZvOiB7fSwNCiAgICAgIHNlbFBPQ29weTogW10sDQogICAgfTsNCiAgfSwNCiAgd2F0Y2g6IHsNCiAgICBzZWxQTzpmdW5jdGlvbigpew0KICAgICAgdGhpcy5jbGVhblByZXNlcnZhdGlvbigpOw0KICAgIH0sDQogICAgZGVmYXVsdFNlbFBvOmZ1bmN0aW9uKCl7DQogICAgICB0aGlzLmNsZWFuUHJlc2VydmF0aW9uKCk7DQogICAgfSwNCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICB0aGlzLnBkdGVtcFBkSW5mbyA9IHRoaXMuZ2V0UGREYXRhKCk7DQogICAgdGhpcy5jbGVhblByZXNlcnZhdGlvbigpOw0KICB9LA0KICBtZXRob2RzOiB7DQogICAgYmFja1RvTWVudSgpIHsNCiAgICAgIHRoaXMuJGVtaXQoImJhY2tUb01lbnUiLCB0cnVlKTsNCiAgICB9LA0KICAgIGFkZFByZXNlcnZhdGlvbigpew0KICAgICAgbGV0IHRlbXAgPSBbXTsNCiAgICAgIHRoaXMuc2VsUE9Db3B5LmZvckVhY2godmFsPT57DQogICAgICAgIGlmKCEodGhpcy5zZWxQTy5pbmNsdWRlcyh2YWwpKSl7DQogICAgICAgICAgdGVtcC5wdXNoKHsNCiAgICAgICAgICAgIHBkVmVySWQ6dGhpcy5wZHRlbXBQZEluZm8ucGRWZXJJZCwNCiAgICAgICAgICAgIHBkQ29kZTp0aGlzLnBkdGVtcFBkSW5mby5wZENvZGUsDQogICAgICAgICAgICBwZEluZm9JZDp0aGlzLnBkdGVtcFBkSW5mby5pZCwNCiAgICAgICAgICAgIHBkTmFtZTp0aGlzLnBkdGVtcFBkSW5mby5wZE5hbWUsDQogICAgICAgICAgICBwYU5hbWU6dGhpcy5nZXRDYXB0aW9uKHZhbCwgMiksDQogICAgICAgICAgICBwZFBhSW5mb0lkOnRoaXMuZ2V0Q2FwdGlvbih2YWwsIDApLA0KICAgICAgICAgICAgcGFDb2RlOnRoaXMuZ2V0Q2FwdGlvbih2YWwsIDEpLA0KICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICB9KQ0KICAgICAgYWRkUHJlc2VydmF0aW9uKHRoaXMuYnVpbGRSZXF1ZXN0RGF0YSh7cGR0ZW1wUGRQYUluZm9zOnRlbXB9KSkudGhlbihyZXM9PnsNCiAgICAgICAgdGhpcy5ub3RpZnlTdWNjZXNzKHJlcy5tZXNzYWdlKTsNCiAgICAgICAgdGhpcy5iYWNrVG9NZW51KCk7DQogICAgICB9KQ0KICAgIH0sDQogICAgY2xlYW5QcmVzZXJ2YXRpb24oKXsNCiAgICAgIHRoaXMuc2VsUE9Db3B5ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLnNlbFBPKSk7DQogICAgICBpZih0aGlzLmRlZmF1bHRTZWxQby5sZW5ndGgpew0KICAgICAgICB0aGlzLmRlZmF1bHRTZWxQby5mb3JFYWNoKGRhdGE9PnsNCiAgICAgICAgICBpZighdGhpcy5zZWxQT0NvcHkuaW5jbHVkZXMoZGF0YSkpew0KICAgICAgICAgICAgdGhpcy5zZWxQT0NvcHkucHVzaChkYXRhKQ0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICAgIH0NCiAgICB9LA0KICAgIGdldENhcHRpb24ob2JqLCBzdGF0ZSkgew0KICAgICAgY29uc3QgaW5kZXggPSBvYmoubGFzdEluZGV4T2YoIjoiKQ0KICAgICAgY29uc3QgaW5kZXgxID0gb2JqLmluZGV4T2YoIjoiKQ0KICAgICAgaWYgKHN0YXRlID09PSAwKSB7DQogICAgICAgIHJldHVybiBvYmouc3Vic3RyaW5nKDAsIGluZGV4MSkNCiAgICAgIH0gZWxzZSBpZihzdGF0ZSA9PT0gMSkgew0KICAgICAgICByZXR1cm4gb2JqLnN1YnN0cmluZyhpbmRleDEgKyAxLCBpbmRleCkNCiAgICAgIH1lbHNlew0KICAgICAgICByZXR1cm4gb2JqLnN1YnN0cmluZyhpbmRleCArIDEsIG9iai5sZW5ndGgpDQogICAgICB9DQogICAgfSwNCiAgfSwNCn07DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAoBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/product-definition/pd-framework-def/pd-attr-def/base-attr-def/preservation","sourcesContent":["<template>\r\n  <cus-wraper>\r\n    <cus-page-title-back :isDialog=\"true\" :label=\"$t('ProductAttributeDefinition.proConPreservationItem')\" @backTo=\"backToMenu\"></cus-page-title-back>\r\n    <el-row style=\"margin-left: 40px;\">\r\n      <el-checkbox-group v-model=\"selPOCopy\">\r\n        <el-col v-for=\"po in poOptions\" :span=\"6\" style=\"padding: 4px;\">\r\n          <el-checkbox :key=\"po.pdPaCode\" :label=\"po.id+':'+po.pdPaCode+':'+po.pdPaName\" :disabled=\"selPO.includes(po.id+':'+po.pdPaCode+':'+po.pdPaName)\">{{ po.pdPaName }}\r\n          </el-checkbox>\r\n        </el-col>\r\n      </el-checkbox-group>\r\n    </el-row>\r\n    <el-form>\r\n      <el-form-item align=\"right\">\r\n          <el-button size=\"small\" @click=\"addPreservation\" icon=\"el-icon-success\" v-auth=\"'product-attr:add'\" type=\"primary\">{{$t('productValueAddedTax.add')}}</el-button>\r\n          <el-button size=\"small\" @click=\"cleanPreservation\" icon=\"el-icon-refresh el-icon--left\" type=\"primary\">{{$t('productValueAddedTax.refresh')}}</el-button>\r\n        </el-form-item>\r\n    </el-form>\r\n  </cus-wraper>\r\n</template>\r\n<script>\r\nlet _this;\r\nimport {addPreservation} from '@/api/basicinfo/ProductAttributeDefinition'\r\nexport default {\r\n  filters: {},\r\n  name: \"preservation\",\r\n  props: {\r\n    selPO: {\r\n      type: Array,\r\n      default: [],\r\n    },\r\n    poOptions: {\r\n      type: Array,\r\n      default: [],\r\n    },\r\n    defaultSelPo: {\r\n      type: Array,\r\n      default: [],\r\n    }\r\n  },\r\n  data() {\r\n    _this = this;\r\n    return {\r\n      pdtempPdInfo: {},\r\n      selPOCopy: [],\r\n    };\r\n  },\r\n  watch: {\r\n    selPO:function(){\r\n      this.cleanPreservation();\r\n    },\r\n    defaultSelPo:function(){\r\n      this.cleanPreservation();\r\n    },\r\n  },\r\n  created() {\r\n    this.pdtempPdInfo = this.getPdData();\r\n    this.cleanPreservation();\r\n  },\r\n  methods: {\r\n    backToMenu() {\r\n      this.$emit(\"backToMenu\", true);\r\n    },\r\n    addPreservation(){\r\n      let temp = [];\r\n      this.selPOCopy.forEach(val=>{\r\n        if(!(this.selPO.includes(val))){\r\n          temp.push({\r\n            pdVerId:this.pdtempPdInfo.pdVerId,\r\n            pdCode:this.pdtempPdInfo.pdCode,\r\n            pdInfoId:this.pdtempPdInfo.id,\r\n            pdName:this.pdtempPdInfo.pdName,\r\n            paName:this.getCaption(val, 2),\r\n            pdPaInfoId:this.getCaption(val, 0),\r\n            paCode:this.getCaption(val, 1),\r\n          });\r\n        }\r\n      })\r\n      addPreservation(this.buildRequestData({pdtempPdPaInfos:temp})).then(res=>{\r\n        this.notifySuccess(res.message);\r\n        this.backToMenu();\r\n      })\r\n    },\r\n    cleanPreservation(){\r\n      this.selPOCopy = JSON.parse(JSON.stringify(this.selPO));\r\n      if(this.defaultSelPo.length){\r\n        this.defaultSelPo.forEach(data=>{\r\n          if(!this.selPOCopy.includes(data)){\r\n            this.selPOCopy.push(data)\r\n          }\r\n        })\r\n      }\r\n    },\r\n    getCaption(obj, state) {\r\n      const index = obj.lastIndexOf(\":\")\r\n      const index1 = obj.indexOf(\":\")\r\n      if (state === 0) {\r\n        return obj.substring(0, index1)\r\n      } else if(state === 1) {\r\n        return obj.substring(index1 + 1, index)\r\n      }else{\r\n        return obj.substring(index + 1, obj.length)\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n</style>\r\n"]}]}