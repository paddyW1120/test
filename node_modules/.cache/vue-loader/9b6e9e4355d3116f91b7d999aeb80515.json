{"remainingRequest":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\basicinfo\\bnft-formula\\bnftAmountFormula\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\basicinfo\\bnft-formula\\bnftAmountFormula\\index.vue","mtime":1609847106517},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\babel-loader\\lib\\index.js","mtime":1706753193796},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1706753190941}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQoNCmltcG9ydCB7YXNzb2NpYXRlLCBkZWxldGVGb3JtdWxhLCBmaW5kQm5mdH0gZnJvbSAiQC9hcGkvYmFzaWNpbmZvL2JuZnRBbW91bnRGb3JtdWxhIg0KaW1wb3J0IHtmaW5kQm5mdER0dGFpbEJ5Qm5mdH0gZnJvbSAnQC9hcGkvYmFzaWNpbmZvL2FjY2VwdEluc3VyYW5jZVJ1bGVzJw0KaW1wb3J0IHtnZXRSdWxlQ29kZX0gZnJvbSAiQC9hcGkvYmFzaWNpbmZvL3BkdGVtcHBkaW5zdWFnZWluZm8iDQoNCmxldCBfdGhpcw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdibmZ0Rm9ybXVsYScsDQogIHByb3BzOiB7DQogICAgZ3VhcmFudGVlRGV0YWlsczogew0KICAgICAgdHlwZTogQXJyYXksDQogICAgICBkZWZhdWx0OiB1bmRlZmluZWQNCiAgICB9LA0KICAgIGNhbGN1bGF0aW9uRm9ybXVsYVR5cGU6IHsNCiAgICAgIHR5cGU6IFN0cmluZywNCiAgICAgIGRlZmF1bHQ6IHVuZGVmaW5lZA0KICAgIH0sDQogICAgcGRVd1NpVHlwZU9wdGlvbnM6IHsNCiAgICAgIHR5cGU6IE9iamVjdCwNCiAgICAgIHJlcXVpcmVkOiBmYWxzZSwNCiAgICB9LA0KICAgIHBkQm5mdE9wdGlvbnM6IHsNCiAgICAgIHR5cGU6IE9iamVjdCwNCiAgICAgIHJlcXVpcmVkOiBmYWxzZQ0KICAgIH0sDQogICAgcHJvZHVjdENhbGNSZXZpc2lvblNob3dJTmZvOiB7DQogICAgICB0eXBlOiBCb29sZWFuLA0KICAgICAgcmVxdWlyZWQ6IGZhbHNlLA0KICAgICAgZGVmYXVsdDogZmFsc2UNCiAgICB9DQogIH0sDQogIGZpbHRlcnM6IHsNCiAgICBmaWx0ZXJfcGRCbmZ0VHlwZShjb2RlKSB7DQogICAgICByZXR1cm4gX3RoaXMuZ2V0Q29kZU5hbWUoInBkQm5mdFR5cGUiLCBjb2RlKQ0KICAgIH0sDQogICAgZmlsdGVyX3BkQm5mdERldGFpbFR5cGUxKGNvZGUpIHsNCiAgICAgIHJldHVybiBfdGhpcy5nZXRDb2RlTmFtZSgicGRjbG1ibmZ0dHlwZTIiLCBjb2RlKQ0KICAgIH0sDQogICAgZmlsdGVyX3BkQm5mdERldGFpbFR5cGUyKGNvZGUpIHsNCiAgICAgIHJldHVybiBfdGhpcy5nZXRDb2RlTmFtZSgicGRzYm5mdG5qeGwiLCBjb2RlKQ0KICAgIH0sDQogICAgZmlsdGVyX3BkQnVzc0RldGFpbFR5cGUoY29kZSkgew0KICAgICAgcmV0dXJuIF90aGlzLmdldENvZGVOYW1lKCdydWxlQnVzaW5lc3NEZXRhaWxDbGFzcycsIGNvZGUpDQogICAgfSwNCiAgICBmaWx0ZXJfcGRBbW50Q2FsY01vZGUoY29kZSkgew0KICAgICAgcmV0dXJuIF90aGlzLmdldENvZGVOYW1lKCdwZEFtbnRDYWxNb2RlJywgY29kZSkNCiAgICB9DQogIH0sDQogIGRhdGEoKSB7DQogICAgX3RoaXMgPSB0aGlzDQogICAgcmV0dXJuIHsNCiAgICAgIHBhcmFtc19ibmZ0OiB7DQogICAgICAgIGVxX3BkSW5mb0lkOiB1bmRlZmluZWQNCiAgICAgIH0sDQogICAgICBwYXJhbXNfY2xtQm5mdDogew0KICAgICAgICBlcV9wZEJuZnRJZDogdW5kZWZpbmVkDQogICAgICB9LA0KICAgICAgcGFyYW1zX3NydmxCbmZ0OiB7DQogICAgICAgIGVxX3BkQm5mdElkOiB1bmRlZmluZWQNCiAgICAgIH0sDQogICAgICBwYXJhbXNfYnJpZWY6IHsNCiAgICAgICAgcHJvZHVjdDogdW5kZWZpbmVkLA0KICAgICAgICBwZEJ1c3NJZDogdGhpcy5wcm9kdWN0Q2FsY1JldmlzaW9uU2hvd0lOZm8gPyB1bmRlZmluZWQgOiAodGhpcy5wZEJuZnRPcHRpb25zLmlkID8gdGhpcy5wZEJuZnRPcHRpb25zLmlkIDogdGhpcy5wZFV3U2lUeXBlT3B0aW9ucy5pZCksDQogICAgICAgIHByb2R1Y3REZXRhaWxUeXBlOiAnJywNCiAgICAgICAgcGRCdXNzRGV0YWlsVHlwZUxpc3Q6IHRoaXMucHJvZHVjdENhbGNSZXZpc2lvblNob3dJTmZvID8gW10gOiBBcnJheSh0aGlzLmNhbGN1bGF0aW9uRm9ybXVsYVR5cGUpDQogICAgICB9LA0KICAgICAgcGFyYW1zX2N1cnJlbnQ6IHsNCiAgICAgICAgZXFfcGRJbmZvSWQ6IHVuZGVmaW5lZCwNCiAgICAgICAgZXFfcGRCdXNzVHlwZTogJycsDQogICAgICAgIGluX3BkQnVzc0RldGFpbFR5cGU6IFtdLA0KICAgICAgICBlcV9wZFR5cGU6ICcnLA0KICAgICAgICBlcV9wZEJ1c3NDb2RlOiAnJw0KICAgICAgfSwNCiAgICAgIGZpbHRlcnNfcGRCbmZ0RGV0YWlsVHlwZTogW10sDQogICAgICBmaWx0ZXJzX3BkQm5mdERldGFpbFR5cGVfYnJpZWY6IFtdLA0KICAgICAgZmlsdGVyc19wZENvZGU6IFtdLA0KICAgICAgZm9ybXVsYVZpZXc6IHsNCiAgICAgICAgZmxhZzogJycsDQogICAgICAgIHJ1bGVDb2RlOiAnJywNCiAgICAgICAgdmlzaWJsZTogZmFsc2UsDQogICAgICAgIHBlcmZvcm1UeXBlOiAnJw0KICAgICAgfSwNCiAgICAgIGxhbmd1YWdlOiBudWxsLA0KICAgICAgc2hvd0NsbUJuZnRGbGFnOiBmYWxzZSwNCiAgICAgIHNob3dTcnZsQm5mdEZsYWc6IGZhbHNlLA0KICAgICAgcnVsZU1lc3NhZ2VJbmZvQm9tOiBbXSwNCiAgICAgIGNvZGVGaWx0ZXJfcGRCdXNzRGV0YWlsVHlwZTogJzEkJywNCiAgICAgIHByb2R1Y3RCbmZ0Rm9ybTogew0KICAgICAgICBibmZ0RHRUeXBlOiBbXSwNCiAgICAgICAgYm5mdDogJycsDQogICAgICAgIGJuZnREdDogJycsDQogICAgICAgIEV4cHJlc3Npb25UeXBlOiAnJw0KICAgICAgfSwNCiAgICAgIHJldmlzaW9uRm9ybXVsYUZvcm06IHsNCiAgICAgICAgcGRCdXNzRGV0YWlsVHlwZTogJycNCiAgICAgIH0sDQogICAgICBzZWxlY3RlZEJuZnRJblJldjoge30sDQogICAgICBzZWxlY3RlZENsbUJuZnRJblJldjoge30sDQogICAgICBzZWxlY3RlZFNydmxCbmZ0SW5SZXY6IHt9LA0KICAgICAgdGFibGVEYXRhQm5mdDogW10sDQogICAgICB0YWJsZURhdGFDbG1CbmZ0OiBbXSwNCiAgICAgIHRhYmxlRGF0YVNydmxCbmZ0OiBbXSwNCiAgICAgIGV4cHJlc3Npb25Db25maWdzOiBbXSwNCiAgICAgIHRhYmxlRGF0YV9icmllZjogW10sDQogICAgICBzZWxlY3RlZEZvcm11bGE6IHt9LA0KICAgICAgT3B0aW9uczE6IFtdLCAvLyDkv53pmpwNCiAgICAgIE9wdGlvbnMyOiBbXSwgLy8g5L+d6Zqc5piO57uGDQogICAgICBwcm9kdWN0OiB7DQogICAgICAgIGlkOiB1bmRlZmluZWQsDQogICAgICAgIGJUeXBlOiAnJywNCiAgICAgICAgY1R5cGU6ICcnLA0KICAgICAgICBwZENvZGU6ICcnLA0KICAgICAgICBwZEVkaXRpb246ICcnLA0KICAgICAgICBwZFZlcklkOiB1bmRlZmluZWQsDQogICAgICAgIHBkU2FsZWNobmw6ICcnLA0KICAgICAgICBwZE5hbWU6ICcnLA0KICAgICAgICBwZFNob3J0bmFtZTogJycsDQogICAgICAgIHBkRW5OYW1lOiAnJywNCiAgICAgICAgcGRTaG9ydEVuTmFtZTogJycsDQogICAgICAgIG9wZXJhdG9yOiAnJywNCiAgICAgICAgcGRTdGFydERhdGVSdWxlOiAnJywNCiAgICAgICAgcGRTdGFydERhdGVNb2RlOiAnJywNCiAgICAgICAgcGRTdGFydFBlcmlvZDogdW5kZWZpbmVkLA0KICAgICAgICBwZFN0YXJ0UGVyaW9kVW5pdDogJycsDQogICAgICAgIHBkRW5kRGF0ZVJ1bGU6ICcnLA0KICAgICAgICBwZEVuZERhdGVNb2RlOiAnJywNCiAgICAgICAgcGRFbmRQZXJpb2Q6IHVuZGVmaW5lZCwNCiAgICAgICAgcGRFbmRQZXJpb2RVbml0OiAnJywNCiAgICAgICAgcGRHcmFjZVBlcmlvZDogdW5kZWZpbmVkLA0KICAgICAgICBwZE9ic2VydmF0aW9uRGF5OiB1bmRlZmluZWQsDQogICAgICAgIHBkQXBwbERhdGU6IHVuZGVmaW5lZCwNCiAgICAgICAgcGRQcm9jZXNzSWQ6IHVuZGVmaW5lZCwNCiAgICAgICAgcGRTdGFydERhdGU6IHVuZGVmaW5lZCwNCiAgICAgICAgcGRTdG9wRGF0ZTogdW5kZWZpbmVkLA0KICAgICAgICBjcmVhdGVUaW1lOiB1bmRlZmluZWQsDQogICAgICAgIHVwZGF0ZVRpbWU6IHVuZGVmaW5lZA0KICAgICAgfSwNCiAgICAgIGZvcm11bGFWaXNpYmxlOiBmYWxzZSwNCiAgICAgIGF0dHJpYnV0ZU9iajoge30sDQogICAgICBwcm9kdWN0Qm5mdEZvcm1SdWxlczogew0KICAgICAgICBibmZ0OiBbew0KICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLA0KICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuJHQoJ2JuZnRGb3JtdWxhLnBsZWFzZVNlbGVjdEJuZnRJdGVtJyksDQogICAgICAgICAgdHJpZ2dlcjogJ2NoYW5nZScNCiAgICAgICAgfV0sDQogICAgICAgIEV4cHJlc3Npb25UeXBlOiBbew0KICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLA0KICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuJHQoJ2JuZnRGb3JtdWxhLnBsZWFzZVNlbGVjdFBkQnVzc0RldGFpbFR5cGUnKSwNCiAgICAgICAgICB0cmlnZ2VyOiAnY2hhbmdlJw0KICAgICAgICB9XQ0KICAgICAgfSwNCiAgICAgIHJldmlzaW9uRm9ybXVsYUZvcm1SdWxlczogew0KICAgICAgICBwZEJ1c3NEZXRhaWxUeXBlOiBbew0KICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLA0KICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuJHQoJ2JuZnRGb3JtdWxhLnBsZWFzZVNlbGVjdFBkQnVzc0RldGFpbFR5cGUnKSwNCiAgICAgICAgICB0cmlnZ2VyOiAnY2hhbmdlJw0KICAgICAgICB9XQ0KICAgICAgfQ0KICAgIH0NCiAgfSwNCiAgd2F0Y2g6IHsNCiAgICBleHByZXNzaW9uQ29uZmlncygpIHsNCiAgICAgIC8vIHBkQm5mdERldGFpbFR5cGUg562b6YCJDQogICAgICB0aGlzLmZpbHRlcnNfcGRCbmZ0RGV0YWlsVHlwZSA9IFtdDQogICAgICBmb3IgKGNvbnN0IHJvdyBvZiB0aGlzLl8ubWFwKHRoaXMuZXhwcmVzc2lvbkNvbmZpZ3MsICdwZEJuZnREZXRhaWxUeXBlJykpIHsNCiAgICAgICAgaWYgKCFyb3cpIGNvbnRpbnVlDQogICAgICAgIGxldCBmaWx0ZXJJdGVtID0ge3RleHQ6ICcnLCB2YWx1ZTogJyd9DQogICAgICAgIGZpbHRlckl0ZW0udGV4dCA9IHJvdyArICc6JyArIHRoaXMuZ2V0Q29kZU5hbWUoJ3BkY2xtYm5mdHR5cGUyJywgcm93LCB0cnVlKQ0KICAgICAgICBmaWx0ZXJJdGVtLnZhbHVlID0gcm93DQogICAgICAgIGlmICghdGhpcy5fLmluY2x1ZGVzKHRoaXMuXy5tYXAodGhpcy5maWx0ZXJzX3BkQm5mdERldGFpbFR5cGUsICd2YWx1ZScpLCBmaWx0ZXJJdGVtLnZhbHVlKSkgew0KICAgICAgICAgIHRoaXMuZmlsdGVyc19wZEJuZnREZXRhaWxUeXBlLnB1c2goZmlsdGVySXRlbSkNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0sDQogICAgdGFibGVEYXRhX2JyaWVmKCkgew0KICAgICAgLy8gcGRCbmZ0RGV0YWlsVHlwZSDnrZvpgIkNCiAgICAgIHRoaXMuZmlsdGVyc19wZEJuZnREZXRhaWxUeXBlX2JyaWVmID0gW10NCiAgICAgIGZvciAoY29uc3Qgcm93IG9mIHRoaXMuXy5tYXAodGhpcy50YWJsZURhdGFfYnJpZWYsICdwZEJuZnREZXRhaWxUeXBlJykpIHsNCiAgICAgICAgaWYgKCFyb3cpIGNvbnRpbnVlDQogICAgICAgIGxldCBmaWx0ZXJJdGVtID0ge3RleHQ6ICcnLCB2YWx1ZTogJyd9DQogICAgICAgIGZpbHRlckl0ZW0udGV4dCA9IHJvdyArICc6JyArIHRoaXMuZ2V0Q29kZU5hbWUoJ3BkY2xtYm5mdHR5cGUyJywgcm93LCB0cnVlKQ0KICAgICAgICBmaWx0ZXJJdGVtLnZhbHVlID0gcm93DQogICAgICAgIGlmICghdGhpcy5fLmluY2x1ZGVzKHRoaXMuXy5tYXAodGhpcy5maWx0ZXJzX3BkQm5mdERldGFpbFR5cGVfYnJpZWYsICd2YWx1ZScpLCBmaWx0ZXJJdGVtLnZhbHVlKSkgew0KICAgICAgICAgIHRoaXMuZmlsdGVyc19wZEJuZnREZXRhaWxUeXBlX2JyaWVmLnB1c2goZmlsdGVySXRlbSkNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgLy8gcGRDb2RlIOetm+mAiQ0KICAgICAgdGhpcy5maWx0ZXJzX3BkQ29kZSA9IFtdDQogICAgICBmb3IgKGNvbnN0IHJvdyBvZiB0aGlzLnRhYmxlRGF0YV9icmllZikgew0KICAgICAgICBpZiAoIXJvdy5wZENvZGUpIGNvbnRpbnVlDQogICAgICAgIGxldCBmaWx0ZXJJdGVtID0ge3RleHQ6ICcnLCB2YWx1ZTogJyd9DQogICAgICAgIGZpbHRlckl0ZW0udGV4dCA9IHJvdy5wZENvZGUgKyAnOicgKyByb3cucGROYW1lDQogICAgICAgIGZpbHRlckl0ZW0udmFsdWUgPSByb3cucGRDb2RlDQogICAgICAgIGlmICghdGhpcy5fLmluY2x1ZGVzKHRoaXMuXy5tYXAodGhpcy5maWx0ZXJzX3BkQ29kZSwgJ3ZhbHVlJyksIGZpbHRlckl0ZW0udmFsdWUpKSB7DQogICAgICAgICAgdGhpcy5maWx0ZXJzX3BkQ29kZS5wdXNoKGZpbHRlckl0ZW0pDQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9DQogIH0sDQogIGFzeW5jIG1vdW50ZWQoKSB7DQogICAgdGhpcy5sYW5ndWFnZSA9IHRoaXMuJHN0b3JlLnN0YXRlLmFwcC5sYW5ndWFnZQ0KICAgIHRoaXMucnVsZU1lc3NhZ2VJbmZvQm9tID0gdGhpcy4kc3RvcmUuc3RhdGUucnVsZU1lc3NhZ2UucnVsZU1lc3NhZ2VzDQogICAgaWYgKHRoaXMucHJvZHVjdENhbGNSZXZpc2lvblNob3dJTmZvKSB7IC8vIOiuouatow0KICAgICAgYXdhaXQgdGhpcy4kcmVmcy5wYWdlX2JuZnQucmVsb2FkKCkNCiAgICB9IGVsc2UgeyAvLyDpnZ7orqLmraMNCiAgICAgIGlmICh0aGlzLmd1YXJhbnRlZURldGFpbHMgIT09IHVuZGVmaW5lZCkgew0KICAgICAgICB0aGlzLiRyZWZzLnBhZ2VfYnJpZWYucmVsb2FkKCkNCiAgICAgICAgdGhpcy5wcm9kdWN0Qm5mdEZvcm0uYm5mdER0VHlwZSA9IHRoaXMuZ3VhcmFudGVlRGV0YWlscw0KICAgICAgICB0aGlzLmZpbmRCbmZ0QnlJZCh0aGlzLmd1YXJhbnRlZURldGFpbHMpDQogICAgICAgIHRoaXMucHJvZHVjdEJuZnRGb3JtLmJuZnQgPSB0aGlzLnBkVXdTaVR5cGVPcHRpb25zLnBkQm5mdENvZGUgKyAiOiIgKyB0aGlzLnBkVXdTaVR5cGVPcHRpb25zLnBkQm5mdFR5cGUNCiAgICAgICAgdGhpcy5wcm9kdWN0Qm5mdEZvcm0uRXhwcmVzc2lvblR5cGUgPSB0aGlzLmNhbGN1bGF0aW9uRm9ybXVsYVR5cGUNCiAgICAgICAgdGhpcy5maW5kQm5mdER0dGFpbEJ5Qm5mdCh0aGlzLnByb2R1Y3RCbmZ0Rm9ybS5ibmZ0KS50aGVuKCgpID0+IHsNCiAgICAgICAgICBpZiAodGhpcy5ndWFyYW50ZWVEZXRhaWxzWzBdID09PSAnQycpIHsNCiAgICAgICAgICAgIHRoaXMucHJvZHVjdEJuZnRGb3JtLmJuZnREdCA9IHRoaXMucGRCbmZ0T3B0aW9ucy5wZENsbUJuZnRDb2RlDQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRoaXMucHJvZHVjdEJuZnRGb3JtLmJuZnREdCA9IHRoaXMucGRCbmZ0T3B0aW9ucy5wZFNydmxCbmZ0Q29kZQ0KICAgICAgICAgIH0NCiAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgICAgICB0aGlzLmhhbmRsZVNlYXJjaCgpDQogICAgICAgICAgfSkNCiAgICAgICAgfSkNCiAgICAgIH0NCiAgICB9DQogIH0sDQogIGNyZWF0ZWQoKSB7DQogICAgdGhpcy5pbml0UHJvZHVjdEluZm8oKQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgc2VsZWN0ZWRCbmZ0SW5SZXZDaGFuZ2VkKCkgew0KICAgICAgdGhpcy5zZWxlY3RlZFNydmxCbmZ0SW5SZXYgPSB7fQ0KICAgICAgdGhpcy5zZWxlY3RlZENsbUJuZnRJblJldiA9IHt9DQogICAgICBzd2l0Y2ggKHRoaXMuc2VsZWN0ZWRCbmZ0SW5SZXYucGRCbmZ0VHlwZSkgew0KICAgICAgICBjYXNlICdDJzoNCiAgICAgICAgICB0aGlzLnNob3dDbG1CbmZ0RmxhZyA9IHRydWUNCiAgICAgICAgICB0aGlzLnNob3dTcnZsQm5mdEZsYWcgPSBmYWxzZQ0KICAgICAgICAgIC8vIOW3suWFs+iBlOWFrOW8j+OAgeeugOaYjuWFrOW8jw0KICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkQm5mdEluUmV2LnBkQm5mdERldGFpbFR5cGUgIT09ICc3Jykgew0KICAgICAgICAgICAgdGhpcy5jb2RlRmlsdGVyX3BkQnVzc0RldGFpbFR5cGUgPSAnMSQyOSQzMCQzMScNCiAgICAgICAgICAgIHRoaXMucGFyYW1zX2N1cnJlbnQuZXFfcGRJbmZvSWQgPSB0aGlzLnByb2R1Y3QuaWQNCiAgICAgICAgICAgIHRoaXMucGFyYW1zX2N1cnJlbnQuZXFfcGRUeXBlID0gJzEnDQogICAgICAgICAgICB0aGlzLnBhcmFtc19jdXJyZW50LmVxX3BkQnVzc1R5cGUgPSAnMicNCiAgICAgICAgICAgIHRoaXMucGFyYW1zX2N1cnJlbnQuaW5fcGRCdXNzRGV0YWlsVHlwZSA9IEFycmF5KCcyOScsICczMCcsICczMScpDQogICAgICAgICAgICB0aGlzLnBhcmFtc19jdXJyZW50LmVxX3BkQnVzc0NvZGUgPSB0aGlzLnNlbGVjdGVkQm5mdEluUmV2LnBkQm5mdENvZGUNCiAgICAgICAgICAgIHRoaXMucGFyYW1zX2JyaWVmLnBkQnVzc0lkID0gdGhpcy5zZWxlY3RlZEJuZnRJblJldi5pZA0KICAgICAgICAgICAgdGhpcy5wYXJhbXNfYnJpZWYucGRCdXNzRGV0YWlsVHlwZUxpc3QgPSBBcnJheSgnMjknLCAnMzAnLCAnMzEnKQ0KICAgICAgICAgICAgLy8g5p+l6K+i5YWs5byPDQogICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgICAgICAgIHRoaXMuJHJlZnMucGFnZV9jdXJyZW50LnJlbG9hZCgpDQogICAgICAgICAgICAgIHRoaXMuJHJlZnMucGFnZV9icmllZi5yZWxvYWQoKQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGhpcy5jb2RlRmlsdGVyX3BkQnVzc0RldGFpbFR5cGUgPSAnMSQnDQogICAgICAgICAgfQ0KICAgICAgICAgIC8vIOafpeivoui1lOS7mOaYjue7hg0KICAgICAgICAgIHRoaXMucGFyYW1zX2NsbUJuZnQuZXFfcGRCbmZ0SWQgPSB0aGlzLnNlbGVjdGVkQm5mdEluUmV2LmlkDQogICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gew0KICAgICAgICAgICAgdGhpcy4kcmVmcy5wYWdlX2NsbUJuZnQucmVsb2FkKCkNCiAgICAgICAgICAgIGlmICh0aGlzLiRyZWZzLnJldmlzaW9uRm9ybXVsYUZvcm0pIHsNCiAgICAgICAgICAgICAgdGhpcy4kcmVmcy5yZXZpc2lvbkZvcm11bGFGb3JtLmNsZWFyVmFsaWRhdGUoKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pDQogICAgICAgICAgYnJlYWsNCiAgICAgICAgY2FzZSAnQSc6DQogICAgICAgIGNhc2UgJ00nOg0KICAgICAgICAgIHRoaXMuc2hvd0NsbUJuZnRGbGFnID0gZmFsc2UNCiAgICAgICAgICB0aGlzLnNob3dTcnZsQm5mdEZsYWcgPSB0cnVlDQogICAgICAgICAgLy8g5bey5YWz6IGU5YWs5byP44CB566A5piO5YWs5byPDQogICAgICAgICAgdGhpcy5jb2RlRmlsdGVyX3BkQnVzc0RldGFpbFR5cGUgPSAnMSQyOSQzMCcNCiAgICAgICAgICB0aGlzLnBhcmFtc19jdXJyZW50LmVxX3BkSW5mb0lkID0gdGhpcy5wcm9kdWN0LmlkDQogICAgICAgICAgdGhpcy5wYXJhbXNfY3VycmVudC5lcV9wZFR5cGUgPSAnMScNCiAgICAgICAgICB0aGlzLnBhcmFtc19jdXJyZW50LmVxX3BkQnVzc1R5cGUgPSAnMicNCiAgICAgICAgICB0aGlzLnBhcmFtc19jdXJyZW50LmluX3BkQnVzc0RldGFpbFR5cGUgPSBBcnJheSgnMjknLCAnMzAnKQ0KICAgICAgICAgIHRoaXMucGFyYW1zX2N1cnJlbnQuZXFfcGRCdXNzQ29kZSA9IHRoaXMuc2VsZWN0ZWRCbmZ0SW5SZXYucGRCbmZ0Q29kZQ0KICAgICAgICAgIHRoaXMucGFyYW1zX2JyaWVmLnBkQnVzc0lkID0gdGhpcy5zZWxlY3RlZEJuZnRJblJldi5pZA0KICAgICAgICAgIHRoaXMucGFyYW1zX2JyaWVmLnBkQnVzc0RldGFpbFR5cGVMaXN0ID0gQXJyYXkoJzI5JywgJzMwJykNCiAgICAgICAgICAvLyDmn6Xor6LnlJ/lrZjmmI7nu4YNCiAgICAgICAgICB0aGlzLnBhcmFtc19zcnZsQm5mdC5lcV9wZEJuZnRJZCA9IHRoaXMuc2VsZWN0ZWRCbmZ0SW5SZXYuaWQNCiAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgICAgICB0aGlzLiRyZWZzLnBhZ2VfY3VycmVudC5yZWxvYWQoKQ0KICAgICAgICAgICAgdGhpcy4kcmVmcy5wYWdlX2JyaWVmLnJlbG9hZCgpDQogICAgICAgICAgICB0aGlzLiRyZWZzLnBhZ2Vfc3J2bEJuZnQucmVsb2FkKCkNCiAgICAgICAgICAgIGlmICh0aGlzLiRyZWZzLnJldmlzaW9uUnVsZUZvcm0pIHsNCiAgICAgICAgICAgICAgdGhpcy4kcmVmcy5yZXZpc2lvblJ1bGVGb3JtLmNsZWFyVmFsaWRhdGUoKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pDQogICAgICAgICAgYnJlYWsNCiAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICB0aGlzLnNob3dDbG1CbmZ0RmxhZyA9IGZhbHNlDQogICAgICAgICAgdGhpcy5zaG93U3J2bEJuZnRGbGFnID0gZmFsc2UNCiAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgICAgICBpZiAodGhpcy4kcmVmcy5yZXZpc2lvblJ1bGVGb3JtKSB7DQogICAgICAgICAgICAgIHRoaXMuJHJlZnMucmV2aXNpb25SdWxlRm9ybS5jbGVhclZhbGlkYXRlKCkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9KQ0KICAgICAgICAgIGJyZWFrDQogICAgICB9DQogICAgfSwNCiAgICBzZWxlY3RlZENsbUJuZnRJblJldkNoYW5nZWQoKSB7DQogICAgICB0aGlzLmNvZGVGaWx0ZXJfcGRCdXNzRGV0YWlsVHlwZSA9ICcxJDIwJDIxJw0KICAgICAgdGhpcy5wYXJhbXNfY3VycmVudC5pbl9wZEJ1c3NEZXRhaWxUeXBlID0gQXJyYXkoJzIwJywgJzIxJykNCiAgICAgIHRoaXMucGFyYW1zX2N1cnJlbnQuZXFfcGRCdXNzQ29kZSA9IHRoaXMuc2VsZWN0ZWRDbG1CbmZ0SW5SZXYucGRDbG1CbmZ0Q29kZQ0KICAgICAgdGhpcy5wYXJhbXNfYnJpZWYucGRCdXNzSWQgPSB0aGlzLnNlbGVjdGVkQ2xtQm5mdEluUmV2LmlkDQogICAgICB0aGlzLnBhcmFtc19icmllZi5wZEJ1c3NEZXRhaWxUeXBlTGlzdCA9IEFycmF5KCcyMCcsICcyMScpDQogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgIHRoaXMuJHJlZnMucGFnZV9jdXJyZW50LnJlbG9hZCgpDQogICAgICAgIHRoaXMuJHJlZnMucGFnZV9icmllZi5yZWxvYWQoKQ0KICAgICAgICBpZiAodGhpcy4kcmVmcy5yZXZpc2lvblJ1bGVGb3JtKSB7DQogICAgICAgICAgdGhpcy4kcmVmcy5yZXZpc2lvblJ1bGVGb3JtLmNsZWFyVmFsaWRhdGUoKQ0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQogICAgc2VsZWN0ZWRTcnZsQm5mdEluUmV2Q2hhbmdlZCgpIHsNCiAgICAgIHRoaXMuY29kZUZpbHRlcl9wZEJ1c3NEZXRhaWxUeXBlID0gJzEkMjckMjgnDQogICAgICB0aGlzLnBhcmFtc19jdXJyZW50LmluX3BkQnVzc0RldGFpbFR5cGUgPSBBcnJheSgnMjcnLCAnMjgnKQ0KICAgICAgdGhpcy5wYXJhbXNfY3VycmVudC5lcV9wZEJ1c3NDb2RlID0gdGhpcy5zZWxlY3RlZFNydmxCbmZ0SW5SZXYucGRTcnZsQm5mdENvZGUNCiAgICAgIHRoaXMucGFyYW1zX2JyaWVmLnBkQnVzc0lkID0gdGhpcy5zZWxlY3RlZFNydmxCbmZ0SW5SZXYuaWQNCiAgICAgIHRoaXMucGFyYW1zX2JyaWVmLnBkQnVzc0RldGFpbFR5cGVMaXN0ID0gQXJyYXkoJzI3JywgJzI4JykNCiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsNCiAgICAgICAgdGhpcy4kcmVmcy5wYWdlX2N1cnJlbnQucmVsb2FkKCkNCiAgICAgICAgdGhpcy4kcmVmcy5wYWdlX2JyaWVmLnJlbG9hZCgpDQogICAgICAgIGlmICh0aGlzLiRyZWZzLnJldmlzaW9uUnVsZUZvcm0pIHsNCiAgICAgICAgICB0aGlzLiRyZWZzLnJldmlzaW9uUnVsZUZvcm0uY2xlYXJWYWxpZGF0ZSgpDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfSwNCiAgICByb3dDbGlja0JuZnQocm93LCBjb2x1bW4sIGV2ZW50KSB7DQogICAgICBpZiAoZXZlbnQudGFyZ2V0Lm5vZGVOYW1lID09PSAiSU5QVVQiKSB7DQogICAgICAgIGlmIChyb3cuaWQgPT09IHRoaXMuc2VsZWN0ZWRCbmZ0SW5SZXYuaWQpIHsNCiAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZEJuZnRJblJldi5wZEJuZnREZXRhaWxUeXBlICE9PSAnNycpIHsNCiAgICAgICAgICAgIHRoaXMuZXhwcmVzc2lvbkNvbmZpZ3MgPSBbXQ0KICAgICAgICAgICAgdGhpcy4kcmVmcy5wYWdlX2N1cnJlbnQudG90YWwgPSAwDQogICAgICAgICAgICB0aGlzLiRyZWZzLnBhZ2VfY3VycmVudC5wYWdlID0gMQ0KICAgICAgICAgICAgdGhpcy50YWJsZURhdGFfYnJpZWYgPSBbXQ0KICAgICAgICAgICAgdGhpcy4kcmVmcy5wYWdlX2JyaWVmLnRvdGFsID0gMA0KICAgICAgICAgICAgdGhpcy4kcmVmcy5wYWdlX2JyaWVmLnBhZ2UgPSAxDQogICAgICAgICAgfQ0KICAgICAgICAgIHRoaXMuc2VsZWN0ZWRCbmZ0SW5SZXYgPSB7fQ0KICAgICAgICAgIHRoaXMuc2VsZWN0ZWRDbG1CbmZ0SW5SZXYgPSB7fQ0KICAgICAgICAgIHRoaXMuc2VsZWN0ZWRTcnZsQm5mdEluUmV2ID0ge30NCiAgICAgICAgICB0aGlzLmNvZGVGaWx0ZXJfcGRCdXNzRGV0YWlsVHlwZSA9ICcxJCcNCiAgICAgICAgICB0aGlzLnBhcmFtc19icmllZi5wZEJ1c3NJZCA9IHVuZGVmaW5lZA0KICAgICAgICAgIHRoaXMuc2hvd0NsbUJuZnRGbGFnID0gZmFsc2UNCiAgICAgICAgICB0aGlzLnNob3dTcnZsQm5mdEZsYWcgPSBmYWxzZQ0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCiAgICByb3dDbGlja0NsbUJuZnQocm93LCBjb2x1bW4sIGV2ZW50KSB7DQogICAgICBpZiAoZXZlbnQudGFyZ2V0Lm5vZGVOYW1lID09PSAiSU5QVVQiKSB7DQogICAgICAgIGlmIChyb3cuaWQgPT09IHRoaXMuc2VsZWN0ZWRDbG1CbmZ0SW5SZXYuaWQpIHsNCiAgICAgICAgICB0aGlzLnNlbGVjdGVkQ2xtQm5mdEluUmV2ID0ge30NCiAgICAgICAgICB0aGlzLnNlbGVjdGVkQm5mdEluUmV2Q2hhbmdlZCgpDQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9LA0KICAgIHJvd0NsaWNrU3J2bEJuZnQocm93LCBjb2x1bW4sIGV2ZW50KSB7DQogICAgICBpZiAoZXZlbnQudGFyZ2V0Lm5vZGVOYW1lID09PSAiSU5QVVQiKSB7DQogICAgICAgIGlmIChyb3cuaWQgPT09IHRoaXMuc2VsZWN0ZWRTcnZsQm5mdEluUmV2LmlkKSB7DQogICAgICAgICAgdGhpcy5zZWxlY3RlZFNydmxCbmZ0SW5SZXYgPSB7fQ0KICAgICAgICAgIHRoaXMuc2VsZWN0ZWRCbmZ0SW5SZXZDaGFuZ2VkKCkNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0sDQogICAgc2hvd0Zvcm11bGEocm93KSB7DQogICAgICB0aGlzLmZvcm11bGFWaWV3LmZsYWcgPSAnMScNCiAgICAgIHRoaXMuZm9ybXVsYVZpZXcucnVsZUNvZGUgPSByb3cucGRDYWxjQ29kZQ0KICAgICAgdGhpcy5mb3JtdWxhVmlldy5wZXJmb3JtVHlwZSA9IHJvdy5wZXJmb3JtVHlwZQ0KICAgICAgdGhpcy5mb3JtdWxhVmlldy52aXNpYmxlID0gdHJ1ZQ0KICAgIH0sDQogICAgcnVsZU1vZHVsZUNsb3NlZCgpIHsNCiAgICAgIHRoaXMuZm9ybXVsYVZpc2libGUgPSBmYWxzZQ0KICAgICAgdGhpcy4kcmVmcy5wYWdlX2JyaWVmLnJlbG9hZCgpDQogICAgfSwNCiAgICBmb3JtdWxhVmlld0Nsb3NlZCgpIHsNCiAgICAgIHRoaXMuZm9ybXVsYVZpZXcudmlzaWJsZSA9IGZhbHNlDQogICAgICB0aGlzLnNlbGVjdGVkRm9ybXVsYSA9IHt9DQogICAgfSwNCiAgICBoYW5kbGVTZWFyY2goKSB7DQogICAgICB0aGlzLnBhcmFtc19jdXJyZW50LmVxX3BkSW5mb0lkID0gdGhpcy5wcm9kdWN0LmlkDQogICAgICB0aGlzLnBhcmFtc19jdXJyZW50LmVxX3BkVHlwZSA9ICcxJw0KICAgICAgdGhpcy5wYXJhbXNfY3VycmVudC5lcV9wZEJ1c3NUeXBlID0gJzInDQogICAgICB0aGlzLnBhcmFtc19jdXJyZW50LmluX3BkQnVzc0RldGFpbFR5cGUgPSBBcnJheSh0aGlzLmNhbGN1bGF0aW9uRm9ybXVsYVR5cGUpDQogICAgICB0aGlzLnBhcmFtc19jdXJyZW50LmVxX3BkQnVzc0NvZGUgPSB0aGlzLnBkQm5mdE9wdGlvbnMuaWQgPyAodGhpcy5ndWFyYW50ZWVEZXRhaWxzWzBdID09PSAnQycgPyB0aGlzLnBkQm5mdE9wdGlvbnMucGRDbG1CbmZ0Q29kZSA6IHRoaXMucGRCbmZ0T3B0aW9ucy5wZFNydmxCbmZ0Q29kZSkgOiB0aGlzLnBkVXdTaVR5cGVPcHRpb25zLnBkQm5mdENvZGUNCiAgICAgIHRoaXMuJHJlZnMucGFnZV9jdXJyZW50LnJlbG9hZCgpDQogICAgfSwNCiAgICBoYW5kbGVTZWFyY2hJblJldmlzaW9uKCkgew0KICAgICAgdGhpcy4kcmVmcy5wYWdlX2N1cnJlbnQucmVsb2FkKCkNCiAgICAgIHRoaXMuJHJlZnMucGFnZV9icmllZi5yZWxvYWQoKQ0KICAgIH0sDQogICAgaW5pdFByb2R1Y3RJbmZvKCkgew0KICAgICAgbGV0IHBkdGVtcFBkSW5mbyA9IHRoaXMuZ2V0UGREYXRhKCkNCiAgICAgIGlmIChPYmplY3Qua2V5cyhwZHRlbXBQZEluZm8pLmxlbmd0aCA+IDApIHsNCiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLnByb2R1Y3QsIHBkdGVtcFBkSW5mbykNCiAgICAgICAgdGhpcy5wYXJhbXNfYnJpZWYucHJvZHVjdCA9IHBkdGVtcFBkSW5mbw0KICAgICAgICB0aGlzLnBhcmFtc19ibmZ0LmVxX3BkSW5mb0lkID0gcGR0ZW1wUGRJbmZvLmlkDQogICAgICAgIHRoaXMucGFyYW1zX2JyaWVmLnByb2R1Y3REZXRhaWxUeXBlID0gdGhpcy5wcm9kdWN0LmNUeXBlDQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLm5vdGlmeUVycm9yKHRoaXMuJHQoJ21lc3NhZ2UuaW52YWxpZFByb2R1Y3RJbmZvJykpDQogICAgICB9DQogICAgfSwNCiAgICAvLyDmmL7npLrkv53pmpzpobnmlbDnu4QNCiAgICBmaW5kQm5mdEJ5SWQodmFsKSB7DQogICAgICB0aGlzLnByb2R1Y3RCbmZ0Rm9ybS5ibmZ0ID0gJycNCiAgICAgIHRoaXMucHJvZHVjdEJuZnRGb3JtLmJuZnREdCA9ICcnDQogICAgICB0aGlzLk9wdGlvbnMxID0gW10NCiAgICAgIHRoaXMuT3B0aW9uczIgPSBbXQ0KICAgICAgbGV0IHBhcmFtcyA9IHsNCiAgICAgICAgcGRJbmZvSWQ6ICcnLA0KICAgICAgICBwZEJuZnRUeXBlOiAnJywNCiAgICAgICAgcGRCbmZ0RGV0YWlsVHlwZTogJycsDQogICAgICB9DQogICAgICBpZiAodGhpcy5wZFV3U2lUeXBlT3B0aW9ucykgew0KICAgICAgICBwYXJhbXMucGRJbmZvSWQgPSB0aGlzLnBkVXdTaVR5cGVPcHRpb25zLnBkSW5mb0lkDQogICAgICB9IGVsc2Ugew0KICAgICAgICBwYXJhbXMucGRJbmZvSWQgPSB0aGlzLnByb2R1Y3QuaWQNCiAgICAgIH0NCiAgICAgIHBhcmFtcy5wZEJuZnRUeXBlID0gdmFsWzBdDQogICAgICBwYXJhbXMucGRCbmZ0RGV0YWlsVHlwZSA9IHZhbFsxXQ0KICAgICAgZmluZEJuZnQodGhpcy5idWlsZFJlcXVlc3REYXRhKHBhcmFtcykpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgbGV0IGRhdGEgPSByZXMuZGF0YQ0KICAgICAgICBpZiAoZGF0YS5sZW5ndGgpIHsNCiAgICAgICAgICBkYXRhLmZvckVhY2godmFsID0+IHsNCiAgICAgICAgICAgIHRoaXMuT3B0aW9uczEucHVzaCh7DQogICAgICAgICAgICAgIGVudGl0eTogdmFsLA0KICAgICAgICAgICAgICBrZXk6IHZhbC5wZEJuZnRDb2RlLA0KICAgICAgICAgICAgICB2YWx1ZTogdmFsLnBkQm5mdENvZGUgKyAiOiIgKyB2YWwucGRCbmZ0VHlwZSwNCiAgICAgICAgICAgICAgbGFiZWw6IHZhbC5wZEJuZnRDb2RlICsgIjoiICsgdmFsLnBkQm5mdE5hbWUNCiAgICAgICAgICAgIH0pDQogICAgICAgICAgfSkNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLiRyZWZzLnByb2R1Y3RCbmZ0Rm9ybS5jbGVhclZhbGlkYXRlKCkNCiAgICAgIH0pDQogICAgfSwNCiAgICBnZXRDYXB0aW9uKG9iaiwgc3RhdGUpIHsNCiAgICAgIGNvbnN0IGluZGV4ID0gb2JqLmxhc3RJbmRleE9mKCI6IikNCiAgICAgIGlmIChzdGF0ZSA9PT0gMCkgew0KICAgICAgICByZXR1cm4gb2JqLnN1YnN0cmluZygwLCBpbmRleCkNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiBvYmouc3Vic3RyaW5nKGluZGV4ICsgMSwgb2JqLmxlbmd0aCkNCiAgICAgIH0NCiAgICB9LA0KICAgIC8vIOaYvuekuuS/nemanOaYjue7humhueaVsOe7hA0KICAgIGFzeW5jIGZpbmRCbmZ0RHR0YWlsQnlCbmZ0KHJvdykgew0KICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gew0KICAgICAgICB0aGlzLk9wdGlvbnMyID0gW10NCiAgICAgICAgdGhpcy5wcm9kdWN0Qm5mdEZvcm0uYm5mdER0ID0gJycNCiAgICAgICAgaWYgKHJvdykgew0KICAgICAgICAgIGxldCBkYXRhID0gew0KICAgICAgICAgICAgcGRCbmZ0Q29kZTogdGhpcy5nZXRDYXB0aW9uKHJvdywgMCksDQogICAgICAgICAgICBwZEJuZnRUeXBlOiB0aGlzLmdldENhcHRpb24ocm93LCAxKQ0KICAgICAgICAgIH0NCiAgICAgICAgICBmaW5kQm5mdER0dGFpbEJ5Qm5mdChkYXRhKS50aGVuKHJlcyA9PiB7DQogICAgICAgICAgICBsZXQgZGF0YSA9IHJlcy5kYXRhDQogICAgICAgICAgICBpZiAoZGF0YS5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgaWYgKHRoaXMuZ2V0Q2FwdGlvbihyb3csIDEpID09PSAnQycpIHsNCiAgICAgICAgICAgICAgICBkYXRhLmZvckVhY2godmFsID0+IHsNCiAgICAgICAgICAgICAgICAgIHRoaXMuT3B0aW9uczIucHVzaCh7DQogICAgICAgICAgICAgICAgICAgIGVudGl0eTogdmFsLA0KICAgICAgICAgICAgICAgICAgICBrZXk6IHZhbC5wZENsbUJuZnRDb2RlLA0KICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdmFsLnBkQ2xtQm5mdENvZGUsDQogICAgICAgICAgICAgICAgICAgIGxhYmVsOiB2YWwucGRDbG1CbmZ0Q29kZSArICI6IiArIHZhbC5wZENsbUJuZnROYW1lDQogICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgZGF0YS5mb3JFYWNoKHZhbCA9PiB7DQogICAgICAgICAgICAgICAgICB0aGlzLk9wdGlvbnMyLnB1c2goew0KICAgICAgICAgICAgICAgICAgICBlbnRpdHk6IHZhbCwNCiAgICAgICAgICAgICAgICAgICAga2V5OiB2YWwucGRTcnZsQm5mdENvZGUsDQogICAgICAgICAgICAgICAgICAgIHZhbHVlOiB2YWwucGRTcnZsQm5mdENvZGUsDQogICAgICAgICAgICAgICAgICAgIGxhYmVsOiB2YWwucGRTcnZsQm5mdENvZGUgKyAiOiIgKyB2YWwucGRTcnZsQm5mdE5hbWUNCiAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmVzb2x2ZSgpDQogICAgICAgICAgfSkNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICByZXNvbHZlKCkNCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9LA0KICAgIGJhY2soKSB7DQogICAgICB0aGlzLiRlbWl0KCdjaGFuZ2VEaWFsb2dWaXNpYmxlX2Zvcm11bGEyJywgZmFsc2UpDQogICAgfSwNCiAgICB0b0Zvcm11bGFTZWxlY3QoKSB7DQogICAgICBpZiAodGhpcy5wcm9kdWN0Q2FsY1JldmlzaW9uU2hvd0lOZm8pIHsgLy8g6K6i5q2jDQogICAgICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLnNlbGVjdGVkQm5mdEluUmV2KS5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICB0aGlzLm5vdGlmeUVycm9yKHRoaXMuJHQoJ2JuZnRGb3JtdWxhLnBsZWFzZVNlbGVjdFBkQm5mdEl0ZW0nKSkNCiAgICAgICAgICByZXR1cm4NCiAgICAgICAgfQ0KICAgICAgICB0aGlzLiRyZWZzLnJldmlzaW9uRm9ybXVsYUZvcm0udmFsaWRhdGUocGFzcyA9PiB7DQogICAgICAgICAgaWYgKHBhc3MpIHsNCiAgICAgICAgICAgIHRoaXMuJGVtaXQoJ2NoYW5nZURpYWxvZ1Zpc2libGVfZm9ybXVsYVNlbGVjdDInLCB0cnVlLA0KICAgICAgICAgICAgICBbdGhpcy5zZWxlY3RlZEJuZnRJblJldi5wZEJuZnRUeXBlXSwgdGhpcy5yZXZpc2lvbkZvcm11bGFGb3JtLnBkQnVzc0RldGFpbFR5cGUsIHRoaXMuc2VsZWN0ZWRCbmZ0SW5SZXYucGRCbmZ0Q29kZSArICc6JywNCiAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEJuZnRJblJldi5wZEJuZnRUeXBlID09PSAnQycgPyB0aGlzLnNlbGVjdGVkQ2xtQm5mdEluUmV2LnBkQ2xtQm5mdENvZGUgOiB0aGlzLnNlbGVjdGVkU3J2bEJuZnRJblJldi5wZFNydmxCbmZ0Q29kZSkNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGhpcy5mb2N1c0l0ZW0oKQ0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICAgIH0gZWxzZSB7IC8vIOmdnuiuouatow0KICAgICAgICBpZiAodGhpcy5wcm9kdWN0Qm5mdEZvcm0uYm5mdER0VHlwZS5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICB0aGlzLm5vdGlmeUVycm9yKHRoaXMuJHQoJ2JuZnRGb3JtdWxhLnBsZWFzZVNlbGVjdEJuZnREZXRhaWxUeXBlJykpDQogICAgICAgICAgcmV0dXJuDQogICAgICAgIH0NCiAgICAgICAgaWYgKCF0aGlzLnByb2R1Y3RCbmZ0Rm9ybS5FeHByZXNzaW9uVHlwZSkgew0KICAgICAgICAgIHRoaXMubm90aWZ5RXJyb3IodGhpcy4kdCgnYm5mdEZvcm11bGEucGxlYXNlU2VsZWN0UGRCdXNzRGV0YWlsVHlwZScpKQ0KICAgICAgICAgIHJldHVybg0KICAgICAgICB9DQogICAgICAgIGlmICghdGhpcy5wcm9kdWN0Qm5mdEZvcm0uYm5mdCkgew0KICAgICAgICAgIHRoaXMubm90aWZ5RXJyb3IodGhpcy4kdCgnYm5mdEZvcm11bGEucGxlYXNlU2VsZWN0UGRCbmZ0SXRlbScpKQ0KICAgICAgICAgIHJldHVybg0KICAgICAgICB9DQogICAgICAgIHRoaXMuJGVtaXQoJ2NoYW5nZURpYWxvZ1Zpc2libGVfZm9ybXVsYVNlbGVjdDInLCB0cnVlLA0KICAgICAgICAgIHRoaXMucHJvZHVjdEJuZnRGb3JtLmJuZnREdFR5cGUsIHRoaXMucHJvZHVjdEJuZnRGb3JtLkV4cHJlc3Npb25UeXBlLCB0aGlzLnByb2R1Y3RCbmZ0Rm9ybS5ibmZ0LCB0aGlzLnByb2R1Y3RCbmZ0Rm9ybS5ibmZ0RHQpDQogICAgICB9DQogICAgfSwNCiAgICB0b0FkZEZvcm11bGEoKSB7DQogICAgICBsZXQgcGFzc0ZsYWcgPSB0cnVlDQogICAgICBpZiAodGhpcy5wcm9kdWN0Q2FsY1JldmlzaW9uU2hvd0lOZm8pIHsNCiAgICAgICAgdGhpcy4kcmVmcy5yZXZpc2lvbkZvcm11bGFGb3JtLnZhbGlkYXRlKHBhc3MgPT4gew0KICAgICAgICAgIGlmICghcGFzcykgew0KICAgICAgICAgICAgcGFzc0ZsYWcgPSBmYWxzZQ0KICAgICAgICAgICAgdGhpcy5mb2N1c0l0ZW0oKQ0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICAgIH0NCiAgICAgIGlmICghcGFzc0ZsYWcpIHsNCiAgICAgICAgcmV0dXJuDQogICAgICB9DQogICAgICBjb25zdCBwYXJhbSA9IHsNCiAgICAgICAgcGRCdXNzVHlwZTogJzInLA0KICAgICAgICBwZEJ1c3NEZXRhaWxUeXBlOiB0aGlzLnByb2R1Y3RDYWxjUmV2aXNpb25TaG93SU5mbyA/IHRoaXMucmV2aXNpb25Gb3JtdWxhRm9ybS5wZEJ1c3NEZXRhaWxUeXBlIDogdGhpcy5jYWxjdWxhdGlvbkZvcm11bGFUeXBlDQogICAgICB9DQogICAgICBnZXRSdWxlQ29kZSh0aGlzLmJ1aWxkUmVxdWVzdERhdGEocGFyYW0pKS50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgdGhpcy5hdHRyaWJ1dGVPYmogPSB7DQogICAgICAgICAgY29kZTogcmVzcG9uc2UuZGF0YSwNCiAgICAgICAgICBydWxlQnVzc01vZHU6ICcyJywNCiAgICAgICAgICBydWxlQnVzc01vZHVEZXRhOiBwYXJhbS5wZEJ1c3NEZXRhaWxUeXBlLA0KICAgICAgICAgIHJ1bGVUeXBlOiAnMicsDQogICAgICAgICAgcnVsZUF0dHI6ICcyJywNCiAgICAgICAgICBwZFR5cGU6ICcxJywNCiAgICAgICAgICByaXNrVHlwZTogdGhpcy5wcm9kdWN0LmJUeXBlLA0KICAgICAgICAgIHJpc2tEZXRhaWw6IHRoaXMucHJvZHVjdC5jVHlwZSwNCiAgICAgICAgICBwZENvZGU6IHRoaXMucHJvZHVjdC5wZENvZGUsDQogICAgICAgICAgcGRFZGl0aW9uOiB0aGlzLnByb2R1Y3QucGRFZGl0aW9uDQogICAgICAgIH0NCiAgICAgICAgdGhpcy5mb3JtdWxhVmlzaWJsZSA9IHRydWUNCiAgICAgIH0pDQogICAgfSwNCiAgICBzZWxlY3RlZEZvcm11bGFDaGFuZ2VkKCkgew0KICAgICAgdGhpcy5mb3JtdWxhVmlldy5mbGFnID0gdGhpcy5zZWxlY3RlZEZvcm11bGEucnVsZUF0dHIgPT09ICcxJyA/ICcxJyA6ICcyJw0KICAgICAgdGhpcy5mb3JtdWxhVmlldy5wZXJmb3JtVHlwZSA9IHRoaXMuc2VsZWN0ZWRGb3JtdWxhLnBlcmZvcm1UeXBlDQogICAgICB0aGlzLmZvcm11bGFWaWV3LnJ1bGVDb2RlID0gdGhpcy5zZWxlY3RlZEZvcm11bGEucGRDYWxjQ29kZQ0KICAgICAgdGhpcy5mb3JtdWxhVmlldy52aXNpYmxlID0gdHJ1ZQ0KICAgIH0sDQogICAgZGVsZXRlRm9ybXVsYShyb3cpIHsNCiAgICAgIGRlbGV0ZUZvcm11bGEocm93KS50aGVuKCgpID0+IHsNCiAgICAgICAgdGhpcy5ub3RpZnlTdWNjZXNzKHRoaXMuJHQoJ3N1Y2Nlc3NNZXNzYWdlLmRlbGV0ZScpKQ0KICAgICAgICB0aGlzLiRyZWZzLnBhZ2VfY3VycmVudC5yZWxvYWQoKQ0KICAgICAgICB0aGlzLiRyZWZzLnBhZ2VfYnJpZWYucmVsb2FkKCkNCiAgICAgICAgdGhpcy4kZW1pdCgnYnJpbmdJbkNhbGNDb2RlJywgdGhpcy5jYWxjdWxhdGlvbkZvcm11bGFUeXBlLCByb3cucGRCdXNzQ29kZSwgJycpDQogICAgICB9KQ0KICAgIH0sDQogICAgaGFuZGxlU2VsZWN0Rm9ybXVsYShyb3cpIHsNCiAgICAgIGxldCBwYXNzRmxhZyA9IHRydWUNCiAgICAgIC8vIOiuouato+aXtu+8jOi/m+ihjOihqOWNlemqjOivgQ0KICAgICAgaWYgKHRoaXMucHJvZHVjdENhbGNSZXZpc2lvblNob3dJTmZvKSB7DQogICAgICAgIHRoaXMuJHJlZnMucmV2aXNpb25Gb3JtdWxhRm9ybS52YWxpZGF0ZShwYXNzID0+IHsNCiAgICAgICAgICBpZiAoIXBhc3MpIHsNCiAgICAgICAgICAgIHRoaXMuZm9jdXNJdGVtKCkNCiAgICAgICAgICAgIHBhc3NGbGFnID0gZmFsc2UNCiAgICAgICAgICB9DQogICAgICAgIH0pDQogICAgICB9DQogICAgICBpZiAoIXBhc3NGbGFnKSB7DQogICAgICAgIHJldHVybg0KICAgICAgfQ0KICAgICAgbGV0IFBkdGVtcFBkQ2FsYyA9IHsNCiAgICAgICAgcGRJbmZvSWQ6IHRoaXMucHJvZHVjdC5pZCwNCiAgICAgICAgcGRWZXJJZDogdGhpcy5wcm9kdWN0LnBkVmVySWQsDQogICAgICAgIHBkVHlwZTogJzEnLA0KICAgICAgICBwZENvZGU6IHRoaXMucHJvZHVjdC5wZENvZGUsDQogICAgICAgIHBkQnVzc1R5cGU6ICcyJywNCiAgICAgICAgcGRCdXNzRGV0YWlsVHlwZTogdGhpcy5wcm9kdWN0Q2FsY1JldmlzaW9uU2hvd0lOZm8gPyB0aGlzLnJldmlzaW9uRm9ybXVsYUZvcm0ucGRCdXNzRGV0YWlsVHlwZSA6IHRoaXMuY2FsY3VsYXRpb25Gb3JtdWxhVHlwZSwNCiAgICAgICAgcGRCdXNzSWQ6ICcnLA0KICAgICAgICBwZEJ1c3NDb2RlOiAnJywNCiAgICAgICAgcGRTdHJ1Y3R1cmVUeXBlOiAnJywNCiAgICAgICAgcGRDYWxjQ29kZTogcm93LnBkQ2FsY0NvZGUsDQogICAgICAgIHBkQ2FsY0Rlc2M6IHJvdy5wZENhbGNEZXNjDQogICAgICB9DQogICAgICBjb25zdCBwZEJuZnRUeXBlID0gdGhpcy5wcm9kdWN0Q2FsY1JldmlzaW9uU2hvd0lOZm8gPyB0aGlzLnNlbGVjdGVkQm5mdEluUmV2LnBkQm5mdFR5cGUgOiB0aGlzLmd1YXJhbnRlZURldGFpbHNbMF0NCiAgICAgIGlmICghdGhpcy5wcm9kdWN0Q2FsY1JldmlzaW9uU2hvd0lOZm8pIHsgLy8g6Z2e5YWs5byP6K6i5q2jDQogICAgICAgIGlmICh0aGlzLnByb2R1Y3RCbmZ0Rm9ybS5ibmZ0RHQpIHsNCiAgICAgICAgICBQZHRlbXBQZENhbGMucGRCdXNzSWQgPSB0aGlzLnBkQm5mdE9wdGlvbnMuaWQNCiAgICAgICAgICBpZiAocGRCbmZ0VHlwZSA9PT0gJ0MnKSB7DQogICAgICAgICAgICBQZHRlbXBQZENhbGMucGRTdHJ1Y3R1cmVUeXBlID0gJzAyJw0KICAgICAgICAgICAgUGR0ZW1wUGRDYWxjLnBkQnVzc0NvZGUgPSB0aGlzLnBkQm5mdE9wdGlvbnMucGRDbG1CbmZ0Q29kZQ0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBQZHRlbXBQZENhbGMucGRTdHJ1Y3R1cmVUeXBlID0gJzA0Jw0KICAgICAgICAgICAgUGR0ZW1wUGRDYWxjLnBkQnVzc0NvZGUgPSB0aGlzLnBkQm5mdE9wdGlvbnMucGRTcnZsQm5mdENvZGUNCiAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgUGR0ZW1wUGRDYWxjLnBkQnVzc0lkID0gdGhpcy5wZFV3U2lUeXBlT3B0aW9ucy5pZA0KICAgICAgICAgIFBkdGVtcFBkQ2FsYy5wZEJ1c3NDb2RlID0gdGhpcy5wZFV3U2lUeXBlT3B0aW9ucy5wZEJuZnRDb2RlDQogICAgICAgICAgUGR0ZW1wUGRDYWxjLnBkU3RydWN0dXJlVHlwZSA9ICcwMScNCiAgICAgICAgfQ0KICAgICAgfSBlbHNlIHsgLy8g5YWs5byP6K6i5q2jDQogICAgICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLnNlbGVjdGVkQ2xtQm5mdEluUmV2KS5sZW5ndGggPiAwKSB7DQogICAgICAgICAgUGR0ZW1wUGRDYWxjLnBkQnVzc0lkID0gdGhpcy5zZWxlY3RlZENsbUJuZnRJblJldi5pZA0KICAgICAgICAgIFBkdGVtcFBkQ2FsYy5wZEJ1c3NDb2RlID0gdGhpcy5zZWxlY3RlZENsbUJuZnRJblJldi5wZENsbUJuZnRDb2RlDQogICAgICAgICAgUGR0ZW1wUGRDYWxjLnBkU3RydWN0dXJlVHlwZSA9ICcwMicNCiAgICAgICAgfSBlbHNlIGlmIChPYmplY3Qua2V5cyh0aGlzLnNlbGVjdGVkU3J2bEJuZnRJblJldikubGVuZ3RoID4gMCkgew0KICAgICAgICAgIFBkdGVtcFBkQ2FsYy5wZEJ1c3NJZCA9IHRoaXMuc2VsZWN0ZWRTcnZsQm5mdEluUmV2LmlkDQogICAgICAgICAgUGR0ZW1wUGRDYWxjLnBkQnVzc0NvZGUgPSB0aGlzLnNlbGVjdGVkU3J2bEJuZnRJblJldi5wZFNydmxCbmZ0Q29kZQ0KICAgICAgICAgIFBkdGVtcFBkQ2FsYy5wZFN0cnVjdHVyZVR5cGUgPSAnMDQnDQogICAgICAgIH0gZWxzZSBpZiAoT2JqZWN0LmtleXModGhpcy5zZWxlY3RlZEJuZnRJblJldikubGVuZ3RoID4gMCkgew0KICAgICAgICAgIFBkdGVtcFBkQ2FsYy5wZEJ1c3NJZCA9IHRoaXMuc2VsZWN0ZWRCbmZ0SW5SZXYuaWQNCiAgICAgICAgICBQZHRlbXBQZENhbGMucGRCdXNzQ29kZSA9IHRoaXMuc2VsZWN0ZWRCbmZ0SW5SZXYucGRCbmZ0Q29kZQ0KICAgICAgICAgIFBkdGVtcFBkQ2FsYy5wZFN0cnVjdHVyZVR5cGUgPSAnMDEnDQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIGlmICghUGR0ZW1wUGRDYWxjLnBkQnVzc0lkIHx8ICFQZHRlbXBQZENhbGMucGRCdXNzQ29kZSB8fCAhUGR0ZW1wUGRDYWxjLnBkU3RydWN0dXJlVHlwZSkgew0KICAgICAgICB0aGlzLm5vdGlmeUVycm9yKHRoaXMuJHQoJ2JuZnRGb3JtdWxhLmluY29tcGxldGVCbmZ0SW5mbycpKQ0KICAgICAgICByZXR1cm4NCiAgICAgIH0NCiAgICAgIGNvbnN0IHBhcmFtID0gew0KICAgICAgICBzZWxlY3RlZEZvcm11bGE6IHJvdywNCiAgICAgICAgcGR0ZW1wUGRDYWxjOiBQZHRlbXBQZENhbGMsDQogICAgICAgIHByb2R1Y3Q6IHRoaXMucHJvZHVjdCwNCiAgICAgICAgcGRCdXNzVHlwZTogJzInLA0KICAgICAgICBwZEJ1c3NEZXRhaWxUeXBlOiB0aGlzLnByb2R1Y3RDYWxjUmV2aXNpb25TaG93SU5mbyA/IHRoaXMucmV2aXNpb25Gb3JtdWxhRm9ybS5wZEJ1c3NEZXRhaWxUeXBlIDogdGhpcy5jYWxjdWxhdGlvbkZvcm11bGFUeXBlLA0KICAgICAgICBuZWVkQ2hlY2tpbmc6IHRydWUNCiAgICAgIH0NCiAgICAgIGFzc29jaWF0ZSh0aGlzLmJ1aWxkUmVxdWVzdERhdGEocGFyYW0pKS50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgbGV0IHN1Y2Nlc3NGbGFnID0gcmVzcG9uc2UuZGF0YS5mbGFnDQogICAgICAgIGxldCBwZHRlbXBQZENhbGMgPSByZXNwb25zZS5kYXRhLnBkdGVtcFBkQ2FsYw0KICAgICAgICBpZiAoc3VjY2Vzc0ZsYWcgPT09IHRydWUpIHsNCiAgICAgICAgICB0aGlzLm5vdGlmeVN1Y2Nlc3ModGhpcy4kdCgncnVsZS5hc3NvY2lhdGlvblN1Y2Nlc3MnKSkNCiAgICAgICAgICB0aGlzLiRyZWZzLnBhZ2VfY3VycmVudC5yZWxvYWQoKQ0KICAgICAgICAgIHRoaXMuJHJlZnMucGFnZV9icmllZi5yZWxvYWQoKQ0KICAgICAgICAgIHRoaXMuJGVtaXQoJ2JyaW5nSW5DYWxjQ29kZScsIHRoaXMuY2FsY3VsYXRpb25Gb3JtdWxhVHlwZSwgcGR0ZW1wUGRDYWxjLnBkQnVzc0NvZGUsIHBkdGVtcFBkQ2FsYy5wZENhbGNDb2RlKQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRoaXMuJGNvbmZpcm0oU3RyaW5nKHRoaXMuJHQoJ3VuZGVyd3JpdGluZ0Ftb3VudEZvcm11bGFTZWxlY3QuY29uZmlybV9vdmVyd3JpdGVfZm9ybXVsYScpKSwgU3RyaW5nKHRoaXMuJHQoJ2NvbmZpcm1NZXNzYWdlLnRpcCcpKSwgew0KICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6IFN0cmluZyh0aGlzLiR0KCdjb25maXJtTWVzc2FnZS5jb25maXJtJykpLA0KICAgICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogU3RyaW5nKHRoaXMuJHQoJ2NvbmZpcm1NZXNzYWdlLmNhbmNlbCcpKSwNCiAgICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJw0KICAgICAgICAgIH0pLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgcGFyYW0ubmVlZENoZWNraW5nID0gZmFsc2UNCiAgICAgICAgICAgIGFzc29jaWF0ZSh0aGlzLmJ1aWxkUmVxdWVzdERhdGEocGFyYW0pKS50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgICAgICAgbGV0IHBkdGVtcFBkQ2FsYyA9IHJlc3BvbnNlLmRhdGEucGR0ZW1wUGRDYWxjDQogICAgICAgICAgICAgIHRoaXMubm90aWZ5U3VjY2Vzcyh0aGlzLiR0KCdydWxlLmFzc29jaWF0aW9uU3VjY2VzcycpKQ0KICAgICAgICAgICAgICB0aGlzLiRyZWZzLnBhZ2VfY3VycmVudC5yZWxvYWQoKQ0KICAgICAgICAgICAgICB0aGlzLiRyZWZzLnBhZ2VfYnJpZWYucmVsb2FkKCkNCiAgICAgICAgICAgICAgdGhpcy4kZW1pdCgnYnJpbmdJbkNhbGNDb2RlJywgdGhpcy5jYWxjdWxhdGlvbkZvcm11bGFUeXBlLCBwZHRlbXBQZENhbGMucGRCdXNzQ29kZSwgcGR0ZW1wUGRDYWxjLnBkQ2FsY0NvZGUpDQogICAgICAgICAgICB9KQ0KICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHsNCiAgICAgICAgICAgIHRoaXMubWVzc2FnZUluZm8odGhpcy4kdCgndW5kZXJ3cml0aW5nQW1vdW50Rm9ybXVsYVNlbGVjdC5jYW5jZWxlZCcpKQ0KICAgICAgICAgIH0pDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkWA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/basicinfo/bnft-formula/bnftAmountFormula","sourcesContent":["<template>\r\n  <cus-wraper>\r\n    <cus-page-title-back v-if=\"!productCalcRevisionShowINfo\" :label=\"$t('pdtempPdClmBnft.pdBnftExpressionDefinition')\"\r\n                         @backTo=\"back\"/>\r\n\r\n    <el-form v-if=\"!productCalcRevisionShowINfo\" ref=\"productBnftForm\" :model=\"productBnftForm\"\r\n             :rules=\"productCalcRevisionShowINfo ? productBnftFormRules : undefined\" label-width=\"auto\">\r\n      <el-row :gutter=\"20\">\r\n        <el-col :span=\"8\">\r\n          <el-form-item :label=\"$t('pdtempPdClmBnft.bnftDtType')\" prop=\"bnftDtType\">\r\n            <cus-cascader v-model=\"productBnftForm.bnftDtType\" :codetype=\"'guaranteeDetails'\"\r\n                          :disabled=\"!productCalcRevisionShowINfo\" class=\"cusSelect\"\r\n                          clearable @change=\"findBnftById\"></cus-cascader>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <el-form-item :label=\"$t('pdtempPdClmBnft.bnft')\" prop=\"bnft\">\r\n            <el-select v-model=\"productBnftForm.bnft\" :disabled=\"!productCalcRevisionShowINfo\"\r\n                       :placeholder=\"$t('pdtempPdBnft.pleaseChoose')\"\r\n                       clearable filterable @change=\"findBnftDttailByBnft($event)\">\r\n              <el-option v-for=\"item in Options1\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\">\r\n              </el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <el-form-item :label=\"$t('pdtempPdClmBnft.bnftDt')\" prop=\"bnftDt\">\r\n            <el-select v-model=\"productBnftForm.bnftDt\" :disabled=\"!productCalcRevisionShowINfo\"\r\n                       :placeholder=\"$t('pdtempPdBnft.pleaseChoose')\" clearable\r\n                       filterable>\r\n              <el-option v-for=\"item in Options2\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\">\r\n              </el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row :gutter=\"20\">\r\n        <el-col :span=\"8\">\r\n          <el-form-item :label=\"$t('i18nView.formulaDetial')\" prop=\"ExpressionType\">\r\n            <cus-select v-model=\"productBnftForm.ExpressionType\" :codetype=\"'ruleBusinessDetailClass'\"\r\n                        :disabled=\"!productCalcRevisionShowINfo\"\r\n                        filter=\"1$17$20$21$22$23$24$27$28$29$30$31\"></cus-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"8\"></el-col>\r\n        <el-col :span=\"8\"></el-col>\r\n      </el-row>\r\n    </el-form>\r\n\r\n    <div v-if=\"productCalcRevisionShowINfo\">\r\n      <!-- 保障表格 -->\r\n      <cus-table-title :label=\"$t('bnftFormula.pdBnftItem')\"/>\r\n      <el-table :data=\"tableDataBnft\" border element-loading-text=\"Loading\" fit highlight-current-row\r\n                size=\"mini\" @row-click=\"rowClickBnft\">\r\n        <el-table-column :label=\"$t('table.select')\" width=\"50\">\r\n          <template slot-scope=\"scope\">\r\n            <el-radio-group v-model=\"selectedBnftInRev\" @change=\"selectedBnftInRevChanged\">\r\n              <el-radio :label=\"scope.row\">{{ '' }}</el-radio>\r\n            </el-radio-group>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('table.id')\" align=\"center\" width=\"50\">\r\n          <template v-slot=\"scope\">\r\n            {{ initTableIndex('page_bnft', scope.$index) }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('bnftFormula.pdBnftType')\" align=\"center\" min-width=\"200\"\r\n                         prop=\"pdBnftType\">\r\n          <template v-slot=\"scope\">\r\n            {{ scope.row.pdBnftType | filter_pdBnftType }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('bnftFormula.pdBnftDetailType')\" align=\"center\" min-width=\"200\"\r\n                         prop=\"pdBnftDetailType\">\r\n          <template v-slot=\"scope\">\r\n            <span v-show=\"scope.row.pdBnftType==='C'\">{{ scope.row.pdBnftDetailType | filter_pdBnftDetailType1 }}</span>\r\n            <span v-show=\"scope.row.pdBnftType==='A'\">{{ scope.row.pdBnftDetailType | filter_pdBnftDetailType2 }}</span>\r\n            <span v-show=\"scope.row.pdBnftType==='M'\">{{ '' }}</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('bnftFormula.pdBnftOrder')\" align=\"center\" min-width=\"200\"\r\n                         prop=\"pdBnftOrder\"></el-table-column>\r\n        <el-table-column :label=\"$t('bnftFormula.pdBnftCode')\" align=\"center\" min-width=\"200\"\r\n                         prop=\"pdBnftCode\"></el-table-column>\r\n        <el-table-column :label=\"$t('bnftFormula.pdBnftName')\" align=\"center\" min-width=\"200\"\r\n                         prop=\"pdBnftName\"></el-table-column>\r\n        <el-table-column :label=\"$t('bnftFormula.pdAmntCalcMode')\" align=\"center\" min-width=\"200\"\r\n                         prop=\"pdAmntCalcMode\">\r\n          <template v-slot=\"scope\">\r\n            {{ scope.row.pdAmntCalcMode | filter_pdAmntCalcMode }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('bnftFormula.pdAmntIncFlag')\" align=\"center\" min-width=\"200\"\r\n                         prop=\"pdAmntIncFlag\"></el-table-column>\r\n      </el-table>\r\n      <cus-pagination ref=\"page_bnft\" v-model=\"tableDataBnft\" :autoBuild=\"false\" :pageSize=\"5\"\r\n                      :params=\"params_bnft\" url=\"/BnftAmountFormula/base/getAllBnftByPdInfoId\"/>\r\n\r\n      <!-- 赔付保障表格 -->\r\n      <div v-if=\"showClmBnftFlag\">\r\n        <cus-table-title :label=\"$t('bnftFormula.pdClmBnftItem')\"/>\r\n        <el-table :data=\"tableDataClmBnft\" border element-loading-text=\"Loading\" fit highlight-current-row\r\n                  size=\"mini\" @row-click=\"rowClickClmBnft\">\r\n          <el-table-column :label=\"$t('table.select')\" width=\"50\">\r\n            <template slot-scope=\"scope\">\r\n              <el-radio-group v-model=\"selectedClmBnftInRev\" @change=\"selectedClmBnftInRevChanged\">\r\n                <el-radio :label=\"scope.row\">{{ '' }}</el-radio>\r\n              </el-radio-group>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('table.id')\" align=\"center\" width=\"50\">\r\n            <template v-slot=\"scope\">\r\n              {{ initTableIndex('page_clmBnft', scope.$index) }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('bnftFormula.pdClmBnftType')\" align=\"center\" min-width=\"200\"\r\n                           prop=\"pdClmBnftType\">\r\n            <template v-slot=\"scope\">\r\n              {{ scope.row.pdClmBnftType | filter_pdBnftDetailType1 }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('bnftFormula.pdClmBnftOrder')\" align=\"center\" min-width=\"200\"\r\n                           prop=\"pdClmBnftOrder\"></el-table-column>\r\n          <el-table-column :label=\"$t('bnftFormula.pdClmBnftCode')\" align=\"center\" min-width=\"200\"\r\n                           prop=\"pdClmBnftCode\"></el-table-column>\r\n          <el-table-column :label=\"$t('bnftFormula.pdClmBnftName')\" align=\"center\" min-width=\"200\"\r\n                           prop=\"pdClmBnftName\"></el-table-column>\r\n        </el-table>\r\n        <cus-pagination ref=\"page_clmBnft\" v-model=\"tableDataClmBnft\" :autoBuild=\"false\" :pageSize=\"5\"\r\n                        :params=\"params_clmBnft\" url=\"/BnftAmountFormula/base/getAllClmBnftByPdBnftId\"/>\r\n      </div>\r\n\r\n      <!-- 生存保障表格 -->\r\n      <div v-if=\"showSrvlBnftFlag\">\r\n        <cus-table-title :label=\"$t('bnftFormula.pdSrvlBnftItem')\"/>\r\n        <el-table :data=\"tableDataSrvlBnft\" border element-loading-text=\"Loading\" fit highlight-current-row\r\n                  size=\"mini\" @row-click=\"rowClickSrvlBnft\">\r\n          <el-table-column :label=\"$t('table.select')\" width=\"50\">\r\n            <template slot-scope=\"scope\">\r\n              <el-radio-group v-model=\"selectedSrvlBnftInRev\" @change=\"selectedSrvlBnftInRevChanged\">\r\n                <el-radio :label=\"scope.row\">{{ '' }}</el-radio>\r\n              </el-radio-group>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('table.id')\" align=\"center\" width=\"50\">\r\n            <template v-slot=\"scope\">\r\n              {{ initTableIndex('page_srvlBnft', scope.$index) }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('bnftFormula.pdSrvlBnftType')\" align=\"center\" min-width=\"200\"\r\n                           prop=\"pdSrvlBnftType\">\r\n            <template v-slot=\"scope\">\r\n              {{ scope.row.pdSrvlBnftType | filter_pdBnftType }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('bnftFormula.pdSrvlAnnType')\" align=\"center\" min-width=\"200\"\r\n                           prop=\"pdSrvlAnnType\">\r\n            <template v-slot=\"scope\">\r\n              <span v-show=\"scope.row.pdSrvlBnftType==='A'\">{{\r\n                  scope.row.pdSrvlAnnType | filter_pdBnftDetailType2\r\n                }}</span>\r\n              <span v-show=\"scope.row.pdSrvlBnftType==='M'\">{{ '' }}</span>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('bnftFormula.pdSrvlBnftCode')\" align=\"center\" min-width=\"200\"\r\n                           prop=\"pdSrvlBnftCode\"></el-table-column>\r\n          <el-table-column :label=\"$t('bnftFormula.pdSrvlBnftName')\" align=\"center\" min-width=\"200\"\r\n                           prop=\"pdSrvlBnftName\"></el-table-column>\r\n        </el-table>\r\n        <cus-pagination ref=\"page_srvlBnft\" v-model=\"tableDataSrvlBnft\" :autoBuild=\"false\" :pageSize=\"5\"\r\n                        :params=\"params_srvlBnft\" url=\"/BnftAmountFormula/base/getAllSrvlBnftByPdBnftId\"/>\r\n      </div>\r\n    </div>\r\n\r\n    <div\r\n      v-if=\"!productCalcRevisionShowINfo || productCalcRevisionShowINfo && (Object.keys(selectedBnftInRev).length > 0 && selectedBnftInRev.pdBnftDetailType !== '7' || Object.keys(selectedClmBnftInRev).length > 0 || Object.keys(selectedSrvlBnftInRev).length > 0)\">\r\n      <!-- 已选择公式 -->\r\n      <cus-form-title :first=\"true\" :label=\"$t('bnftFormula.pdBnftOptioned')\"></cus-form-title>\r\n      <cus-table-title :label=\"$t('bnftFormula.pdBnftCalcFormula')\"/>\r\n      <el-table :data=\"expressionConfigs\" border highlight-current-row>\r\n        <el-table-column :label=\"$t('table.select')\" width=\"50\">\r\n          <template slot-scope=\"scope\">\r\n            <el-radio-group v-model=\"selectedFormula\" @change=\"selectedFormulaChanged\">\r\n              <el-radio :label=\"scope.row\">{{ '' }}</el-radio>\r\n            </el-radio-group>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('table.id')\" align=\"center\" width=\"50\">\r\n          <template v-slot=\"scope\">\r\n            {{ initTableIndex('page_current', scope.$index) }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('table.detail')\" align=\"center\" width=\"80\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button size=\"small\" type=\"text\" @click=\"showFormula(scope.row)\">>></el-button>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :filter-method=\"filters_method\" :filters=\"filters_pdBnftDetailType\"\r\n                         :label=\"$t('pdtempPdClmBnft.bnftDtType')\" align=\"center\" min-width=\"200\"\r\n                         prop=\"pdBnftDetailType\"\r\n                         sortable>\r\n          <template v-slot=\"scope\">\r\n            <span v-show=\"scope.row.pdBnftType==='C'\">{{ scope.row.pdBnftDetailType | filter_pdBnftDetailType1 }}</span>\r\n            <span v-show=\"scope.row.pdBnftType==='A'\">{{ scope.row.pdBnftDetailType | filter_pdBnftDetailType2 }}</span>\r\n            <span v-show=\"scope.row.pdBnftType==='M'\">{{ $t('pdtempPdBnft.none') }}</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('bnftFormula.guaranteeItem')\" align=\"center\" min-width=\"200\">\r\n          <template slot-scope=\"scope\">\r\n            {{ scope.row.pdBnftCode ? scope.row.pdBnftCode + ':' + scope.row.pdBnftName : '' }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column\r\n          v-if=\"productCalcRevisionShowINfo || calculationFormulaType === '17' || calculationFormulaType === '20' || calculationFormulaType === '21' || calculationFormulaType === '27' || calculationFormulaType === '28'\"\r\n          :label=\"$t('bnftFormula.guaranteeDetails')\" align=\"center\" min-width=\"200\">\r\n          <template slot-scope=\"scope\">\r\n            {{ scope.row.pdBnftDTCode ? scope.row.pdBnftDTCode + ':' + scope.row.pdBnftDTName : '' }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('i18nView.formulaDetial')\" align=\"center\" min-width=\"200\" prop=\"pdBussDetailType\">\r\n          <template v-slot=\"scope\">\r\n            {{ scope.row.pdBussDetailType | filter_pdBussDetailType }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('pdtempPdClmBnft.expressionCode')\" align=\"center\" min-width=\"200\" prop=\"pdCalcCode\">\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('pdtempPdClmBnft.expressionDesc')\" align=\"center\" min-width=\"200\" prop=\"pdCalcDesc\">\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('rule.ruleAttr')\" align=\"center\" min-width=\"200\">\r\n          <template v-slot=\"scope\">\r\n            {{\r\n              scope.row.ruleAttr === '1' ? $t('rule.general') : (scope.row.ruleAttr === '2' ? $t('rule.individual') : '')\r\n            }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('pdtempPdClmBnft.action')\" align=\"center\" fixed=\"right\" width=\"120\">\r\n          <template slot-scope=\"scope\">\r\n            <cus-del-btn v-auth=\"'pdtemp-pd-underwriting-amount-formula:delete'\"\r\n                         @ok=\"deleteFormula(scope.row)\"></cus-del-btn>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <cus-pagination ref=\"page_current\" v-model=\"expressionConfigs\" :autoBuild=\"false\" :pageSize=\"5\"\r\n                      :params=\"params_current\" url=\"/BnftAmountFormula/base/allFormulaByPdInfoId\"/>\r\n\r\n      <!-- 可选择公式 -->\r\n      <cus-form-title :first=\"true\" :label=\"$t('bnftFormula.pdBnftOption')\" style=\"margin-top: 50px\"></cus-form-title>\r\n\r\n      <el-form ref=\"revisionFormulaForm\" :model=\"revisionFormulaForm\" :rules=\"revisionFormulaFormRules\"\r\n               label-width=\"auto\">\r\n        <el-row :gutter=\"10\" type=\"flex\">\r\n          <el-col :span=\"8\">\r\n            <el-form-item v-if=\"productCalcRevisionShowINfo\" :label=\"$t('i18nView.formulaDetial')\"\r\n                          prop=\"pdBussDetailType\">\r\n              <cus-select v-model=\"revisionFormulaForm.pdBussDetailType\" :codetype=\"'ruleBusinessDetailClass'\"\r\n                          :filter=\"codeFilter_pdBussDetailType\"></cus-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\"></el-col>\r\n          <el-col :span=\"8\" style=\"text-align: right\">\r\n            <el-button icon=\"el-icon-connection\" size=\"small\" type=\"primary\" @click=\"toFormulaSelect\">\r\n              {{ $t('rule.moreFormula') }}\r\n            </el-button>\r\n            <el-button icon=\"el-icon-circle-plus el-icon--left\" size=\"small\" type=\"primary\" @click=\"toAddFormula\">\r\n              {{ $t('rule.toAddFormula') }}\r\n            </el-button>\r\n          </el-col>\r\n        </el-row>\r\n      </el-form>\r\n\r\n      <cus-table-title :label=\"$t('bnftFormula.pdBnftCalc')\"></cus-table-title>\r\n      <el-table :data=\"tableData_brief\" border highlight-current-row>\r\n        <el-table-column :label=\"$t('table.id')\" align=\"center\" width=\"50\">\r\n          <template v-slot=\"scope\">\r\n            {{ initTableIndex('page_brief', scope.$index) }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('table.detail')\" align=\"center\" width=\"80\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button size=\"small\" type=\"text\" @click=\"showFormula(scope.row)\">>></el-button>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :filter-method=\"filters_method\" :filters=\"filters_pdBnftDetailType_brief\"\r\n                         :label=\"$t('pdtempPdClmBnft.bnftDtType')\" align=\"center\" min-width=\"200\"\r\n                         prop=\"pdBnftDetailType\"\r\n                         sortable>\r\n          <template v-slot=\"scope\">\r\n            <span v-show=\"scope.row.pdBnftType==='C'\">{{ scope.row.pdBnftDetailType | filter_pdBnftDetailType1 }}</span>\r\n            <span v-show=\"scope.row.pdBnftType==='A'\">{{ scope.row.pdBnftDetailType | filter_pdBnftDetailType2 }}</span>\r\n            <span v-show=\"scope.row.pdBnftType==='M'\">{{ $t('pdtempPdBnft.none') }}</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :filter-method=\"filters_method\" :filters=\"filters_pdCode\" :label=\"$t('bnftFormula.product')\"\r\n                         align=\"center\"\r\n                         min-width=\"200\" prop=\"pdCode\">\r\n          <template slot-scope=\"scope\">\r\n            {{ scope.row.pdCode ? scope.row.pdCode + ':' + scope.row.pdName : '' }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('bnftFormula.guaranteeItem')\" align=\"center\" min-width=\"200\">\r\n          <template slot-scope=\"scope\">\r\n            {{ scope.row.pdBnftCode ? scope.row.pdBnftCode + ':' + scope.row.pdBnftName : '' }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column\r\n          v-if=\"calculationFormulaType === '17' || calculationFormulaType === '20' || calculationFormulaType === '21' || calculationFormulaType === '27' || calculationFormulaType === '28'\"\r\n          :label=\"$t('bnftFormula.guaranteeDetails')\" align=\"center\" min-width=\"200\">\r\n          <template slot-scope=\"scope\">\r\n            {{ scope.row.pdBnftDTCode ? scope.row.pdBnftDTCode + ':' + scope.row.pdBnftDTName : '' }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('i18nView.formulaDetial')\" align=\"center\" min-width=\"200\" prop=\"pdBussDetailType\">\r\n          <template v-slot=\"scope\">\r\n            {{ scope.row.pdBussDetailType | filter_pdBussDetailType }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('pdtempPdClmBnft.expressionCode')\" align=\"center\" min-width=\"200\"\r\n                         prop=\"pdCalcCode\"></el-table-column>\r\n        <el-table-column :label=\"$t('pdtempPdClmBnft.expressionDesc')\" align=\"center\" min-width=\"200\"\r\n                         prop=\"pdCalcDesc\"></el-table-column>\r\n        <el-table-column :label=\"$t('rule.ruleAttr')\" align=\"center\" min-width=\"200\">\r\n          <template v-slot=\"scope\">\r\n            {{\r\n              scope.row.ruleAttr === '1' ? $t('rule.general') : (scope.row.ruleAttr === '2' ? $t('rule.individual') : '')\r\n            }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('pdtempPdClmBnft.action')\" align=\"center\" fixed=\"right\" width=\"120\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button v-auth=\"'BnftAmountFormula:associate'\" icon=\"el-icon-connection\"\r\n                       size=\"small\" type=\"primary\" @click=\"handleSelectFormula(scope.row)\">\r\n              {{ $t('form.select') }}\r\n            </el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <cus-pagination ref=\"page_brief\" v-model=\"tableData_brief\" :autoBuild=\"false\" :pageSize=\"5\" :params=\"params_brief\"\r\n                      url=\"/BnftAmountFormula/base/briefFormula\"/>\r\n    </div>\r\n\r\n    <!-- 规则引擎公式定义弹窗 -->\r\n    <cus-rule-definition :attributeObj=\"attributeObj\" :ruleDefinitionClosed=\"ruleModuleClosed\"\r\n                         :visible=\"formulaVisible\"></cus-rule-definition>\r\n\r\n    <!-- 公式查看和决策树编辑弹窗 -->\r\n    <cus-rule-modify :flag=\"formulaView.flag\" :performType=\"formulaView.performType\" :ruleCode=\"formulaView.ruleCode\"\r\n                     :ruleModifyClosed=\"formulaViewClosed\" :ruleType=\"'2'\"\r\n                     :visible=\"formulaView.visible\"></cus-rule-modify>\r\n\r\n  </cus-wraper>\r\n</template>\r\n\r\n<script>\r\n\r\nimport {associate, deleteFormula, findBnft} from \"@/api/basicinfo/bnftAmountFormula\"\r\nimport {findBnftDttailByBnft} from '@/api/basicinfo/acceptInsuranceRules'\r\nimport {getRuleCode} from \"@/api/basicinfo/pdtemppdinsuageinfo\"\r\n\r\nlet _this\r\n\r\nexport default {\r\n  name: 'bnftFormula',\r\n  props: {\r\n    guaranteeDetails: {\r\n      type: Array,\r\n      default: undefined\r\n    },\r\n    calculationFormulaType: {\r\n      type: String,\r\n      default: undefined\r\n    },\r\n    pdUwSiTypeOptions: {\r\n      type: Object,\r\n      required: false,\r\n    },\r\n    pdBnftOptions: {\r\n      type: Object,\r\n      required: false\r\n    },\r\n    productCalcRevisionShowINfo: {\r\n      type: Boolean,\r\n      required: false,\r\n      default: false\r\n    }\r\n  },\r\n  filters: {\r\n    filter_pdBnftType(code) {\r\n      return _this.getCodeName(\"pdBnftType\", code)\r\n    },\r\n    filter_pdBnftDetailType1(code) {\r\n      return _this.getCodeName(\"pdclmbnfttype2\", code)\r\n    },\r\n    filter_pdBnftDetailType2(code) {\r\n      return _this.getCodeName(\"pdsbnftnjxl\", code)\r\n    },\r\n    filter_pdBussDetailType(code) {\r\n      return _this.getCodeName('ruleBusinessDetailClass', code)\r\n    },\r\n    filter_pdAmntCalcMode(code) {\r\n      return _this.getCodeName('pdAmntCalMode', code)\r\n    }\r\n  },\r\n  data() {\r\n    _this = this\r\n    return {\r\n      params_bnft: {\r\n        eq_pdInfoId: undefined\r\n      },\r\n      params_clmBnft: {\r\n        eq_pdBnftId: undefined\r\n      },\r\n      params_srvlBnft: {\r\n        eq_pdBnftId: undefined\r\n      },\r\n      params_brief: {\r\n        product: undefined,\r\n        pdBussId: this.productCalcRevisionShowINfo ? undefined : (this.pdBnftOptions.id ? this.pdBnftOptions.id : this.pdUwSiTypeOptions.id),\r\n        productDetailType: '',\r\n        pdBussDetailTypeList: this.productCalcRevisionShowINfo ? [] : Array(this.calculationFormulaType)\r\n      },\r\n      params_current: {\r\n        eq_pdInfoId: undefined,\r\n        eq_pdBussType: '',\r\n        in_pdBussDetailType: [],\r\n        eq_pdType: '',\r\n        eq_pdBussCode: ''\r\n      },\r\n      filters_pdBnftDetailType: [],\r\n      filters_pdBnftDetailType_brief: [],\r\n      filters_pdCode: [],\r\n      formulaView: {\r\n        flag: '',\r\n        ruleCode: '',\r\n        visible: false,\r\n        performType: ''\r\n      },\r\n      language: null,\r\n      showClmBnftFlag: false,\r\n      showSrvlBnftFlag: false,\r\n      ruleMessageInfoBom: [],\r\n      codeFilter_pdBussDetailType: '1$',\r\n      productBnftForm: {\r\n        bnftDtType: [],\r\n        bnft: '',\r\n        bnftDt: '',\r\n        ExpressionType: ''\r\n      },\r\n      revisionFormulaForm: {\r\n        pdBussDetailType: ''\r\n      },\r\n      selectedBnftInRev: {},\r\n      selectedClmBnftInRev: {},\r\n      selectedSrvlBnftInRev: {},\r\n      tableDataBnft: [],\r\n      tableDataClmBnft: [],\r\n      tableDataSrvlBnft: [],\r\n      expressionConfigs: [],\r\n      tableData_brief: [],\r\n      selectedFormula: {},\r\n      Options1: [], // 保障\r\n      Options2: [], // 保障明细\r\n      product: {\r\n        id: undefined,\r\n        bType: '',\r\n        cType: '',\r\n        pdCode: '',\r\n        pdEdition: '',\r\n        pdVerId: undefined,\r\n        pdSalechnl: '',\r\n        pdName: '',\r\n        pdShortname: '',\r\n        pdEnName: '',\r\n        pdShortEnName: '',\r\n        operator: '',\r\n        pdStartDateRule: '',\r\n        pdStartDateMode: '',\r\n        pdStartPeriod: undefined,\r\n        pdStartPeriodUnit: '',\r\n        pdEndDateRule: '',\r\n        pdEndDateMode: '',\r\n        pdEndPeriod: undefined,\r\n        pdEndPeriodUnit: '',\r\n        pdGracePeriod: undefined,\r\n        pdObservationDay: undefined,\r\n        pdApplDate: undefined,\r\n        pdProcessId: undefined,\r\n        pdStartDate: undefined,\r\n        pdStopDate: undefined,\r\n        createTime: undefined,\r\n        updateTime: undefined\r\n      },\r\n      formulaVisible: false,\r\n      attributeObj: {},\r\n      productBnftFormRules: {\r\n        bnft: [{\r\n          required: true,\r\n          message: this.$t('bnftFormula.pleaseSelectBnftItem'),\r\n          trigger: 'change'\r\n        }],\r\n        ExpressionType: [{\r\n          required: true,\r\n          message: this.$t('bnftFormula.pleaseSelectPdBussDetailType'),\r\n          trigger: 'change'\r\n        }]\r\n      },\r\n      revisionFormulaFormRules: {\r\n        pdBussDetailType: [{\r\n          required: true,\r\n          message: this.$t('bnftFormula.pleaseSelectPdBussDetailType'),\r\n          trigger: 'change'\r\n        }]\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    expressionConfigs() {\r\n      // pdBnftDetailType 筛选\r\n      this.filters_pdBnftDetailType = []\r\n      for (const row of this._.map(this.expressionConfigs, 'pdBnftDetailType')) {\r\n        if (!row) continue\r\n        let filterItem = {text: '', value: ''}\r\n        filterItem.text = row + ':' + this.getCodeName('pdclmbnfttype2', row, true)\r\n        filterItem.value = row\r\n        if (!this._.includes(this._.map(this.filters_pdBnftDetailType, 'value'), filterItem.value)) {\r\n          this.filters_pdBnftDetailType.push(filterItem)\r\n        }\r\n      }\r\n    },\r\n    tableData_brief() {\r\n      // pdBnftDetailType 筛选\r\n      this.filters_pdBnftDetailType_brief = []\r\n      for (const row of this._.map(this.tableData_brief, 'pdBnftDetailType')) {\r\n        if (!row) continue\r\n        let filterItem = {text: '', value: ''}\r\n        filterItem.text = row + ':' + this.getCodeName('pdclmbnfttype2', row, true)\r\n        filterItem.value = row\r\n        if (!this._.includes(this._.map(this.filters_pdBnftDetailType_brief, 'value'), filterItem.value)) {\r\n          this.filters_pdBnftDetailType_brief.push(filterItem)\r\n        }\r\n      }\r\n      // pdCode 筛选\r\n      this.filters_pdCode = []\r\n      for (const row of this.tableData_brief) {\r\n        if (!row.pdCode) continue\r\n        let filterItem = {text: '', value: ''}\r\n        filterItem.text = row.pdCode + ':' + row.pdName\r\n        filterItem.value = row.pdCode\r\n        if (!this._.includes(this._.map(this.filters_pdCode, 'value'), filterItem.value)) {\r\n          this.filters_pdCode.push(filterItem)\r\n        }\r\n      }\r\n    }\r\n  },\r\n  async mounted() {\r\n    this.language = this.$store.state.app.language\r\n    this.ruleMessageInfoBom = this.$store.state.ruleMessage.ruleMessages\r\n    if (this.productCalcRevisionShowINfo) { // 订正\r\n      await this.$refs.page_bnft.reload()\r\n    } else { // 非订正\r\n      if (this.guaranteeDetails !== undefined) {\r\n        this.$refs.page_brief.reload()\r\n        this.productBnftForm.bnftDtType = this.guaranteeDetails\r\n        this.findBnftById(this.guaranteeDetails)\r\n        this.productBnftForm.bnft = this.pdUwSiTypeOptions.pdBnftCode + \":\" + this.pdUwSiTypeOptions.pdBnftType\r\n        this.productBnftForm.ExpressionType = this.calculationFormulaType\r\n        this.findBnftDttailByBnft(this.productBnftForm.bnft).then(() => {\r\n          if (this.guaranteeDetails[0] === 'C') {\r\n            this.productBnftForm.bnftDt = this.pdBnftOptions.pdClmBnftCode\r\n          } else {\r\n            this.productBnftForm.bnftDt = this.pdBnftOptions.pdSrvlBnftCode\r\n          }\r\n          this.$nextTick(() => {\r\n            this.handleSearch()\r\n          })\r\n        })\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.initProductInfo()\r\n  },\r\n  methods: {\r\n    selectedBnftInRevChanged() {\r\n      this.selectedSrvlBnftInRev = {}\r\n      this.selectedClmBnftInRev = {}\r\n      switch (this.selectedBnftInRev.pdBnftType) {\r\n        case 'C':\r\n          this.showClmBnftFlag = true\r\n          this.showSrvlBnftFlag = false\r\n          // 已关联公式、简明公式\r\n          if (this.selectedBnftInRev.pdBnftDetailType !== '7') {\r\n            this.codeFilter_pdBussDetailType = '1$29$30$31'\r\n            this.params_current.eq_pdInfoId = this.product.id\r\n            this.params_current.eq_pdType = '1'\r\n            this.params_current.eq_pdBussType = '2'\r\n            this.params_current.in_pdBussDetailType = Array('29', '30', '31')\r\n            this.params_current.eq_pdBussCode = this.selectedBnftInRev.pdBnftCode\r\n            this.params_brief.pdBussId = this.selectedBnftInRev.id\r\n            this.params_brief.pdBussDetailTypeList = Array('29', '30', '31')\r\n            // 查询公式\r\n            this.$nextTick(() => {\r\n              this.$refs.page_current.reload()\r\n              this.$refs.page_brief.reload()\r\n            })\r\n          } else {\r\n            this.codeFilter_pdBussDetailType = '1$'\r\n          }\r\n          // 查询赔付明细\r\n          this.params_clmBnft.eq_pdBnftId = this.selectedBnftInRev.id\r\n          this.$nextTick(() => {\r\n            this.$refs.page_clmBnft.reload()\r\n            if (this.$refs.revisionFormulaForm) {\r\n              this.$refs.revisionFormulaForm.clearValidate()\r\n            }\r\n          })\r\n          break\r\n        case 'A':\r\n        case 'M':\r\n          this.showClmBnftFlag = false\r\n          this.showSrvlBnftFlag = true\r\n          // 已关联公式、简明公式\r\n          this.codeFilter_pdBussDetailType = '1$29$30'\r\n          this.params_current.eq_pdInfoId = this.product.id\r\n          this.params_current.eq_pdType = '1'\r\n          this.params_current.eq_pdBussType = '2'\r\n          this.params_current.in_pdBussDetailType = Array('29', '30')\r\n          this.params_current.eq_pdBussCode = this.selectedBnftInRev.pdBnftCode\r\n          this.params_brief.pdBussId = this.selectedBnftInRev.id\r\n          this.params_brief.pdBussDetailTypeList = Array('29', '30')\r\n          // 查询生存明细\r\n          this.params_srvlBnft.eq_pdBnftId = this.selectedBnftInRev.id\r\n          this.$nextTick(() => {\r\n            this.$refs.page_current.reload()\r\n            this.$refs.page_brief.reload()\r\n            this.$refs.page_srvlBnft.reload()\r\n            if (this.$refs.revisionRuleForm) {\r\n              this.$refs.revisionRuleForm.clearValidate()\r\n            }\r\n          })\r\n          break\r\n        default:\r\n          this.showClmBnftFlag = false\r\n          this.showSrvlBnftFlag = false\r\n          this.$nextTick(() => {\r\n            if (this.$refs.revisionRuleForm) {\r\n              this.$refs.revisionRuleForm.clearValidate()\r\n            }\r\n          })\r\n          break\r\n      }\r\n    },\r\n    selectedClmBnftInRevChanged() {\r\n      this.codeFilter_pdBussDetailType = '1$20$21'\r\n      this.params_current.in_pdBussDetailType = Array('20', '21')\r\n      this.params_current.eq_pdBussCode = this.selectedClmBnftInRev.pdClmBnftCode\r\n      this.params_brief.pdBussId = this.selectedClmBnftInRev.id\r\n      this.params_brief.pdBussDetailTypeList = Array('20', '21')\r\n      this.$nextTick(() => {\r\n        this.$refs.page_current.reload()\r\n        this.$refs.page_brief.reload()\r\n        if (this.$refs.revisionRuleForm) {\r\n          this.$refs.revisionRuleForm.clearValidate()\r\n        }\r\n      })\r\n    },\r\n    selectedSrvlBnftInRevChanged() {\r\n      this.codeFilter_pdBussDetailType = '1$27$28'\r\n      this.params_current.in_pdBussDetailType = Array('27', '28')\r\n      this.params_current.eq_pdBussCode = this.selectedSrvlBnftInRev.pdSrvlBnftCode\r\n      this.params_brief.pdBussId = this.selectedSrvlBnftInRev.id\r\n      this.params_brief.pdBussDetailTypeList = Array('27', '28')\r\n      this.$nextTick(() => {\r\n        this.$refs.page_current.reload()\r\n        this.$refs.page_brief.reload()\r\n        if (this.$refs.revisionRuleForm) {\r\n          this.$refs.revisionRuleForm.clearValidate()\r\n        }\r\n      })\r\n    },\r\n    rowClickBnft(row, column, event) {\r\n      if (event.target.nodeName === \"INPUT\") {\r\n        if (row.id === this.selectedBnftInRev.id) {\r\n          if (this.selectedBnftInRev.pdBnftDetailType !== '7') {\r\n            this.expressionConfigs = []\r\n            this.$refs.page_current.total = 0\r\n            this.$refs.page_current.page = 1\r\n            this.tableData_brief = []\r\n            this.$refs.page_brief.total = 0\r\n            this.$refs.page_brief.page = 1\r\n          }\r\n          this.selectedBnftInRev = {}\r\n          this.selectedClmBnftInRev = {}\r\n          this.selectedSrvlBnftInRev = {}\r\n          this.codeFilter_pdBussDetailType = '1$'\r\n          this.params_brief.pdBussId = undefined\r\n          this.showClmBnftFlag = false\r\n          this.showSrvlBnftFlag = false\r\n        }\r\n      }\r\n    },\r\n    rowClickClmBnft(row, column, event) {\r\n      if (event.target.nodeName === \"INPUT\") {\r\n        if (row.id === this.selectedClmBnftInRev.id) {\r\n          this.selectedClmBnftInRev = {}\r\n          this.selectedBnftInRevChanged()\r\n        }\r\n      }\r\n    },\r\n    rowClickSrvlBnft(row, column, event) {\r\n      if (event.target.nodeName === \"INPUT\") {\r\n        if (row.id === this.selectedSrvlBnftInRev.id) {\r\n          this.selectedSrvlBnftInRev = {}\r\n          this.selectedBnftInRevChanged()\r\n        }\r\n      }\r\n    },\r\n    showFormula(row) {\r\n      this.formulaView.flag = '1'\r\n      this.formulaView.ruleCode = row.pdCalcCode\r\n      this.formulaView.performType = row.performType\r\n      this.formulaView.visible = true\r\n    },\r\n    ruleModuleClosed() {\r\n      this.formulaVisible = false\r\n      this.$refs.page_brief.reload()\r\n    },\r\n    formulaViewClosed() {\r\n      this.formulaView.visible = false\r\n      this.selectedFormula = {}\r\n    },\r\n    handleSearch() {\r\n      this.params_current.eq_pdInfoId = this.product.id\r\n      this.params_current.eq_pdType = '1'\r\n      this.params_current.eq_pdBussType = '2'\r\n      this.params_current.in_pdBussDetailType = Array(this.calculationFormulaType)\r\n      this.params_current.eq_pdBussCode = this.pdBnftOptions.id ? (this.guaranteeDetails[0] === 'C' ? this.pdBnftOptions.pdClmBnftCode : this.pdBnftOptions.pdSrvlBnftCode) : this.pdUwSiTypeOptions.pdBnftCode\r\n      this.$refs.page_current.reload()\r\n    },\r\n    handleSearchInRevision() {\r\n      this.$refs.page_current.reload()\r\n      this.$refs.page_brief.reload()\r\n    },\r\n    initProductInfo() {\r\n      let pdtempPdInfo = this.getPdData()\r\n      if (Object.keys(pdtempPdInfo).length > 0) {\r\n        Object.assign(this.product, pdtempPdInfo)\r\n        this.params_brief.product = pdtempPdInfo\r\n        this.params_bnft.eq_pdInfoId = pdtempPdInfo.id\r\n        this.params_brief.productDetailType = this.product.cType\r\n      } else {\r\n        this.notifyError(this.$t('message.invalidProductInfo'))\r\n      }\r\n    },\r\n    // 显示保障项数组\r\n    findBnftById(val) {\r\n      this.productBnftForm.bnft = ''\r\n      this.productBnftForm.bnftDt = ''\r\n      this.Options1 = []\r\n      this.Options2 = []\r\n      let params = {\r\n        pdInfoId: '',\r\n        pdBnftType: '',\r\n        pdBnftDetailType: '',\r\n      }\r\n      if (this.pdUwSiTypeOptions) {\r\n        params.pdInfoId = this.pdUwSiTypeOptions.pdInfoId\r\n      } else {\r\n        params.pdInfoId = this.product.id\r\n      }\r\n      params.pdBnftType = val[0]\r\n      params.pdBnftDetailType = val[1]\r\n      findBnft(this.buildRequestData(params)).then(res => {\r\n        let data = res.data\r\n        if (data.length) {\r\n          data.forEach(val => {\r\n            this.Options1.push({\r\n              entity: val,\r\n              key: val.pdBnftCode,\r\n              value: val.pdBnftCode + \":\" + val.pdBnftType,\r\n              label: val.pdBnftCode + \":\" + val.pdBnftName\r\n            })\r\n          })\r\n        }\r\n        this.$refs.productBnftForm.clearValidate()\r\n      })\r\n    },\r\n    getCaption(obj, state) {\r\n      const index = obj.lastIndexOf(\":\")\r\n      if (state === 0) {\r\n        return obj.substring(0, index)\r\n      } else {\r\n        return obj.substring(index + 1, obj.length)\r\n      }\r\n    },\r\n    // 显示保障明细项数组\r\n    async findBnftDttailByBnft(row) {\r\n      return new Promise(resolve => {\r\n        this.Options2 = []\r\n        this.productBnftForm.bnftDt = ''\r\n        if (row) {\r\n          let data = {\r\n            pdBnftCode: this.getCaption(row, 0),\r\n            pdBnftType: this.getCaption(row, 1)\r\n          }\r\n          findBnftDttailByBnft(data).then(res => {\r\n            let data = res.data\r\n            if (data.length) {\r\n              if (this.getCaption(row, 1) === 'C') {\r\n                data.forEach(val => {\r\n                  this.Options2.push({\r\n                    entity: val,\r\n                    key: val.pdClmBnftCode,\r\n                    value: val.pdClmBnftCode,\r\n                    label: val.pdClmBnftCode + \":\" + val.pdClmBnftName\r\n                  })\r\n                })\r\n              } else {\r\n                data.forEach(val => {\r\n                  this.Options2.push({\r\n                    entity: val,\r\n                    key: val.pdSrvlBnftCode,\r\n                    value: val.pdSrvlBnftCode,\r\n                    label: val.pdSrvlBnftCode + \":\" + val.pdSrvlBnftName\r\n                  })\r\n                })\r\n              }\r\n            }\r\n            resolve()\r\n          })\r\n        } else {\r\n          resolve()\r\n        }\r\n      })\r\n    },\r\n    back() {\r\n      this.$emit('changeDialogVisible_formula2', false)\r\n    },\r\n    toFormulaSelect() {\r\n      if (this.productCalcRevisionShowINfo) { // 订正\r\n        if (Object.keys(this.selectedBnftInRev).length === 0) {\r\n          this.notifyError(this.$t('bnftFormula.pleaseSelectPdBnftItem'))\r\n          return\r\n        }\r\n        this.$refs.revisionFormulaForm.validate(pass => {\r\n          if (pass) {\r\n            this.$emit('changeDialogVisible_formulaSelect2', true,\r\n              [this.selectedBnftInRev.pdBnftType], this.revisionFormulaForm.pdBussDetailType, this.selectedBnftInRev.pdBnftCode + ':',\r\n              this.selectedBnftInRev.pdBnftType === 'C' ? this.selectedClmBnftInRev.pdClmBnftCode : this.selectedSrvlBnftInRev.pdSrvlBnftCode)\r\n          } else {\r\n            this.focusItem()\r\n          }\r\n        })\r\n      } else { // 非订正\r\n        if (this.productBnftForm.bnftDtType.length === 0) {\r\n          this.notifyError(this.$t('bnftFormula.pleaseSelectBnftDetailType'))\r\n          return\r\n        }\r\n        if (!this.productBnftForm.ExpressionType) {\r\n          this.notifyError(this.$t('bnftFormula.pleaseSelectPdBussDetailType'))\r\n          return\r\n        }\r\n        if (!this.productBnftForm.bnft) {\r\n          this.notifyError(this.$t('bnftFormula.pleaseSelectPdBnftItem'))\r\n          return\r\n        }\r\n        this.$emit('changeDialogVisible_formulaSelect2', true,\r\n          this.productBnftForm.bnftDtType, this.productBnftForm.ExpressionType, this.productBnftForm.bnft, this.productBnftForm.bnftDt)\r\n      }\r\n    },\r\n    toAddFormula() {\r\n      let passFlag = true\r\n      if (this.productCalcRevisionShowINfo) {\r\n        this.$refs.revisionFormulaForm.validate(pass => {\r\n          if (!pass) {\r\n            passFlag = false\r\n            this.focusItem()\r\n          }\r\n        })\r\n      }\r\n      if (!passFlag) {\r\n        return\r\n      }\r\n      const param = {\r\n        pdBussType: '2',\r\n        pdBussDetailType: this.productCalcRevisionShowINfo ? this.revisionFormulaForm.pdBussDetailType : this.calculationFormulaType\r\n      }\r\n      getRuleCode(this.buildRequestData(param)).then(response => {\r\n        this.attributeObj = {\r\n          code: response.data,\r\n          ruleBussModu: '2',\r\n          ruleBussModuDeta: param.pdBussDetailType,\r\n          ruleType: '2',\r\n          ruleAttr: '2',\r\n          pdType: '1',\r\n          riskType: this.product.bType,\r\n          riskDetail: this.product.cType,\r\n          pdCode: this.product.pdCode,\r\n          pdEdition: this.product.pdEdition\r\n        }\r\n        this.formulaVisible = true\r\n      })\r\n    },\r\n    selectedFormulaChanged() {\r\n      this.formulaView.flag = this.selectedFormula.ruleAttr === '1' ? '1' : '2'\r\n      this.formulaView.performType = this.selectedFormula.performType\r\n      this.formulaView.ruleCode = this.selectedFormula.pdCalcCode\r\n      this.formulaView.visible = true\r\n    },\r\n    deleteFormula(row) {\r\n      deleteFormula(row).then(() => {\r\n        this.notifySuccess(this.$t('successMessage.delete'))\r\n        this.$refs.page_current.reload()\r\n        this.$refs.page_brief.reload()\r\n        this.$emit('bringInCalcCode', this.calculationFormulaType, row.pdBussCode, '')\r\n      })\r\n    },\r\n    handleSelectFormula(row) {\r\n      let passFlag = true\r\n      // 订正时，进行表单验证\r\n      if (this.productCalcRevisionShowINfo) {\r\n        this.$refs.revisionFormulaForm.validate(pass => {\r\n          if (!pass) {\r\n            this.focusItem()\r\n            passFlag = false\r\n          }\r\n        })\r\n      }\r\n      if (!passFlag) {\r\n        return\r\n      }\r\n      let PdtempPdCalc = {\r\n        pdInfoId: this.product.id,\r\n        pdVerId: this.product.pdVerId,\r\n        pdType: '1',\r\n        pdCode: this.product.pdCode,\r\n        pdBussType: '2',\r\n        pdBussDetailType: this.productCalcRevisionShowINfo ? this.revisionFormulaForm.pdBussDetailType : this.calculationFormulaType,\r\n        pdBussId: '',\r\n        pdBussCode: '',\r\n        pdStructureType: '',\r\n        pdCalcCode: row.pdCalcCode,\r\n        pdCalcDesc: row.pdCalcDesc\r\n      }\r\n      const pdBnftType = this.productCalcRevisionShowINfo ? this.selectedBnftInRev.pdBnftType : this.guaranteeDetails[0]\r\n      if (!this.productCalcRevisionShowINfo) { // 非公式订正\r\n        if (this.productBnftForm.bnftDt) {\r\n          PdtempPdCalc.pdBussId = this.pdBnftOptions.id\r\n          if (pdBnftType === 'C') {\r\n            PdtempPdCalc.pdStructureType = '02'\r\n            PdtempPdCalc.pdBussCode = this.pdBnftOptions.pdClmBnftCode\r\n          } else {\r\n            PdtempPdCalc.pdStructureType = '04'\r\n            PdtempPdCalc.pdBussCode = this.pdBnftOptions.pdSrvlBnftCode\r\n          }\r\n        } else {\r\n          PdtempPdCalc.pdBussId = this.pdUwSiTypeOptions.id\r\n          PdtempPdCalc.pdBussCode = this.pdUwSiTypeOptions.pdBnftCode\r\n          PdtempPdCalc.pdStructureType = '01'\r\n        }\r\n      } else { // 公式订正\r\n        if (Object.keys(this.selectedClmBnftInRev).length > 0) {\r\n          PdtempPdCalc.pdBussId = this.selectedClmBnftInRev.id\r\n          PdtempPdCalc.pdBussCode = this.selectedClmBnftInRev.pdClmBnftCode\r\n          PdtempPdCalc.pdStructureType = '02'\r\n        } else if (Object.keys(this.selectedSrvlBnftInRev).length > 0) {\r\n          PdtempPdCalc.pdBussId = this.selectedSrvlBnftInRev.id\r\n          PdtempPdCalc.pdBussCode = this.selectedSrvlBnftInRev.pdSrvlBnftCode\r\n          PdtempPdCalc.pdStructureType = '04'\r\n        } else if (Object.keys(this.selectedBnftInRev).length > 0) {\r\n          PdtempPdCalc.pdBussId = this.selectedBnftInRev.id\r\n          PdtempPdCalc.pdBussCode = this.selectedBnftInRev.pdBnftCode\r\n          PdtempPdCalc.pdStructureType = '01'\r\n        }\r\n      }\r\n      if (!PdtempPdCalc.pdBussId || !PdtempPdCalc.pdBussCode || !PdtempPdCalc.pdStructureType) {\r\n        this.notifyError(this.$t('bnftFormula.incompleteBnftInfo'))\r\n        return\r\n      }\r\n      const param = {\r\n        selectedFormula: row,\r\n        pdtempPdCalc: PdtempPdCalc,\r\n        product: this.product,\r\n        pdBussType: '2',\r\n        pdBussDetailType: this.productCalcRevisionShowINfo ? this.revisionFormulaForm.pdBussDetailType : this.calculationFormulaType,\r\n        needChecking: true\r\n      }\r\n      associate(this.buildRequestData(param)).then(response => {\r\n        let successFlag = response.data.flag\r\n        let pdtempPdCalc = response.data.pdtempPdCalc\r\n        if (successFlag === true) {\r\n          this.notifySuccess(this.$t('rule.associationSuccess'))\r\n          this.$refs.page_current.reload()\r\n          this.$refs.page_brief.reload()\r\n          this.$emit('bringInCalcCode', this.calculationFormulaType, pdtempPdCalc.pdBussCode, pdtempPdCalc.pdCalcCode)\r\n        } else {\r\n          this.$confirm(String(this.$t('underwritingAmountFormulaSelect.confirm_overwrite_formula')), String(this.$t('confirmMessage.tip')), {\r\n            confirmButtonText: String(this.$t('confirmMessage.confirm')),\r\n            cancelButtonText: String(this.$t('confirmMessage.cancel')),\r\n            type: 'warning'\r\n          }).then(() => {\r\n            param.needChecking = false\r\n            associate(this.buildRequestData(param)).then(response => {\r\n              let pdtempPdCalc = response.data.pdtempPdCalc\r\n              this.notifySuccess(this.$t('rule.associationSuccess'))\r\n              this.$refs.page_current.reload()\r\n              this.$refs.page_brief.reload()\r\n              this.$emit('bringInCalcCode', this.calculationFormulaType, pdtempPdCalc.pdBussCode, pdtempPdCalc.pdCalcCode)\r\n            })\r\n          }).catch(() => {\r\n            this.messageInfo(this.$t('underwritingAmountFormulaSelect.canceled'))\r\n          })\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>\r\n"]}]}