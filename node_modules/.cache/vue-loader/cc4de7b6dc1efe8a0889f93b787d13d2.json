{"remainingRequest":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\business-general-conf\\pdgenlcmpninfo\\index.vue?vue&type=style&index=0&id=5d967c5c&lang=scss&scoped=true&","dependencies":[{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\business-general-conf\\pdgenlcmpninfo\\index.vue","mtime":1609847106584},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\css-loader\\dist\\cjs.js","mtime":1706753188288},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1706753191924},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\postcss-loader\\src\\index.js","mtime":1706753189537},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1706753187424},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1706753190941}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLm5hbWVzdHlsZXsKICB3aWR0aDogNjMzcHg7Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsbA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/business-general-conf/pdgenlcmpninfo","sourcesContent":["<template>\r\n  <el-main>\r\n\r\n    <el-form label-width=\"auto\" ref=\"params\">\r\n      <el-row type=\"flex\"  class=\"row-bg\" justify=\"right\">\r\n        <el-col :span=\"6\" >\r\n          <el-form-item :label=\"$t('i18nView.cmpnType')\">\r\n            <cus-select :codetype=\"'yhtype'\" :placeholder=\"$t('pdgenlCmpnInfo.cmpnType')\" v-model=\"params.cmpnType\" clearable></cus-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"6\">\r\n          <el-form-item :label=\"$t('i18nView.codename')\">\r\n            <el-select v-model=\"params.cmpnCode\" :placeholder=\"$t('form.please_select')\"  clearable>\r\n              <el-option :key=\"item.id\" :label=\"item.cmpnCode+':'+item.cmpnChName\" :value=\"item.cmpnCode\"\r\n                         v-for=\"item in options\"></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <cus-btn-wrapper>\r\n          <el-button  size=\"small\" type=\"primary\" icon=\"el-icon-search\" @click=\"searchDataByCondition()\" >{{$t('pdgenlCmpnInfo.search') }}</el-button>\r\n        </cus-btn-wrapper>\r\n      </el-row>\r\n\r\n      <cus-table-title :label=\"$t('i18nView.codename')\"></cus-table-title>\r\n      <el-table  :data=\"tableData\" size=\"mini\" fit element-loading-text=\"Loading\" border highlight-current-row align=\"center\"  class=\"wraper-table\" style=\"width: 95%\" @row-click=\"chooseRow\">\r\n          <el-table-column width=\"50px\" :label=\"$t('table.select')\" align=\"center\">\r\n            <template slot-scope=\"scope\">\r\n              <el-radio v-model=\"chooseRowId\" :label=\"scope.row.id\">\r\n                <span class=\"el-radio__label\"></span>\r\n              </el-radio>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"index\" width=\"80\"  :label=\"$t('table.id')\" align=\"center\" type=\"index\" sortable ></el-table-column>\r\n          <el-table-column :label=\"$t('i18nView.cmpnCode')\" prop=\"cmpnCode\" align=\"center\"></el-table-column>\r\n          <el-table-column :label=\"$t('i18nView.cmpnName')\" prop=\"cmpnChName\" align=\"center\"></el-table-column>\r\n          <el-table-column :label=\"$t('i18nView.cmpnType')\" prop=\"cmpnType\" align=\"center\">\r\n            <template v-slot=\"scope\">{{scope.row.cmpnType | filter_type('cmpnType')}}</template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('i18nView.cmpnStartDate')\" prop=\"cmpnStartDate\" align=\"center\"></el-table-column>\r\n          <el-table-column :label=\"$t('i18nView.cmpnEndDate')\" prop=\"cmpnEndDate\" align=\"center\"></el-table-column>\r\n          <el-table-column width=\"88px\" :label=\"$t('i18nView.pdRelated')\" align=\"center\">\r\n            <template slot-scope=\"scope\">\r\n              <el-button  size=\"small\" type=\"text\" @click=\"showDrawer(scope.row.cmpnCode)\" >>></el-button>\r\n              <el-dialog  :visible.sync=\"drawer\" :modal-append-to-body=\"false\">\r\n                <cus-page-title-back :isDialog=\"true\" @backTo=\"drawer=false\" :label=\"$t('pdgenlCmpnInfo.aboutPd')\"/>\r\n                <el-table :data=\"formPdCodeName\" border size=\"88%\">\r\n                  <el-table-column :label=\"$t('i18nView.pdCode')\" prop=\"pdCode\" align=\"center\"></el-table-column>\r\n                  <el-table-column :label=\"$t('i18nView.pdName')\" prop=\"pdName\" align=\"center\"></el-table-column>\r\n                </el-table>\r\n                <div slot=\"footer\" class=\"dialog-footer\">\r\n                  <el-button  size=\"small\" @click=\"drawer = false\" type=\"primary\">{{$t('pdtempsaledes.close')}}</el-button>\r\n                </div>\r\n              </el-dialog>\r\n            </template>\r\n          </el-table-column>\r\n      </el-table>\r\n    </el-form>\r\n\r\n\r\n    <cus-form-title :label=\"$t('pdgenlCmpnInfo.offerDefinition')\" :showArrow=\"true\" :display=\"discountDefFlag\" @show=\"discountDefFlag = !discountDefFlag\"/>\r\n      <el-form v-if=\"discountDefFlag\"  ref=\"form\" :model=\"form\" label-width=\"auto\"  :rules=\"rules\" >\r\n        <el-row type=\"flex\" :gutter=\"10\" class=\"row-bg\" >\r\n         <!-- <el-col :span=\"6\">\r\n            <el-form-item label=\"优惠编码\" align=\"right\" :label=\"$t('pdgenlCmpnInfo.cmpnCode')\">\r\n              <el-input :placeholder=\"$t('pdgenlCmpnInfo.cmpnCode')\" v-model=\"form.cmpnCode\" clearable></el-input>\r\n            </el-form-item>\r\n          </el-col>-->\r\n          <el-col :span=\"6\" >\r\n            <el-form-item :label=\"$t('i18nView.cmpnType')\" prop=\"cmpnType\">\r\n              <cus-select :codetype=\"'yhtype'\" :placeholder=\"$t('pdgenlCmpnInfo.cmpnType')\" v-model=\"form.cmpnType\" clearable></cus-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row type=\"flex\" :gutter=\"10\" class=\"row-bg\" justify=\"center\">\r\n          <el-col :span=\"12\" >\r\n            <el-form-item :label=\"$t('i18nView.cmpnChName')\" prop=\"cmpnChName\">\r\n              <el-input type=\"text\" :placeholder=\"$t('i18nView.cmpnChName')\" v-model=\"form.cmpnChName\" maxlength=\"60\" show-word-limit class=\"namestyle\"></el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\" ></el-col>\r\n        </el-row>\r\n<!--        <el-row type=\"flex\" :gutter=\"10\" class=\"row-bg\" justify=\"center\">-->\r\n<!--          <el-col :span=\"12\" >-->\r\n<!--            <el-form-item :label=\"$t('i18nView.cmpnEnName')\" prop=\"cmpnEnName\">-->\r\n<!--              <el-input type=\"text\" :placeholder=\"$t('pdgenlCmpnInfo.cmpnEnName')\" v-model=\"form.cmpnEnName\" maxlength=\"120\" show-word-limit class=\"namestyle\"></el-input>-->\r\n<!--            </el-form-item>-->\r\n<!--          </el-col>-->\r\n<!--          <el-col :span=\"12\" ></el-col>-->\r\n<!--        </el-row>-->\r\n        <el-row v-if=\"form.cmpnType=='H'\">\r\n          <el-col :span=\"6\">\r\n            <el-form-item :label=\"$t('i18nView.cmpnPayCurr')\" prop=\"pdPolCurr\" >\r\n              <cus-select :codetype=\"'productCurrency'\" v-model=\"form.cmpnPayCurr\" ></cus-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"6\">\r\n            <el-form-item :label=\"$t('i18nView.cmpnPolCurr')\" prop=\"pdPolYear\" >\r\n              <cus-select :codetype=\"'productCurrency'\" v-model=\"form.cmpnPolCurr\" :placeholder=\"$t('form.please_select')\" clearable>\r\n                <el-option\r\n                  v-for=\"item in pdCurr\"\r\n                  :key=\"item.code\"\r\n                  :label=\"item.code+'  :  '+item.name\"\r\n                  :value=\"item.code\">\r\n              </el-option>\r\n              </cus-select>\r\n             <!-- <cus-select :codetype=\"'productCurrency'\" v-model=\"form.cmpnPolCurr\" ></cus-select>-->\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row  :gutter=\"10\">\r\n          <el-col :span=\"6\" >\r\n            <el-form-item align=\"right\" :label=\"$t('i18nView.cmpnStartDate')\" prop=\"cmpnStartDate\">\r\n              <el-date-picker type=\"date\" :placeholder=\"$t('i18nView.selectDate')\" v-model=\"form.cmpnStartDate\"  ></el-date-picker>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"6\" >\r\n            <el-form-item :label=\"$t('i18nView.cmpnEndDate')\" prop=\"cmpnEndDate\">\r\n              <el-date-picker  type=\"date\" :placeholder=\"$t('i18nView.selectDate')\" v-model=\"form.cmpnEndDate\"  ></el-date-picker>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"6\" >\r\n            <el-form-item :label=\"$t('i18nView.cmpnSdNotice')\">\r\n              <el-switch v-model=\"form.cmpnSdNotice\"  active-value=\"Y\" inactive-value=\"N\"></el-switch>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row :gutter=\"10\" >\r\n          <el-col :span=\"6\">\r\n            <el-form-item  :label=\"$t('i18nView.cmpnCalcMode')\">\r\n              <cus-radio :codetype=\"'yhjsfs'\" :placeholder=\"$t('pdgenlCmpnInfo.cmpnCalcMode')\" v-model=\"form.cmpnCalcMode\" :changeMethod=\"changeExWay\"></cus-radio>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"6\" :label=\"$t('pdgenlCmpnInfo.cmpnVal')\">\r\n            <el-form-item :label=\"$t('i18nView.cmpnVal')\" prop=\"cmpnVal\" :rules=\"this.form.cmpnCalcMode==1?rules.cmpnVal:[{ required: false, trigger: 'blur' }]\">\r\n              <el-input :placeholder=\"$t('pdgenlCmpnInfo.cmpnVal')\" v-model=\"form.cmpnVal\" clearable :disabled=\"form.cmpnCalcMode==2\" >\r\n                <template slot=\"suffix\">{{$t('i18nView.yuan')}}</template>\r\n              </el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row :gutter=\"10\" >\r\n          <el-col :span=\"6\" >\r\n            <el-form-item :label=\"$t('i18nView.calcComsFlag')\">\r\n              <el-switch v-model=\"form.calcComsFlag\"  active-value='Y' inactive-value='N' @change=\"executeComsFlag(form.calcComsFlag)\"></el-switch>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"6\" >\r\n            <el-form-item :label=\"$t('i18nView.calcComsBasic')\">\r\n              <cus-select :codetype=\"'pd_prem_cal_method'\" :placeholder=\"$t('pdgenlCmpnInfo.calcComsBasic')\" :disabled=\"form.calcComsFlag=='N'\"\r\n                          v-model=\"form.calcComsBasic\" clearable></cus-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"6\" ></el-col>\r\n        </el-row>\r\n\r\n        <el-row type=\"flex\" :gutter=\"10\" class=\"row-bg\" justify=\"center\">\r\n          <el-col :span=\"24\" >\r\n            <el-form-item :label=\"$t('i18nView.cmpnSdNotice')\">\r\n              <el-input type=\"textarea\" :placeholder=\"$t('i18nView.pleInput')\" v-model=\"form.cmpnDesc\" maxlength=\"100\" show-word-limit></el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <cus-form-title :label=\"$t('pdgenlCmpnInfo.cmpnCalcMode')\" />\r\n        <el-row :gutter=\"10\">\r\n          <el-col :span=\"6\" >\r\n            <el-form-item :label=\"$t('i18nView.cmpnCalcFormula')\" prop=\"cmpnCalcCode\" :rules=\"this.form.cmpnCalcMode==2?rules.cmpnCalcCode:[{ required: false, trigger: 'blur' }]\">\r\n              <el-input readonly v-model=\"form.cmpnCalcCode\">\r\n                <svg-icon @click=\"toFormulaDef()\" icon-class=\"calc\" slot=\"suffix\"\r\n                          style=\"color: #606266;font-size: 18px;cursor: pointer\"/>\r\n              </el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n\r\n        <el-form-item id=\"boxFixed\"  style=\"float: right\">\r\n          <el-button  size=\"small\"  icon=\"el-icon-success\"  style=\"margin-right: 5px;margin-left: 5px\"  type=\"primary\" v-auth=\"'pdgenl-cmpn-info:add'\" @click=\"submitForm\"  v-show=\"!this.chooseRowId\">{{$t('pdtempsaledes.submit')}}</el-button>\r\n          <el-button  size=\"small\" icon=\"el-icon-success\" style=\"margin-left: 5px\"  type=\"primary\" v-auth=\"'pdgenl-cmpn-info:add'\" @click=\"submitForm\"  v-show=\"this.chooseRowId\">{{$t('pdtempsaledes.update')}}</el-button>\r\n          <cus-popover\r\n            :buttonText=\"$t('table.delete')\"\r\n            @confirm=\"deleteData\" icon=\"el-icon-delete\" style=\"margin-left: 5px\" type=\"danger\"\r\n            v-show=\"this.chooseRowId\"\r\n            :content=\"$t('pdgenlCmpnInfo.deleteContent')\">\r\n          </cus-popover>\r\n          <el-button  icon=\"el-icon-refresh\" size=\"small\" style=\"margin-left: 5px\"  type=\"primary\"  @click=\"resetForm('form')\">{{$t('pdtempsaledes.clear')}}</el-button>\r\n        </el-form-item>\r\n\r\n\r\n      </el-form>\r\n    <!-- 弹窗（已关联公式列表） -->\r\n    <el-dialog :close-on-click-modal=\"false\" :visible.sync=\"formulaVisible\" append-to-body center\r\n               v-dialog-drag v-if=\"formulaVisible\" width=\"80%\">\r\n      <pdgenlDiscountFormula :pdBussDetailType=\"this.pdBussDetailType\"  :generalDiscount =\"generalDiscount\"\r\n                        @bringInCalcCode=\"bringInCalcCode\"\r\n                        @changeDialogVisible_GenDiscountFormula=\"changeDialogVisible_GenDiscountFormula\"\r\n                        @changeDialogVisible_GenDiscountFormulaSelect=\"changeDialogVisible_GenDiscountFormulaSelect\"></pdgenlDiscountFormula>\r\n    </el-dialog>\r\n\r\n    <!-- 弹窗（公式关联） -->\r\n    <el-dialog :close-on-click-modal=\"false\" :visible.sync=\"formulaSelectVisible\" append-to-body\r\n               center v-dialog-drag v-if=\"formulaSelectVisible\" width=\"70%\">\r\n      <pdgenlDiscountFormulaSelect :pdBussDetailType=\"this.pdBussDetailType\"  :generalDiscount =\"generalDiscount\"\r\n                              @bringInCalcCode=\"bringInCalcCode\"\r\n                              @changeDialogVisible_GenDiscountFormulaSelect=\"changeDialogVisible_GenDiscountFormulaSelect\"></pdgenlDiscountFormulaSelect>\r\n    </el-dialog>\r\n\r\n  </el-main>\r\n</template>\r\n<script>\r\n\r\n  import {addPdgenlCmpnInfo, deletePdgenlCmpnInfo, getPdCodeName, getPdgenlCmpnInfo, getPolCurr} from '@/api/basicinfo/pdgenlcmpninfo'\r\n  import pdgenlDiscountFormula from '@/views/business-general-conf/pdgenlcmpninfo/discount-formula'\r\n  import pdgenlDiscountFormulaSelect from '@/views/business-general-conf/pdgenlcmpninfo/discount-formula-select'\r\n let _this;\r\n    export default {\r\n      name: 'pdgenlCmpnInfo',\r\n      components: {\r\n        pdgenlDiscountFormula, pdgenlDiscountFormulaSelect},\r\n      filters: {\r\n        filter_type(code,value){\r\n          if (value == 'cmpnType'){\r\n              return _this.getCodeName('yhtype', code);\r\n          }\r\n        },\r\n\r\n      },\r\n        data() {\r\n          _this = this;\r\n            return {\r\n              discountDefFlag: false,\r\n              input:'',\r\n              drawer: false,\r\n              formulaVisible:false,\r\n              formulaSelectVisible:false,\r\n              generalDiscount:{},\r\n              chooseRowId:'',\r\n                //表格数据\r\n              tableData: [],\r\n              mpdcode:'',\r\n              options:[],\r\n              pdCurr:[],\r\n              params: {\r\n                cmpnCode:'',\r\n                cmpnType: ''\r\n              },\r\n\r\n              formPdCodeName:[],\r\n              form: {  //表单数据与后端实体类对应\r\n                id: '', //主键ID\r\n                cmpnCode:'', cmpnType:'', cmpnChName:'', cmpnEnName:'', cmpnStartDate:'',\r\n                cmpnEndDate:'', cmpnCalcMode:'1', cmpnVal:'', cmpnCalcCode:'', calcComsFlag:'',\r\n                calcComsBasic:'', cmpnSdNotice:'', cmpnDesc:'', cmpnPayCurr:'', cmpnPolCurr:'',\r\n              },\r\n              bcform: {  //表单数据与后端实体类对应\r\n                id: '', //主键ID\r\n                cmpnCode:'', cmpnType:'', cmpnChName:'', cmpnEnName:'', cmpnStartDate:'',\r\n                cmpnEndDate:'', cmpnCalcMode:'1', cmpnVal:'', cmpnCalcCode:'', calcComsFlag:'',\r\n                calcComsBasic:'', cmpnSdNotice:'', cmpnDesc:'',cmpnPayCurr:'', cmpnPolCurr:'',\r\n              },\r\n              //检验规则\r\n              rules: {\r\n                cmpnType: [{required: true, message: this.$t('pdgenlCmpnInfo.selemsg'), trigger: 'change'}],\r\n                cmpnChName: [{required: true, message: this.$t('pdgenlCmpnInfo.impmsg'), trigger: 'blur'}],\r\n                cmpnEnName: [{required: true, message: this.$t('pdgenlCmpnInfo.impmsg'), trigger: 'blur'}],\r\n                cmpnStartDate: [{required: true, message: this.$t('i18nView.datePlaceholder'), trigger: 'blur'}],\r\n                cmpnEndDate: [{required: true, message: this.$t('i18nView.datePlaceholder'), trigger: 'blur'},\r\n                  {\r\n                    validator: (rule, value, callback) => {\r\n                      if (value <this.form.cmpnStartDate) {\r\n                        callback(new Error(this.$t('pdgenlCmpnInfo.timeIntervalVerification')))\r\n                      } else {\r\n                        callback()\r\n                      }\r\n                    }\r\n                  }],\r\n                cmpnVal:[{ required: true,message: this.$t('pdgenlCmpnInfo.imputms'), trigger: 'blur' }],\r\n                cmpnCalcCode:[{ required: true,message: this.$t('pdgenlCmpnInfo.pleaseInput')+this.$t('pdgenlCmpnInfo.cmpnCalcCode'), trigger: 'blur' }]\r\n              },\r\n            }\r\n        },\r\n        computed: {},\r\n        created() {\r\n          /*let pdtempPdInfo = JSON.parse(sessionStorage.getItem(\"pdInfo\"));\r\n          this.mpdcode = pdtempPdInfo.pdCode;*/\r\n          this.mpdcode = '100112';\r\n        },\r\n        mounted() {\r\n          this.getPolCurr(this.mpdcode);\r\n          this.initQueryDatas();\r\n         // this.form.cmpnStartDate = new Date();\r\n          // his.bcform = this.form;\r\n          Object.assign(this.bcform,this.form)\r\n        },\r\n        methods: {\r\n          /*控制抽屉是否显示*/\r\n          showDrawer(val){\r\n            getPdCodeName(this.buildRequestData({\"pdCmnpCode\":val})).then(res=>{\r\n              if (res.code === 200){\r\n                this.formPdCodeName = res.data;\r\n              }\r\n            });\r\n            if (this.drawer){\r\n              this.drawer=false;\r\n            }else{\r\n              this.drawer=true;\r\n            }\r\n          },\r\n          bringInCalcCode(cmpnType, calcCode) {\r\n            debugger\r\n            console.log(cmpnType+calcCode)\r\n            if (this.form.cmpnType === cmpnType) {\r\n              this.$set(this.form, 'cmpnCalcCode', calcCode)\r\n            }\r\n          },\r\n          toFormulaDef() {\r\n            if(this.form.cmpnCalcMode=='2'){\r\n              if (this.form.cmpnType == '' || this.form.cmpnType == undefined) {\r\n                this.notifyError(\"请选择优惠类型\");\r\n                return\r\n              }\r\n              this.pdBussDetailType = '40';\r\n              this.formulaVisible = true;\r\n              this.generalDiscount = this.form\r\n            }else{\r\n              this.notifyError(\"请选择正确的优惠计算方式\");\r\n            }\r\n          },\r\n          changeDialogVisible_GenDiscountFormula(visible) {\r\n            this.formulaVisible = visible\r\n          },\r\n          changeDialogVisible_GenDiscountFormulaSelect(visible) {\r\n            this.formulaSelectVisible = visible\r\n            if (visible === false) {\r\n              this.formulaVisible = false;\r\n              this.$nextTick(() => {\r\n                this.formulaVisible = true\r\n              })\r\n            }\r\n          },\r\n          executeComsFlag(flag){\r\n            if (flag==0){\r\n              this.form.calcComsBasic = '';\r\n            }\r\n          },\r\n          changeExWay(way){\r\n            if (way == 2){\r\n              this.form.cmpnVal = ''\r\n            }else if (way==1){\r\n              this.form.cmpnCalcCode = ''\r\n            }\r\n          },\r\n          /*表单搜索功能*/\r\n          searchDataByCondition(){\r\n            getPdgenlCmpnInfo(this.buildRequestData(this.params)).then(res=>{\r\n              if (res.code === 200) {\r\n                this.tableData = res.data;\r\n                this.options=res.data\r\n              }\r\n            })\r\n          },\r\n\r\n          /*表格选择一条数据，回显到表单*/\r\n          chooseRow(row, column, event){\r\n            if (event.target.nodeName === \"INPUT\") {\r\n              if (row.id == this.chooseRowId) {\r\n                this.chooseRowId = '';\r\n                this.form= this.bcform;\r\n              } else {\r\n                this.chooseRowId = row.id;\r\n                this.form =Object.assign({},row);\r\n\r\n                this.form.cmpnPolCurr = _this.getCodeName('productCurrency', row.cmpnPolCurr,);\r\n              }\r\n            }\r\n            this.discountDefFlag = true\r\n          },\r\n\r\n          /*获取产品保单币种*/\r\n          getPolCurr(mpdCode){\r\n\r\n            getPolCurr(mpdCode).then(res=>{\r\n              for(let n = 0 ;n < res.data.length;n++){\r\n                let code = res.data[n];\r\n                let codeName = _this.getCodeName('productCurrency', code,true);\r\n                let mpdCurr = {};\r\n                mpdCurr.code = code;\r\n                mpdCurr.name = codeName;\r\n                this.pdCurr.push(mpdCurr);\r\n              }\r\n            })\r\n          },\r\n\r\n          /*表格初始化数据*/\r\n          initQueryDatas(){\r\n            getPdgenlCmpnInfo(this.buildRequestData(this.params)).then(res=>{\r\n              if (res.code == 200){\r\n                this.tableData = res.data;\r\n                this.options=res.data\r\n              }\r\n            })\r\n          },\r\n          submitForm() {\r\n            console.log(this.form.cmpnCalcCode)\r\n            this.$refs.form.validate((valid) => {\r\n              if (valid) {\r\n                addPdgenlCmpnInfo(this.form).then(res => {\r\n                  if (res.code === 200) {\r\n                    this.initQueryDatas();\r\n                    this.notifySuccess(res.message);\r\n                  }\r\n                })\r\n              }\r\n            })\r\n          },\r\n          deleteData() {\r\n            if (this.chooseRowId!=null && ''!=this.chooseRowId){\r\n\r\n              deletePdgenlCmpnInfo(this.chooseRowId).then(res=>{\r\n                if (res.code == 200) {\r\n                  this.initQueryDatas();\r\n                  this.notifySuccess(res.message);\r\n                }this.resetForm('form')\r\n              })\r\n            }\r\n          },\r\n          resetForm(formName) {\r\n            this.$refs[formName].resetFields();\r\n            this.form= this.bcform;\r\n            this.chooseRowId='';\r\n          }\r\n\r\n        }\r\n    }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n  .namestyle{\r\n    width: 633px;\r\n  }\r\n</style>\r\n"]}]}