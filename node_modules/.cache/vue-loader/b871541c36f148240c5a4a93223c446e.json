{"remainingRequest":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\86181\\Desktop\\product\\pcs-product-view\\src\\components\\HeaderSearch\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\src\\components\\HeaderSearch\\index.vue","mtime":1609847106283},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\babel-loader\\lib\\index.js","mtime":1706753193796},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1706753190941}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIGZ1c2UgaXMgYSBsaWdodHdlaWdodCBmdXp6eS1zZWFyY2ggbW9kdWxlCi8vIG1ha2Ugc2VhcmNoIHJlc3VsdHMgbW9yZSBpbiBsaW5lIHdpdGggZXhwZWN0YXRpb25zCmltcG9ydCBGdXNlIGZyb20gJ2Z1c2UuanMnCmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnCmltcG9ydCBpMThuIGZyb20gJ0AvbGFuZycKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnSGVhZGVyU2VhcmNoJywKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgc2VhcmNoOiAnJywKICAgICAgb3B0aW9uczogW10sCiAgICAgIHNlYXJjaFBvb2w6IFtdLAogICAgICBzaG93OiBmYWxzZSwKICAgICAgZnVzZTogdW5kZWZpbmVkCiAgICB9CiAgfSwKICBjb21wdXRlZDogewogICAgcm91dGVzKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVycy5wZXJtaXNzaW9uX3JvdXRlcwogICAgfSwKICAgIGxhbmcoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzLmxhbmd1YWdlCiAgICB9CiAgfSwKICB3YXRjaDogewogICAgbGFuZygpIHsKICAgICAgdGhpcy5zZWFyY2hQb29sID0gdGhpcy5nZW5lcmF0ZVJvdXRlcyh0aGlzLnJvdXRlcykKICAgIH0sCiAgICByb3V0ZXMoKSB7CiAgICAgIHRoaXMuc2VhcmNoUG9vbCA9IHRoaXMuZ2VuZXJhdGVSb3V0ZXModGhpcy5yb3V0ZXMpCiAgICB9LAogICAgc2VhcmNoUG9vbChsaXN0KSB7CiAgICAgIHRoaXMuaW5pdEZ1c2UobGlzdCkKICAgIH0sCiAgICBzaG93KHZhbHVlKSB7CiAgICAgIGlmICh2YWx1ZSkgewogICAgICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNsb3NlKQogICAgICB9IGVsc2UgewogICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNsb3NlKQogICAgICB9CiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5zZWFyY2hQb29sID0gdGhpcy5nZW5lcmF0ZVJvdXRlcyh0aGlzLnJvdXRlcykKICB9LAogIG1ldGhvZHM6IHsKICAgIGNsaWNrKCkgewogICAgICB0aGlzLnNob3cgPSAhdGhpcy5zaG93CiAgICAgIGlmICh0aGlzLnNob3cpIHsKICAgICAgICB0aGlzLiRyZWZzLmhlYWRlclNlYXJjaFNlbGVjdCAmJiB0aGlzLiRyZWZzLmhlYWRlclNlYXJjaFNlbGVjdC5mb2N1cygpCiAgICAgIH0KICAgIH0sCiAgICBjbG9zZSgpIHsKICAgICAgdGhpcy4kcmVmcy5oZWFkZXJTZWFyY2hTZWxlY3QgJiYgdGhpcy4kcmVmcy5oZWFkZXJTZWFyY2hTZWxlY3QuYmx1cigpCiAgICAgIHRoaXMub3B0aW9ucyA9IFtdCiAgICAgIHRoaXMuc2hvdyA9IGZhbHNlCiAgICB9LAogICAgY2hhbmdlKHZhbCkgewogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh2YWwucGF0aCkuY2F0Y2goKCkgPT4gewogICAgICB9KQogICAgICB0aGlzLnNlYXJjaCA9ICcnCiAgICAgIHRoaXMub3B0aW9ucyA9IFtdCiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICB0aGlzLnNob3cgPSBmYWxzZQogICAgICB9KQogICAgfSwKICAgIGluaXRGdXNlKGxpc3QpIHsKICAgICAgdGhpcy5mdXNlID0gbmV3IEZ1c2UobGlzdCwgewogICAgICAgIHNob3VsZFNvcnQ6IHRydWUsCiAgICAgICAgdGhyZXNob2xkOiAwLjQsCiAgICAgICAgbG9jYXRpb246IDAsCiAgICAgICAgZGlzdGFuY2U6IDEwMCwKICAgICAgICBtYXhQYXR0ZXJuTGVuZ3RoOiAzMiwKICAgICAgICBtaW5NYXRjaENoYXJMZW5ndGg6IDEsCiAgICAgICAga2V5czogW3sKICAgICAgICAgIG5hbWU6ICd0aXRsZScsCiAgICAgICAgICB3ZWlnaHQ6IDAuNwogICAgICAgIH0sIHsKICAgICAgICAgIG5hbWU6ICdwYXRoJywKICAgICAgICAgIHdlaWdodDogMC4zCiAgICAgICAgfV0KICAgICAgfSkKICAgIH0sCiAgICAvLyBGaWx0ZXIgb3V0IHRoZSByb3V0ZXMgdGhhdCBjYW4gYmUgZGlzcGxheWVkIGluIHRoZSBzaWRlYmFyCiAgICAvLyBBbmQgZ2VuZXJhdGUgdGhlIGludGVybmF0aW9uYWxpemVkIHRpdGxlCiAgICBnZW5lcmF0ZVJvdXRlcyhyb3V0ZXMsIGJhc2VQYXRoID0gJy8nLCBwcmVmaXhUaXRsZSA9IFtdKSB7CiAgICAgIGxldCByZXMgPSBbXQoKICAgICAgZm9yIChjb25zdCByb3V0ZXIgb2Ygcm91dGVzKSB7CiAgICAgICAgLy8gc2tpcCBoaWRkZW4gcm91dGVyCiAgICAgICAgaWYgKHJvdXRlci5oaWRkZW4pIHsKICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgfQoKICAgICAgICBjb25zdCBkYXRhID0gewogICAgICAgICAgcGF0aDogcGF0aC5yZXNvbHZlKGJhc2VQYXRoLCByb3V0ZXIucGF0aCksCiAgICAgICAgICB0aXRsZTogWy4uLnByZWZpeFRpdGxlXQogICAgICAgIH0KCiAgICAgICAgaWYgKHJvdXRlci5tZXRhICYmIHJvdXRlci5tZXRhLnRpdGxlKSB7CiAgICAgICAgICAvLyBnZW5lcmF0ZSBpbnRlcm5hdGlvbmFsaXplZCB0aXRsZQogICAgICAgICAgY29uc3QgaTE4bnRpdGxlID0gaTE4bi50KGByb3V0ZS4ke3JvdXRlci5tZXRhLnRpdGxlfWApCgogICAgICAgICAgZGF0YS50aXRsZSA9IFsuLi5kYXRhLnRpdGxlLCBpMThudGl0bGVdCgogICAgICAgICAgaWYgKHJvdXRlci5yZWRpcmVjdCAhPT0gJ25vUmVkaXJlY3QnKSB7CiAgICAgICAgICAgIC8vIG9ubHkgcHVzaCB0aGUgcm91dGVzIHdpdGggdGl0bGUKICAgICAgICAgICAgLy8gc3BlY2lhbCBjYXNlOiBuZWVkIHRvIGV4Y2x1ZGUgcGFyZW50IHJvdXRlciB3aXRob3V0IHJlZGlyZWN0CiAgICAgICAgICAgIHJlcy5wdXNoKGRhdGEpCiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyByZWN1cnNpdmUgY2hpbGQgcm91dGVzCiAgICAgICAgaWYgKHJvdXRlci5jaGlsZHJlbikgewogICAgICAgICAgY29uc3QgdGVtcFJvdXRlcyA9IHRoaXMuZ2VuZXJhdGVSb3V0ZXMocm91dGVyLmNoaWxkcmVuLCBkYXRhLnBhdGgsIGRhdGEudGl0bGUpCiAgICAgICAgICBpZiAodGVtcFJvdXRlcy5sZW5ndGggPj0gMSkgewogICAgICAgICAgICByZXMgPSBbLi4ucmVzLCAuLi50ZW1wUm91dGVzXQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcmVzCiAgICB9LAogICAgcXVlcnlTZWFyY2gocXVlcnkpIHsKICAgICAgaWYgKHF1ZXJ5ICE9PSAnJykgewogICAgICAgIHRoaXMub3B0aW9ucyA9IHRoaXMuZnVzZS5zZWFyY2gocXVlcnkpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5vcHRpb25zID0gW10KICAgICAgfQogICAgfQogIH0KfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAoBA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/HeaderSearch","sourcesContent":["<template>\r\n  <div :class=\"{'show':show}\" class=\"header-search\">\r\n    <svg-icon @click.stop=\"click\" class-name=\"search-icon\" icon-class=\"search\"/>\r\n    <el-select\r\n      :remote-method=\"querySearch\"\r\n      @change=\"change\"\r\n      class=\"header-search-select\"\r\n      default-first-option\r\n      filterable\r\n      placeholder=\"Search\"\r\n      ref=\"headerSearchSelect\"\r\n      remote\r\n      v-model=\"search\"\r\n    >\r\n      <el-option :key=\"item.path\" :label=\"item.title.join(' > ')\" :value=\"item\" v-for=\"item in options\"/>\r\n    </el-select>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  // fuse is a lightweight fuzzy-search module\r\n  // make search results more in line with expectations\r\n  import Fuse from 'fuse.js'\r\n  import path from 'path'\r\n  import i18n from '@/lang'\r\n\r\n  export default {\r\n    name: 'HeaderSearch',\r\n    data() {\r\n      return {\r\n        search: '',\r\n        options: [],\r\n        searchPool: [],\r\n        show: false,\r\n        fuse: undefined\r\n      }\r\n    },\r\n    computed: {\r\n      routes() {\r\n        return this.$store.getters.permission_routes\r\n      },\r\n      lang() {\r\n        return this.$store.getters.language\r\n      }\r\n    },\r\n    watch: {\r\n      lang() {\r\n        this.searchPool = this.generateRoutes(this.routes)\r\n      },\r\n      routes() {\r\n        this.searchPool = this.generateRoutes(this.routes)\r\n      },\r\n      searchPool(list) {\r\n        this.initFuse(list)\r\n      },\r\n      show(value) {\r\n        if (value) {\r\n          document.body.addEventListener('click', this.close)\r\n        } else {\r\n          document.body.removeEventListener('click', this.close)\r\n        }\r\n      }\r\n    },\r\n    mounted() {\r\n      this.searchPool = this.generateRoutes(this.routes)\r\n    },\r\n    methods: {\r\n      click() {\r\n        this.show = !this.show\r\n        if (this.show) {\r\n          this.$refs.headerSearchSelect && this.$refs.headerSearchSelect.focus()\r\n        }\r\n      },\r\n      close() {\r\n        this.$refs.headerSearchSelect && this.$refs.headerSearchSelect.blur()\r\n        this.options = []\r\n        this.show = false\r\n      },\r\n      change(val) {\r\n        this.$router.push(val.path).catch(() => {\r\n        })\r\n        this.search = ''\r\n        this.options = []\r\n        this.$nextTick(() => {\r\n          this.show = false\r\n        })\r\n      },\r\n      initFuse(list) {\r\n        this.fuse = new Fuse(list, {\r\n          shouldSort: true,\r\n          threshold: 0.4,\r\n          location: 0,\r\n          distance: 100,\r\n          maxPatternLength: 32,\r\n          minMatchCharLength: 1,\r\n          keys: [{\r\n            name: 'title',\r\n            weight: 0.7\r\n          }, {\r\n            name: 'path',\r\n            weight: 0.3\r\n          }]\r\n        })\r\n      },\r\n      // Filter out the routes that can be displayed in the sidebar\r\n      // And generate the internationalized title\r\n      generateRoutes(routes, basePath = '/', prefixTitle = []) {\r\n        let res = []\r\n\r\n        for (const router of routes) {\r\n          // skip hidden router\r\n          if (router.hidden) {\r\n            continue\r\n          }\r\n\r\n          const data = {\r\n            path: path.resolve(basePath, router.path),\r\n            title: [...prefixTitle]\r\n          }\r\n\r\n          if (router.meta && router.meta.title) {\r\n            // generate internationalized title\r\n            const i18ntitle = i18n.t(`route.${router.meta.title}`)\r\n\r\n            data.title = [...data.title, i18ntitle]\r\n\r\n            if (router.redirect !== 'noRedirect') {\r\n              // only push the routes with title\r\n              // special case: need to exclude parent router without redirect\r\n              res.push(data)\r\n            }\r\n          }\r\n\r\n          // recursive child routes\r\n          if (router.children) {\r\n            const tempRoutes = this.generateRoutes(router.children, data.path, data.title)\r\n            if (tempRoutes.length >= 1) {\r\n              res = [...res, ...tempRoutes]\r\n            }\r\n          }\r\n        }\r\n        return res\r\n      },\r\n      querySearch(query) {\r\n        if (query !== '') {\r\n          this.options = this.fuse.search(query)\r\n        } else {\r\n          this.options = []\r\n        }\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n  .header-search {\r\n    font-size: 0 !important;\r\n\r\n    .search-icon {\r\n      cursor: pointer;\r\n      font-size: 18px;\r\n      vertical-align: middle;\r\n    }\r\n\r\n    .header-search-select {\r\n      font-size: 18px;\r\n      transition: width 0.2s;\r\n      width: 0;\r\n      overflow: hidden;\r\n      background: transparent;\r\n      border-radius: 0;\r\n      display: inline-block;\r\n      vertical-align: middle;\r\n\r\n      ::v-deep .el-input__inner {\r\n        border-radius: 0;\r\n        border: 0;\r\n        padding-left: 0;\r\n        padding-right: 0;\r\n        box-shadow: none !important;\r\n        border-bottom: 1px solid #d9d9d9;\r\n        vertical-align: middle;\r\n      }\r\n    }\r\n\r\n    &.show {\r\n      .header-search-select {\r\n        width: 210px;\r\n        margin-left: 10px;\r\n      }\r\n    }\r\n  }\r\n</style>\r\n"]}]}