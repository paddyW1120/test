{"remainingRequest":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\commodity-release\\package-release\\releaseincr\\index.vue?vue&type=style&index=0&id=4b4a1106&lang=scss&scoped=true&","dependencies":[{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\commodity-release\\package-release\\releaseincr\\index.vue","mtime":1609847106648},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\css-loader\\dist\\cjs.js","mtime":1706753188288},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1706753191924},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\postcss-loader\\src\\index.js","mtime":1706753189537},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1706753187424},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1706753190941}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouZWwtYnV0dG9uIHsNCiAgdGV4dC1hbGlnbjogY2VudGVyOw0KICB3aWR0aDogMTAwcHg7DQp9DQoNCi5zd2J1IHsNCiAgd2lkdGg6IDEzNXB4Ow0KfQ0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAylBA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/commodity-release/package-release/releaseincr","sourcesContent":["<template>\r\n  <cus-wraper>\r\n    <el-form>\r\n      <el-form-item :label=\"$t('i18nView.pdReleType')\">\r\n        <cus-radio v-model=\"releTypeDet\" :changeMethod=\"changeReleaseType\" :codetype=\"'comboreleasetypedet'\"\r\n                   :isRequired=\"true\"></cus-radio>\r\n      </el-form-item>\r\n    </el-form>\r\n    <cus-table-title :label=\"$t('ppReleaseInfoIncr.pendinginfo')\"></cus-table-title>\r\n<!--停售发布-->\r\n    <el-table v-if=\"!showStopSel\" :data=\"configsAfterFilter\" border element-loading-text=\"Loading\" fit highlight-current-row size=\"mini\"\r\n              @selection-change=\"handleSelectionChange\">\r\n      <el-table-column align=\"center\" type=\"selection\" width=\"55\"></el-table-column>\r\n      <el-table-column :label=\"$t('table.id')\" align=\"center\" type=\"index\"></el-table-column>\r\n      <el-table-column :label=\"$t('i18nView.ppCode')\" align=\"center\"\r\n                       prop=\"ppCode\"></el-table-column>      <!--:label=\"$t('table.id')\"-->\r\n      <el-table-column :label=\"$t('i18nView.ppName')\" align=\"center\"\r\n                       prop=\"ppName\"></el-table-column>  <!--:label=\"$t('pdtempPdFile.column1')\"-->\r\n      <el-table-column align=\"center\" :label=\"$t('i18nView.pdAuditDoneDate')\" prop=\"pdAuditDate\"></el-table-column>\r\n      <el-table-column  align=\"center\" :label=\"$t('i18nView.ppDisDate')\" prop=\"pdStopSaleDate\"></el-table-column>\r\n      <el-table-column  align=\"center\" :label=\"$t('i18nView.discontinuationDetails')\" prop=\"pdStopSaleReason\"></el-table-column>\r\n    </el-table>\r\n\r\n    <el-table v-if=\"showStopSel\" :data=\"configsAfterFilter\" border element-loading-text=\"Loading\" fit highlight-current-row size=\"mini\"\r\n              @selection-change=\"handleSelectionChange\">\r\n      <el-table-column align=\"center\" type=\"selection\" width=\"55\"></el-table-column>\r\n      <el-table-column :label=\"$t('table.id')\" align=\"center\" type=\"index\"></el-table-column>\r\n      <el-table-column :label=\"$t('i18nView.ppCode')\" align=\"center\"\r\n                       prop=\"ppCode\"></el-table-column>      <!--:label=\"$t('table.id')\"-->\r\n      <el-table-column :label=\"$t('i18nView.ppName')\" align=\"center\"\r\n                       prop=\"ppName\"></el-table-column>  <!--:label=\"$t('pdtempPdFile.column1')\"-->\r\n      <el-table-column align=\"center\" :label=\"$t('i18nView.pdAuditDoneDate')\" prop=\"pdAuditDate\"></el-table-column>\r\n      <el-table-column align=\"center\" :label=\"$t('i18nView.testResult')\" prop=\"pdAuditTimes\">\r\n        <template slot-scope=\"scope\" v-if=\"showStopSel\">\r\n        <el-button size=\"small\" style=\"width: 100px\" type=\"text\" @click=\"reviewHistory(scope.row)\"><i\r\n          class=\"el-icon-d-arrow-right\"></i>\r\n        </el-button>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column  align=\"center\" :label=\"$t('i18nView.auditRes')\" prop=\"pdAuditTimes\">\r\n        <template slot-scope=\"scope\" v-if=\"showStopSel\">\r\n          <el-button size=\"small\" style=\"width: 100px\" type=\"text\" @click=\"reviewHistory(scope.row)\"><i\r\n            class=\"el-icon-d-arrow-right\"></i></el-button>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"this.releTypeDet==='1'?'待发布内容':(this.releTypeDet==='2'?'待发布规则':'待发布公式')\" align=\"center\"\r\n                       prop=\"pdAuditTimes\">\r\n        <template slot-scope=\"scope\" v-if=\"showStopSel\">\r\n          <el-button size=\"small\" style=\"width: 100px\" type=\"text\" @click=\"readyReleaseInfoClick(scope.row)\"><i\r\n            class=\"el-icon-d-arrow-right\"></i></el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <!-- 分页 -->\r\n    <cus-pagination ref=\"page\" v-show=\"false\" v-model=\"configs\" :autoBuild=\"false\" :pageSize=\"10\" :params=\"params\"\r\n                    url=\"/comboRelease/base/searchPPInRelease\"/>\r\n\r\n    <!-- 套餐发布 按钮组  -->\r\n    <div v-if=\"readyReleIncrease\">\r\n      <cus-form-title :label=\"$t('i18nView.waitPostContent')\"></cus-form-title>\r\n      <el-row style=\"margin-top: 33px\">\r\n        <el-col :span=\"6\">\r\n          <el-button class=\"swbu\" size=\"small\" type=\"primary\" @click=\"getPdDesignPage\">{{ $t('ppReleaseInfoAll.vpbd') }}<i\r\n            class=\"el-icon-info\"></i></el-button>\r\n        </el-col>\r\n        <el-col :span=\"6\">\r\n          <el-button class=\"swbu\" size=\"small\" type=\"primary\" @click=\"getPdSalePage\">{{ $t('ppReleaseInfoAll.vpsd') }}<i\r\n            class=\"el-icon-info\"></i></el-button>\r\n        </el-col>\r\n        <el-col :span=\"6\">\r\n          <el-button class=\"swbu\" size=\"small\" type=\"primary\" @click=\"getPdUWPage\">{{ $t('ppReleaseInfoAll.vpnb') }}<i\r\n            class=\"el-icon-info\"></i></el-button>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row style=\"margin-top: 33px\">\r\n        <el-col :span=\"6\">\r\n          <el-button class=\"swbu\" size=\"small\" type=\"primary\" @click=\"getPdAUPage\">{{ $t('ppReleaseInfoAll.vpud') }}<i\r\n            class=\"el-icon-info\"></i></el-button>\r\n        </el-col>\r\n        <el-col :span=\"6\">\r\n          <el-button class=\"swbu\" size=\"small\" type=\"primary\" @click=\"getPdCLPage\">{{ $t('ppReleaseInfoAll.vpcd') }}<i\r\n            class=\"el-icon-info\"></i></el-button>\r\n        </el-col>\r\n        <el-col :span=\"6\">\r\n          <el-button class=\"swbu\" size=\"small\" type=\"primary\" @click=\"getPdTSPage\">\r\n            {{ $t('ppReleaseInfoAll.testconclusion') }}<i\r\n            class=\"el-icon-info\"></i></el-button>\r\n        </el-col>\r\n      </el-row>\r\n    </div>\r\n    <!-- 规则发布 -->\r\n    <div v-if=\"readyReleaseRules\">\r\n      <cus-table-title :label=\"$t('ruleRelease.tableName')\"/>\r\n      <el-table :data=\"rulesData\" align=\"center\" border class=\"wraper-table\" fit highlight-current-row>\r\n        <el-table-column align=\"center\" :label=\"$t('table.id')\" type=\"index\" width=\"55px\"></el-table-column>\r\n        <el-table-column align=\"center\" :label=\"$t('i18nView.ruleCode')\" prop=\"pdRuleCode\"></el-table-column>\r\n        <el-table-column align=\"center\" :label=\"$t('i18nView.ruleType')\" prop=\"pdRuleCls\"></el-table-column>\r\n        <el-table-column align=\"center\" :label=\"$t('rule.pdRuleDtCls')\" prop=\"pdRuleDtCls\"></el-table-column>\r\n        <el-table-column align=\"center\" :label=\"$t('i18nView.ruleDec')\" prop=\"pdRuleDesc\"></el-table-column>\r\n      </el-table>\r\n    </div>\r\n    <!-- 公式发布 -->\r\n    <div v-if=\"readyReleaseFormula\">\r\n      <cus-table-title :label=\"$t('i18nView.waitPostFormula')\"/>\r\n      <el-table :data=\"formulaData\" align=\"center\" border class=\"wraper-table\" fit highlight-current-row>\r\n        <el-table-column align=\"center\" :label=\"$t('table.id')\" type=\"index\" width=\"55px\"></el-table-column>\r\n        <el-table-column align=\"center\" :label=\"$t('i18nView.formulaCode')\" prop=\"calcCode\"></el-table-column>\r\n        <el-table-column align=\"center\" :label=\"$t('i18nView.calcType')\" prop=\"pdBussType\"></el-table-column>\r\n        <el-table-column align=\"center\" :label=\"$t('i18nView.formulaDetial')\" prop=\"pdBussDetailType\"></el-table-column>\r\n        <el-table-column align=\"center\" :label=\"$t('i18nView.formulaDec')\" prop=\"calcDesc\"></el-table-column>\r\n      </el-table>\r\n    </div>\r\n\r\n    <!--发布选项-->\r\n    <el-form v-if=\"showRele\" ref=\"PdtempPdVerRlsForm\" :inline=\"true\" :model=\"PdtempPdVerRls\" :rules=\"rules\"\r\n             label-width=\"auto\" style=\"margin-top: 33px ;\">\r\n      <cus-form-title :label=\"$t('table.publish')\"></cus-form-title>\r\n      <!-- 发布方式 -->\r\n      <el-row :gutter=\"10\" class=\"row-bg\" justify=\"left\" type=\"flex\">\r\n        <el-col :span=\"24\">\r\n          <el-form-item :label=\"$t('i18nView.releaseMethod')\" prop=\"pdReleWay\">\r\n            <cus-select v-model=\"PdtempPdVerRls.pdReleWay\" :codetype=\"'releaseway'\" :filter=\"releasewayFilter\"\r\n                        @change=\"getSysPath\"></cus-select>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n      <!-- 发布说明 -->\r\n      <el-row>\r\n        <el-col :span=\"24\">\r\n          <el-form-item :label=\"$t('i18nView.releaseDetails')\" prop=\"pdReleDetails\">\r\n            <el-input v-model=\"PdtempPdVerRls.pdReleDetails\"\r\n                      maxlength=\"500\"\r\n                      :placeholder=\"$t('i18nView.pleInput')\"\r\n                      show-word-limit\r\n                      style=\"width: 588px;\"\r\n                      type=\"textarea\">\r\n            </el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n      <!--发布选项  ： 脚本  文件包  -->\r\n      <div v-if=\"showCheck\">\r\n        <el-row :gutter=\"10\" class=\"row-bg\" justify=\"center\" type=\"flex\">\r\n          <el-col :span=\"24\">\r\n            <el-form-item :label=\"$t('i18nView.pdAuditConc')\" prop=\"pdAuditConc\">\r\n              <el-checkbox-group v-model=\"PdtempPdVerRls.pdAuditConc\" @change=\"showPath\">\r\n                <el-checkbox v-for=\"path in pdtempPdReleSyspathList\" :key=\"path.id\" :label=\"path\">\r\n                  {{ path.pdReleSysname }}\r\n                </el-checkbox>\r\n              </el-checkbox-group>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row v-if=\"tableflag\">\r\n          <el-table :data=\"pathtableData\" align=\"center\" border class=\"wraper-table\" fit highlight-current-row>\r\n            <el-table-column align=\"center\" :label=\"$t('table.id')\" type=\"index\" width=\"55px\"></el-table-column>\r\n            <el-table-column :label=\"$t('i18nView.currency')\" align=\"center\"\r\n                             prop=\"pdReleSysname\"></el-table-column>\r\n            <el-table-column :label=\"$t('i18nView.pdReleIp')\" align=\"center\"\r\n                             prop=\"pdReleIp\"></el-table-column>\r\n            <el-table-column :label=\"$t('i18nView.pdReleIp')\" align=\"center\"\r\n                             prop=\"pdRelePort\"></el-table-column>\r\n            <el-table-column :label=\"$t('i18nView.pdReleIp')\" align=\"center\"\r\n                             prop=\"pdUsername\"></el-table-column>\r\n          </el-table>\r\n        </el-row>\r\n        <el-row :gutter=\"10\" class=\"row-bg\" style=\"margin-top: 15px\" type=\"flex\">\r\n          <el-col :span=\"24\">\r\n            <el-form-item :label=\"$t('i18nView.pdReleFileName')\">\r\n              <el-input v-model=\"PdtempPdVerRls.pdReleFile\" readonly style=\"width: 588px\"></el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n      </div>\r\n      <!--发布选项  ： Excel文件-->\r\n      <div v-if=\"showRadio\">\r\n        <el-row :gutter=\"10\" class=\"row-bg\" justify=\"center\" type=\"flex\">\r\n          <el-col :span=\"24\">\r\n            <el-form-item :label=\"$t('i18nView.pdAuditConc')\" prop=\"pdAuditConc\">\r\n              <el-radio-group v-model=\"PdtempPdVerRls.pdAuditConc\" @change=\"showPathOne\">\r\n                <el-radio v-for=\"path in pdtempPdReleSyspathList\" :key=\"path.id\" :label=\"path\">{{\r\n                    path.pdReleSysname\r\n                  }}\r\n                </el-radio>\r\n              </el-radio-group>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row v-if=\"tableflag\">\r\n          <el-table :data=\"pathtableData\" align=\"center\" border class=\"wraper-table\" fit highlight-current-row>\r\n            <el-table-column align=\"center\" :label=\"$t('table.id')\" type=\"index\" width=\"55px\"></el-table-column>\r\n            <el-table-column :label=\"$t('i18nView.currency')\" align=\"center\"\r\n                             prop=\"pdReleSysname\"></el-table-column>\r\n            <el-table-column :label=\"$t('i18nView.pdReleIp')\" align=\"center\"\r\n                             prop=\"pdReleIp\"></el-table-column>\r\n            <el-table-column :label=\"$t('i18nView.pdRelePort')\" align=\"center\"\r\n                             prop=\"pdRelePort\"></el-table-column>\r\n            <el-table-column :label=\"$t('i18nView.pdUsername')\" align=\"center\"\r\n                             prop=\"pdUsername\"></el-table-column>\r\n          </el-table>\r\n        </el-row>\r\n        <el-row :gutter=\"10\" class=\"row-bg\" style=\"margin-top: 15px\" type=\"flex\">\r\n          <el-col :span=\"24\">\r\n            <el-form-item :label=\"$t('i18nView.pdReleFileName')\">\r\n              <el-input v-model=\"PdtempPdVerRls.pdReleFile\" readonly style=\"width: 588px\"></el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n      </div>\r\n      <!--发布确认按钮-->\r\n      <el-row>\r\n        <el-col :span=\"24\" align=\"right\">\r\n          <el-button :disabled=\"releButton\" size=\"small\" type=\"primary\" @click=\"submitReleInfo(PdtempPdVerRls)\">\r\n            {{ $t('ppReleaseInfoIncr.releBut') }}\r\n          </el-button>\r\n          <el-button :disabled=\"releButton\" icon=\"el-icon-refresh\" size=\"small\" type=\"primary\" @click=\"refreshPage\">\r\n            {{ $t('ppReleaseInfoIncr.releRefresh') }}\r\n          </el-button>\r\n        </el-col>\r\n      </el-row>\r\n    </el-form>\r\n    <!-- 审核结论 弹窗 -->\r\n    <el-dialog v-if=\"dialogTableVisible\" v-dialog-drag :close-on-click-modal=\"false\"\r\n               :visible.sync=\"dialogTableVisible\" append-to-body center width=\"75%\">\r\n      <cus-page-title-back :label=\"$t('ppReleaseInfoIncr.pdaudith')\" @backTo=\"backAuditPage\"></cus-page-title-back>\r\n      <el-table :data=\"auditResult\" align=\"center\" border class=\"wraper-table\" fit highlight-current-row\r\n                style=\"width: 100%\">\r\n        <el-table-column align=\"center\" :label=\"$t('table.id')\" type=\"index\" width=\"55px\"></el-table-column>\r\n        <el-table-column :label=\"$t('i18nView.ppCode')\" align=\"center\"\r\n                         prop=\"pdCode\"></el-table-column>\r\n        <el-table-column :label=\"$t('i18nView.auditRes')\" align=\"center\" prop=\"pdAuditConc\">\r\n          <template v-slot=\"scope\">{{ scope.row.pdAuditConc == 'N' ? '不通过' : '通过' }}</template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('i18nView.auditOper')\" align=\"center\"\r\n                         prop=\"pdAuditStaff\"></el-table-column>\r\n        <el-table-column :label=\"$t('i18nView.auditDate')\" align=\"center\"\r\n                         prop=\"pdAuditDate\"></el-table-column>\r\n        <el-table-column :label=\"$t('i18nView.auditContent')\" align=\"center\"\r\n                         prop=\"pdAuditIdea\"></el-table-column>\r\n      </el-table>\r\n    </el-dialog>\r\n  </cus-wraper>\r\n</template>\r\n<script>\r\n\r\n\r\nimport {reviewHistory} from \"@/api/basicinfo/comboAuditInfo\";\r\nimport {getAllPath, searchPdCalc, searchPdRules} from \"@/api/basicinfo/pdtemppdrelease\";\r\nimport {comboRelease} from \"@/api/basicinfo/pdtemppprelease\"\r\n\r\nlet count = 0;\r\nexport default {\r\n  name: 'releaseInc',\r\n  data() {\r\n    return {\r\n      readyReleIncrease: false,  // 套餐发布\r\n      readyReleaseRules: false, // 规则发布\r\n      readyReleaseFormula: false, // 公式发布\r\n      showStopSel: true, // 停售发布\r\n      releTypeDet: '1',\r\n      //表格多选\r\n      multipleSelection: [],\r\n      checkId: [],\r\n      releasewayFilter: '0$3$4$5',\r\n      choosePpInfo:{},\r\n      PdtempPdVerRls: {\r\n        pdReleWay: '',      //发布方式\r\n        pdEdition: '',  //  套餐版本\r\n        pdType: '',  //  套餐类型\r\n        pdInfoId: '',  //  套餐id\r\n        pdCode: '',  //  套餐编码\r\n        pdReleOrder: '',  //  发布序号\r\n        pdReleType: '',  //  发布类型 : 全量发布 增量发布\r\n        pdReleSys: '',  //  发至系统\r\n        pdReleEnv: '',  //  发至环境\r\n        pdReleFilePath: '',  //  发布文件地址\r\n        pdReleStu: '',  //  发布状态 : 发布成功 发布失败\r\n        pdReleContent: '',  //  发布内容\r\n        pdReleDetails: '',  //  发布说明\r\n        pdReleFile: '',  //  生成文件名\r\n        pdAuditConc: []  //  发布环境\r\n      },\r\n      /*多选套餐信息*/\r\n      checkPdInfo: {\r\n        pdInfoId: '',  //  套餐id\r\n        pdVerId: '',  // 版本id\r\n        pdCode: '',  //  套餐编码\r\n        pdEdition: '',  //  套餐版本\r\n      },\r\n\r\n      releButton: true,\r\n      showRele: false,\r\n      tableflag: false,\r\n      showRadio: false,\r\n      showCheck: false,\r\n      pathtableDataBc: [],\r\n      pathtableData: [],\r\n      envList: [],\r\n      pdtempPdReleSyspathList: [],\r\n\r\n      rulesData: [],  // 规则数据\r\n      formulaData: [], // 公式数据\r\n      auditResult: [], // 审核记录\r\n\r\n      dialogTableVisible: false,\r\n      pdOptions: [],\r\n      selectEdition: [],\r\n      pdInfo: {},\r\n\r\n      pdAuditDetailInfo: {\r\n        pdType: '1',\r\n        pdInfoId: '',\r\n        pdCode: '',\r\n        pdAuditOrderNum: '1',\r\n        pdAuditInfoId: '',\r\n        pdAuditConc: '',\r\n        pdAuditStaff: '',\r\n        pdAuditDate: '',\r\n        pdAuditIdea: '',\r\n        pdReturnFuncNode: [],\r\n      },\r\n\r\n      //表格数据\r\n      configsAfterFilter: [],\r\n      configs: [],\r\n      //查询参数\r\n      params: {\r\n        pdReleType: '2'\r\n      },\r\n      //检验规则\r\n      rules: {\r\n        pdReleWay: [{required: true, message: '请选择发布方式', trigger: 'change'}],\r\n        pdReleDetails: [{required: true, message: '请输入发布说明', trigger: 'change'}],\r\n        pdAuditConc: [{required: true, message: '请选择发布环境', trigger: 'change'}]\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.$refs.page.buildData().then(() => {\r\n      // 初始化时展示产品发布的产品\r\n      for (const comboReleaseInfoVo of this.configs) {\r\n        if (comboReleaseInfoVo.defType !== '3' && (comboReleaseInfoVo.pdReturnFuncCode.indexOf('productInfoFlag') !== -1 || comboReleaseInfoVo.pdReturnFuncCode.indexOf('productDistributionFlag') !== -1 || comboReleaseInfoVo.pdReturnFuncCode.indexOf('productCoverFlag') !== -1 || comboReleaseInfoVo.pdReturnFuncCode.indexOf('productUnderwritingFlag') !== -1 || comboReleaseInfoVo.pdReturnFuncCode.indexOf('productHePeiFlag') !== -1)) {\r\n          this.configsAfterFilter.push(comboReleaseInfoVo)\r\n        }\r\n      }\r\n    })\r\n  },\r\n  created() {\r\n  },\r\n  watch: {\r\n    'PdtempPdVerRls.pdAuditConc'(val) {\r\n      this.envList = val\r\n    },\r\n    releTypeDet(val) {\r\n      this.PdtempPdVerRls.pdReleWay = ''\r\n      this.getSysPath(this.PdtempPdVerRls.pdReleWay)\r\n      if (val === '1' || val === '4') {\r\n        this.releasewayFilter = '0$3$4$5'\r\n      } else {\r\n        this.releasewayFilter = '0$0$3$4'\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    /* 父组件刷新子组件表格 */\r\n    refreshChildTable() {\r\n      this.$refs.page.reload();\r\n      this.multipleSelection = [];\r\n      this.checkId = [];\r\n    },\r\n\r\n    /*发布类型修改*/\r\n    changeReleaseType(val) {\r\n      this.configsAfterFilter = [];\r\n      this.readyReleIncrease = false;\r\n      this.readyReleaseRules = false;\r\n      this.readyReleaseFormula = false;\r\n      this.showStopSel = val !== '4';\r\n      for (const productReleaseInfoVo of this.configs) {\r\n        switch (val) {\r\n          case '1':\r\n            if (productReleaseInfoVo.defType !== '3' && (productReleaseInfoVo.pdReturnFuncCode.indexOf('productInfoFlag') !== -1 || productReleaseInfoVo.pdReturnFuncCode.indexOf('productDistributionFlag') !== -1 || productReleaseInfoVo.pdReturnFuncCode.indexOf('productCoverFlag') !== -1 || productReleaseInfoVo.pdReturnFuncCode.indexOf('productUnderwritingFlag') !== -1 || productReleaseInfoVo.pdReturnFuncCode.indexOf('productHePeiFlag') !== -1 || productReleaseInfoVo.pdReturnFuncCode.indexOf('productPreservationFlag') !== -1 || productReleaseInfoVo.pdReturnFuncCode.indexOf('productRenewalFlag') !== -1)) {\r\n              this.configsAfterFilter.push(productReleaseInfoVo)\r\n            }\r\n            break\r\n          case '2':\r\n            if (productReleaseInfoVo.defType !== '3' && (productReleaseInfoVo.pdReturnFuncCode.indexOf('productRuleFlag') !== -1)) {\r\n              this.configsAfterFilter.push(productReleaseInfoVo)\r\n            }\r\n            break\r\n          case '3':\r\n            if (productReleaseInfoVo.defType !== '3' && (productReleaseInfoVo.pdReturnFuncCode.indexOf('productFormulaFlag') !== -1)) {\r\n              this.configsAfterFilter.push(productReleaseInfoVo)\r\n            }\r\n            break\r\n          case '4':\r\n            if (productReleaseInfoVo.defType === '3') {\r\n              this.configsAfterFilter.push(productReleaseInfoVo)\r\n            }\r\n            break\r\n        }\r\n      }\r\n    },\r\n    backAuditPage() {\r\n      this.dialogTableVisible = false\r\n    },\r\n    /*待发布内容显示*/\r\n    readyReleaseInfoClick(row) {\r\n      this.choosePpInfo = row;\r\n      this.cacheCurrPagePdData(row)\r\n      //  套餐发布\r\n      if (this.releTypeDet === '1') {\r\n        this.readyReleaseRules = false;\r\n        this.readyReleaseFormula = false;\r\n        this.readyReleIncrease = !this.readyReleIncrease;\r\n      }\r\n      //  规则发布\r\n      else if (this.releTypeDet === '2') {\r\n        this.readyReleIncrease = false;\r\n        this.readyReleaseFormula = false;\r\n        this.readyReleaseRules = !this.readyReleaseRules;\r\n        let data = {\"pdInfoId\": row.id};\r\n        searchPdRules(this.buildRequestData(data)).then(res => {\r\n          this.rulesData = res.data.records;\r\n          console.log(this.rulesData)\r\n        })\r\n      }\r\n      // 公式发布\r\n      else if (this.releTypeDet === '3') {\r\n        this.readyReleIncrease = false;\r\n        this.readyReleaseRules = false;\r\n        this.readyReleaseFormula = !this.readyReleaseFormula;\r\n        let data = {\"pdInfoId\": row.id};\r\n        searchPdCalc(this.buildRequestData(data)).then(res => {\r\n          this.formulaData = res.data;\r\n        })\r\n      }\r\n    },\r\n    /*  多选待发布数据，获取并准备 发布数据  */\r\n    handleSelectionChange(val) {\r\n      this.multipleSelection = [];\r\n      this.checkId = [];\r\n      if (val) {\r\n        this.showRele = val.length > 0;\r\n        for (const valElement of val) {\r\n          this.checkId.push(valElement.id)\r\n        }\r\n        this.multipleSelection = val\r\n      }\r\n    },\r\n    /*刷新*/\r\n    refreshPage() {\r\n      if (this.$refs.PdtempPdVerRlsForm) {\r\n        this.$refs.PdtempPdVerRlsForm.resetFields();\r\n      }\r\n    },\r\n    /*  发布确认 */\r\n    submitReleInfo() {\r\n      this.$refs.PdtempPdVerRlsForm.validate(pass => {\r\n        if (pass) {\r\n          let params = {\r\n            \"comboReleaseInfoVoList\": this.multipleSelection,\r\n            \"pdtempPdReleSyspathList\": Array.isArray(this.envList) ? this.envList : Array(this.envList),\r\n            \"pdReleWay\": this.PdtempPdVerRls.pdReleWay,\r\n            \"pdReleDetails\": this.PdtempPdVerRls.pdReleDetails,\r\n            \"releType\": \"2\",\r\n            \"releTypeDet\": this.releTypeDet\r\n          }\r\n          comboRelease(this.buildRequestData(params)).then(res => {\r\n            if (res.data.message) {\r\n              this.notifyError(res.data.message)\r\n            } else {\r\n              this.notifySuccess('发布成功')\r\n              /*this.PdtempPdVerRls.pdReleFile = '';\r\n              for (const pdoperPdVerRls of res.data.pdoperPdVerRlsList) {\r\n                this.PdtempPdVerRls.pdReleFile += pdoperPdVerRls.pdReleFileName + \"; \";\r\n                let filePath = pdoperPdVerRls.pdReleFilePath + \"//\" + pdoperPdVerRls.pdReleFileName;\r\n                let fileName = pdoperPdVerRls.pdReleFileName;\r\n                let data = {\"filePath\": filePath}\r\n                downloadReleFile(this.buildRequestData(data)).then(res => {\r\n                  this.downloadResponseFile(res, fileName)\r\n                })\r\n              }\r\n              this.PdtempPdVerRls.pdReleFile = this.PdtempPdVerRls.pdReleFile.substring(0, this.PdtempPdVerRls.pdReleFile.length - 2)*/\r\n              if (this.PdtempPdVerRls.pdReleWay === '2') {\r\n                this.$emit('parentByClick', \"已发布\" + this.PdtempPdVerRls.pdReleEnv);\r\n              }\r\n              this.$emit('initTableData')\r\n            }\r\n          })\r\n        } else {\r\n          this.focusItem()\r\n        }\r\n      })\r\n    },\r\n    /*  待发布--审核结论  */\r\n    reviewHistory(row) {\r\n      let data = {\r\n        pdAuditDetailInfoId: row.id,\r\n        pdInfoId: row.id,\r\n        pdVerId: row.pdVerId\r\n      }\r\n      reviewHistory(this.buildRequestData(data)).then(res => {\r\n        this.auditResult = res.data\r\n        this.dialogTableVisible = true;\r\n      })\r\n    },\r\n    /*  发布多选-显示环境  */\r\n    showPath(val) {\r\n      this.PdtempPdVerRls.pdReleEnv = '';\r\n      for (const argument of val) {\r\n        this.PdtempPdVerRls.pdReleEnv += argument + \";\"\r\n      }\r\n      this.pathtableData = [];\r\n      /*for (const name of val) {\r\n        for (const pathData of this.pathtableDataBc) {\r\n          if (name === pathData.pdReleSysname) {\r\n            this.pathtableData.push(pathData);\r\n          }\r\n        }\r\n      }*/\r\n      this.pathtableData = val\r\n      this.tableflag = this.pathtableData.length !== 0\r\n    },\r\n    /*  发布单选-显示环境  */\r\n    showPathOne(val) {\r\n      this.pathtableData = [];\r\n      for (const pathData of this.pathtableDataBc) {\r\n        if (val === pathData) {\r\n          this.pathtableData.push(pathData);\r\n        }\r\n      }\r\n      this.tableflag = this.pathtableData.length !== 0;\r\n    },\r\n    /*  根据发布选项获取环境  */\r\n    getSysPath(val) {\r\n      this.PdtempPdVerRls.pdAuditConc = []\r\n      this.PdtempPdVerRls.pdReleFile = ''\r\n      if (!val) {\r\n        this.releButton = true;\r\n        this.$emit('parentByClick', \"待发布\", this.checkId);\r\n        this.showCheck = false;\r\n        this.showRadio = false;\r\n      } else {\r\n        if (val !== '2') {\r\n          this.PdtempPdVerRls.pdReleFile = '';\r\n          this.showCheck = true;\r\n          this.showRadio = false;\r\n          this.envList = [];\r\n          this.tableflag = false;\r\n          this.PdtempPdVerRls.pdReleEnv = '';\r\n          this.pathtableData = [];\r\n          this.$emit('parentByClick', \"发布待确认\", this.checkId);\r\n        } else {\r\n          this.envList = [];\r\n          this.showRadio = true;\r\n          this.showCheck = false;\r\n          this.PdtempPdVerRls.pdReleEnv = '';\r\n          this.tableflag = false;\r\n          this.pathtableData = [];\r\n        }\r\n        this.releButton = false;\r\n        this.pdtempPdReleSyspathList = [];\r\n        getAllPath().then(res => {\r\n          this.pathtableDataBc = res.data;\r\n          for (const argument of res.data) {\r\n            this.pdtempPdReleSyspathList.push(argument)\r\n          }\r\n        })\r\n      }\r\n      this.$nextTick(() => {\r\n        if (this.$refs.PdtempPdVerRlsForm) {\r\n          this.$refs.PdtempPdVerRlsForm.clearValidate()\r\n        }\r\n      })\r\n    },\r\n    /*页面跳转按钮组*/\r\n    getPdDesignPage() {\r\n      this.$router.push({name: '产品套餐框架定义主页', query: {showPageFlag: '0'},params:this.choosePpInfo})\r\n\r\n    },\r\n    getPdSalePage() {\r\n      this.$router.push({name: '产品套餐销售定义主页', query: {showPageFlag: '0'},params:this.choosePpInfo})\r\n    },\r\n    getPdUWPage() {\r\n      this.$router.push({name: '产品套餐承保定义主页', query: {showPageFlag: '0'},params:this.choosePpInfo})\r\n    },\r\n    getPdAUPage() {\r\n      this.$router.push({name: '产品套餐核保定义主页', query: {showPageFlag: '0'},params:this.choosePpInfo})\r\n    },\r\n    getPdCLPage() {\r\n      this.$router.push({name: '产品套餐核赔定义主页', query: {showPageFlag: '0'},params:this.choosePpInfo})\r\n    },\r\n    getPdTSPage() {\r\n      this.$router.push({name: '', query: {showPageFlag: '0'},params:this.choosePpInfo})\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.el-button {\r\n  text-align: center;\r\n  width: 100px;\r\n}\r\n\r\n.swbu {\r\n  width: 135px;\r\n}\r\n</style>\r\n"]}]}