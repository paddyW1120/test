{"remainingRequest":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\product-definition\\pd-operation-def\\pd-operation-monitor\\index.vue?vue&type=style&index=0&id=7e653643&lang=scss&scoped=true&","dependencies":[{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\product-definition\\pd-operation-def\\pd-operation-monitor\\index.vue","mtime":1609847106948},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\css-loader\\dist\\cjs.js","mtime":1706753188288},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1706753191924},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\postcss-loader\\src\\index.js","mtime":1706753189537},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1706753187424},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1706753190941}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoud3JhcGVyIHsKICBmb250LXNpemU6IDA7CiAgbWFyZ2luLXRvcDogM3B4Owp9Cgoud3JhcGVyID4gZGl2IHsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7Cn0KCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqqBA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/product-definition/pd-operation-def/pd-operation-monitor","sourcesContent":["<template>\r\n  <cus-wraper>\r\n   <cus-form-title :display=\"false\" :label=\"$t('productOperationMonitor.productOperationDefinition')\" :showArrow=\"true\"\r\n                      @show=\"toShowPdBnft\"></cus-form-title>\r\n  <div v-if=\"showState\">\r\n    <el-form label-width=\"auto\" ref=\"params\" :model=\"params\">\r\n      <el-row  :gutter=\"10\">\r\n        <cus-col :span=\"8\">\r\n          <el-form-item :label=\"$t('productOperationMonitor.pdDetailType')\">\r\n            <cus-select :codetype=\"'ProductCategory'\" clearable filterable v-model=\"params.pdRegionType\"\r\n                        @change=\"selectedDetailTypeChanged\" >\r\n            </cus-select>\r\n          </el-form-item>\r\n        </cus-col>\r\n        <cus-col :span=\"8\">\r\n          <el-form-item :label=\"$t('productOperationMonitor.product')\">\r\n            <el-select @change=\"selectedPdCodeChanged\" clearable filterable\r\n                       v-model=\"params.pdCode\">\r\n              <el-option :key=\"product.id\" :label=\"product.pdCode+':'+product.pdName\" :value=\"product.pdCode\"\r\n                         v-for=\"product in productOptionList\"></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </cus-col>\r\n        <cus-col :span=\"8\">\r\n          <el-form-item :label=\"$t('customComponents.pdEdition')\">\r\n            <el-select clearable filterable v-model=\"params.pdEdition\" >\r\n              <el-option :key=\"edition\" :label=\"edition\" :value=\"edition\"\r\n                         v-for=\"edition in editionOptionList\"></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </cus-col>\r\n      </el-row>\r\n      <el-row  :gutter=\"10\">\r\n        <cus-col :span=\"8\">\r\n          <el-form-item :label=\"$t('productOperationMonitor.pdApplyDate')\">\r\n            <el-date-picker\r\n              v-model=\"value2\"\r\n              type=\"daterange\"\r\n              align=\"right\"\r\n              unlink-panels\r\n              :range-separator=\"$t('productOperationMonitor.to')\"\r\n              :start-placeholder=\"$t('productOperationMonitor.pdApplyStartDate')\"\r\n              :end-placeholder=\"$t('productOperationMonitor.pdApplyEndDate')\"\r\n              :picker-options=\"pickerOptions\">\r\n            </el-date-picker>\r\n          </el-form-item>\r\n        </cus-col>\r\n        <cus-col :span=\"8\">\r\n          <el-form-item :label=\"$t('productOperationMonitor.changeDate')\">\r\n            <el-date-picker\r\n              v-model=\"value1\"\r\n              type=\"daterange\"\r\n              align=\"right\"\r\n              unlink-panels\r\n              :range-separator=\"$t('productOperationMonitor.to')\"\r\n              :start-placeholder=\"$t('productOperationMonitor.pdApplyStartDate')\"\r\n              :end-placeholder=\"$t('productOperationMonitor.pdApplyEndDate')\"\r\n              :picker-options=\"pickerOptions\">\r\n            </el-date-picker>\r\n          </el-form-item>\r\n        </cus-col>\r\n      </el-row>\r\n      <el-row  :gutter=\"10\">\r\n        <cus-col :span=\"8\">\r\n          <el-form-item :label=\"$t('productOperationMonitor.defType')\" prop=\"defType\">\r\n            <cus-select :codetype=\"'pdAuditType'\" clearable\r\n                        v-model=\"params.defType\"></cus-select>\r\n          </el-form-item>\r\n        </cus-col>\r\n        <cus-col :span=\"8\">\r\n          <el-form-item :label=\"$t('productOperationMonitor.isTestReturn')\">\r\n            <el-switch active-value=\"Y\" inactive-value=\"N\" v-model=\"params.isTestReturn\"></el-switch>\r\n          </el-form-item>\r\n        </cus-col>\r\n        <cus-col :span=\"8\">\r\n          <el-form-item :label=\"$t('productOperationMonitor.isReviewReturn')\">\r\n            <el-switch active-value=\"Y\" inactive-value=\"N\" v-model=\"params.isReviewReturn\"></el-switch>\r\n          </el-form-item>\r\n        </cus-col>\r\n      </el-row>\r\n      <el-row>\r\n\r\n          <el-button  size=\"small\" type=\"primary\"  icon=\"el-icon-search\" @click=\"handSearch\" style=\"float: right;margin-right: 20px;\">\r\n            {{$t('productOperationMonitor.search')}}\r\n          </el-button>\r\n        </el-row>\r\n    </el-form>\r\n  </div>\r\n    <el-divider content-position=\"left\"><i class=\"el-icon-s-grid\"></i>{{$t('productOperationMonitor.productOperation')}}\r\n    </el-divider>\r\n    <el-table :data=\"operationMonitorTable\" ref=\"page\" size=\"mini\" @row-click=\"rowClick_Operation\" highlight-current-row\r\n              fit element-loading-text=\"Loading\" border align=\"center\" class=\"wraper-table\">\r\n      <el-table-column width=\"60\" :label=\"$t('productOperationMonitor.selection')\" align=\"center\">\r\n        <template slot-scope=\"scope\">\r\n          <el-radio-group  v-model=\"selectOperation\">\r\n            <el-radio :label=\"scope.row.id\">{{''}}</el-radio>\r\n          </el-radio-group>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column :label=\"$t('table.id')\" type=\"index\" align=\"center\">\r\n           <template v-slot=\"scope\">\r\n           {{ initTableIndex('page', scope.$index) }}\r\n           </template>\r\n         </el-table-column>\r\n      <el-table-column :label=\"$t('i18nView.pdCode')\" prop=\"pdCode\" sortable align=\"center\"></el-table-column>\r\n      <el-table-column :label=\"$t('i18nView.pdCode')\" prop=\"pdName\" align=\"center\"></el-table-column>\r\n      <el-table-column :label=\"$t('customComponents.pdEdition')\" prop=\"pdEdition\"\r\n                       align=\"center\"></el-table-column>\r\n      <el-table-column :label=\"$t('productOperationMonitor.defType')\" sortable prop=\"defType\" align=\"center\"\r\n                       :filters=\"filterHandlerList1\"\r\n                       :filter-method=\"filterHandler\">\r\n        <template v-slot=\"scope\">{{scope.row.defType | filter_pdAuditType}}</template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('productOperationMonitor.pdApplyDate')\" sortable prop=\"pdApplDate\"\r\n                       align=\"center\"></el-table-column>\r\n      <el-table-column :label=\"$t('productOperationMonitor.changeDate')\" sortable prop=\"changeDate\"\r\n                       align=\"center\"></el-table-column>\r\n\r\n      <el-table-column :label=\"$t('productOperationMonitor.pdTestReturnTimes')\" prop=\"pdTestReturnTimes\" align=\"center\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button  size=\"small\" type=\"text\" @click=\"reviewTestHistory(scope.row)\"\r\n                     :disabled=\"scope.row.pdAuditTimes==0||scope.row.pdAuditTimes==null\">\r\n            {{scope.row.pdAuditTimes}}\r\n          </el-button>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('productOperationMonitor.pdAuditTimes')\" prop=\"pdAuditTimes\" align=\"center\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button  size=\"small\" type=\"text\" @click=\"reviewAuditHistory(scope.row)\"\r\n                     :disabled=\"scope.row.pdAuditTimes==0||scope.row.pdAuditTimes==null\">\r\n            {{scope.row.pdAuditTimes}}\r\n          </el-button>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('productOperationMonitor.operation')\" align=\"center\">\r\n        <template v-slot=\"scope\">\r\n          <el-button  @click=\"finishedOperationalAll(scope.row)\" size=\"mini\" type=\"primary\"><i class=\"el-icon-finished\">{{$t('productOperationMonitor.submitDefinition')}}</i>\r\n          </el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n   <cus-pagination ref=\"page\" v-model=\"operationMonitorTable\"\r\n                    :pageSize=\"10\" :params=\"params\" url=\"/product-Operation-Monitor/base/list\"/>\r\n\r\n  <!--  <el-button  size=\"small\" @click=\"showMore_operation\" type=\"text\" v-if=\"needShowMore_operation && !showAll_operation\">\r\n      {{$t('productOperationMonitor.showMore')}}\r\n      <i class=\"el-icon-arrow-down\"></i>\r\n    </el-button>\r\n    <el-button  size=\"small\" @click=\"showBack_operation\" type=\"text\" v-if=\"needShowMore_operation && showAll_operation\">\r\n      {{$t('productOperationMonitor.showBack')}}\r\n      <i class=\"el-icon-arrow-up\"></i>\r\n    </el-button> -->\r\n    <br>\r\n    <!--产品营运定义进度-->\r\n    <div v-if=\"showOperationProgress\">\r\n      <h4>\r\n        <el-divider direction=\"vertical\" class=\"divider\"></el-divider>\r\n        {{$t('productOperationMonitor.productOperationProgress')}}\r\n      </h4>\r\n      <div class=\"cusSubCard cusProcess\">\r\n        <div class=\"sub\" v-for=\"item1 in  this.statusData.children\">\r\n          <el-tooltip effect=\"light\" :content=\"$t('productOperationMonitor.processTip')\"\r\n                      placement=\"top-end\">\r\n            <div class=\"wraper\" @click=\"handleGoPage(item1.moduleName)\">\r\n              <div class=\"loss\" :class=\"{'loss_no' : item1.moduleStatus ==='0'}\"></div>\r\n              <div class=\"tag\" :class=\"{'tag_no' : item1.moduleStatus ==='0'}\">{{item1.moduleName}}</div>\r\n              <div class=\"triangle\" :class=\"{'triangle_no' : item1.moduleStatus ==='0'}\"></div>\r\n            </div>\r\n          </el-tooltip>\r\n          <div style=\"margin-top: 23px\">\r\n            <el-steps direction=\"vertical\" process-status=\"success\" v-for=\"item2 in  item1.children\">\r\n              <el-step :icon=\"item2.moduleStatus=='1'?'el-icon-circle-check': 'el-icon-circle-close'\"\r\n                       :status=\"item2.moduleStatus=='1'? 'finish' : 'wait'\" :title=\"item2.moduleName\"></el-step>\r\n            </el-steps>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <!--审核退回记录弹窗-->\r\n    <el-dialog :visible.sync=\"dialogVisibleOfAuditHistory\" @close=\"dialogVisibleOfAuditHistory = false\" append-to-body\r\n               width=\"75%\">\r\n      <el-divider content-position=\"left\"><i class=\"el-icon-s-grid\"></i>{{$t('productOperationMonitor.HistoryReturns')}}\r\n      </el-divider>\r\n      <el-table :data=\"tableDataAuditHistory\" fit element-loading-text=\"Loading\" class=\"wraper-table\" border ref=\"tableDataAuditHistory\"\r\n                style=\"width: 100%\" @expand-change=\"tableValue\">\r\n        <el-table-column type=\"index\" :label=\"$t('table.id')\" align=\"center\"\r\n                         width=\"60\"></el-table-column>\r\n        <el-table-column :label=\"$t('i18nView.pdCode')\" prop=\"pdCode\" align=\"center\"></el-table-column>\r\n        <el-table-column :label=\"$t('productOperationMonitor.pdAuditConclusion')\" prop=\"pdAuditConc\" align=\"center\">\r\n          <template v-slot=\"scope\">{{scope.row.pdAuditConc | getPdAuditConc}}</template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('productOperationMonitor.pdAuditStaff')\" prop=\"pdAuditStaff\"\r\n                         align=\"center\"></el-table-column>\r\n        <el-table-column :label=\"$t('productOperationMonitor.pdAuditDate')\" prop=\"pdAuditDate\"\r\n                         align=\"center\"></el-table-column>\r\n        <el-table-column type=\"expand\" :label=\"$t('productOperationMonitor.details')\" align=\"center\" width=\"60\">\r\n          <template slot-scope=\"props\">\r\n            <div>\r\n              <el-divider content-position=\"left\"><i class=\"el-icon-s-grid\"></i>{{$t('productOperationMonitor.pdPostAudit')}}\r\n              </el-divider>\r\n              <el-table :data=\"tableDataAuditDetails\" size=\"mini\" fit element-loading-text=\"Loading\" border\r\n                        highlight-current-row align=\"center\" class=\"wraper-table\">\r\n                <el-table-column :label=\"$t('table.id')\" type=\"index\"\r\n                                 align=\"center\"></el-table-column>\r\n                <el-table-column :label=\"$t('productOperationMonitor.defineContent')\" prop=\"pdDefineContent\" align=\"center\">\r\n                  <template slot-scope=\"scope\">{{scope.row.pdDefineContent | filter_pdNodeCode}}</template>\r\n                </el-table-column>\r\n                <el-table-column :label=\"$t('productOperationMonitor.pdAuditConclusion')\" prop=\"pdAuditConcthis\"\r\n                                 align=\"center\"></el-table-column>\r\n                <el-table-column :label=\"$t('productOperationMonitor.isCancelDefinition')\" prop=\"pdIsCancelDefinition\"\r\n                                 align=\"center\"></el-table-column>\r\n                <el-table-column :label=\"$t('productOperationMonitor.notPassOpinion')\" prop=\"pdNotPassOpinion\"\r\n                                 align=\"center\" width=\"360px\"></el-table-column>\r\n              </el-table>\r\n              <el-form label-position=\"left\" inline class=\"demo-table-expand\">\r\n                <el-form-item :label=\"$t('productOperationMonitor.pdReturnFuncNode')\" style=\"width: 100%\">\r\n                    <span>{{ props.row.pdReturnFuncNode | filter_FuncNodeName}}</span>\r\n                  </el-form-item>\r\n                <el-form-item :label=\"$t('i18nView.pdAuditIdea')\">\r\n                  <span>{{ props.row.pdAuditIdea }}</span>\r\n                </el-form-item>\r\n              </el-form>\r\n            </div>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </el-dialog>\r\n  </cus-wraper>\r\n</template>\r\n<script>\r\n\r\nimport {\r\n  getStatus,\r\n  productOperationMonitorList,\r\n  queryAuditNotes,\r\n  reviewHistory\r\n} from '@/api/basicinfo/productOperationMonitor'\r\nimport {findAllProductByPdDetailType} from \"@/api/basicinfo/pdclaimverification\"\r\nimport {closeVisitTag} from \"@/utils/tagsView\"\r\nimport {finishProductOperationalDef} from '@/api/workflow/workflow'\r\n\r\nlet _this\r\n  export default {\r\n    name: 'productOperationMonitor',\r\n    filters: {\r\n      filter_pdAuditType(code) {\r\n        return _this.getCodeName('pdAuditType', code)\r\n      },\r\n      filter_pdNodeCode(val) {\r\n        let returnText = '';\r\n        switch (val) {\r\n          case 'productRuleFlag':\r\n            returnText = '产品规则订正';\r\n            break;\r\n          case 'productFormulaFlag':\r\n            returnText = '产品公式订正';\r\n            break;\r\n          case 'productInfoFlag':\r\n            returnText = '产品框架定义';\r\n            break;\r\n          case 'productDistributionFlag':\r\n            returnText = '产品销售信息';\r\n            break;\r\n          case 'productCoverFlag':\r\n            returnText = '产品承保信息';\r\n            break;\r\n          case 'productUnderwritingFlag':\r\n            returnText = '产品核保信息';\r\n            break;\r\n          case 'productPreservationFlag':\r\n            returnText = '产品保全信息';\r\n            break;\r\n          case 'productHePeiFlag':\r\n            returnText = '产品核赔信息';\r\n            break;\r\n          case 'productRenewalFlag':\r\n            returnText = '产品续期续保信息';\r\n            break;\r\n        }\r\n        return returnText;\r\n      },\r\n      filter_FuncNodeName(val) {\r\n        let funcNode = JSON.parse(val);\r\n        let returnPoints = [];\r\n        for (let i = 0; i < funcNode.length; i++) {\r\n          for (let j = 0; j < _this.nodeOptions.length; j++) {\r\n            if (funcNode[i] === _this.nodeOptions[j].key) {\r\n              returnPoints.push(_this.nodeOptions[j].label)\r\n            }\r\n          }\r\n        }\r\n        if (returnPoints.length>0){\r\n          return returnPoints;\r\n        }else {\r\n          return val;\r\n        }\r\n      },\r\n      getPdAuditConc(state) {\r\n        if (state == 'N') {\r\n          state = '不通过'\r\n        } else if (state == 'Y') {\r\n          state = '通过'\r\n        } else if (state == 'X') {\r\n          state = '取消本次定义'\r\n        } else if (state == 'Z') {\r\n          state = '产品暂停'\r\n        }\r\n        return state\r\n      }\r\n    },\r\n      watch:{\r\n        'operationMonitorTable'(){\r\n            if (this.operationMonitorTable.length > 0) {\r\n                this.filterHandlerList1 = [];\r\n                this.operationMonitorTable.forEach(val => {\r\n                    this.filterHandlerList1.push({\r\n                        text: this.getCodeName('pdAuditType',val.defType,true),\r\n                        value: val.defType\r\n                    });\r\n\r\n                });\r\n            }\r\n            this.filterHandlerList1 = this.filterHandlerList1.reduce(function(prev, element) {\r\n                if (!prev.find(el => el.text == element.text)) {\r\n                    prev.push(element);\r\n                }\r\n                return prev;\r\n            }, []);\r\n        },\r\n        'value1'(){\r\n            if (this.value1) {\r\n                let arr = this.value1;\r\n                this.params.changeEndDate = arr[1];\r\n                this.params.changeStartDate = arr[0];\r\n            }else {\r\n                this.params.changeEndDate = undefined;\r\n                this.params.changeStartDate = undefined;\r\n            }\r\n        },\r\n          'value2'(){\r\n              if (this.value2){\r\n                  let arr = this.value2;\r\n                  this.params.pdApplyStartDate=arr[0];\r\n                  this.params.pdApplyEndDate=arr[1];\r\n              }else {\r\n                  this.params.pdApplyStartDate=undefined;\r\n                  this.params.pdApplyEndDate=undefined;\r\n              }\r\n\r\n          },\r\n      },\r\n    data() {\r\n      _this = this\r\n      return {\r\n          filterHandlerList1:[],\r\n          nodeOptions: [\r\n          {'key': 'productInfoFlag', 'label': '产品框架定义'},\r\n          {'key': 'productDistributionFlag', 'label': '产品销售信息'},\r\n          {'key': 'productCoverFlag', 'label': '产品承保信息'},\r\n          {'key': 'productUnderwritingFlag', 'label': '产品核保信息'},\r\n          {'key': 'productRenewalFlag', 'label': '产品续期续保信息'},\r\n          {'key': 'productPreservationFlag', 'label': '产品保全信息'},\r\n          {'key': 'productHePeiFlag', 'label': '产品核赔信息'},\r\n          {'key': 'productRuleFlag', 'label': '产品规则订正'},\r\n          {'key': 'productFormulaFlag', 'label': '产品公式订正'}],\r\n          pickerOptions: {\r\n              shortcuts: [{\r\n                  text: '最近一周',\r\n                  onClick(picker) {\r\n                      const end = new Date();\r\n                      const start = new Date();\r\n                      start.setTime(start.getTime() - 3600 * 1000 * 24 * 7);\r\n                      picker.$emit('pick', [start, end]);\r\n                  }\r\n              }, {\r\n                  text: '最近一个月',\r\n                  onClick(picker) {\r\n                      const end = new Date();\r\n                      const start = new Date();\r\n                      start.setTime(start.getTime() - 3600 * 1000 * 24 * 30);\r\n                      picker.$emit('pick', [start, end]);\r\n                  }\r\n              }, {\r\n                  text: '最近三个月',\r\n                  onClick(picker) {\r\n                      const end = new Date();\r\n                      const start = new Date();\r\n                      start.setTime(start.getTime() - 3600 * 1000 * 24 * 90);\r\n                      picker.$emit('pick', [start, end]);\r\n                  }\r\n              }]\r\n          },\r\n          value1:'',\r\n          value2:'',\r\n        //初始化表格\r\n        operationMonitorTable: [],\r\n        tableData: [],\r\n        tableDataDetails: [],\r\n        tableDataAuditHistory: [],\r\n        tableDataAuditDetails: [],\r\n\r\n        //初始化下拉选\r\n        productOptionList: [],\r\n        editionOptionList: [],\r\n        detailTypeOptionList:[],\r\n\r\n        selectOperation: {},\r\n        selectRow: {},\r\n        statusData: {},\r\n        statusDataList: {},\r\n        statusDataChildrenList:{},\r\n        pdInfoId: '',\r\n        pdProcessId: '',\r\n        moduleNode: '',\r\n        showState:false,\r\n        params: {\r\n          pdRegionType: '',\r\n          pdCode: '',\r\n          pdEdition: '',\r\n          defType: '',\r\n          pdApplyStartDate: undefined,\r\n          pdApplyEndDate: undefined,\r\n          changeStartDate: undefined,\r\n          changeEndDate: undefined,\r\n          isTestReturn: '',\r\n          isReviewReturn: ''\r\n        },\r\n        //产品营运监控定义完毕传参\r\n        data: {\r\n          productTestFlag: '1',\r\n          processInstanceId: ''\r\n        },\r\n        //动态显示\r\n        showOperationProgress: false,\r\n        dialogVisibleOfAuditHistory: false,\r\n        needShowMore_operation: false,\r\n        showAll_operation: false\r\n      }\r\n    },\r\n    computed: {},\r\n    created() {\r\n      this.params.pdApplyEndDate = new Date();\r\n      this.initOperationMonitorProduct()\r\n      let row=this.getJsonData(\"operationSelect\")\r\n      if(row.id!=undefined) {\r\n        this.selectRow = row\r\n        this.selectOperation=row.id\r\n        this.pdInfoId = row.id\r\n        this.pdProcessId = row.pdProcessId\r\n        this.showOperationProgress = true\r\n        this.checkProcess()\r\n      }\r\n    },\r\n    mounted() {\r\n    },\r\n    methods: {\r\n        getCodeNames(code){\r\n            return this.getCodeNames('pdAuditType',code);\r\n        },\r\n        filterHandler(value, row, column) {\r\n            const property = column['property'];\r\n            return row[property] === value;\r\n        },\r\n      handSearch() {\r\n        this.$refs.page.reload();\r\n        this.selectOperation = {}\r\n        this.showOperationProgress = false\r\n      },\r\n      initOperationMonitorProduct() {\r\n       productOperationMonitorList(this.buildRequestData(this.params)).then(response => {\r\n          this.tableData = response.data.records;\r\n          //获取产品编码\r\n          for (const product of this.tableData) {\r\n            let flag = false\r\n            for (const productOption of this.productOptionList) {\r\n              if (productOption.pdCode === product.pdCode) {\r\n                flag = true\r\n                break\r\n              }\r\n            }\r\n            if (!flag) {\r\n              this.productOptionList.push(product)\r\n            }\r\n          }\r\n          //展示更多或者收起\r\n         /* this.showAll_operation = false\r\n          if (this.tableData.length > 10) {\r\n            this.operationMonitorTable = this.tableData.slice(0, 10)\r\n            this.needShowMore_operation = true\r\n          } else {\r\n            this.operationMonitorTable = this.tableData\r\n            this.needShowMore_operation = false\r\n          }*/\r\n        })\r\n      },\r\n      selectedDetailTypeChanged(val){\r\n        debugger\r\n        let param={\r\n          pdRegionType:val\r\n        }\r\n        if(\"\".endsWith(val) || val==undefined){\r\n          this.handSearch()\r\n          return false\r\n        }\r\n        console.log(\"this.tableData\",this.tableData);\r\n        findAllProductByPdDetailType(this.buildRequestData(param)).then(response =>{\r\n          this.productOptionList =[]\r\n          this.detailTypeOptionList =response.data\r\n          for (const product of this.detailTypeOptionList) {\r\n            for (const productOption of  this.tableData) {\r\n              if (productOption.pdCode === product.pdCode) {\r\n                this.productOptionList.push(productOption)\r\n              }\r\n            }\r\n          }\r\n        })\r\n      },\r\n      selectedPdCodeChanged(pdCode) {\r\n        this.params.pdEdition = ''\r\n        const productOptionList_filter = this._.filter(this.operationMonitorTable, {'pdCode': pdCode})\r\n        this.editionOptionList = this._.map(productOptionList_filter, 'pdEdition')\r\n      },\r\n      showMore_operation() {\r\n        this.showAll_operation = true\r\n        this.operationMonitorTable = this.tableData\r\n      },\r\n      showBack_operation() {\r\n        this.showAll_operation = false\r\n        this.operationMonitorTable = this.tableData.slice(0, 10)\r\n      },\r\n      rowClick_Operation(row, column, event) {\r\n        if (event.target.nodeName === \"INPUT\") {\r\n          if (row.id === this.selectOperation) {\r\n            this.selectOperation = {}\r\n            this.showOperationProgress = false\r\n            this.cacheJsonData('operationSelect', this.selectOperation)\r\n          }else{\r\n            this.selectRow = row\r\n            this.cacheJsonData('operationSelect', row)\r\n            this.pdInfoId = row.id\r\n            this.pdProcessId = row.pdProcessId\r\n            this.showOperationProgress = true\r\n            this.checkProcess()\r\n          }\r\n        }\r\n      },\r\n\r\n      /*点击审核退回次数时显示退回审核记录*/\r\n      reviewAuditHistory(row) {\r\n        this.dialogVisibleOfAuditHistory = true;\r\n        reviewHistory(this.buildRequestData({\"pdInfoId\": row.id})).then(res => {\r\n          this.tableDataAuditHistory = res.data\r\n        })\r\n      },\r\n      //点击查看测试退回次数时显示退回测试记录\r\n      reviewTestHistory() {\r\n\r\n      },\r\n      /*表格单条详细数据*/\r\n      tableValue(row,expandedRows) {\r\n          var that = this;\r\n          if (expandedRows.length>1) {\r\n              that.expands = []\r\n              if (row) {\r\n                  that.expands.push(row);\r\n              }\r\n              this.$refs.tableDataAuditHistory.toggleRowExpansion(expandedRows[0]);\r\n          } else {\r\n              that.expands = [];\r\n          }\r\n        let pdReturnFuncNode = JSON.parse(row.pdReturnFuncNode)\r\n        this.tableDataAuditDetails = []\r\n        queryAuditNotes(this.buildRequestData({\"pdInfoId\": row.id})).then(res => {\r\n          this.tableDataDetails = res.data\r\n          for (const dataAudit of this.tableDataDetails) {\r\n            for (let i = 0; i < pdReturnFuncNode.length; i++) {\r\n              if (dataAudit.pdDefineContent === pdReturnFuncNode[i]) {\r\n                this.tableDataAuditDetails.push(dataAudit)\r\n              }\r\n            }\r\n          }\r\n        })\r\n      },\r\n      finishedOperationalAll(row) {\r\n\r\n        getStatus(this.buildRequestData({\"pdProcessId\": this.pdProcessId, \"moduleNode\": this.moduleNode})).then(res => {\r\n          this.statusData = res.data[0]\r\n        })\r\n        let flag = 0;\r\n        for (const statusDataList1 of this.statusData.children) {\r\n          for (let i = 0; i < statusDataList1.children.length; i++) {\r\n            if (statusDataList1.children[i].moduleStatus == 0) {\r\n\r\n              flag = 1;\r\n              break;\r\n            }\r\n          }\r\n          if (flag == 1) {\r\n            this.$confirm(this.$t('productOperationMonitor.confirmExitDefinition1'), this.$t('confirmMessage.tip'), {\r\n              confirmButtonText: this.$t('confirmMessage.confirm'),\r\n              cancelButtonText: this.$t('confirmMessage.cancel'),\r\n              type: 'warning'\r\n            }).then(() => {\r\n              this.$confirm(this.$t('productOperationMonitor.whetherToEnterTheTestNode'), this.$t('confirmMessage.tip'), {\r\n                confirmButtonText: this.$t('productOperationMonitor.yes'),\r\n                cancelButtonText: this.$t('productOperationMonitor.no'),\r\n                type: 'warning'\r\n              }).then(() => {\r\n                this.data.processInstanceId = row.pdProcessId\r\n                this.data.productTestFlag = '0'\r\n                this.finishProductOperationalDef()\r\n              }).catch(() => {\r\n                this.data.processInstanceId = row.pdProcessId\r\n                this.data.productTestFlag = '1'\r\n                this.finishProductOperationalDef()\r\n              })\r\n            }).catch(() => {\r\n            })\r\n            break;\r\n          } else {\r\n            this.$confirm(this.$t('productOperationMonitor.confirmExitDefinition'), this.$t('confirmMessage.tip'), {\r\n              confirmButtonText: this.$t('confirmMessage.confirm'),\r\n              cancelButtonText: this.$t('confirmMessage.cancel'),\r\n              type: 'warning'\r\n            }).then(() => {\r\n              this.$confirm(this.$t('productOperationMonitor.whetherToEnterTheTestNode'), this.$t('confirmMessage.tip'), {\r\n                confirmButtonText: this.$t('productOperationMonitor.yes'),\r\n                cancelButtonText: this.$t('productOperationMonitor.no'),\r\n                type: 'warning'\r\n              }).then(() => {\r\n                this.data.processInstanceId = row.pdProcessId\r\n                this.data.productTestFlag = '0'\r\n                this.finishProductOperationalDef()\r\n              }).catch(() => {\r\n                this.data.processInstanceId = row.pdProcessId\r\n                this.data.productTestFlag = '1'\r\n                this.finishProductOperationalDef()\r\n              })\r\n            }).catch(() => {\r\n            })\r\n          }\r\n        }\r\n      },\r\n      finishProductOperationalDef() {\r\n        finishProductOperationalDef(this.data).then(res => {\r\n          this.notifySuccess(res.message)\r\n          closeVisitTag()\r\n          this.$store.dispatch('product/storageProducts')\r\n          this.$router.push({path: \"/dashboard\"});\r\n        })\r\n      },\r\n      checkProcess() {\r\n        this.moduleNode = 'operational'\r\n        getStatus(this.buildRequestData({\"pdProcessId\": this.pdProcessId, \"moduleNode\": this.moduleNode})).then(res => {\r\n          this.statusData = res.data[0]\r\n        })\r\n      },\r\n      handleGoPage(type) {\r\n        let path = this.menuNameToPath(type)\r\n        this.cacheJsonData(path,this.selectRow)\r\n        this.$router.push({path: path});\r\n      },\r\n    toShowPdBnft() {\r\n      this.showState = !this.showState;\r\n      this.$nextTick(() => {\r\n        if (this.$refs.drawForm) {\r\n          this.$refs.drawForm.clearValidate()\r\n        }\r\n      })\r\n    },\r\n    }\r\n  }\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n\r\n  .wraper {\r\n    font-size: 0;\r\n    margin-top: 3px;\r\n  }\r\n\r\n  .wraper > div {\r\n    display: inline-block;\r\n  }\r\n\r\n</style>\r\n"]}]}