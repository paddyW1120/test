{"remainingRequest":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\basicinfo\\obperiod-deductible-limit\\obperiod\\clm-obperiod\\index.vue?vue&type=style&index=0&id=331fd66b&lang=scss&scoped=true&","dependencies":[{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\basicinfo\\obperiod-deductible-limit\\obperiod\\clm-obperiod\\index.vue","mtime":1609847106554},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\css-loader\\dist\\cjs.js","mtime":1706753188288},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1706753191924},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\postcss-loader\\src\\index.js","mtime":1706753189537},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1706753187424},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1706753190941}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLmRpdmlkZXIgew0KICBjb2xvcjogYmxhY2s7DQogIGJhY2tncm91bmQtY29sb3I6IGJsYWNrOw0KICB3aWR0aDogMXB4Ow0KfQ0KDQouY3N0IHsNCiAgd2lkdGg6IDYwcHg7DQogIGhlaWdodDogMzdweDsNCiAgbWFyZ2luLXJpZ2h0OiAtNXB4Ow0KICBib3JkZXI6IDA7DQp9DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqwBA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/basicinfo/obperiod-deductible-limit/obperiod/clm-obperiod","sourcesContent":["<template>\r\n  <cus-wraper>\r\n    <cus-page-title-back :isDialog=\"true\" :label=\"$t('pdtempPdMedFeeBill.clmObperiodDef')\" @backTo=\"backToMenu\"></cus-page-title-back>\r\n    <!-- <cus-row>\r\n      <cus-col :span=\"24\">\r\n        <el-button size=\"small\" type=\"text\" @click=\"backToMenu\"><i class=\"el-icon-back\"></i>{{ \"返回\" }}</el-button>\r\n        <label style=\"font-size:14px\"> 赔付观察期定义</label>\r\n      </cus-col>\r\n    </cus-row>\r\n    <hr/> -->\r\n    <br/>\r\n    <el-form ref=\"bnftForm\" :model=\"bnftForm\" :rules=\"rules\" label-width=\"120px\" style=\"width:98%;\">\r\n      <cus-row :gutter=\"10\" class=\"row-bg\" justify=\"center\" type=\"flex\">\r\n        <cus-col :span=\"8\">\r\n          <el-form-item :label=\"$t('pdtempPdMedFeeBill.bnft')\">\r\n            <el-select v-model=\"bnftForm1.pdBnftCode\" :placeholder=\"$t('pdtempPdBnft.pleaseChoose')\" clearable disabled\r\n                       filterable>\r\n              <el-option v-for=\"item in bnftOptions\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\" disabled>\r\n              </el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </cus-col>\r\n        <cus-col :span=\"8\">\r\n          <el-form-item :label=\"$t('pdtempPdMedFeeBill.clmBnft')\">\r\n            <el-select v-model=\"configsForm.pdClmBnftCode\" :placeholder=\"$t('pdtempPdBnft.pleaseChoose')\" clearable disabled\r\n                       filterable>\r\n              <el-option v-for=\"item in ClmBnftOptions\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\">\r\n              </el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </cus-col>\r\n        <cus-col :span=\"8\">\r\n        </cus-col>\r\n      </cus-row>\r\n      <br/></el-form>\r\n      <cus-table-title :label=\"$t('pdtempPdMedFeeBill.guaranteeObservation')\"></cus-table-title>\r\n      <el-table ref=\"periodTable\" :data=\"periodConfigs\" border element-loading-text=\"Loading\" fit\r\n                highlight-current-row max-height=\"300px\" size=\"mini\" @row-click=\"chooseOne\">\r\n        <el-table-column :label=\"$t('pdtempPdBnft.choose')\" width=\"55\">\r\n          <template slot-scope=\"scope\">\r\n            <el-radio v-model=\"radio2\" :label=\"scope.row.id\">\r\n              <span class=\"el-radio__label\"></span>\r\n            </el-radio>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('table.id')\" align=\"center\" type=\"index\" width=\"50\"></el-table-column>\r\n        <el-table-column :label=\"$t('i18nView.pdBnftCtrlLimLevel')\" align=\"center\"\r\n                         prop=\"pdBnftCtrlLimLevel\">\r\n          <template v-slot=\"scope\">\r\n            {{ scope.row.pdBnftCtrlLimLevel | filter_pdBnftCtrlLimLevel }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('i18nView.pdBnftCtrlLimCode')\" align=\"center\" width=\"200\"\r\n                         prop=\"pdBnftCtrlLimCode\">\r\n          <!-- <template v-slot=\"scope\">\r\n                  <span>{{\r\n                      _.map(scope.row.pdtempClmCtrlLimRelaVoList, item => {\r\n                        return item.pdBnftCtrlConCode + ':' + item.pdBnftCtrlConName\r\n                      }).join(', ')\r\n                    }}</span>\r\n          </template> -->\r\n          <template slot-scope=\"scope\">\r\n            <el-table border :data='scope.row.pdtempClmCtrlLimRelaVoList' fit size=\"mini\" style=\"width: 100%\" :show-header=\"false\" >\r\n              <el-table-column prop='pdBnftCtrlConCode' >\r\n                <template slot-scope=\"prop\">\r\n                  {{prop.row.pdBnftCtrlConCode}}:{{prop.row.pdBnftCtrlConName}}\r\n                </template>\r\n              </el-table-column>\r\n            </el-table>\r\n          </template>\r\n        </el-table-column>\r\n        <!--<el-table-column align=\"center\" :label=\"$t('pdtempPdMedFeeBill.pdBnftFactorLimValue')\" prop=\"pdBnftFactorLimValue\">\r\n          <template v-slot=\"scope\">{{ scope.row.pdBnftFactorLimValue | filter_pdBnftFactorLimValue }}</template>\r\n        </el-table-column>-->\r\n        <el-table-column align=\"center\" :label=\"$t('pdtempPdMedFeeBill.Obperiod')\" prop=\"pdBnftFactorValue\">\r\n          <template v-slot=\"scope\">\r\n            {{ scope.row.pdBnftFactorValue }}{{ scope.row.pdBnftFactorValueUnit | filter_pdBnftRuleObservationUnit }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column align=\"center\" :label=\"$t('pdtempPdMedFeeBill.obperiodCalcFormula')\" prop=\"pdBnftFactorValueCalCode\" width=\"150px\">\r\n          <template slot-scope=\"scope\">\r\n            <span>{{ scope.row.pdBnftFactorValueCalCode }}\r\n              <svg-icon v-if=\"scope.row.pdBnftFactorValueCalCode\" icon-class=\"calc\" style=\"color: #606266;font-size: 18px;cursor: pointer\"\r\n                          @click=\"toTableFormula(scope.row)\"/></span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column align=\"center\" :label=\"$t('pdtempPdMedFeeBill.pdBnftCumType')\" prop=\"pdBnftCumType\">\r\n          <template v-slot=\"scope\">{{ scope.row.pdBnftCumType | filter_pdBnftCumType }}</template>\r\n        </el-table-column>\r\n        <el-table-column align=\"center\" :label=\"$t('pdtempPdMedFeeBill.pdBnftCumCount')\" prop=\"pdBnftCumFrequency\">\r\n          <template v-slot=\"scope\">{{ scope.row.pdBnftCumFrequency | filter_pdBnftCumFrequency }}</template>\r\n        </el-table-column>\r\n        <el-table-column align=\"center\" :label=\"$t('pdtempPdMedFeeBill.actions')\" width=\"100\">\r\n          <template slot-scope=\"scope\">\r\n            <cus-del-btn icon=\"el-icon-delete\" size=\"mini\" type=\"danger\" @ok=\"deleteBnftForm(scope.row)\"></cus-del-btn>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <cus-pagination ref=\"page_O\" v-model=\"periodConfigs\" :pageSize=\"5\" :params=\"params\"\r\n                      url=\"/product-compensation/base/pagePdtempClmCtrlLimVo1\"/>\r\n      <br/>\r\n      <el-form :model=\"bnftForm\" label-width=\"140px\" ref=\"bnftForm\" :rules=\"rules\" style=\"width:98%;\">\r\n      <cus-form-title :label=\"$t('pdtempPdMedFeeBill.operiodDef')\"></cus-form-title>\r\n      <cus-row>\r\n        <el-col :span=\"7\" v-show=\"!configsForm.pdClmBnftCode\">\r\n          <el-form-item :label=\"$t('pdtempPdMedFeeBill.pdBnftCtrlLimLevel')\" prop=\"pdBnftCtrlLimLevel\">\r\n            <cus-select v-model=\"bnftForm.pdBnftCtrlLimLevel\" :codetype=\"'pdBnftRuleLimitLevel1'\"\r\n                        @change=\"cleanPdBnftCtrlLimLevel\"></cus-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\" v-show=\"configsForm.pdClmBnftCode\">\r\n          <el-form-item :label=\"$t('pdtempPdMedFeeBill.pdBnftCtrlLimLevel')\"  prop=\"pdBnftCtrlLimLevel\">\r\n            <cus-select v-model=\"bnftForm.pdBnftCtrlLimLevel1\" :codetype=\"'pdBnftRuleLimitLevel3'\"\r\n                        @change=\"cleanPdBnftCtrlLimLevel\"></cus-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\" v-show=\"bnftForm.pdBnftCtrlLimLevel==='5' && !configsForm.pdClmBnftCode\">\r\n          <el-form-item :label=\"$t('pdClaimVerificationRules.pdBnftFactorLimType')\">\r\n              <el-select v-model=\"bnftForm.pdtempPdBnft\" :disabled=\"!!bnftForm1.pdBnftCode\" multiple clearable filterable value-key=\"id\">\r\n                <el-option v-for=\"item in pdBnftOptions\"\r\n                           :key=\"item.id\"\r\n                           :label=\"item.pdBnftCode+':'+item.pdBnftName\"\r\n                           :value=\"item\">\r\n                </el-option>\r\n              </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\" v-show=\"bnftForm.pdBnftCtrlLimLevel==='6' && !configsForm.pdClmBnftCode && !bnftForm1.pdBnftCode\">\r\n          <el-form-item :label=\"$t('pdtempPdMedFeeBill.conBnft')\">\r\n              <el-select v-model=\"bnftForm.pdtempPdBnft\" clearable filterable multiple\r\n                         value-key=\"id\">\r\n                <el-option v-for=\"PdBnftitem in conBnftOptions\"\r\n                           :key=\"PdBnftitem.id\"\r\n                           :label=\"PdBnftitem.pdBnftCode+':'+PdBnftitem.pdBnftName\"\r\n                           :value=\"PdBnftitem\">\r\n                </el-option>\r\n              </el-select>\r\n              <!-- <el-button size=\"small\" type=\"text\" @click=\"openChooseDialog\">{{ '更多>>' }}</el-button> -->\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\" v-show=\"bnftForm.pdBnftCtrlLimLevel==='6' && !configsForm.pdClmBnftCode\">\r\n          <el-form-item :label=\"$t('pdtempPdMedFeeBill.pdBnftCtrlConCode')\">\r\n              <el-select v-model=\"bnftForm.pdtempPdBnftList\" clearable disabled filterable multiple\r\n                         value-key=\"id\">\r\n                <el-option v-for=\"PdBnftitem in pdBnftList\"\r\n                           :key=\"PdBnftitem.id\"\r\n                           :label=\"PdBnftitem.pdBnftCode+':'+PdBnftitem.pdBnftName\"\r\n                           :value=\"PdBnftitem\">\r\n                </el-option>\r\n              </el-select>\r\n              <!-- <el-button size=\"small\" type=\"text\" @click=\"openChooseDialog\">{{ '更多>>' }}</el-button> -->\r\n          </el-form-item>\r\n        </el-col>\r\n        <cus-btn-wrapper  v-show=\"bnftForm.pdBnftCtrlLimLevel==='6' && !configsForm.pdClmBnftCode\">\r\n          <el-button size=\"small\" type=\"text\" @click=\"openChooseDialog\">{{$t('i18nView.more')}}</el-button>\r\n        </cus-btn-wrapper>\r\n        <el-col :span=\"7\" v-show=\"bnftForm.pdBnftCtrlLimLevel1==='13' && configsForm.pdClmBnftCode\">\r\n          <el-form-item :label=\"$t('pdtempProgInfo.bnftinfo')\">\r\n              <el-select v-model=\"bnftForm.pdClmBnftCode\" :placeholder=\"$t('pdtempPdBnft.pleaseChoose')\" clearable disabled\r\n                         filterable>\r\n                <el-option v-for=\"item in ClmBnft\"\r\n                           :key=\"item.id\"\r\n                           :label=\"item.pdClmBnftCode+':'+item.pdClmBnftName\"\r\n                           :value=\"item\">\r\n                </el-option>\r\n              </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\" v-show=\"bnftForm.pdBnftCtrlLimLevel1==='14' && configsForm.pdClmBnftCode\">\r\n            <el-form-item :label=\"$t('pdtempPdMedFeeBill.AssociatedGuaranteeDetails')\">\r\n              <el-select v-model=\"bnftForm.pdBnftCtrlConCodeList\"\r\n                         :placeholder=\"$t('pdtempPdBnft.pleaseChoose')\" clearable disabled\r\n                         filterable multiple value-key=\"id\">\r\n                <el-option v-for=\"item in ClmBnftList\"\r\n                           :key=\"item.id\"\r\n                           :label=\"item.pdClmBnftCode+':'+item.pdClmBnftName\"\r\n                           :value=\"item\">\r\n                </el-option>\r\n              </el-select>\r\n              <!-- <el-button size=\"small\" type=\"text\" @click=\"openChooseDialog1\">{{ '更多>>' }}</el-button> -->\r\n            </el-form-item>\r\n        </el-col>\r\n        <cus-btn-wrapper  v-show=\"bnftForm.pdBnftCtrlLimLevel1==='14' && configsForm.pdClmBnftCode\">\r\n          <el-button size=\"small\" type=\"text\" @click=\"openChooseDialog1\">{{ $t('pdtempPdMedFeeBill.more') }}</el-button>\r\n        </cus-btn-wrapper>\r\n        <el-col :span=\"10\" v-if=\"bnftForm1.pdBnftCode||bnftForm.pdBnftCtrlLimLevel!=='6'\"></el-col>\r\n        <el-col :span=\"3\" v-if=\"!bnftForm1.pdBnftCode&&bnftForm.pdBnftCtrlLimLevel==='6'\"></el-col>\r\n      </cus-row>\r\n      <cus-row >\r\n        <el-col :span=\"24\">\r\n          <el-form-item :label=\"$t('pdtempPdMedFeeBill.pdBnftFactorType')\" prop=\"pdBnftFactorLimValue\">\r\n            <cus-radio v-model=\"bnftForm.pdBnftFactorLimValue\" :codetype=\"'pdObPeriodStartRule'\"></cus-radio>\r\n          </el-form-item>\r\n        </el-col>\r\n      </cus-row>\r\n      <cus-row>\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('pdtempPdMedFeeBill.Obperiod')\" prop=\"pdBnftFactorValue\">\r\n            <el-input v-model=\"bnftForm.pdBnftFactorValue\">\r\n              <cus-select slot=\"append\" v-model=\"bnftForm.pdBnftFactorValueUnit\" :codetype=\"'pdsbnftdy'\" :filter=\"pdBnftRuleObservationUnit\"\r\n                          class=\"cst\"></cus-select>\r\n            </el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('pdtempPdMedFeeBill.pdBnftCumType')\" prop=\"pdBnftCumType\">\r\n            <cus-radio v-model=\"bnftForm.pdBnftCumType\" :codetype=\"'pdBnftCumType'\"></cus-radio>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('pdtempPdMedFeeBill.pdBnftCumPeriod')\" prop=\"pdBnftCumFrequency\">\r\n            <cus-radio v-model=\"bnftForm.pdBnftCumFrequency\" :codetype=\"'pdBnftCumFrequency'\"\r\n                       :disabled=\"bnftForm.pdBnftCumType==1\"></cus-radio>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"3\"></el-col>\r\n      </cus-row>\r\n      <cus-row>\r\n        <cus-col>\r\n          <el-form-item :label=\"$t('pdtempPdMedFeeBill.clmObperiodCus')\">\r\n            <el-switch v-model=\"cusObperiod\">\r\n            </el-switch>\r\n          </el-form-item>\r\n        </cus-col>\r\n\r\n      </cus-row>\r\n      <el-form-item align=\"right\">\r\n        <el-button v-show=\"!radio2\" icon=\"el-icon-success\" size=\"small\" type=\"primary\" @click=\"saveBnftForm('O')\" dialog-disable=\"disable\">\r\n          {{ $t('pdtempPdMedFeeBill.save') }}\r\n        </el-button>\r\n        <el-button v-show=\"radio2\" icon=\"el-icon-success\" size=\"small\" type=\"primary\" @click=\"updateBnftForm('O')\" dialog-disable=\"disable\">\r\n          {{ $t('pdtempPdMedFeeBill.update') }}\r\n        </el-button>\r\n        <el-button icon=\"el-icon-refresh\" size=\"small\" type=\"primary\" @click=\"cleanBnftForm\" dialog-disable=\"disable\">\r\n          {{  $t('pdtempPdMedFeeBill.refresh') }}\r\n        </el-button>\r\n      </el-form-item>\r\n      <div v-if=\"cusObperiod\">\r\n        <cus-form-title :label=\"$t('pdtempPdMedFeeBill.clmObperiodCus')\"></cus-form-title>\r\n        <cus-row >\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('pdtempPdMedFeeBill.observationCalc')\">\r\n              <el-input v-model=\"bnftForm.pdBnftFactorValueCalCode\" readonly>\r\n                <svg-icon slot=\"suffix\" icon-class=\"calc\" style=\"color: #606266;font-size: 18px;cursor: pointer\"\r\n                          @click=\"toFormula\"/>\r\n              </el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"17\">\r\n          </el-col>\r\n        </cus-row>\r\n      </div>\r\n    </el-form>\r\n\r\n    <!-- 弹窗（已关联公式列表） -->\r\n    <el-dialog v-if=\"formulaVisible\" v-dialog-drag :close-on-click-modal=\"false\" :show-close=\"false\" :visible.sync=\"formulaVisible\"\r\n               append-to-body center width=\"80%\">\r\n      <clmCtrlFormula :pdBussDetailType=\"pdBussDetailType\" :pdtempClmCtrlMain=\"selectedClmCtrl\"\r\n                      :pdtempPdBnft=\"bnftForm1\" :pdtempPdClmBnft=\"configsForm\" @bringInCalcCode=\"bringInCalcCode\"\r\n                      @changeDialogVisible_ClmCtrlFormula=\"changeDialogVisible_ClmCtrlFormula\"\r\n                      @changeDialogVisible_ClmCtrlFormulaSelect=\"changeDialogVisible_ClmCtrlFormulaSelect\"></clmCtrlFormula>\r\n    </el-dialog>\r\n\r\n    <!-- 弹窗（公式关联） -->\r\n    <el-dialog v-if=\"formulaSelectVisible\" v-dialog-drag :close-on-click-modal=\"false\" :show-close=\"false\"\r\n               :visible.sync=\"formulaSelectVisible\" append-to-body center width=\"70%\">\r\n      <clmCtrlFormulaSelect :pdBussDetailType=\"pdBussDetailType\" :pdtempClmCtrlMain=\"selectedClmCtrl\"\r\n                            :pdtempPdBnft=\"bnftForm1\" :pdtempPdClmBnft=\"configsForm\" @bringInCalcCode=\"bringInCalcCode\"\r\n                            @changeDialogVisible_ClmCtrlFormulaSelect=\"changeDialogVisible_ClmCtrlFormulaSelect\"></clmCtrlFormulaSelect>\r\n    </el-dialog>\r\n\r\n  </cus-wraper>\r\n</template>\r\n<script>\r\nlet _this;\r\nimport {\r\n  deleteObBnftForm,\r\n  findBnftOptions,\r\n  findBusinessItemByCtrlCode1,\r\n  findClmBnftOptions,\r\n  savePdtempClmCtrlLim,\r\n  selectbnftCode,\r\n  selectbnftinfoCode,\r\n} from \"@/api/basicinfo/pdtemppdclmbnft\";\r\nimport {pdtempPdClsLabList} from \"@/api/basicinfo/ProductAttributeDefinition\";\r\nimport clmCtrlFormula from \"@/views/basicinfo/clm-formula/clmCtrlFormula/index\";\r\nimport clmCtrlFormulaSelect from \"@/views/basicinfo/clm-formula/clmCtrlFormulaSelect/index\";\r\n\r\nexport default {\r\n  name: \"pdtemppdobperiod\",\r\n  components: {clmCtrlFormula, clmCtrlFormulaSelect},\r\n  filters: {\r\n    filter_pdBnftCtrlLimLevel(code) {\r\n      return _this.getCodeName('limitlevel', code);\r\n    },\r\n    filter_pdBnftRuleObservationUnit(code) {\r\n      return _this.getCodeName(\"pdsbnftdy\", code, true);\r\n    },\r\n    filter_pdBnftCumType(code) {\r\n      return _this.getCodeName(\"pdBnftCumType\", code);\r\n    },\r\n    filter_pdBnftCumFrequency(code) {\r\n      return _this.getCodeName(\"pdBnftCumFrequency\", code);\r\n    },\r\n    filter_pdBnftFactorLimValue(code) {\r\n      return _this.getCodeName(\"pdObPeriodStartRule\", code);\r\n    },\r\n  },\r\n  props: {\r\n    moreType: {\r\n      type: String,\r\n      default: ''\r\n    },\r\n    bnftForm1: {\r\n      type: Object,\r\n      default: {},\r\n    },\r\n    configsForm: {\r\n      type: Object,\r\n      default: {},\r\n    },\r\n    pdBnftArr: {\r\n      type: Array,\r\n      default: () => {\r\n        return [];\r\n      },\r\n    },\r\n    pdClmBnftArr: {\r\n      type: Array,\r\n      default: [],\r\n    },\r\n    showObPeriod: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n  },\r\n  data() {\r\n    _this = this;\r\n    return {\r\n      pdBnftList: [],\r\n      ClmBnft: [],\r\n      ClmBnftList: [],\r\n      pdBnftOptions: [],\r\n      params: {\r\n        pdBnftCode: this.bnftForm1.pdBnftCode,\r\n        pdBnftCtrlType: 'O',\r\n        pdBnftCtrlLimLevelList: null,\r\n        pdClmBnftCode: this.configsForm.pdClmBnftCode,\r\n        pdInfoId: null,\r\n      },\r\n      pdtempPdInfo: {},\r\n      selectedClmCtrl: {},\r\n      pdType: null,\r\n      radio2: null,\r\n      bnftForm: {\r\n        pdBnftFactorLimValue: null,\r\n        pdBnftFactorValue: null,\r\n        pdBnftCtrlLimLevel: null,\r\n        pdBnftFactorValue1: null,\r\n        pdBnftFactorValue2: null,\r\n        pdBnftFactorValue3: null,\r\n        pdBnftFactorValueUnit: 'D',\r\n        pdBnftCumType: null,\r\n        pdBnftCumFrequency: '2',\r\n        pdBnftCtrlConCode: [],\r\n        pdBnftCtrlLimLevel1: '',\r\n        pdClmBnftCode: undefined,\r\n        pdtempPdBnft: [],\r\n        pdtempPdBnftList: [],\r\n        pdBnftCtrlConCodeList: []\r\n      },\r\n      pdBnftRuleObservationUnit: \"1$Y$M$D\",\r\n      feeConfigs: [],\r\n      periodConfigs: [],\r\n      Options: [],\r\n      bnftOptions: [],\r\n      conBnftOptions: [],\r\n      ClmBnftOptions: [],\r\n      cusObperiod: false,\r\n      pdBussDetailType: \"\",\r\n      formulaVisible: \"\",\r\n      formulaSelectVisible: \"\",\r\n      rules: {\r\n        pdBnftCtrlLimLevel: [{\r\n          required: true,\r\n          message: this.$t('pay_def.message.please_enter') + '限制级别',\r\n          trigger: 'blur'\r\n        }],\r\n      }\r\n    };\r\n  },\r\n  async created() {\r\n    if (!this.configsForm.pdClmBnftCode) {\r\n      this.params.pdBnftCtrlLimLevelList = '5'\r\n      this.bnftForm.pdBnftCtrlLimLevel = '5'\r\n    } else {\r\n      this.params.pdBnftCtrlLimLevelList = '13'\r\n      this.bnftForm.pdBnftCtrlLimLevel1 = '13'\r\n    }\r\n    this.pdtempPdInfo = this.getPdData();\r\n    this.params.pdInfoId = this.pdtempPdInfo.id\r\n    await this.findTypeRegion();\r\n    this.findperiodConfigs();\r\n    this.findOptions();\r\n    this.findbnftCode();\r\n    this.findConBnftCode();\r\n    this.findbnftinfoCode();\r\n    this.$refs.page_O.reload();\r\n\r\n  },\r\n  watch: {\r\n    showObPeriod: function () {\r\n      if (this.showObPeriod == true) {\r\n        this.findperiodConfigs();\r\n        this.cleanBnftForm();\r\n        this.$refs.page_O.reload();\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    bringInCalcCode(pdBussId, calcCode) {\r\n      for (const ob of this.periodConfigs) {\r\n        if (ob.id === Number(pdBussId)) {\r\n          this.$set(ob, \"pdBnftFactorValueCalCode\", calcCode);\r\n          break;\r\n        }\r\n      }\r\n      if (this.bnftForm.id === Number(pdBussId)) {\r\n        this.bnftForm.pdBnftFactorValueCalCode = calcCode;\r\n      }\r\n    },\r\n    changeDialogVisible_ClmCtrlFormula(visible) {\r\n      this.formulaVisible = visible;\r\n    },\r\n    changeDialogVisible_ClmCtrlFormulaSelect(visible) {\r\n      this.formulaSelectVisible = visible;\r\n      if (visible === false) {\r\n        this.formulaVisible = false;\r\n        this.$nextTick(() => {\r\n          this.formulaVisible = true;\r\n        });\r\n      }\r\n    },\r\n    toFormula() {\r\n      if (Object.keys(this.selectedClmCtrl).length === 0) {\r\n        this.notifyError(\"请选择一条观察期\");\r\n        return;\r\n      }\r\n      if (this.configsForm.id) {\r\n        this.pdBussDetailType = \"22\";\r\n      } else {\r\n        this.pdBussDetailType = \"65\";\r\n      }\r\n      this.formulaVisible = true;\r\n    },\r\n    toTableFormula(row){\r\n      this.selectedClmCtrl = row;\r\n      if (this.configsForm.id) {\r\n        this.pdBussDetailType = \"22\";\r\n      } else {\r\n        this.pdBussDetailType = \"65\";\r\n      }\r\n      this.formulaVisible = true;\r\n    },\r\n    async findTypeRegion() {\r\n      await pdtempPdClsLabList(this.pdtempPdInfo.id).then((response) => {\r\n        for (let i = 0; i < response.data.length; i++) {\r\n          if (response.data[i].pdClsType === \"1\") {\r\n            this.pdType = response.data[i].pdCls2;\r\n          }\r\n        }\r\n      });\r\n    },\r\n    findperiodConfigs() {\r\n      let data = {\r\n        pdBnftCtrlType: \"o\",\r\n      };\r\n      if (this.configsForm.pdClmBnftCode == null) {\r\n        data.pdBnftCode = this.bnftForm1.pdBnftCode;\r\n        data.pdBnftCtrlLevel = \"1\";\r\n      } else {\r\n        data.pdBnftCode = this.configsForm.pdClmBnftCode;\r\n        data.pdBnftCtrlLevel = \"2\";\r\n      }\r\n\r\n    },\r\n    findOptions() {\r\n      this.ClmBnftOptions = [];\r\n      findClmBnftOptions().then((res) => {\r\n        let clmData = res.data;\r\n        clmData.forEach((data) => {\r\n          this.ClmBnftOptions.push({\r\n            value: data.pdClmBnftCode,\r\n            label: data.pdClmBnftCode + \":\" + data.pdClmBnftName,\r\n          });\r\n        });\r\n      });\r\n      this.bnftOptions = [];\r\n      findBnftOptions().then((res) => {\r\n        let bnftData = res.data;\r\n        bnftData.forEach((data) => {\r\n          this.bnftOptions.push({\r\n            value: data.pdBnftCode,\r\n            label: data.pdBnftCode + \":\" + data.pdBnftName,\r\n          });\r\n        });\r\n      });\r\n    },\r\n    chooseOne(row, column, event) {\r\n      if (event.target.nodeName === \"INPUT\") {\r\n        if (row.id === this.radio2) {\r\n          this.radio2 = null;\r\n          this.selectedClmCtrl = {};\r\n          this.bnftForm.pdBnftFactorValueCalCode = \"\";\r\n          this.$refs.periodTable.setCurrentRow();\r\n          this.cleanBnftForm();\r\n        } else {\r\n          this.selectedClmCtrl = row;\r\n          this.radio2 = row.id;\r\n          let list = [];\r\n          this.bnftForm = {\r\n            id: row.id,\r\n            pdBnftFactorLimValue: row.pdBnftFactorLimValue,\r\n            pdBnftFactorValue: row.pdBnftFactorValue,\r\n            pdBnftFactorValueUnit: row.pdBnftFactorValueUnit,\r\n            pdBnftFactorValueCalCode: row.pdBnftFactorValueCalCode,\r\n            pdBnftCumType: row.pdBnftCumType,\r\n            pdBnftCumFrequency: row.pdBnftCumFrequency,\r\n            pdBnftCtrlCode: row.pdBnftCtrlCode,\r\n            pdBnftCtrlConCodeList: list,\r\n            pdBnftCtrlLimLevel: row.pdBnftCtrlLimLevel,\r\n            pdBnftCtrlLimLevel1: row.pdBnftCtrlLimLevel1,\r\n          };\r\n          this.findBusinessItemByCtrlCode1();\r\n        }\r\n      }\r\n\r\n    },\r\n    findBusinessItemByCtrlCode1(){\r\n      findBusinessItemByCtrlCode1(this.bnftForm.pdBnftCtrlCode).then(response => {\r\n            switch (this.bnftForm.pdBnftCtrlLimLevel) {\r\n              case \"5\":\r\n                this.pdBnftOptions = response.data\r\n                this.bnftForm.pdtempPdBnft = response.data\r\n                break;\r\n              case \"6\":\r\n                 this.bnftForm.pdtempPdBnft = [response.data[0]]\r\n                this.bnftForm.pdtempPdBnftList = response.data.slice(1,response.data.length)\r\n                this.pdBnftList = response.data\r\n                break;\r\n              case \"13\":\r\n                this.ClmBnft = response.data\r\n                this.bnftForm.pdClmBnftCode = response.data[0]\r\n                this.bnftForm.pdBnftCtrlLimLevel1 = '13'\r\n                break;\r\n              case \"14\":\r\n                this.bnftForm.pdBnftCtrlConCodeList = response.data\r\n                this.ClmBnftList = response.data\r\n                this.bnftForm.pdBnftCtrlLimLevel1 = '14'\r\n                break;\r\n              default:\r\n                break;\r\n            }\r\n          })\r\n    },\r\n    changeOption() {\r\n      this.$forceUpdate();\r\n    },\r\n    saveBnftForm(pdBnftCtrlType) {\r\n      if (!this.configsForm.pdClmBnftCode) {\r\n        if (!this.bnftForm.pdBnftCtrlLimLevel) {\r\n          this.$message.error({message: '请选择限制等级！', type: 'warning'});\r\n\r\n          return\r\n        }\r\n        if (this.bnftForm.pdtempPdBnftList == []) {\r\n          this.$message.error({message: '关联保障不能为空，请关联保障！', type: 'warning'});\r\n\r\n          return\r\n        }\r\n\r\n      } else {\r\n        if (!this.bnftForm.pdBnftCtrlLimLevel1) {\r\n          this.$message.error({message: '请选择限制等级！', type: 'warning'});\r\n\r\n          return\r\n        }\r\n        if (this.bnftForm.pdBnftCtrlConCodeList == []) {\r\n          this.$message.error({message: '关联保障明细不能为空，请关联保障明细！', type: 'warning'});\r\n\r\n          return\r\n        }\r\n      }\r\n      if (this.bnftForm.pdBnftCumType === '1') {\r\n        this.bnftForm.pdBnftCumFrequency = null\r\n      }\r\n      this.bnftForm.pdBnftCtrlType = pdBnftCtrlType\r\n      this.bnftForm.pdBnftCtrlLevel = this.bnftForm.pdBnftCtrlLimLevel\r\n      this.bnftForm.pdBnftCtrlLevel1 = this.bnftForm.pdBnftCtrlLimLevel1\r\n      if(this.bnftForm.pdBnftCtrlLevel1){\r\n        this.bnftForm.pdBnftCtrlLevel = ''\r\n      }\r\n      this.bnftForm.id = null\r\n      let data = {\r\n        pdgenlClmCtrlVoForCompensation: this.bnftForm,\r\n        pdBnftCode: this.bnftForm1.pdBnftCode,\r\n        pdtempPdInfo: this.pdtempPdInfo,\r\n        pdClmBnftCode: this.configsForm.pdClmBnftCode\r\n\r\n      }\r\n      savePdtempClmCtrlLim(this.buildRequestData(data)).then((res) => {\r\n        this.notifySuccess('保存成功');\r\n        return new Promise(resolve => {\r\n          this.$refs.page_O.reload().then(() => {\r\n            for (let i = 0; i < this.periodConfigs.length; i++) {\r\n              if (this.periodConfigs[i].pdBnftCtrlCode == res.data.pdBnftCtrlCode) {\r\n                // this.$refs.periodTable.setCurrentRow(this.periodConfigs[i])\r\n                this.radio2 = this.periodConfigs[i].id\r\n                this.bnftForm = Object.assign({},this.periodConfigs[i])\r\n                this.findbnftCode();\r\n                this.findbnftinfoCode();\r\n                this.findBusinessItemByCtrlCode1();\r\n              }\r\n            }\r\n          })\r\n        })\r\n\r\n      })\r\n    },\r\n    updateBnftForm(pdBnftCtrlType) {\r\n      if (!this.configsForm.pdClmBnftCode) {\r\n        if (!this.bnftForm.pdBnftCtrlLimLevel) {\r\n          this.$message.error({message: '请选择限制等级！', type: 'warning'});\r\n\r\n          return\r\n        }\r\n        if (this.bnftForm.pdtempPdBnftList == []) {\r\n          this.$message.error({message: '关联保障不能为空，请关联保障！', type: 'warning'});\r\n\r\n          return\r\n        }\r\n\r\n      } else {\r\n        if (!this.bnftForm.pdBnftCtrlLimLevel1) {\r\n          this.$message.error({message: '请选择限制等级！', type: 'warning'});\r\n\r\n          return\r\n        }\r\n        if (this.bnftForm.pdBnftCtrlConCodeList == []) {\r\n          this.$message.error({message: '关联保障明细不能为空，请关联保障明细！', type: 'warning'});\r\n\r\n          return\r\n        }\r\n      }\r\n      if (this.bnftForm.pdBnftCumType === '1') {\r\n        this.bnftForm.pdBnftCumFrequency = null\r\n      }\r\n      this.bnftForm.pdBnftCtrlType = pdBnftCtrlType\r\n      this.bnftForm.pdBnftCtrlLevel = this.bnftForm.pdBnftCtrlLimLevel\r\n      let data = {\r\n        pdgenlClmCtrlVoForCompensation: this.bnftForm,\r\n        pdBnftCode: this.bnftForm1.pdBnftCode,\r\n        pdtempPdInfo: this.pdtempPdInfo,\r\n        pdClmBnftCode: this.configsForm.pdClmBnftCode\r\n\r\n      }\r\n      savePdtempClmCtrlLim(this.buildRequestData(data)).then((res) => {\r\n        this.notifySuccess('更新成功');\r\n        return new Promise(resolve => {\r\n          this.$refs.page_O.reload().then(() => {\r\n            for (let i = 0; i < this.periodConfigs.length; i++) {\r\n              if (this.periodConfigs[i].pdBnftCtrlCode == res.data.pdBnftCtrlCode) {\r\n                // this.$refs.periodTable.setCurrentRow(this.periodConfigs[i])\r\n                this.radio2 = this.periodConfigs[i].id\r\n              }\r\n            }\r\n          })\r\n        })\r\n      })\r\n    },\r\n    cleanBnftForm() {\r\n      this.$refs[\"bnftForm\"].resetFields();\r\n      this.radio2 = null;\r\n      this.$refs.periodTable.setCurrentRow();\r\n      this.cusObperiod = false;\r\n      this.bnftForm.pdBnftCtrlLimLevel1 = '';\r\n      this.ClmBnftList = [];\r\n      this.findbnftCode();\r\n      this.findbnftinfoCode();\r\n    },\r\n    deleteBnftForm(row) {\r\n      let data = {\r\n        pdBnftCtrlCode: row.pdBnftCtrlCode,\r\n      };\r\n      deleteObBnftForm(this.buildRequestData(data)).then(() => {\r\n        this.notifySuccess(this.$t(\"successMessage.delete\"));\r\n        this.$refs.page_O.reload();\r\n      });\r\n    },\r\n    backToMenu() {\r\n      this.$emit(\"backToFeeBill\", \"bnft\");\r\n    },\r\n    openChooseDialog() {\r\n      this.$emit('showFeeBillTypeFlag', 'bnft5')\r\n    },\r\n    openChooseDialog1() {\r\n      this.$emit('showFeeBillTypeFlag', 'bnft6')\r\n    },\r\n    findbnftCode() {\r\n      let params;\r\n      if(this.bnftForm1.pdBnftCode){\r\n        params = {pdBnftCode: this.bnftForm1.pdBnftCode}\r\n      }else{\r\n        params = {pdInfoId: this.pdtempPdInfo.id}\r\n      }\r\n      selectbnftCode(this.buildRequestData(params)).then(response => {\r\n        this.pdBnftOptions = response.data\r\n        this.bnftForm.pdtempPdBnft = [];\r\n        if(this.bnftForm1.pdBnftCode){\r\n          this.bnftForm.pdtempPdBnft.push(response.data[0])\r\n        }\r\n\r\n      })\r\n    },\r\n    findConBnftCode() {\r\n      let params = {pdInfoId: this.pdtempPdInfo.id}\r\n      selectbnftCode(this.buildRequestData(params)).then(response => {\r\n        this.conBnftOptions = response.data\r\n      })\r\n    },\r\n    findbnftinfoCode() {\r\n      const params = {pdClmBnftCode: this.configsForm.pdClmBnftCode}\r\n      selectbnftinfoCode(this.buildRequestData(params)).then(response => {\r\n        this.ClmBnft = response.data\r\n        this.bnftForm.pdClmBnftCode = response.data[0]\r\n      })\r\n    },\r\n    bringSelectedPdClmBnftMoreBill(selectedItemList) {\r\n      this.bnftForm.pdtempPdBnftList = []\r\n      this.pdBnftList = []\r\n      for (const selectedItem of selectedItemList) {\r\n        this.bnftForm.pdtempPdBnftList.push(selectedItem)\r\n        this.pdBnftList.push(selectedItem)\r\n      }\r\n    },\r\n    bringSelectedPdBnftMoreBill(selectedItemList) {\r\n      this.bnftForm.pdBnftCtrlConCodeList = []\r\n      this.ClmBnftList = []\r\n      for (const selectedItem of selectedItemList) {\r\n        this.bnftForm.pdBnftCtrlConCodeList.push(selectedItem)\r\n        this.ClmBnftList.push(selectedItem)\r\n      }\r\n    },\r\n    cleanPdBnftCtrlLimLevel(val) {\r\n      this.pdBnftOptions = []\r\n      this.bnftForm.pdtempPdBnft = []\r\n      this.pdBnftList = []\r\n      this.bnftForm.pdtempPdBnftList = []\r\n      this.ClmBnft = []\r\n      this.bnftForm.pdClmBnftCode = undefined\r\n      this.ClmBnftList = []\r\n      this.bnftForm.pdBnftCtrlConCodeList = []\r\n      if('5'===val){\r\n        this.findbnftCode();\r\n      }\r\n      if('13'===val){\r\n        this.findbnftinfoCode();\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.divider {\r\n  color: black;\r\n  background-color: black;\r\n  width: 1px;\r\n}\r\n\r\n.cst {\r\n  width: 60px;\r\n  height: 37px;\r\n  margin-right: -5px;\r\n  border: 0;\r\n}\r\n</style>\r\n"]}]}