{"remainingRequest":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\system\\admin-role\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\system\\admin-role\\index.vue","mtime":1609847107185},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\babel-loader\\lib\\index.js","mtime":1706753193796},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1706753190941}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQoNCmltcG9ydCB7YWRkUm9sZSwgZGVsZXRlUm9sZSwgZmluZFVzZXJzQnlSb2xlSWQsIHVwZGF0ZVJvbGUsc2VsZWN0VGVuYW50c30gZnJvbSAnQC9hcGkvc3lzdGVtL3JvbGUtYWRtaW4nDQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogJ1JvbGUnLA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQoNCiAgICAgIC8v6KGo5qC85pWw5o2uDQogICAgICBjb25maWdzOiBbXSwNCiAgICAgIHRlbmFudExpc3Q6IFtdLC8vIOenn+aIt+WIl+ihqA0KICAgICAgLy/mn6Xor6Llj4LmlbDlj6/ku6XmmK/mqKHns4rmiJbogIXnrYnlgLwgbGlrZV8gIGVxXw0KICAgICAgcGFyYW1zOiB7DQogICAgICAgIHJvbGVOYW1lOiAnJywNCiAgICAgICAgdGVuYW50SWQ6ICcnLA0KICAgICAgICByb2xlQ29kZTogJycNCiAgICAgIH0sDQogICAgICBmb3JtOiB7ICAvL+ihqOWNleaVsOaNruS4juWQjuerr+WunuS9k+exu+WvueW6lA0KICAgICAgICBpZDogJycsIC8v5Li76ZSuSUQNCiAgICAgICAgcm9sZUNvZGU6ICcnLCAvL+i0puWPtw0KICAgICAgICByb2xlTmFtZTogJycsIC8v6LSm5Y+3DQogICAgICAgIHRlbmFudElkOiAnJywgLy/np5/miLdJZA0KICAgICAgfSwNCiAgICAgIHJ1bGVzOiB7DQogICAgICAgIHJvbGVDb2RlOiBbDQogICAgICAgICAge3JlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWl6KeS6Imy57yW56CBJywgdHJpZ2dlcjogJ2JsdXInfSwNCiAgICAgICAgXSwNCiAgICAgICAgcm9sZU5hbWU6IFsNCiAgICAgICAgICB7cmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaXop5LoibLlkI0nLCB0cmlnZ2VyOiAnYmx1cid9LA0KICAgICAgICBdLA0KICAgICAgICB0ZW5hbnRJZDogWw0KICAgICAgICAgIHtyZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+mAieaLqeenn+aItycsIHRyaWdnZXI6ICdibHVyJ30sDQogICAgICAgIF0NCiAgICAgIH0sDQogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwgLy9kaWFsb2fmmL7npLrov5jmmK/pmpDol48NCiAgICAgIGRpYWxvZ1N0YXR1czogJycsIC8v6KGo5Y2V54q25oCB5piv5paw5aKe6L+Y5piv5L+u5pS5DQogICAgICB0aXRsZU1hcDogew0KICAgICAgICB1cGRhdGU6IHRoaXMuJHQoJ3JvbGVWaWV3LnVwZGF0ZScpLA0KICAgICAgICBjcmVhdGU6IHRoaXMuJHQoJ3JvbGVWaWV3LmFkZCcpDQogICAgICB9LA0KICAgIH0NCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICBsZXQgcm9sZWNvZGVzID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5yb2xlY29kZXMNCiAgICBpZiAocm9sZWNvZGVzLmluZGV4T2YoJ3N1cGVyQWRtaW4nLCAwKSAhPSAtMSkgew0KICAgICAgdGhpcy5wYXJhbXMuaXNTdXBlckFkbWluID0gdHJ1ZTsNCiAgICB9DQoNCiAgICB0aGlzLmluaXRUZW5hbnRzKCkNCg0KICB9LA0KICBtb3VudGVkKCkgew0KICB9LA0KICBtZXRob2RzOiB7DQogICAgZmlsdGVyVGVuYW50TmFtZSh0ZW5hbnRJZCl7DQogICAgICAgIHJldHVybiAgIHRoaXMuXy5maWx0ZXIodGhpcy50ZW5hbnRMaXN0LHsiaWQiOiBwYXJzZUludCh0ZW5hbnRJZCl9KVswXS5uYW1lDQogICAgfSwNCiAgICBpbml0VGVuYW50cygpIHsNCiAgICAgIHNlbGVjdFRlbmFudHMoKS50aGVuKHJlcyA9PiB7DQogICAgICAgICAgdGhpcy50ZW5hbnRMaXN0ID0gcmVzLmRhdGENCiAgICAgIH0pDQogICAgfSwNCiAgICBoYW5kbGVTZWFyY2goKSB7DQogICAgICB0aGlzLiRyZWZzLnBhZ2UucmVsb2FkKCkNCiAgICB9LA0KICAgIHRlbmFudENoYW5nZSh2YWwpIHsNCiAgICAgIHRoaXMuZm9ybS50ZW5hbnRJZCA9IHZhbA0KICAgIH0sDQogICAgaGFuZGxlQ3JlYXRlKCkgew0KICAgICAgdGhpcy5yZXNldEZvcm0oKQ0KICAgICAgdGhpcy5kaWFsb2dTdGF0dXMgPSAnY3JlYXRlJw0KICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZQ0KICAgIH0sDQogICAgaGFuZGxlVXBkYXRlKHJvdykgew0KICAgICAgY29uc29sZS5sb2cocm93KQ0KICAgICAgdGhpcy5mb3JtID0gT2JqZWN0LmFzc2lnbih7fSwgcm93KQ0KICAgICAgdGhpcy5kaWFsb2dTdGF0dXMgPSAndXBkYXRlJw0KICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZQ0KICAgIH0sDQogICAgaGFuZGxlRGVsZXRlKGlkKSB7DQogICAgICBmaW5kVXNlcnNCeVJvbGVJZChpZCkudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgIGRlbGV0ZVJvbGUoaWQpLnRoZW4ocmVzcG9uc2UgPT4gew0KICAgICAgICAgICAgdGhpcy5oYW5kbGVTZWFyY2goKQ0KICAgICAgICAgICAgdGhpcy5ub3RpZnlTdWNjZXNzKHJlc3BvbnNlLm1lc3NhZ2UpDQogICAgICAgICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSBmYWxzZQ0KICAgICAgICAgIH0pDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdGhpcy5ub3RpZnlFcnJvcign6KeS6Imy5LiL5a2Y5Zyo55So5oi377yM5LiN5YWB6K645Yig6Zmk6KeS6Imy77yBJykNCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9LA0KICAgIHN1Ym1pdEZvcm0oKSB7DQogICAgICB0aGlzLiRyZWZzLmRhdGFGb3JtLnZhbGlkYXRlKHZhbGlkID0+IHsNCiAgICAgICAgaWYgKHZhbGlkKSB7DQogICAgICAgICAgbGV0IGJhY2s7DQogICAgICAgICAgaWYgKHRoaXMuZm9ybS5pZCkgew0KICAgICAgICAgICAgYmFjayA9IHVwZGF0ZVJvbGUodGhpcy5mb3JtKQ0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBiYWNrID0gYWRkUm9sZSh0aGlzLmZvcm0pDQogICAgICAgICAgfQ0KICAgICAgICAgIGJhY2sudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgICAgICB0aGlzLmhhbmRsZVNlYXJjaCgpDQogICAgICAgICAgICB0aGlzLm5vdGlmeVN1Y2Nlc3MocmVzcG9uc2UubWVzc2FnZSkNCiAgICAgICAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IGZhbHNlDQogICAgICAgICAgfSkNCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9LA0KICAgIHJlc2V0Rm9ybSgpIHsNCiAgICAgIHRoaXMuZm9ybSA9IHsgIC8v6KGo5Y2V5pWw5o2u5LiO5ZCO56uv5a6e5L2T57G75a+55bqUDQogICAgICAgIGlkOiAnJywgLy/kuLvplK5JRA0KICAgICAgICByb2xlQ29kZTogJycsIC8v6KeS6Imy57yW56CBDQogICAgICAgIHJvbGVOYW1lOiAnJywgLy/op5LoibLlkI0NCiAgICAgICAgdGVuYW50SWQ6ICcnDQogICAgICB9DQogICAgfSwNCiAgICB0b0F1dGhTZXR0aW5nKHJvdykgew0KICAgICAgdGhpcy4kcm91dGVyLnB1c2goe25hbWU6ICdhdXRoU2V0dGluZycsIHBhcmFtczoge3JvbGVJZDogcm93LmlkLGZsYWc6ICcyJ319KQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4GA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/system/admin-role","sourcesContent":["<template>\r\n  <cus-wraper>\r\n       <el-form label-width=\"auto\">\r\n         <el-row :gutter=\"10\">\r\n           <cus-col>\r\n                  <el-form-item :label=\"$t('roleView.table_roleName')\">\r\n                    <el-input v-model=\"params.roleName\" :placeholder=\"$t('form.please_enter')\" class=\"filter-item\"\r\n                              clearable></el-input>\r\n                  </el-form-item>\r\n           </cus-col>\r\n\r\n           <cus-col>\r\n             <el-form-item :label=\"$t('roleView.table_roleCode')\">\r\n               <el-input v-model=\"params.roleCode\" :placeholder=\"$t('form.please_enter')\" class=\"filter-item\"\r\n                         clearable></el-input>\r\n             </el-form-item>\r\n           </cus-col>\r\n\r\n\r\n           <cus-col>\r\n             <el-form-item :label=\"$t('sysTenant.name')\">\r\n               <el-select  clearable filterable\r\n                           v-model=\"params.tenantId\" >\r\n                 <el-option  :key=\"tenant.id\" :label=\"tenant.comCode+':'+tenant.name\" :value=\"tenant.id\"\r\n                             v-for=\"tenant in tenantList\"></el-option>\r\n               </el-select>\r\n             </el-form-item>\r\n           </cus-col>\r\n\r\n\r\n           <cus-btn-wrapper>\r\n             <el-button v-waves class=\"filter-button\" icon=\"el-icon-search\" size=\"small\" type=\"primary\" @click=\"handleSearch\">\r\n               {{$t('table.search') }}\r\n             </el-button>\r\n             <el-button v-auth=\"'sys-role:add'\" v-waves class=\"filter-button\" icon=\"el-icon-plus\" size=\"small\" type=\"primary\"\r\n                        @click=\"handleCreate\">{{ $t('table.add') }}\r\n             </el-button>\r\n           </cus-btn-wrapper>\r\n         </el-row>\r\n       </el-form>\r\n\r\n\r\n    <cus-table-title :label=\"$t('route.sys_role_list')\"></cus-table-title>\r\n    <el-table :data=\"configs\" border element-loading-text=\"Loading\" fit highlight-current-row size=\"mini\">\r\n      <el-table-column :label=\"$t('table.id')\" align=\"center\" sortable type=\"index\"></el-table-column>\r\n      <el-table-column :label=\"$t('roleView.table_roleName')\" align=\"center\" prop=\"roleName\"></el-table-column>\r\n      <el-table-column :label=\"$t('roleView.table_roleCode')\" align=\"center\" prop=\"roleCode\"></el-table-column>\r\n      <el-table-column :label=\"$t('roleView.table_tenantName')\" align=\"center\"\r\n                       prop=\"tenantId\">\r\n              <template v-slot=\"scope\">\r\n                      {{filterTenantName(scope.row.tenantId)}}\r\n              </template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('table.actions')\" align=\"center\"  width=\"350\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button v-auth=\"'sys-role:update'\" class=\"filter-button\" icon=\"el-icon-edit\" size=\"small\"\r\n                     type=\"primary\" @click=\"handleUpdate(scope.row)\">\r\n            {{ $t('table.edit') }}\r\n          </el-button>\r\n          <el-button v-auth=\"'sys-role:toAuthSetting'\" class=\"filter-button\" icon=\"el-icon-edit\" size=\"small\"\r\n                     type=\"primary\" @click=\"toAuthSetting(scope.row)\">\r\n            {{ $t('roleView.roleAuthoritySettings') }}\r\n          </el-button>\r\n          <cus-del-btn v-auth=\"'sys-role:delete'\" :buttonText=\"$t('table.delete')\" style=\"margin-left: 10px\"\r\n                       @ok=\"handleDelete(scope.row.id)\"/>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <!-- 分页 -->\r\n    <cus-pagination ref=\"page\" v-model=\"configs\" :pageSize=\"10\" :params=\"params\" url=\"/sys-role-admin/base/list\"/>\r\n\r\n    <!---新增修改dialog---->\r\n\r\n    <el-dialog v-dialog-drag  :visible.sync=\"dialogVisible\" @close=\"dialogVisible=false\" >\r\n      <cus-page-title-back @backTo=\"dialogVisible=false\" :isDialog=\"true\" :label=\"titleMap[dialogStatus]\" />\r\n      <el-form ref=\"dataForm\" :model=\"form\" :rules=\"rules\" label-width=\"auto\" style=\"margin-left: 10%\">\r\n        <el-row :gutter=\"20\"><el-col :span=\"15\"><el-form-item :label=\"$t('roleView.table_roleCode')+':'\" prop=\"roleCode\">\r\n          <el-input v-model=\"form.roleCode\"\r\n                    :placeholder=\"$t('roleView.input')+$t('roleView.table_roleCode')\"></el-input>\r\n        </el-form-item></el-col></el-row>\r\n        <el-row :gutter=\"20\"><el-col :span=\"15\"><el-form-item :label=\"$t('roleView.table_roleName')+':'\" prop=\"roleName\">\r\n          <el-input v-model=\"form.roleName\"\r\n                    :placeholder=\"$t('roleView.input')+$t('roleView.table_roleName')\"></el-input>\r\n        </el-form-item></el-col></el-row>\r\n        <el-row :gutter=\"20\"><el-col :span=\"15\"> <el-form-item  :label=\"$t('roleView.table_tenantName')+':'\" prop=\"tenantId\">\r\n          <el-select  v-model=\"form.tenantId\" :placeholder=\"$t('form.please_select')\"  clearable filterable>\r\n            <el-option\r\n              v-for=\"(item,index) in tenantList\"\r\n              :key=\"item.id\"\r\n              :label=\"item.name\"\r\n              :value=\"item.id\">\r\n            </el-option>\r\n          </el-select>\r\n        </el-form-item></el-col></el-row>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button size=\"small\" icon='el-icon-circle-close' type=\"primary\" @click=\"dialogVisible = false\"> {{ $t('table.cancel') }} </el-button>\r\n          <el-button v-auth=\"'sys-role:add'\" class=\"el-icon-success\" size=\"small\" type=\"primary\" @click=\"submitForm\"> {{\r\n              $t('table.confirm')\r\n            }} </el-button>\r\n        </span>\r\n    </el-dialog>\r\n\r\n\r\n  </cus-wraper>\r\n</template>\r\n<script>\r\n\r\nimport {addRole, deleteRole, findUsersByRoleId, updateRole,selectTenants} from '@/api/system/role-admin'\r\n\r\nexport default {\r\n  name: 'Role',\r\n  data() {\r\n    return {\r\n\r\n      //表格数据\r\n      configs: [],\r\n      tenantList: [],// 租户列表\r\n      //查询参数可以是模糊或者等值 like_  eq_\r\n      params: {\r\n        roleName: '',\r\n        tenantId: '',\r\n        roleCode: ''\r\n      },\r\n      form: {  //表单数据与后端实体类对应\r\n        id: '', //主键ID\r\n        roleCode: '', //账号\r\n        roleName: '', //账号\r\n        tenantId: '', //租户Id\r\n      },\r\n      rules: {\r\n        roleCode: [\r\n          {required: true, message: '请输入角色编码', trigger: 'blur'},\r\n        ],\r\n        roleName: [\r\n          {required: true, message: '请输入角色名', trigger: 'blur'},\r\n        ],\r\n        tenantId: [\r\n          {required: true, message: '请选择租户', trigger: 'blur'},\r\n        ]\r\n      },\r\n      dialogVisible: false, //dialog显示还是隐藏\r\n      dialogStatus: '', //表单状态是新增还是修改\r\n      titleMap: {\r\n        update: this.$t('roleView.update'),\r\n        create: this.$t('roleView.add')\r\n      },\r\n    }\r\n  },\r\n  created() {\r\n    let rolecodes = this.$store.getters.rolecodes\r\n    if (rolecodes.indexOf('superAdmin', 0) != -1) {\r\n      this.params.isSuperAdmin = true;\r\n    }\r\n\r\n    this.initTenants()\r\n\r\n  },\r\n  mounted() {\r\n  },\r\n  methods: {\r\n    filterTenantName(tenantId){\r\n        return   this._.filter(this.tenantList,{\"id\": parseInt(tenantId)})[0].name\r\n    },\r\n    initTenants() {\r\n      selectTenants().then(res => {\r\n          this.tenantList = res.data\r\n      })\r\n    },\r\n    handleSearch() {\r\n      this.$refs.page.reload()\r\n    },\r\n    tenantChange(val) {\r\n      this.form.tenantId = val\r\n    },\r\n    handleCreate() {\r\n      this.resetForm()\r\n      this.dialogStatus = 'create'\r\n      this.dialogVisible = true\r\n    },\r\n    handleUpdate(row) {\r\n      console.log(row)\r\n      this.form = Object.assign({}, row)\r\n      this.dialogStatus = 'update'\r\n      this.dialogVisible = true\r\n    },\r\n    handleDelete(id) {\r\n      findUsersByRoleId(id).then(response => {\r\n        if (response.data.length === 0) {\r\n          deleteRole(id).then(response => {\r\n            this.handleSearch()\r\n            this.notifySuccess(response.message)\r\n            this.dialogVisible = false\r\n          })\r\n        } else {\r\n          this.notifyError('角色下存在用户，不允许删除角色！')\r\n        }\r\n      })\r\n    },\r\n    submitForm() {\r\n      this.$refs.dataForm.validate(valid => {\r\n        if (valid) {\r\n          let back;\r\n          if (this.form.id) {\r\n            back = updateRole(this.form)\r\n          } else {\r\n            back = addRole(this.form)\r\n          }\r\n          back.then(response => {\r\n            this.handleSearch()\r\n            this.notifySuccess(response.message)\r\n            this.dialogVisible = false\r\n          })\r\n        }\r\n      })\r\n    },\r\n    resetForm() {\r\n      this.form = {  //表单数据与后端实体类对应\r\n        id: '', //主键ID\r\n        roleCode: '', //角色编码\r\n        roleName: '', //角色名\r\n        tenantId: ''\r\n      }\r\n    },\r\n    toAuthSetting(row) {\r\n      this.$router.push({name: 'authSetting', params: {roleId: row.id,flag: '2'}})\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>\r\n"]}]}