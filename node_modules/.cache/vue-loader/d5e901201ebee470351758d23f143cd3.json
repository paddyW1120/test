{"remainingRequest":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\ibrms\\objectManagement\\functionTest\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\ibrms\\objectManagement\\functionTest\\index.vue","mtime":1609847106739},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\babel-loader\\lib\\index.js","mtime":1706753193796},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1706753190941}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBtYXBHZXR0ZXJzIH0gZnJvbSAidnVleCI7DQppbXBvcnQgew0KICBmaW5kUnVsZUZ1bmN0aW9uLA0KICBleGVjdXRlRnVuY3Rpb24sDQogIHJlbGVhc2VGdW5jdGlvbiwNCiAgdGVzdENvbXBsZXRlRnVuY3Rpb24sDQogIHVwZGF0ZVJ1bGVGdW5jdGlvbg0KfSBmcm9tICJAL2FwaS9pYnJtcy9ydWxlRnVuY3Rpb24iOw0KaW1wb3J0IHsgY2xvc2VWaXNpdFRhZyB9IGZyb20gIkAvdXRpbHMvdGFnc1ZpZXciOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJydWxlRnVuY3Rpb25UZXN0IiwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgZm9ybTogew0KICAgICAgICAvL+ihqOWNleaVsOaNruS4juWQjuerr+WunuS9k+exu+WvueW6lA0KICAgICAgICBpZDogIiIsIC8v5Li76ZSuSUQNCiAgICAgICAgZnVuY3Rpb25OYW1lOiAiIiwNCiAgICAgICAgZnVuY3Rpb25FbnRpdHk6ICIiLA0KICAgICAgICBleHByZXNzaW9uOiAiIiwNCiAgICAgICAgZGF0YTogIiIsDQogICAgICAgIHJlc3VsdDogIiIsDQogICAgICAgIGNvbnNvbGU6ICIiDQogICAgICB9LA0KICAgICAgcmFkaW86IGZhbHNlLA0KICAgICAgZnVuY3Rpb25JZDogIiIsDQogICAgICByZXN1bHRTdHI6ICIiLA0KICAgICAgLy/mo4Dpqozop4TliJkNCiAgICAgIHJ1bGVzOiB7fSwNCiAgICAgIHVwZGF0ZVN0YXRlOiB0cnVlLA0KICAgICAgZnVuY3Rpb246IHt9DQogICAgfTsNCiAgfSwNCg0KICBjb21wdXRlZDoge30sDQogIGNyZWF0ZWQoKSB7DQogICAgbGV0IGJhc2VJbmZvID0gdGhpcy4kcm91dGUucGFyYW1zLmJhc2VJbmZvOw0KICAgIHRoaXMuZnVuY3Rpb24gPSBiYXNlSW5mbzsNCiAgICBjb25zb2xlLmxvZygiYmFzZUluZm8iLCBiYXNlSW5mbyk7DQogICAgdGhpcy5mb3JtLmlkID0gYmFzZUluZm8uaWQ7DQogICAgdGhpcy5mb3JtLmZ1bmN0aW9uTmFtZSA9IGJhc2VJbmZvLm5hbWU7DQogICAgZmluZFJ1bGVGdW5jdGlvbihiYXNlSW5mby5pZCkudGhlbihyZXNwb25zZSA9PiB7DQogICAgICBpZiAoDQogICAgICAgIHJlc3BvbnNlLmRhdGEuZnVuY3Rpb25FbnRpdHkgJiYNCiAgICAgICAgcmVzcG9uc2UuZGF0YS5mdW5jdGlvbkVudGl0eS5sZW5ndGggPiAwDQogICAgICApIHsNCiAgICAgICAgdGhpcy5mb3JtLmV4cHJlc3Npb24gPSByZXNwb25zZS5kYXRhLmZ1bmN0aW9uRW50aXR5Ow0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy5jcmVhdGVGdW5jdGlvbk1vZGVsQW5kRGF0YVN0cihiYXNlSW5mbyk7DQogICAgICB9DQogICAgfSk7DQogICAgdGhpcy5jcmVhdGVEYXRhU3RyKGJhc2VJbmZvKTsNCiAgICB0aGlzLmNyZWF0ZVJlc3VsdFN0cihiYXNlSW5mbyk7DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBjcmVhdGVGdW5jdGlvbk1vZGVsQW5kRGF0YVN0cihiYXNlSW5mbykgew0KICAgICAgbGV0IGZ1bmN0aW9uU3RyID0gImltcG9ydCBqYXZhLmxhbmcuTWF0aDtcdFxuIGZ1bmN0aW9uICI7DQogICAgICBsZXQgcGFyID0gIiI7DQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJhc2VJbmZvLnBhcmFOdW07IGkrKykgew0KICAgICAgICBsZXQgcCA9ICJ2YXIiICsgaSArICIsIjsNCiAgICAgICAgcGFyICs9IHA7DQogICAgICB9DQogICAgICBmdW5jdGlvblN0ciArPWJhc2VJbmZvLm5hbWUgKyAiKCIgKyBwYXIuc3Vic3RyaW5nKDAsIHBhci5sZW5ndGggLSAxKSArICIpe1xuIjsNCiAgICAgIGZ1bmN0aW9uU3RyICs9ICJcdFxuIjsNCiAgICAgIGZ1bmN0aW9uU3RyICs9ICJ9IjsNCiAgICAgIHRoaXMuZm9ybS5leHByZXNzaW9uID0gZnVuY3Rpb25TdHI7DQogICAgfSwNCiAgICBjcmVhdGVSZXN1bHRTdHIoYmFzZUluZm8pIHsNCiAgICAgIGxldCBwYXIgPSAiIjsNCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmFzZUluZm8ucGFyYU51bTsgaSsrKSB7DQogICAgICAgIGxldCBwID0gInZhciIgKyBpICsgIiwiOw0KICAgICAgICBwYXIgKz0gcDsNCiAgICAgIH0NCiAgICAgIHRoaXMucmVzdWx0U3RyID0NCiAgICAgICAgIlxuIHJlc3VsdCA9ICIgKw0KICAgICAgICBiYXNlSW5mby5uYW1lICsNCiAgICAgICAgIigiICsNCiAgICAgICAgcGFyLnN1YnN0cmluZygwLCBwYXIubGVuZ3RoIC0gMSkgKw0KICAgICAgICAiKTtcbiI7DQogICAgICB0aGlzLnJlc3VsdFN0ciArPSAicmV0dXJuIHJlc3VsdDsiOw0KICAgIH0sDQogICAgY3JlYXRlRGF0YVN0cihiYXNlSW5mbykgew0KICAgICAgbGV0IGRhdGFTdHIgPSB7fTsNCiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgYmFzZUluZm8ucGFyYU51bTsgaisrKSB7DQogICAgICAgIGxldCBwYXJhbU5hbWUgPSAidmFyIiArIGo7DQogICAgICAgIGRhdGFTdHJbcGFyYW1OYW1lXSA9ICIiOw0KICAgICAgfQ0KICAgICAgdGhpcy5mb3JtLmRhdGEgPSBKU09OLnN0cmluZ2lmeShkYXRhU3RyKTsNCiAgICAgIGNvbnNvbGUubG9nKGRhdGFTdHIpOw0KICAgIH0sDQogICAgaGFuZGxlU2VhcmNoKCkgew0KICAgICAgdGhpcy4kcmVmcy5wYWdlLnJlbG9hZCgpOw0KICAgIH0sDQogICAgaGFuZGxlRGVsZXRlKGlkKSB7fSwNCiAgICBydW5FeHByZXNzaW9uKCkgew0KICAgICAgLypsZXQgY2hlY2sgPSB0aGlzLmZ1bmN0aW9uRW50aXR5Q2hlY2soKTsNCiAgICAgICAgaWYoY2hlY2sgPT09IDApew0KICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfSovDQogICAgICBsZXQgb2JqID0gSlNPTi5wYXJzZSh0aGlzLmZvcm0uZGF0YSk7DQogICAgICBsZXQgYWxsRXhwcmVzc2lvbiA9IHRoaXMuZm9ybS5leHByZXNzaW9uICsgdGhpcy5yZXN1bHRTdHI7DQogICAgICBsZXQgdm8gPSB7DQogICAgICAgIGV4cHJlc3Npb25TdHI6IGFsbEV4cHJlc3Npb24sDQogICAgICAgIGRhdGFKc29uU3RyOiBvYmoNCiAgICAgIH07DQogICAgICBleGVjdXRlRnVuY3Rpb24odm8pDQogICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7DQogICAgICAgICAgbGV0IHJlc3VsdCA9IHJlc3BvbnNlLmRhdGE7DQogICAgICAgICAgdGhpcy5mb3JtLnJlc3VsdCA9IHJlc3VsdC5yZXN1bHQ7DQogICAgICAgICAgdGhpcy5mb3JtLmNvbnNvbGUgPSByZXN1bHQub3V0Ow0KICAgICAgICB9KQ0KICAgICAgICAuY2F0Y2goZXJyID0+IHsNCiAgICAgICAgICB0aGlzLmZvcm0ucmVzdWx0ID0gIiI7DQogICAgICAgICAgdGhpcy5mb3JtLmNvbnNvbGUgPSBlcnIudG9TdHJpbmcoKTsNCiAgICAgICAgfSk7DQogICAgfSwNCiAgICByZWxlYXNlRXhwcmVzc2lvbigpIHsNCg0KICAgICAgaWYgKHRoaXMuZnVuY3Rpb24uZnVuY3Rpb25FbnRpdHkpIHsNCiAgICAgICAgaWYgKHRoaXMuZnVuY3Rpb24uc3RhdGUgPT0gIjIiKSB7DQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgICAgbWVzc2FnZTogdGhpcy4kdCgicnVsZUZ1bmN0aW9uVGVzdC5jaGVja0luZm8iKSwNCiAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciDQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICAvKmxldCBjaGVjayA9IHRoaXMuZnVuY3Rpb25FbnRpdHlDaGVjaygpOw0KICAgICAgICAgICAgaWYoY2hlY2sgPT09IDApew0KICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9Ki8NCiAgICAgICAgbGV0IHZvID0gew0KICAgICAgICAgIGZ1bmN0aW9uSWQ6IHRoaXMuZm9ybS5pZCwNCiAgICAgICAgICBzdGF0ZTogIjEiDQogICAgICAgIH07DQogICAgICAgIHRlc3RDb21wbGV0ZUZ1bmN0aW9uKHZvKS50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7DQogICAgICAgICAgaWYgKHJlc3BvbnNlLmNvZGUgPT0gMjAwKSB7DQogICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IG5hbWU6ICLlh73mlbDnrqHnkIYiLCBwYXJhbXM6IHt9IH0pOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlc3BvbnNlLm1lc3NhZ2UpOw0KICAgICAgICAgIH0NCiAgICAgICAgICByZXR1cm47DQogICAgICAgIH0pOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgbWVzc2FnZTogdGhpcy4kdCgicnVsZUZ1bmN0aW9uVGVzdC50ZXN0Q2hlY2siKSwNCiAgICAgICAgICB0eXBlOiAid2FybmluZyINCiAgICAgICAgfSk7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICB9LA0KICAgIGZ1bmN0aW9uRW50aXR5Q2hlY2soKSB7DQogICAgICAvLyBsZXQgcmVndHggPSAvKD88PWZ1bmN0aW9uKS4qPyg/PVwoKS87DQogICAgICBsZXQgcmVndHggPSAgbmV3IFJlZ0V4cCgiKD88PWZ1bmN0aW9uKS4qPyg/PVxcKCkiKQ0KICAgICAgbGV0IGZ1bmN0aW9uTmFtZSA9IHJlZ3R4LmV4ZWModGhpcy5mb3JtLmV4cHJlc3Npb24pOzsNCiAgICAgIGlmICh0aGlzLmZvcm0uZnVuY3Rpb25OYW1lICE9IGZ1bmN0aW9uTmFtZVswXS50cmltKCkpIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcih0aGlzLiR0KCJydWxlRnVuY3Rpb25UZXN0LkVudGl0eUNoZWNrIikpOw0KICAgICAgICByZXR1cm4gMDsNCiAgICAgIH0gZWxzZSBpZiAoIXRoaXMuZm9ybS5kYXRhKSB7DQogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IodGhpcy4kdCgicnVsZUZ1bmN0aW9uVGVzdC5kYXRhQ2hlY2siKSk7DQogICAgICAgIHJldHVybiAwOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIDE7DQogICAgICB9DQogICAgfSwNCiAgICByZXNldEZvcm0oKSB7DQogICAgICB0aGlzLmZvcm0gPSB7DQogICAgICAgIC8v6KGo5Y2V5pWw5o2u5LiO5ZCO56uv5a6e5L2T57G75a+55bqUDQogICAgICAgIGlkOiAiIiwgLy/kuLvplK5JRA0KICAgICAgICB4eHh4OiAiIg0KICAgICAgfTsNCiAgICB9LA0KICAgIGdvQmFja0luZm8oKSB7DQogICAgICAvL+i3s+i9rOWIsOeItumhtemdog0KICAgICAgY2xvc2VWaXNpdFRhZygpOw0KICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBuYW1lOiAi5Ye95pWw566h55CGIiB9KTsNCiAgICB9LA0KICAgIHVwZGF0ZU1WRUwoKSB7DQogICAgICB0aGlzLnVwZGF0ZVN0YXRlID0gZmFsc2U7DQogICAgfSwNCiAgICBzdWJtaXQoKSB7DQogICAgICBpZiAodGhpcy5mdW5jdGlvbi5zdGF0ZSAhPSAiMiIgJiYgdGhpcy5mb3JtLmV4cHJlc3Npb24pIHsNCiAgICAgICAgICAgIHRoaXMuZnVuY3Rpb24uZnVuY3Rpb25FbnRpdHkgPSB0aGlzLmZvcm0uZXhwcmVzc2lvbjsNCiAgICAgICAgICAgIHVwZGF0ZVJ1bGVGdW5jdGlvbih0aGlzLmZ1bmN0aW9uKS50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmNvZGUgPT0gMjAwKSB7DQogICAgICAgICAgICAgICAgICB0aGlzLmZ1bmN0aW9uID0gcmVzcG9uc2UuZGF0YTsNCiAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybS5leHByZXNzaW9uID0gdGhpcy5mdW5jdGlvbi5mdW5jdGlvbkVudGl0eTsNCiAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5U3VjY2VzcyhyZXNwb25zZS5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdGUgPSB0cnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKHRoaXMuJHQoInJ1bGVGdW5jdGlvblRlc3QudXBkYXRlSW5mbyIpKTsNCiAgICAgIH0NCiAgICB9DQogIH0NCn07DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/ibrms/objectManagement/functionTest","sourcesContent":["<template>\r\n  <cus-wraper>\r\n    <cus-page-title-back @backTo=\"goBackInfo\" :label=\"$t('ruleFunctionTest.mvel')\" />\r\n    <el-row>\r\n      <span class=\"formtitle\" style=\"font-weight:blod\">\r\n        <el-divider direction=\"vertical\" class=\"divider\"></el-divider>\r\n        <span>{{$t('ruleFunctionTest.info')}}</span>\r\n      </span>\r\n      <span style=\"margin-left: 5px;\">\r\n        <el-link\r\n          class=\"updateRule\"\r\n          type=\"primary\"\r\n          style=\"border-bottom:dashed 1px;\"\r\n          :disabled=\"(updateState ? false:'disabled')\"\r\n          @click=\"updateMVEL()\"\r\n        >{{$t('ruleFunctionTest.updateFunction')}}</el-link>\r\n      </span>\r\n    </el-row>\r\n\r\n    <el-form :model=\"form\" label-width=\"160px\" ref=\"form\" style=\"width: 98%\">\r\n      <div>\r\n        <el-row>\r\n          <div style=\"float: right;margin-right: 20px;\">\r\n            <el-button\r\n              size=\"mini\"\r\n              type=\"primary\"\r\n              icon=\"el-icon-caret-right\"\r\n              @click=\"runExpression\"\r\n            >{{$t('ruleFunctionTest.run')}}</el-button>\r\n            <el-button size=\"mini\" type=\"primary\" @click=\"submit\">\r\n              <i class=\"el-icon-success el-icon--left\"></i>\r\n              {{ this.function.functionEntity?$t('table.update'):$t('table.save')}}\r\n            </el-button>\r\n          </div>\r\n        </el-row>\r\n        <br />\r\n      </div>\r\n      <el-row :gutter=\"10\" justify=\"center\" type=\"flex\">\r\n        <el-col :span=\"14\">\r\n          <label style=\"font-size: 12px !important;\">{{$t('ruleFunctionTest.code')}}</label>\r\n          <textarea\r\n            class=\"el-textarea codeArea\"\r\n            v-model=\"form.expression\"\r\n            :disabled=\"(updateState ?'disabled':false)\"\r\n          ></textarea>\r\n        </el-col>\r\n        <el-col :span=\"10\">\r\n          <label style=\"font-size: 12px !important;\">{{$t('ruleFunctionTest.data')}}</label>\r\n          <textarea class=\"el-textarea codeArea\" v-model=\"form.data\"></textarea>\r\n        </el-col>\r\n      </el-row>\r\n      <br />\r\n      <el-row :gutter=\"10\" justify=\"center\" type=\"flex\">\r\n        <el-col :span=\"24\">\r\n          <el-input type=\"text\" v-model=\"form.result\" readonly style=\"font-size: 12px !important;\">\r\n            <template slot=\"prepend\">{{$t('ruleFunctionTest.result')}}</template>\r\n          </el-input>\r\n        </el-col>\r\n      </el-row>\r\n      <br />\r\n\r\n      <el-row :gutter=\"10\" justify=\"center\" type=\"flex\">\r\n        <el-col :span=\"24\">\r\n          <label  style=\"font-size: 12px !important;\">{{$t('ruleFunctionTest.console')}}</label>\r\n          <textarea class=\"el-textarea controlArea\" :model=\"form.console\" readonly :disabled=\"true\" style=\"font-size: 12px !important;\">{{form.console}}</textarea>\r\n        </el-col>\r\n      </el-row>\r\n      <br />\r\n      <el-button\r\n        size=\"mini\"\r\n        type=\"primary\"\r\n        @click=\"releaseExpression\"\r\n        style=\"font-size: 12px !important;float: right;margin-right: 20px;\"\r\n      >\r\n        <i class=\"el-icon-success el-icon--left\"></i>\r\n        {{$t('ruleFunctionTest.release')}}\r\n      </el-button>\r\n    </el-form>\r\n  </cus-wraper>\r\n</template>\r\n<script>\r\nimport { mapGetters } from \"vuex\";\r\nimport {\r\n  findRuleFunction,\r\n  executeFunction,\r\n  releaseFunction,\r\n  testCompleteFunction,\r\n  updateRuleFunction\r\n} from \"@/api/ibrms/ruleFunction\";\r\nimport { closeVisitTag } from \"@/utils/tagsView\";\r\n\r\nexport default {\r\n  name: \"ruleFunctionTest\",\r\n  data() {\r\n    return {\r\n      form: {\r\n        //表单数据与后端实体类对应\r\n        id: \"\", //主键ID\r\n        functionName: \"\",\r\n        functionEntity: \"\",\r\n        expression: \"\",\r\n        data: \"\",\r\n        result: \"\",\r\n        console: \"\"\r\n      },\r\n      radio: false,\r\n      functionId: \"\",\r\n      resultStr: \"\",\r\n      //检验规则\r\n      rules: {},\r\n      updateState: true,\r\n      function: {}\r\n    };\r\n  },\r\n\r\n  computed: {},\r\n  created() {\r\n    let baseInfo = this.$route.params.baseInfo;\r\n    this.function = baseInfo;\r\n    console.log(\"baseInfo\", baseInfo);\r\n    this.form.id = baseInfo.id;\r\n    this.form.functionName = baseInfo.name;\r\n    findRuleFunction(baseInfo.id).then(response => {\r\n      if (\r\n        response.data.functionEntity &&\r\n        response.data.functionEntity.length > 0\r\n      ) {\r\n        this.form.expression = response.data.functionEntity;\r\n      } else {\r\n        this.createFunctionModelAndDataStr(baseInfo);\r\n      }\r\n    });\r\n    this.createDataStr(baseInfo);\r\n    this.createResultStr(baseInfo);\r\n  },\r\n  methods: {\r\n    createFunctionModelAndDataStr(baseInfo) {\r\n      let functionStr = \"import java.lang.Math;\\t\\n function \";\r\n      let par = \"\";\r\n      for (let i = 0; i < baseInfo.paraNum; i++) {\r\n        let p = \"var\" + i + \",\";\r\n        par += p;\r\n      }\r\n      functionStr +=baseInfo.name + \"(\" + par.substring(0, par.length - 1) + \"){\\n\";\r\n      functionStr += \"\\t\\n\";\r\n      functionStr += \"}\";\r\n      this.form.expression = functionStr;\r\n    },\r\n    createResultStr(baseInfo) {\r\n      let par = \"\";\r\n      for (let i = 0; i < baseInfo.paraNum; i++) {\r\n        let p = \"var\" + i + \",\";\r\n        par += p;\r\n      }\r\n      this.resultStr =\r\n        \"\\n result = \" +\r\n        baseInfo.name +\r\n        \"(\" +\r\n        par.substring(0, par.length - 1) +\r\n        \");\\n\";\r\n      this.resultStr += \"return result;\";\r\n    },\r\n    createDataStr(baseInfo) {\r\n      let dataStr = {};\r\n      for (let j = 0; j < baseInfo.paraNum; j++) {\r\n        let paramName = \"var\" + j;\r\n        dataStr[paramName] = \"\";\r\n      }\r\n      this.form.data = JSON.stringify(dataStr);\r\n      console.log(dataStr);\r\n    },\r\n    handleSearch() {\r\n      this.$refs.page.reload();\r\n    },\r\n    handleDelete(id) {},\r\n    runExpression() {\r\n      /*let check = this.functionEntityCheck();\r\n        if(check === 0){\r\n          return;\r\n        }*/\r\n      let obj = JSON.parse(this.form.data);\r\n      let allExpression = this.form.expression + this.resultStr;\r\n      let vo = {\r\n        expressionStr: allExpression,\r\n        dataJsonStr: obj\r\n      };\r\n      executeFunction(vo)\r\n        .then(response => {\r\n          console.log(response);\r\n          let result = response.data;\r\n          this.form.result = result.result;\r\n          this.form.console = result.out;\r\n        })\r\n        .catch(err => {\r\n          this.form.result = \"\";\r\n          this.form.console = err.toString();\r\n        });\r\n    },\r\n    releaseExpression() {\r\n\r\n      if (this.function.functionEntity) {\r\n        if (this.function.state == \"2\") {\r\n            this.$message({\r\n              message: this.$t(\"ruleFunctionTest.checkInfo\"),\r\n              type: \"warning\"\r\n            });\r\n            return;\r\n        }\r\n        /*let check = this.functionEntityCheck();\r\n            if(check === 0){\r\n              return;\r\n            }*/\r\n        let vo = {\r\n          functionId: this.form.id,\r\n          state: \"1\"\r\n        };\r\n        testCompleteFunction(vo).then(response => {\r\n          console.log(response);\r\n          if (response.code == 200) {\r\n            this.$router.push({ name: \"函数管理\", params: {} });\r\n          } else {\r\n            this.$message.error(response.message);\r\n          }\r\n          return;\r\n        });\r\n      } else {\r\n        this.$message({\r\n          message: this.$t(\"ruleFunctionTest.testCheck\"),\r\n          type: \"warning\"\r\n        });\r\n        return;\r\n      }\r\n    },\r\n    functionEntityCheck() {\r\n      // let regtx = /(?<=function).*?(?=\\()/;\r\n      let regtx =  new RegExp(\"(?<=function).*?(?=\\\\()\")\r\n      let functionName = regtx.exec(this.form.expression);;\r\n      if (this.form.functionName != functionName[0].trim()) {\r\n        this.$message.error(this.$t(\"ruleFunctionTest.EntityCheck\"));\r\n        return 0;\r\n      } else if (!this.form.data) {\r\n        this.$message.error(this.$t(\"ruleFunctionTest.dataCheck\"));\r\n        return 0;\r\n      } else {\r\n        return 1;\r\n      }\r\n    },\r\n    resetForm() {\r\n      this.form = {\r\n        //表单数据与后端实体类对应\r\n        id: \"\", //主键ID\r\n        xxxx: \"\"\r\n      };\r\n    },\r\n    goBackInfo() {\r\n      //跳转到父页面\r\n      closeVisitTag();\r\n      this.$router.push({ name: \"函数管理\" });\r\n    },\r\n    updateMVEL() {\r\n      this.updateState = false;\r\n    },\r\n    submit() {\r\n      if (this.function.state != \"2\" && this.form.expression) {\r\n            this.function.functionEntity = this.form.expression;\r\n            updateRuleFunction(this.function).then(response => {\r\n              if (response.code == 200) {\r\n                  this.function = response.data;\r\n                  this.form.expression = this.function.functionEntity;\r\n                  this.notifySuccess(response.message);\r\n                  this.updateState = true;\r\n                }\r\n            });\r\n      } else {\r\n        this.$message.warning(this.$t(\"ruleFunctionTest.updateInfo\"));\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.showDiv {\r\n  width: 90%;\r\n  height: 100%;\r\n  margin-top: -40px;\r\n  margin-left: -40px;\r\n  position: absolute;\r\n  background: #ffffff00;\r\n  z-index: 999;\r\n}\r\n/*.el-textarea{*/\r\n/*  textarea{*/\r\n/*    height: 300px;*/\r\n/*    overflow: auto;*/\r\n/*    resize: none;*/\r\n/*  }*/\r\n/*}*/\r\n.codeArea {\r\n  height: 225px !important;\r\n  min-height: 225px !important;\r\n  overflow: auto;\r\n  resize: none;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.12), 0 0 6px rgba(0, 0, 0, 0.04);\r\n}\r\n.controlArea {\r\n  height: 100px !important;\r\n  max-height: 100px;\r\n  overflow: auto;\r\n  resize: none;\r\n}\r\n</style>\r\n"]}]}