{"remainingRequest":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\product-testing\\new-single-test\\casedef\\index.vue?vue&type=style&index=0&id=0abd114c&lang=scss&scoped=true&","dependencies":[{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\product-testing\\new-single-test\\casedef\\index.vue","mtime":1610950391295},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\css-loader\\dist\\cjs.js","mtime":1706753188288},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1706753191924},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\postcss-loader\\src\\index.js","mtime":1706753189537},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1706753187424},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1706753190941}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCg0KLmRpdmlkZXIgew0KICBiYWNrZ3JvdW5kLWNvbG9yOiBibGFjazsNCiAgbWFyZ2luLWxlZnQ6IDRweDsNCn0NCg0KLmZvcm10aXRsZSB7DQogIHBhZGRpbmctdG9wOiAxMHB4Ow0KICBmb250LXNpemU6IDE1cHg7DQogIGZvbnQtd2VpZ2h0OiBib2xkOw0KICBjdXJzb3I6IHBvaW50ZXI7DQp9DQoNCi5kaXZjbGFzcyB7DQogIGJvcmRlcjogMXB4IHNvbGlkICMwMDAwMDAyZTsNCiAgd2lkdGg6IDczNXB4Ow0KICBoZWlnaHQ6IGF1dG87DQp9DQoNCi5jc3Qgew0KICB3aWR0aDogODBweDsNCiAgYm9yZGVyOiAwOw0KfQ0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2wCA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/product-testing/new-single-test/casedef","sourcesContent":["<template>\r\n  <cus-wraper>\r\n\r\n    <cus-page-title-back :label=\"$t('productTestingNewCaseDefinition.CaseDefinition')\" @backTo=\"backPage\"/>\r\n\r\n    <cus-commodity-info></cus-commodity-info>\r\n\r\n    <div style=\"margin: 20px 30px 30px 0px\">\r\n      <!-- 产品信息 -->\r\n      <el-row class=\"row-bg\" justify=\"left\" type=\"flex\">\r\n        <el-col :span=\"6\">\r\n          <el-button icon=\"el-icon-cloudy\" size=\"small\" type=\"primary\" @click=\"openUploadDialog\">\r\n            {{ $t('productTestingNewCaseDefinition.testCaseUpload') }}\r\n          </el-button>\r\n        </el-col>\r\n      </el-row>\r\n    </div>\r\n    <!--测试案例-->\r\n\r\n    <cus-table-title :label=\"$t('productTestingNewCaseDefinition.testCase')\"/>\r\n\r\n    <el-table :data=\"configs1\" align=\"center\" border class=\"wraper-table\" element-loading-text=\"Loading\" fit\r\n              highlight-current-row\r\n              size=\"mini\">\r\n      <el-table-column :label=\"$t('table.select')\" align=\"center\" width=\"50\">\r\n        <template slot-scope=\"scope\">\r\n          <el-radio-group v-model=\"selectConfigs1\">\r\n            <el-radio :label=\"scope.row\" @change=\"handleUpdateCase\">{{ '' }}</el-radio>\r\n          </el-radio-group>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('table.id')\" align=\"center\" type=\"index\"></el-table-column>\r\n      <el-table-column :label=\"$t('productTestingNewCaseDefinition.testCaseCode')\" align=\"center\"\r\n                       prop=\"pdTestCaseCode\"></el-table-column>\r\n      <el-table-column :label=\"$t('productTestingNewCaseDefinition.testCaseType')\" align=\"center\"\r\n                       prop=\"pdTestCaseType\">\r\n        <template v-slot=\"scope\">{{ scope.row.pdTestCaseType | filterCaseType }}</template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('productTestingNewDetails.testPoint')\" align=\"center\"\r\n                       prop=\"pdFuncDesc\">\r\n        <template slot-scope=\"scope\">\r\n          <el-popover v-if=\"scope.row.pdFuncDesc.length > 1\" placement=\"top\" trigger=\"hover\">\r\n            <span v-for=\"item in scope.row.pdFuncDesc\">{{ item.pd_test_func_desc }}、</span>\r\n            <div slot=\"reference\" class=\"name-wrapper\">\r\n              <el-tag size=\"medium\">{{ scope.row.pdFuncDesc[0].pd_test_func_desc }}...</el-tag>\r\n            </div>\r\n          </el-popover>\r\n          <el-tag v-if=\"scope.row.pdFuncDesc.length === 1\" size=\"medium\">{{ scope.row.pdFuncDesc[0].pd_test_func_desc }}\r\n          </el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('productTestingNewDetails.testCaseDefType')\" align=\"center\"\r\n                       prop=\"pdTestCaseDefinition\">\r\n        <template v-slot=\"scope\">{{ scope.row.pdTestCaseDefinition | filterCaseDefinition }}</template>\r\n      </el-table-column>\r\n\r\n      <el-table-column :label=\"$t('productTestingNewDetails.creatDate')\" align=\"center\" fixed=\"right\"\r\n                       prop=\"createTime\"></el-table-column>\r\n\r\n      <el-table-column :label=\"$t('table.actions')\" align=\"center\" fixed=\"right\" width=\"150\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button v-if=\"scope.row.pdTestCaseDefinition === '2'\" v-auth=\"'new-single-test:downloadCase'\" class=\"filter-button\"\r\n                     icon=\"el-icon-download\" size=\"mini\" @click=\"downloadCaseDef(scope.row)\">\r\n          </el-button>\r\n          <cus-del-btn v-auth=\"'new-single-test:deleteCase'\" :disabled=\"scope.row.pdTestStatus==='1'\"\r\n                       @ok=\"deleteCaseDef(scope.row.id)\"/>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <cus-pagination ref=\"page1\" v-model=\"configs1\" :pageSize=\"10\" :params=\"params1\"\r\n                    url=\"/new-single-test/base/queryPdTestCase\"/>\r\n\r\n\r\n    <cus-form-title :first=\"true\" :label=\"$t('productTestingNewCaseDefinition.CaseDefinition')\"/>\r\n    <el-form ref=\"caseDefForm\" :model=\"CaseDefinition\" :rules=\"defRules\" class=\"demo-ruleForm\"\r\n             label-width=\"auto\" style=\"margin-left: 30px\">\r\n\r\n      <el-form-item :label=\"$t('productTestingNewCaseDefinition.testPoint')\" prop=\"testPoint\">\r\n        <el-select v-model=\"CaseDefinition.testPoint\" :placeholder=\"$t('i18nView.selectPlaceholder')\" class=\"filter-item\" clearable multiple\r\n                   style=\"width: 300px\">\r\n          <el-option v-for=\"item in funcSelect\" :key=\"item.id\" :label=\"item.label\"\r\n                     :value=\"item.value\"></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n\r\n\r\n      <el-form-item :label=\"$t('productTestingNewCaseDefinition.testCaseDesc')\" prop=\"pdTestCaseDesc\">\r\n        <el-input v-model=\"CaseDefinition.pdTestCaseDesc\" :autosize=\"{ minRows: 3, maxRows:6}\" maxlength=\"100\"\r\n                  :placeholder=\"$t('i18nView.pleInput')\" show-word-limit style=\"width: 300px\"\r\n                  type=\"textarea\"></el-input>\r\n      </el-form-item>\r\n\r\n    </el-form>\r\n\r\n    <cus-table-title :label=\"$t('productTestingNewCaseDefinition.customer')\"/>\r\n\r\n    <el-table :data=\"customers\" align=\"center\" border class=\"wraper-table\" element-loading-text=\"Loading\" fit\r\n              highlight-current-row\r\n              size=\"mini\">\r\n      <el-table-column :label=\"$t('table.select')\" width=\"50\"  align=\"center\">\r\n        <template slot-scope=\"scope\">\r\n          <el-radio-group v-model=\"selectConfigs2\">\r\n            <el-radio :label=\"scope.row\" @change=\"handleUpdateCustomer\">{{ '' }}</el-radio>\r\n          </el-radio-group>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('table.id')\" align=\"center\" type=\"index\"></el-table-column>\r\n      <el-table-column :label=\"$t('productTestingNewCaseDefinition.customerrole')\" align=\"center\"\r\n                       prop=\"customerRole\"></el-table-column>\r\n      <el-table-column :label=\"$t('productTestingNewCaseDefinition.customerseq')\" align=\"center\"\r\n                       prop=\"\">\r\n        <template v-slot=\"scope\">{{ filterSeq(scope.row) }}</template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('productTestingNewCaseDefinition.customerno')\" align=\"center\"\r\n      >\r\n        <template v-slot=\"scope\">{{ filterCustomerNo(scope.row) }}</template>\r\n\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('productTestingNewCaseDefinition.customersex')\" align=\"center\"\r\n                       prop=\"\">\r\n        <template v-slot=\"scope\">{{ filterSex(scope.row) | filterSexType }}</template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('productTestingNewCaseDefinition.customerage')\" align=\"center\" prop=\"\">\r\n        <template v-slot=\"scope\">{{ filterAge(scope.row) }}</template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('table.actions')\" align=\"center\" width=\"80px\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button size=\"mini\" type=\"danger\" @click=\"delCustomer(scope.row)\">-</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <!--被保人资料-->\r\n\r\n    <cus-form-title :label=\"$t('productTestingNewDetails.insured')\"/>\r\n\r\n    <el-form ref=\"insuredForm\"  :model=\"insured\" :rules=\"insuredRules\" label-width=\"auto\">\r\n      <el-row :gutter=\"10\">\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.insuredSeq')\" prop=\"insuredSeq\"\r\n                        required>\r\n            <el-input v-model.number=\"insured.insuredSeq\" clearable filterable type=\"number\">\r\n            </el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.customerno')\">\r\n            <el-input v-model=\"insured.insuredNo\" clearable disabled readonly></el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row :gutter=\"10\">\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.salary')\">\r\n            <el-input v-model.number=\"insured.salary\" clearable type=\"number\"/>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.customersex')\" prop=\"insuredSex\">\r\n            <cus-select v-model=\"insured.insuredSex\" :codetype=\"'sex'\"/>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.customerage')\" prop=\"insuredAppAge\"\r\n                        required>\r\n            <el-input v-model.number=\"insured.insuredAppAge\" :placeholder=\"$t('pay_def.message.please_enter')\" clearable>\r\n              <el-select slot=\"append\" v-model=\"insured.ageUnit\" class=\"cst\">\r\n                <el-option :label=\"$t('i18nView.ageY')\" value=\"Y\"/>\r\n                <el-option :label=\"$t('i18nView.dayD')\" value=\"D\"/>\r\n              </el-select>\r\n            </el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row :gutter=\"10\">\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.occupationGrade')\"\r\n                        prop=\"occupationType\">\r\n            <cus-select v-model=\"insured.occupationType\" :codetype=\"'occupationtype'\" @change=\"\">\r\n            </cus-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.smokingSigns')\">\r\n            <el-switch v-model=\"insured.smokeFlag\" active-value=\"Y\" inactive-value=\"N\"></el-switch>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewDetails.relationshipWithPrincipalInsured')\"\r\n                        prop=\"relationToMInsured\">\r\n            <cus-select v-model=\"insured.relationToMInsured\" :codetype=\"'relagenttoins'\" clearable\r\n                        filterable>\r\n            </cus-select>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <el-row>\r\n        <el-col  align=\"right\">\r\n          <el-button :icon=\"this.insuredUpdateFlag? 'el-icon-success': 'el-icon-plus'\" size=\"small\"\r\n                     type=\"primary\"\r\n                     @click=\"saveInsured()\">\r\n            {{ this.insuredUpdateFlag ? $t('table.update') : $t('productTestingNewDetails.save') }}\r\n          </el-button>\r\n        </el-col>\r\n      </el-row>\r\n\r\n    </el-form>\r\n\r\n\r\n    <!--投保人资料-->\r\n    <cus-form-title :label=\"$t('productTestingNewDetails.policyholderInformation')\" :showArrow=\"true\"\r\n                    @show=\"showPolicyHolderForm\"/>\r\n\r\n    <el-form v-show=\"policyHolderFormFlag\" ref=\"policyForm\"  :model=\"policyHolder\" :rules=\"policyHolderRules\"\r\n             label-width=\"auto\">\r\n      <el-row :gutter=\"10\">\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.policyholderSeq')\" prop=\"appntSeq\"\r\n                        required>\r\n            <el-input v-model.number=\"policyHolder.appntSeq\" clearable filterable type=\"number\">\r\n            </el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.customerno')\">\r\n            <el-input v-model=\"policyHolder.appntNo\" clearable disabled readonly/>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row :gutter=\"10\">\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.salary')\">\r\n            <el-input v-model.number=\"policyHolder.salary\" clearable type=\"number\"/>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.customersex')\" prop=\"appntSex\">\r\n            <cus-select v-model=\"policyHolder.appntSex\" :codetype=\"'sex'\">\r\n            </cus-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.customerage')\" prop=\"appntAge\"\r\n                        required>\r\n            <el-input v-model.number=\"policyHolder.appntAge\" :placeholder=\"$t('pay_def.message.please_enter')\" clearable>\r\n              <el-select slot=\"append\" v-model=\"policyHolder.ageUnit\" class=\"cst\">\r\n                <el-option :label=\"$t('i18nView.ageY')\" value=\"Y\"/>\r\n                <el-option :label=\"$t('i18nView.dayD')\" value=\"D\"/>\r\n              </el-select>\r\n            </el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n        </el-col>\r\n      </el-row>\r\n      <el-row :gutter=\"10\">\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.occupationGrade')\"\r\n                        prop=\"occupationType\">\r\n            <cus-select v-model=\"policyHolder.occupationType\" :codetype=\"'occupationtype'\" @change=\"\">\r\n            </cus-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.smokingSigns')\">\r\n            <el-switch v-model=\"policyHolder.smokeFlag\" active-value=\"Y\" inactive-value=\"N\"/>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewDetails.relationshipWithTheInsured')\"\r\n                        prop=\"relationToInsured\">\r\n            <cus-select v-model=\"policyHolder.relationToInsured\" :codetype=\"'relagenttoins'\" clearable\r\n                        filterable>\r\n            </cus-select>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <el-row>\r\n        <el-col align=\"right\">\r\n          <el-button :icon=\"this.policyUpdateFlag? 'el-icon-success': 'el-icon-plus'\" size=\"small\"\r\n                     type=\"primary\"\r\n                     @click=\"savePolicyHolder\">\r\n            {{ this.policyUpdateFlag ? $t('table.update') : $t('productTestingNewDetails.save') }}\r\n          </el-button>\r\n        </el-col>\r\n      </el-row>\r\n\r\n    </el-form>\r\n\r\n\r\n    <br/>\r\n\r\n    <!--受益人资料-->\r\n    <cus-form-title :label=\"$t('productTestingNewCaseDefinition.beneficiary')\" :showArrow=\"true\"\r\n                    @show=\"showBeneficiaryForm\"/>\r\n\r\n    <el-form v-show=\"beneficiaryFormFlag\" ref=\"bnfForm\"  :model=\"beneficiary\" :rules=\"beneficiaryRules\"\r\n             label-width=\"auto\">\r\n      <el-row :gutter=\"10\">\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.bnfSeq')\" prop=\"bnfSeq\" required>\r\n            <el-input v-model.number=\"beneficiary.bnfSeq\" clearable filterable type=\"number\">\r\n            </el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.belToInsuredSeq')\" prop=\"bnfSeq\"\r\n                        required>\r\n            <el-input v-model.number=\"beneficiary.belToInsuredSeq\" clearable filterable type=\"number\">\r\n            </el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.customerno')\">\r\n            <el-input v-model=\"beneficiary.bnfNo\" clearable disabled readonly></el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row :gutter=\"10\">\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.salary')\">\r\n            <el-input v-model.number=\"beneficiary.salary\" clearable type=\"number\"/>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.customersex')\" prop=\"bnfSex\">\r\n            <cus-select v-model=\"beneficiary.bnfSex\" :codetype=\"'sex'\" @change=\"\">\r\n            </cus-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.customerage')\" prop=\"bnfAge\"\r\n                        required>\r\n            <el-input v-model.number=\"beneficiary.bnfAge\" :placeholder=\"$t('pay_def.message.please_enter')\" clearable>\r\n              <el-select slot=\"append\" v-model=\"beneficiary.ageUnit\" class=\"cst\">\r\n                <el-option :label=\"$t('i18nView.ageY')\" value=\"Y\"/>\r\n                <el-option :label=\"$t('i18nView.dayD')\" value=\"D\"/>\r\n              </el-select>\r\n            </el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n        </el-col>\r\n      </el-row>\r\n      <el-row :gutter=\"10\">\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.occupationGrade')\"\r\n                        prop=\"occupationType\">\r\n            <cus-select v-model=\"beneficiary.occupationType\" :codetype=\"'occupationtype'\" @change=\"\">\r\n            </cus-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.smokingSigns')\">\r\n            <el-switch v-model=\"beneficiary.smokeFlag\" active-value=\"Y\" inactive-value=\"N\"></el-switch>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('productTestingNewDetails.relationshipWithTheInsured')\"\r\n                        prop=\"relationToInsured\">\r\n            <cus-select v-model=\"beneficiary.relationToInsured\" :codetype=\"'relagenttoins'\" clearable\r\n                        filterable>\r\n            </cus-select>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <el-row>\r\n        <el-col  align=\"right\">\r\n          <el-button :icon=\"this.bnfUpdateFlag? 'el-icon-success': 'el-icon-plus'\" size=\"small\"\r\n                     type=\"primary\"\r\n                     @click=\"saveBeneficiary()\">\r\n            {{ this.bnfUpdateFlag ? $t('table.update') : $t('productTestingNewDetails.save') }}\r\n          </el-button>\r\n        </el-col>\r\n      </el-row>\r\n\r\n    </el-form>\r\n\r\n    <!--当前产品资料-->\r\n\r\n    <br/>\r\n\r\n    <cus-form-title :label=\"$t('productTestingNewCaseDefinition.currentProduct')\"/>\r\n\r\n\r\n    <custompage v-if=\"elementDatasShow\" :elementDatas=\"elementDatas\"></custompage>\r\n\r\n\r\n    <!-- 产品搭配 -->\r\n    <cus-form-title v-if=\"this.pdInfo.commodityType==='R'\" :label=\"$t('productTestingNewCaseDefinition.productRela')\" :showArrow=\"true\"\r\n                    @show=\"queryRelaPdData\"/>\r\n\r\n    <el-form\r\n      v-if=\"tableFlag\"\r\n      ref=\"relaPdForm\"\r\n\r\n      :model=\"relaPdForm\"\r\n      :rules=\"relaPdRules\"\r\n      label-position=\"right\"\r\n      label-width=\"auto\"\r\n      size=\"medium\"\r\n      style=\"margin-left: 13px;margin-top: 20px\"\r\n    >\r\n      <el-row :gutter=\"10\">\r\n        <el-col :span=7>\r\n          <el-form-item :label=\"$t('productTestingNewCaseDefinition.product')\" prop=\"relaPdSed\">\r\n            <el-select v-model=\"relaPdForm.relaPdSed\" clearable filterable @change=\"queryPdEdtion\">\r\n              <el-option v-for=\"item in relaPdSelect\" :label=\"item.label\" :value=\"item.value\"/>\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=7>\r\n          <el-form-item :label=\"$t('customComponents.pdEdition')\" prop=\"relaPdEditionSed\">\r\n            <el-select v-model=\"relaPdForm.relaPdEditionSed\" clearable filterable>\r\n              <el-option v-for=\"item in relaPdEditionSelect\" :label=\"item.label\" :value=\"item.value\"/>\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <cus-btn-wrapper>\r\n          <el-button icon=\"el-icon-plus\" size=\"small\"\r\n                     type=\"primary\"\r\n                     @click=\"initRelaPdTableData\">\r\n            {{ $t('table.add') }}\r\n          </el-button>\r\n        </cus-btn-wrapper>\r\n      </el-row>\r\n\r\n    </el-form>\r\n\r\n    <cus-table-title v-if=\"tableFlag\" :label=\"$t('productTestingNewCaseDefinition.relaPd')\"/>\r\n\r\n    <el-table v-if=\"tableFlag\" :data=\"configs3\" align=\"center\" border class=\"wraper-table\"\r\n              element-loading-text=\"Loading\" fit\r\n              highlight-current-row\r\n              size=\"mini\">\r\n      <el-table-column :label=\"$t('table.select')\" width=\"50\"  align=\"center\">\r\n        <template slot-scope=\"scope\">\r\n          <el-radio-group v-model=\"selectConfigs3\">\r\n            <el-radio :label=\"scope.row\" @change=\"handleRelaPd\">{{ '' }}</el-radio>\r\n          </el-radio-group>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('table.id')\" align=\"center\" type=\"index\"></el-table-column>\r\n      <el-table-column :label=\"$t('i18nView.pdCode')\" align=\"center\"\r\n                       prop=\"pdRelaItemVal\"></el-table-column>\r\n      <el-table-column :label=\"$t('i18nView.pdName')\" align=\"center\"\r\n                       prop=\"pdRelaItemName\">\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('productTestingNewCaseDefinition.defStatus')\" align=\"center\"\r\n                       prop=\"defStatus\">\r\n        <template v-slot=\"scope\">{{ scope.row.defStatus === 'Y' ? '已定义' : '未定义' }}</template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('productTestingNewCaseDefinition.relation')\" align=\"center\"\r\n                       prop=\"pdRelaVal\">\r\n        <template v-slot=\"scope\">{{ scope.row.pdRelaVal | filterRela }}</template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('table.actions')\" align=\"center\" width=\"80px\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button size=\"mini\" type=\"danger\" @click=\"delSelectRelaPd(scope.$index,scope.row)\">-</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <cus-form-title v-if=\"relaElementShow\" :label=\"$t('productTestingNewCaseDefinition.relaPd')\"/>\r\n\r\n\r\n    <custompage v-if=\"relaElementShow\" :elementDatas=\"relaElementDatas\"></custompage>\r\n\r\n\r\n    <el-row v-if=\"relaElementShow\" style=\"margin-top: 30px\">\r\n      <el-col align=\"right\">\r\n        <el-button :icon=\"this.relaUpdateFlag? 'el-icon-success': 'el-icon-plus'\" size=\"small\"\r\n                   type=\"primary\"\r\n                   @click=\"saveRelaPdPageElement\">\r\n          {{ this.relaUpdateFlag ? $t('table.update') : $t('productTestingNewDetails.save') }}\r\n        </el-button>\r\n      </el-col>\r\n    </el-row>\r\n\r\n    <el-row style=\"margin-top: 35px\">\r\n      <el-col  align=\"right\">\r\n        <el-button icon=\"el-icon-success\" size=\"small\"\r\n                   type=\"primary\"\r\n                   @click=\"saveCaseDef\">\r\n          {{ this.testCaseUpdateFlag ? $t('table.update') : $t('table.save') }}\r\n        </el-button>\r\n      </el-col>\r\n    </el-row>\r\n\r\n\r\n    <!--测试案例上传弹窗-->\r\n    <el-dialog v-dialog-drag :close-on-click-modal=\"false\" :show-close=true :visible.sync=\"dialogTableVisible1\" center\r\n               top=\"8vh\" width=\"1200px\">\r\n      <div>\r\n      <span style=\"cursor: pointer\" @click=\"back1\">\r\n        <i class=\"el-icon-back\" style=\"margin-right: 5px\">{{ $t('table.back') }}</i>\r\n      </span>\r\n        <el-divider direction=\"vertical\"></el-divider>\r\n        <label>{{ $t('productTestingNewCaseDefinition.testCaseNewUpload') }}</label>\r\n      </div>\r\n      <hr>\r\n      <br/>\r\n      <cus-commodity-info></cus-commodity-info>\r\n\r\n      <el-row style=\"margin-top: 15px;margin-bottom: 15px\">\r\n        <el-col :span=\"24\" align=\"left\">\r\n          <el-button v-auth=\"'new-single-test:downloadTemplate'\" icon=\"el-icon-download\" size=\"small\"\r\n                     style=\"width: 130px\"\r\n                     type=\"primary\" @click=\"templateDownload\">\r\n            {{ $t('productTestingNewCaseDefinition.templateDownload') }}\r\n          </el-button>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <div align=\"left\" class=\"divclass\">\r\n        <div style=\"margin-left: 18px;margin-top: 18px;margin-bottom: 18px\">\r\n          <el-form id=\"uploadForm\">\r\n            <el-form-item>\r\n              <el-upload ref=\"upload\" :auto-upload=\"false\" :file-list=\"fileList\" :limit=\"1\"\r\n                         :on-change=\"handleChange\" :on-remove=\"handleRemove\" action=\"\" drag multiple>\r\n                <i class=\"el-icon-upload\"></i>\r\n                <div class=\"el-upload__text\">{{$t('i18nView.uploadText1')}}<em>{{$t('i18nView.uploadText2')}}</em></div>\r\n                <div class=\"el-upload__text\">{{$t('i18nView.chooseOverClick')}}\"{{ $t('table.upload') }}\"{{$t('i18nView.button')}}</div>\r\n                <div slot=\"tip\" class=\"el-upload__tip\">{{$t('i18nView.onlyUploadModelFile')}}</div>\r\n              </el-upload>\r\n\r\n            </el-form-item>\r\n          </el-form>\r\n        </div>\r\n      </div>\r\n      <el-row style=\"margin-top: 35px\">\r\n        <el-col :span=\"24\" align=\"right\">\r\n          <el-button icon=\"el-icon-upload\" size=\"small\" style=\"width: 130px\" type=\"primary\" @click=\"testCaseUpload\">\r\n            {{ $t('productTestingNewCaseDefinition.upload') }}\r\n          </el-button>\r\n        </el-col>\r\n      </el-row>\r\n    </el-dialog>\r\n  </cus-wraper>\r\n</template>\r\n<script>\r\n\r\nimport {\r\n  deleteCase,\r\n  downloadCaseDef,\r\n  downloadCaseTemplate,\r\n  initElement,\r\n  queryCustomerNo,\r\n  queryPdTestFunc,\r\n  queryRelaPd,\r\n  saveCaseDef,\r\n  uploadTestCase\r\n} from '@/api/pdtest/productTestingNew'\r\n\r\nimport custompage from '@/views/product-testing/new-single-test/custompage'\r\n\r\n\r\nlet _this\r\nexport default {\r\n  name: 'productTestingNewCaseDefinition',\r\n  filters: {\r\n    filterCaseType(code) {\r\n      return _this.testCaseType[code]\r\n    },\r\n    filterCaseDefinition(code) {\r\n      return _this.testCaseDefinition[code]\r\n    },\r\n    filterSexType(code) {\r\n      return _this.getCodeName('sex', code, true)\r\n    }, filterRela(code) {\r\n      return _this.getCodeName('insuranceRelationship', code)\r\n    },\r\n    filterRelationToInsured(code) {\r\n      return _this.getCodeName('relagenttoins', code)\r\n    }\r\n  },\r\n  data() {\r\n    let checkAge = (rule, value, callback) => {\r\n      if (!value) {\r\n        return callback(new Error(this.$t('productTestingNewCaseDefinition.AppntAgemsg')))\r\n      }\r\n      if (!Number.isInteger(value)) {\r\n        callback(new Error(this.$t(\"i18nView.pleaseInputNumValue\")))\r\n      } else {\r\n        if (value < 1) {\r\n          return callback(new Error(this.$t(\"i18nView.notAge\")))\r\n        } else {\r\n          callback()\r\n        }\r\n      }\r\n    }\r\n    let checkSeq = (rule, value, callback) => {\r\n      if (!value) {\r\n        return callback(new Error(this.$t('productTestingNewCaseDefinition.AppntSeqmsg')))\r\n      }\r\n      if (value < 1) {\r\n        return callback(new Error('不可小于1'))\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    _this = this\r\n    return {\r\n      testCaseType: {'1': '自动化测试', '2': '自定义测试'},\r\n      testCaseDefinition: {'1': '页面定义', '2': '上传定义'},\r\n      selectConfigs1: '',\r\n      selectConfigs2: '',\r\n      selectConfigs3: '',\r\n      funcSelect: [],\r\n      elementDatasShow: false,\r\n      elementDatas: {},\r\n      currentPdPageData: {},\r\n      elementRules: {},\r\n      configs1: [],\r\n      configs2: [],\r\n      configs3: [],\r\n      testCaseUpdateFlag: false,\r\n      relaPdList: [],\r\n      relaPdSelect: [],\r\n      relaPdEditionSelect: [],\r\n      relaPdPageEleDatas: [],\r\n      relaPdForm: {\r\n        relaPdSed: '',\r\n        relaPdEditionSed: ''\r\n      },\r\n      relaPdRules: {\r\n        relaPdSed: [{\r\n          required: true,\r\n          message: this.$t('productTestingNewCaseDefinition.relaPdmsg'),\r\n          trigger: 'change'\r\n        }],\r\n        relaPdEditionSed: [{\r\n          required: true,\r\n          message: this.$t('productTestingNewCaseDefinition.relaPdEditionmsg'),\r\n          trigger: 'change'\r\n        }]\r\n      },\r\n      relaPdCode: '',\r\n      relaPdEdition: '',\r\n      relaElementDatas: {},\r\n      relaElementShow: false,\r\n      tableFlag: false,\r\n      quickicon: 'el-icon-arrow-right',\r\n      fileList: [],\r\n      params1: {},\r\n      pdInfo: {\r\n        pdInfoId: '',\r\n        commodityType: ''\r\n      },\r\n      CaseDefinition: {\r\n        pdInfoId: '',\r\n        pdCode: '',\r\n        pdName: '',\r\n        pdEdition: '',\r\n        pdTestCaseDesc: '',\r\n        testPoint: '',\r\n        pdTestModuleCode: ''\r\n\r\n      },\r\n      defRules: {\r\n        pdTestCaseDesc: [{\r\n          required: true,\r\n          message: this.$t('productTestingNewCaseDefinition.casedescmsg'),\r\n          trigger: 'blur'\r\n        }],\r\n        testPoint: [{\r\n          required: true,\r\n          message: this.$t('productTestingNewCaseDefinition.testpointmsg'),\r\n          trigger: 'change'\r\n        }]\r\n      },\r\n      CaseDetails: {},\r\n      customers: [],\r\n      policyUpdateFlag: false,\r\n      policyHolderFormFlag: false,\r\n      policyHolder: {\r\n        pKey: '',\r\n        customerRole: '',\r\n        customerCode: 'policyholder',\r\n        appntSeq: 1,\r\n        appntAge: '',\r\n        appntNo: '',\r\n        appntSex: '',\r\n        ageUnit: 'Y',\r\n        smokeFlag: 'N',\r\n        relationToInsured: '',\r\n        occupationType: '',\r\n        salary: ''\r\n      },\r\n      policyHolderRules: {\r\n        appntSeq: [{validator: checkSeq, trigger: 'blur'}],\r\n        appntAge: [\r\n          {validator: checkAge, trigger: 'blur'}\r\n        ],\r\n        appntSex: [\r\n          {\r\n            required: true,\r\n            message: this.$t('productTestingNewCaseDefinition.AppntSexmsg'),\r\n            trigger: 'change'\r\n          }]\r\n      },\r\n      insuredUpdateFlag: false,\r\n      insured: {\r\n        pKey: '',\r\n        customerRole: '',\r\n        customerCode: 'insured',\r\n        insuredSeq: 1,\r\n        insuredAppAge: '',\r\n        ageUnit: 'Y',\r\n        insuredNo: '',\r\n        insuredSex: '',\r\n        smokeFlag: 'N',\r\n        relationToMInsured: '',\r\n        occupationType: '',\r\n        salary: ''\r\n      },\r\n      insuredRules: {\r\n        insuredSeq: [{validator: checkSeq, trigger: 'blur'}],\r\n        insuredAppAge: [{validator: checkAge, trigger: 'blur'}],\r\n        insuredSex: [{\r\n          required: true, message: this.$t('productTestingNewCaseDefinition.AppntSexmsg'), trigger: 'change'\r\n        }]\r\n      },\r\n      beneficiary: {\r\n        pKey: '',\r\n        customerRole: '',\r\n        customerCode: 'beneficiary',\r\n        bnfSeq: 1,\r\n        belToInsuredSeq: '',\r\n        bnfAge: '',\r\n        ageUnit: 'Y',\r\n        bnfNo: '',\r\n        bnfSex: '',\r\n        smokeFlag: 'N',\r\n        relationToInsured: '',\r\n        occupationType: '',\r\n        salary: ''\r\n      },\r\n      beneficiaryRules: {\r\n        bnfSeq: [{validator: checkSeq, trigger: 'blur'}],\r\n        belToInsuredSeq: [{validator: checkSeq, trigger: 'blur'}],\r\n        bnfAge: [\r\n          {validator: checkAge, trigger: 'blur'}\r\n        ],\r\n        bnfSex: [\r\n          {\r\n            required: true,\r\n            message: this.$t('productTestingNewCaseDefinition.AppntSexmsg'),\r\n            trigger: 'change'\r\n          }]\r\n      },\r\n      beneficiaryFormFlag: false,\r\n      bnfUpdateFlag: false,\r\n      relaUpdateFlag: false,\r\n      dialogTableVisible1: false,\r\n      //检验规则\r\n      rules: {}\r\n    }\r\n  },\r\n  components: {\r\n    custompage\r\n  },\r\n  computed: {},\r\n  mounted() {\r\n  },\r\n  created() {\r\n    let pdInfo = this.getJsonData('pdTestInfo')\r\n    if (pdInfo) {\r\n      this.params1.pdInfoId = pdInfo.id\r\n      this.pdInfo.pdInfoId = pdInfo.id\r\n      this.pdInfo.commodityType = pdInfo.commodityType\r\n\r\n      this.CaseDefinition.pdInfoId = pdInfo.id\r\n      this.CaseDefinition.pdCode = pdInfo.pdCode\r\n      this.CaseDefinition.pdName = pdInfo.pdName\r\n      this.CaseDefinition.pdEdition = pdInfo.pdEdition\r\n\r\n      this.initTestFuncSelect('newsingletest', pdInfo.id)\r\n      this.initElement(pdInfo.pdCode, pdInfo.id)\r\n    }\r\n  },\r\n  methods: {\r\n    filterCustomerNo(row) {\r\n      if (row.customerCode === 'policyholder') {\r\n        return row.appntNo\r\n      } else if (row.customerCode === 'insured') {\r\n        return row.insuredNo\r\n      } else if (row.customerCode === 'beneficiary') {\r\n        return row.bnfNo\r\n      }\r\n    },\r\n    filterSeq(row) {\r\n      if (row.customerCode === 'policyholder') {\r\n        return row.appntSeq\r\n      } else if (row.customerCode === 'insured') {\r\n        return row.insuredSeq\r\n      } else if (row.customerCode === 'beneficiary') {\r\n        return row.bnfSeq\r\n      }\r\n    },\r\n    filterSex(row) {\r\n      if (row.customerCode === 'policyholder') {\r\n        return row.appntSex\r\n      } else if (row.customerCode === 'insured') {\r\n        return row.insuredSex\r\n      } else if (row.customerCode === 'beneficiary') {\r\n        return row.bnfSex\r\n      }\r\n    },\r\n    filterAge(row) {\r\n      let unit = ''\r\n      if (row.ageUnit === 'Y') {\r\n        unit = '(岁)'\r\n      }\r\n      if (row.ageUnit === 'D') {\r\n        unit = '(天)'\r\n      }\r\n      if (row.customerCode === 'policyholder') {\r\n        return row.appntAge + unit\r\n      } else if (row.customerCode === 'insured') {\r\n        return row.insuredAppAge + unit\r\n      } else if (row.customerCode === 'beneficiary') {\r\n        return row.bnfAge + unit\r\n      }\r\n    },\r\n    savePolicyHolder() {\r\n      this.$refs.policyForm.validate(pass => {\r\n        if (pass) {\r\n          //查询客户号\r\n          queryCustomerNo(this.buildRequestData({\r\n            'sex': this.policyHolder.appntSex,\r\n            'age': this.policyHolder.appntAge\r\n          })).then(res => {\r\n            let customNo = res.data\r\n            if (customNo) {\r\n              this.policyHolder.appntNo = res.data\r\n              if (this.policyUpdateFlag) { //当前为更新\r\n                let currentKey = this.policyHolder.pKey\r\n                let temp = Object.assign({}, this.policyHolder)\r\n                this.customers = this.customers.map(item => item.pKey === currentKey ? temp : item)\r\n                this.policyUpdateFlag = false\r\n              } else {\r\n                this.policyHolder.pKey = 'policy' + (this.customers.length + 1)\r\n                this.policyHolder.customerRole = '投保人'\r\n                let temp = Object.assign({}, this.policyHolder)\r\n                this.customers.push(temp)\r\n              }\r\n              this.$refs.policyForm.resetFields()\r\n              this.policyHolder.appntSeq = this.policyHolder.appntSeq + 1\r\n              this.policyHolder.appntNo = ''\r\n            } else {\r\n              this.notifyError(this.$t('productTestingNewCaseDefinition.customNoErrorMsg'))\r\n            }\r\n          })\r\n        }\r\n      })\r\n    },\r\n    saveInsured() {\r\n      this.$refs['insuredForm'].validate(pass => {\r\n        if (pass) {\r\n          //查询客户号\r\n          queryCustomerNo(this.buildRequestData({\r\n            'sex': this.insured.insuredSex,\r\n            'age': this.insured.insuredAppAge\r\n          })).then(res => {\r\n            let customNo = res.data\r\n            if (customNo) {\r\n              this.insured.insuredNo = res.data\r\n              if (this.insuredUpdateFlag) { //当前为更新\r\n                let currentKey = this.insured.pKey\r\n                let temp = Object.assign({}, this.insured)\r\n                this.customers = this.customers.map(item => item.pKey === currentKey ? temp : item)\r\n                this.insuredUpdateFlag = false\r\n              } else {\r\n                this.insured.pKey = 'insured' + (this.customers.length + 1)\r\n                this.insured.customerRole = '被保人'\r\n                let temp = Object.assign({}, this.insured)\r\n                this.customers.push(temp)\r\n              }\r\n              this.$refs.insuredForm.resetFields()\r\n              this.insured.insuredSeq = this.insured.insuredSeq + 1\r\n              this.insured.insuredNo = ''\r\n            } else {\r\n              this.notifyError(this.$t('productTestingNewCaseDefinition.customNoErrorMsg'))\r\n            }\r\n          })\r\n        }\r\n      })\r\n    },\r\n    showBeneficiaryForm() {\r\n      this.beneficiaryFormFlag = !this.beneficiaryFormFlag\r\n    },\r\n    showPolicyHolderForm() {\r\n      this.policyHolderFormFlag = !this.policyHolderFormFlag\r\n    },\r\n    saveBeneficiary() {\r\n\r\n      let insuredSeq = this.beneficiary.belToInsuredSeq\r\n\r\n      this.$refs['bnfForm'].validate(pass => {\r\n        if (pass) {\r\n          //校验被保人序列存在\r\n          if (this.customers.filter(res => res.customerCode === 'insured' && res.insuredSeq === insuredSeq).length > 0) {\r\n            //查询客户号\r\n            queryCustomerNo(this.buildRequestData({\r\n              'sex': this.beneficiary.bnfSex,\r\n              'age': this.beneficiary.bnfAge\r\n            })).then(res => {\r\n              let customNo = res.data\r\n              if (customNo) {\r\n                this.beneficiary.bnfNo = res.data\r\n                if (this.bnfUpdateFlag) { //当前为更新\r\n                  let currentKey = this.beneficiary.pKey\r\n                  let temp = Object.assign({}, this.beneficiary)\r\n                  this.customers = this.customers.map(item => item.pKey === currentKey ? temp : item)\r\n                  this.bnfUpdateFlag = false\r\n                } else {\r\n                  this.beneficiary.pKey = 'bnf' + (this.customers.length + 1)\r\n                  this.beneficiary.customerRole = '受益人'\r\n                  let temp = Object.assign({}, this.beneficiary)\r\n                  this.customers.push(temp)\r\n                }\r\n                this.$refs.bnfForm.resetFields()\r\n                this.beneficiary.bnfSeq = this.insured.bnfSeq + 1\r\n                this.beneficiary.bnfNo = ''\r\n              } else {\r\n                this.notifyError(this.$t('productTestingNewCaseDefinition.customNoErrorMsg'))\r\n              }\r\n            })\r\n          } else {\r\n            this.notifyError(this.$t('productTestingNewCaseDefinition.notExistInsureSeqErrorMsg'))\r\n          }\r\n        }\r\n      })\r\n    },\r\n    delCustomer(row) {\r\n      this.customers = this.customers.filter(data => data.pKey !== row.pKey)\r\n      this.$refs.policyHolder.resetFields()\r\n    },\r\n    handleUpdateCustomer(row) {\r\n      if (row.customerCode === 'policyholder') {\r\n        this.policyHolder = Object.assign({}, row)\r\n        this.policyUpdateFlag = true\r\n      } else if (row.customerCode === 'insured') {\r\n        this.insured = Object.assign({}, row)\r\n        this.insuredUpdateFlag = true\r\n      } else if (row.customerCode === 'beneficiary') {\r\n        this.beneficiary = Object.assign({}, row)\r\n        this.bnfUpdateFlag = true\r\n      }\r\n    },\r\n    downloadCaseDef(row) {\r\n      let fileName = row.pdTestCaseCode + '上传定义.xlsm'\r\n      downloadCaseDef(this.buildRequestData({'testCasePath': row.pdTestCasePath})).then(res => {\r\n        this.downloadResponseFile(res, fileName)\r\n      })\r\n    },\r\n    deleteCaseDef(id) {\r\n      deleteCase(id).then(res => {\r\n        this.notifySuccess(this.$t('successMessage.delete'))\r\n        this.$refs.page1.reload()\r\n        this.resetCaseDef()\r\n      })\r\n    },\r\n    resetCaseDef() {\r\n      this.CaseDefinition.id = ''\r\n      this.CaseDefinition.pdTestCaseDesc = ''\r\n      this.CaseDefinition.testPoint = ''\r\n      this.testCaseUpdateFlag = false\r\n      this.customers = []\r\n      this.currentPdPageData = {}\r\n      this.relaPdPageEleDatas = []\r\n      this.configs3 = []\r\n      this.tableFlag = false\r\n      this.relaElementShow = false\r\n      this.initElement(this.CaseDefinition.pdCode, this.CaseDefinition.pdInfoId)\r\n    },\r\n    handleUpdateCase(row) {\r\n      this.testCaseUpdateFlag = true\r\n      this.CaseDefinition.id = row.id\r\n      this.CaseDefinition.pdInfoId = row.pdInfoId\r\n      this.CaseDefinition.pdCode = row.pdCode\r\n      this.CaseDefinition.pdEdition = row.pdEdition\r\n      this.CaseDefinition.pdName = row.pdName\r\n      this.CaseDefinition.pdTestCaseDesc = row.pdTestCaseDesc\r\n      this.CaseDefinition.testPoint = row.pdFuncDesc.map(data => data.pd_test_func_id)\r\n      //处理data\r\n      let pdTestCaseData = JSON.parse(row.pdTestCaseData)\r\n\r\n      let data = pdTestCaseData.testData\r\n\r\n      this.customers = data.customers\r\n      this.currentPdPageData = data.currentPdPageData\r\n      this.relaPdPageEleDatas = data.relaPdPageData\r\n\r\n      if (this.pdInfo.commodityType === 'R') {\r\n\r\n        //回显险种定义页面的栏位\r\n\r\n        //不能直接遍历赋值 需使用中间转换\r\n        let temp = JSON.parse(JSON.stringify(this.elementDatas))\r\n        temp.forEach(tem => {\r\n          tem.config.defaultValue = this.currentPdPageData[tem.vModel]\r\n        })\r\n        this.elementDatas = temp\r\n        this.queryRelaPdData()\r\n      }\r\n\r\n    },\r\n    initElement(pdCode, pdInfoId) {\r\n      let data = {\r\n        'pdCode': pdCode,\r\n        'pdInfoId': pdInfoId\r\n      }\r\n      initElement(this.buildRequestData(data)).then(response => {\r\n        this.elementDatas = response.data\r\n        this.elementDatasShow = true\r\n      })\r\n    },\r\n    queryRelaPdData() {\r\n      this.tableFlag = !this.tableFlag\r\n      if (this.tableFlag) {\r\n        let data = {'pdInfoId': this.pdInfo.pdInfoId}\r\n        queryRelaPd(this.buildRequestData(data)).then(res => {\r\n          let list = res.data\r\n          this.relaPdList = res.data\r\n          this.relaPdSelect = []\r\n          for (let i = 0; i < list.length; i++) {\r\n            let data = list[i]\r\n            this.relaPdSelect.push({\r\n              'label': data.pdRelaItemVal + ':' + data.pdRelaItemName,\r\n              'value': data.pdRelaItemVal\r\n            })\r\n          }\r\n\r\n          //回填数据\r\n          if (this.relaPdPageEleDatas && this.relaPdPageEleDatas.length > 0) {\r\n            this.configs3 = []\r\n            this.relaPdPageEleDatas.forEach(data => {\r\n              let pdCode = data.relaPdCode\r\n              let pdEdition = data.relaPdEdition\r\n              let tempData = this.relaPdList.filter(data2 => data2.pdRelaItemVal === pdCode && data2.pdRelaItemEdition === pdEdition)[0]\r\n              tempData['defStatus'] = 'Y'\r\n              this.configs3.push(tempData)\r\n            })\r\n          }\r\n        })\r\n      }\r\n    },\r\n    queryPdEdtion(val) {\r\n      this.relaPdEditionSelect = []\r\n      this.relaPdList.filter(data => data.pdRelaItemVal === val).forEach(data => {\r\n        this.relaPdEditionSelect.push({'label': data.pdRelaItemEdition, 'value': data.pdRelaItemEdition})\r\n      })\r\n      this.relaPdForm.relaPdEditionSed = ''\r\n    },\r\n    initRelaPdTableData() {\r\n      this.$refs.relaPdForm.validate(pass => {\r\n        if (pass) {\r\n          let pdCode = this.relaPdForm.relaPdSed\r\n          let pdEdition = this.relaPdForm.relaPdEditionSed\r\n          this.relaElementShow = false\r\n          let flag = this.configs3.some(data => {\r\n            return (data.pdRelaItemVal === pdCode && data.pdRelaItemEdition === pdEdition)\r\n          })\r\n          if (!flag) {\r\n            let tempData = this.relaPdList.filter(data2 => data2.pdRelaItemVal === pdCode && data2.pdRelaItemEdition === pdEdition)[0]\r\n            tempData['defStatus'] = 'N'\r\n            this.configs3.push(tempData)\r\n            this.selectConfigs3 = ''\r\n          } else {\r\n            this.notifyError(this.$t('productTestingNewCaseDefinition.relaAddMsg'))\r\n          }\r\n        }\r\n      })\r\n    },\r\n    delSelectRelaPd(index, row) {\r\n      this.relaElementShow = false\r\n      this.selectConfigs3 = ''\r\n      this.configs3.splice(index, 1)\r\n      this.relaPdPageEleDatas = this.relaPdPageEleDatas.filter(data2 => !(row.pdRelaItemVal === data2.relaPdCode && row.pdRelaItemEdition === data2.relaPdEdition))\r\n    },\r\n    saveRelaPdPageElement() {\r\n      let data = {}\r\n      let result = {}\r\n      let flag = true\r\n      for (let i = 0; i < this.relaElementDatas.length; i++) {\r\n        let data = this.relaElementDatas[i]\r\n        if (data.required) {\r\n          if (!data.config.defaultValue) {\r\n            flag = false\r\n            this.notifyError('请输入' + data.label)\r\n            break\r\n          }\r\n        }\r\n        result[data.vModel] = data.config.defaultValue\r\n      }\r\n      if (flag) {\r\n        data['relaPdCode'] = this.relaPdCode\r\n        data['relaPdEdition'] = this.relaPdEdition\r\n        data['param'] = result\r\n        if (this.relaUpdateFlag) {\r\n          this.relaPdPageEleDatas = this.relaPdPageEleDatas.map(item => (item.relaPdCode === this.relaPdCode &&\r\n            item.relaPdEdition === this.relaPdEdition) ? data : item)\r\n          this.notifySuccess(this.$t('successMessage.update'))\r\n        } else {\r\n          this.relaPdPageEleDatas.push(data)\r\n          let tempConfigs3 = JSON.parse(JSON.stringify(this.configs3))\r\n          tempConfigs3.forEach(con => {\r\n            if (con.pdRelaItemVal === this.relaPdCode && con.pdRelaItemEdition === this.relaPdEdition) {\r\n              con.defStatus = 'Y'\r\n            }\r\n          })\r\n          this.configs3 = tempConfigs3\r\n          console.log(this.configs3)\r\n          this.notifySuccess(this.$t('successMessage.add'))\r\n        }\r\n        this.relaUpdateFlag = true\r\n      }\r\n    },\r\n    handleRelaPd(row) {\r\n      this.relaPdEdition = row.pdRelaItemEdition\r\n      this.relaPdCode = row.pdRelaItemVal\r\n      let data = {\r\n        'pdCode': row.pdRelaItemVal,\r\n        'pdInfoId': row.pdRelaItemId\r\n      }\r\n      this.relaElementShow = false\r\n      this.relaUpdateFlag = false\r\n      initElement(this.buildRequestData(data)).then(response => {\r\n        this.relaElementDatas = response.data\r\n        let temp = JSON.parse(JSON.stringify(this.relaElementDatas)) //深克隆\r\n        if (this.relaElementDatas.length > 0) {\r\n          this.relaElementShow = true\r\n          //回显当前搭配产品下险种页面的数据\r\n          this.relaPdPageEleDatas.filter(reladata => reladata.relaPdCode === data.pdCode && reladata.relaPdEdition === this.relaPdEdition).forEach(temp2 => {\r\n            let param = temp2.param\r\n            temp.forEach(rela => {\r\n              rela.config.defaultValue = param[rela.vModel]\r\n              this.relaUpdateFlag = true\r\n            })\r\n          })\r\n          this.relaElementDatas = temp\r\n        }\r\n      })\r\n    },\r\n    saveCaseDef() {\r\n\r\n      this.$refs.caseDefForm.validate(pass => {\r\n        if (pass) {\r\n          if (this.customers && this.customers.length > 0) {\r\n            this.CaseDefinition['pdTestModuleCode'] = 'newsingletest'\r\n            this.CaseDefinition['data'] = {}\r\n            this.CaseDefinition.data['customers'] = this.customers\r\n            //保存产品险种定制页面信息\r\n            let result = {}\r\n            let flag = true\r\n            for (let i = 0; i < this.elementDatas.length; i++) {\r\n              let data = this.elementDatas[i]\r\n              if (data.required) {\r\n                if (!data.config.defaultValue) {\r\n                  flag = false\r\n                  this.notifyError('请输入当前产品下' + data.label)\r\n                  break\r\n                }\r\n              }\r\n              result[data.vModel] = data.config.defaultValue\r\n            }\r\n            if (flag) {\r\n              result['productCode'] = this.CaseDefinition.pdCode\r\n              result['productVersionNo'] = this.CaseDefinition.pdEdition\r\n              this.CaseDefinition.data['currentPdPageData'] = result\r\n              this.CaseDefinition.data['relaPdPageData'] = this.relaPdPageEleDatas\r\n              //保存入库\r\n              saveCaseDef(this.buildRequestData(this.CaseDefinition)).then(res => {\r\n                this.notifySuccess(this.$t('successMessage.save'))\r\n                this.$refs.page1.reload()\r\n                this.resetCaseDef()\r\n              })\r\n            }\r\n          } else {\r\n            this.notifyError('请新增测试案例数据')\r\n          }\r\n        } else {\r\n          this.focusItem()\r\n        }\r\n      })\r\n    },\r\n    initTestFuncSelect(testModuleCode, pdInfoId) {\r\n      this.funcSelect = []\r\n      queryPdTestFunc(this.buildRequestData({'testModuleCode': testModuleCode, 'pdInfoId': pdInfoId})).then(res => {\r\n        let funcs = res.data\r\n        for (let i = 0; i < funcs.length; i++) {\r\n          let data = funcs[i]\r\n          this.funcSelect.push({'label': data.pdTestFuncCode + ':' + data.pdTestFuncDesc, 'value': data.id})\r\n        }\r\n      })\r\n    },\r\n    templateDownload() {\r\n      downloadCaseTemplate(this.buildRequestData({'testModule': 'newsingletest'})).then(res => {\r\n        this.downloadResponseFile(res, 'NewSingleTestCaseTemplate.xlsm')\r\n      })\r\n    },\r\n    openUploadDialog() {\r\n      this.dialogTableVisible1 = true\r\n    },\r\n    testCaseUpload() {\r\n      if (this.fileList.length === 0) {\r\n        this.notifyError('请选择上传的文件')\r\n      } else {\r\n        let formData = this.uploadUtil(this.fileList)\r\n        formData.append('pdInfoId', this.CaseDefinition.pdInfoId)\r\n        uploadTestCase(formData).then(res => {\r\n          this.notifySuccess('上传成功')\r\n          this.$refs.upload.clearFiles()\r\n          this.back1()\r\n          this.$refs.page1.reload()\r\n        })\r\n      }\r\n    },\r\n    back1() {\r\n      this.dialogTableVisible1 = false\r\n    },\r\n    backPage() {\r\n      this.$router.push({path: '/product-testing/new-single-test/new-single-test-detail'})\r\n    },\r\n    //文件状态改变时的钩子，添加文件、上传成功和上传失败时都会被调用\r\n    handleChange(file, fileList) {\r\n      if (fileList.length > 1) {\r\n        for (let i = 0; i < fileList.length - 1; i++) {\r\n          if (file.name === fileList[i].name) {\r\n            this.$notify.error({\r\n              title: '错误',\r\n              message: '上传文件名不能重复!',\r\n              duration: 2000\r\n            })\r\n            fileList.pop()\r\n          }\r\n        }\r\n      }\r\n      this.fileList = fileList\r\n\r\n      /*\r\n     var msg = file.name.substring(file.name.lastIndexOf('.') + 1)\r\n     //判断文件格式\r\n     if (!(msg === 'xls' || msg === 'xlsx')) {\r\n       this.$notify.error({\r\n         title: '错误',\r\n         message: '上传文件只能是 xls、xlsx格式!',\r\n         duration: 200\r\n       })\r\n       return\r\n     }*/\r\n      //判断文件大小\r\n      if (!(file.size / 1024 / 1024 < 10)) {\r\n        // this.$refs.fileUpload.clearFiles()\r\n        this.$notify.error({\r\n          title: '错误',\r\n          message: '上传文件大小不能超过 10MB!',\r\n          duration: 500\r\n        })\r\n        return\r\n      }\r\n\r\n    },\r\n    //文件超出个数限制时的钩子\r\n    handleExceed(files, fileList) {\r\n      this.$notify.warning({\r\n        title: '提示',\r\n        message: '最多上传三个文件,替换请先移除！',\r\n        duration: 1000\r\n      })\r\n    },\r\n    handleResult(response, file, fileList) {\r\n      if (response.success) {\r\n\r\n      } else {\r\n        this.$message.error(`上传文件失败`)\r\n      }\r\n    },\r\n    handleRemove(file, fileList) {\r\n      this.fileList = fileList\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.divider {\r\n  background-color: black;\r\n  margin-left: 4px;\r\n}\r\n\r\n.formtitle {\r\n  padding-top: 10px;\r\n  font-size: 15px;\r\n  font-weight: bold;\r\n  cursor: pointer;\r\n}\r\n\r\n.divclass {\r\n  border: 1px solid #0000002e;\r\n  width: 735px;\r\n  height: auto;\r\n}\r\n\r\n.cst {\r\n  width: 80px;\r\n  border: 0;\r\n}\r\n</style>\r\n\r\n"]}]}