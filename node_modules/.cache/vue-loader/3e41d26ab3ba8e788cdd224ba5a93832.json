{"remainingRequest":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\product-package-definition\\pp-operation-def\\pp-sales-def\\sale-fee-def\\index.vue?vue&type=style&index=0&id=9ded3c7a&lang=scss&scoped=true&","dependencies":[{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\product-package-definition\\pp-operation-def\\pp-sales-def\\sale-fee-def\\index.vue","mtime":1609847107046},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\css-loader\\dist\\cjs.js","mtime":1706753188288},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1706753191924},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\postcss-loader\\src\\index.js","mtime":1706753189537},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1706753187424},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1706753190941}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouY3N0ew0KICB3aWR0aDogOCU7DQp9DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgiBA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/product-package-definition/pp-operation-def/pp-sales-def/sale-fee-def","sourcesContent":["<template>\r\n  <cus-wraper>\r\n  <!-- 产品套餐销售费用表格 -->\r\n    <cus-table-title :label=\"$t('saleFeeDefinition.pdSaleFee')\"></cus-table-title>\r\n      <el-table :data=\"tableData\"  @selection-change=\"checkSaleFeeTable\"  ref=\"multipleTable\"  border element-loading-text=\"Loading\" fit size=\"mini\">\r\n        <el-table-column :label=\"$t('productValueAddedTax.select')\" type=\"selection\" align=\"center\" width=\"55px\"></el-table-column>\r\n        <el-table-column :label=\"$t('table.id')\" prop=\"index\" type=\"index\"  align=\"center\" width=\"55\"></el-table-column>\r\n        <el-table-column :label=\"$t('i18nView.feeType')\" prop=\"pdRateType\" align=\"center\" width=\"130px\">\r\n          <template v-slot=\"scope\">{{scope.row.pdRateType | filter_codetype('pdRateType')}}</template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('i18nView.pdSlMgc')\" prop=\"pdSlMgc\" align=\"center\">\r\n          <template v-slot=\"scope\">{{scope.row.pdSlMgc | filter_codetype('pdSlMgc')}}</template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('i18nView.SaleChanl')\" prop=\"pdSaleChnl\" align=\"center\" width=\"130px\">\r\n          <template v-slot=\"scope\">{{scope.row.pdSaleChnl | filter_codetype('pdSaleChnl')}}</template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('i18nView.pdAgencyCode')\" prop=\"pdAgencyCode\"  align=\"center\" width=\"100px\"></el-table-column>\r\n        <el-table-column :label=\"$t('i18nView.pdPolCurr')\" align=\"center\" prop=\"pdPolCurr\">\r\n          <template v-slot=\"scope\">{{scope.row.pdPolCurr | filter_codetype('pdPolCurr')}}</template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('i18nView.pdPolYear')\"align=\"center\" prop=\"pdPolYear\"></el-table-column>\r\n        <el-table-column :label=\"$t('i18nView.payTerm')\"  align=\"center\" prop=\"pdPayPeriod\">\r\n          <template v-slot=\"scope\">{{scope.row.pdPayPeriod}}:{{scope.row.pdPayPeriodUnit}}</template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('saleFeeDefinition.pdStartAppAge')\" align=\"center\"\r\n                         prop=\"pdStartAppAge\"></el-table-column>\r\n        <el-table-column :label=\"$t('saleFeeDefinition.pdEndAppAge')\" align=\"center\" prop=\"pdEndAppAge\"></el-table-column>\r\n        <el-table-column :label=\"$t('saleFeeDefinition.pdRate')\" align=\"center\" prop=\"pdRate\"></el-table-column>\r\n      </el-table>\r\n    <br>\r\n    <el-row v-if=\"this.checkSaleFee.length>1\" style=\"float: right\">\r\n      <el-button dialog-disable=\"disable\" size=\"small\"  @click=\"deleteMoreFee\" v-auth=\"'pdtemp-pd-sale-fee-info:delete'\" icon=\"el-icon-delete\" type=\"danger\">{{$t('table.delete')}}</el-button>\r\n    </el-row>\r\n    <div v-if=\"this.checkSaleFee.length<2\" >\r\n      <el-form  :model=\"form\" :rules=\"rules1\" label-width=\"85px\"ref=\"form\" v-if=\"!pageFlag\">\r\n        <el-form-item :label=\"$t('i18nView.feeType')\" prop=\"pdRateType\">\r\n          <cus-radio :codetype=\"'sdRateType'\" v-model=\"form.pdRateType\"></cus-radio>\r\n        </el-form-item>\r\n        <cus-row >\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('i18nView.pdSlMgc')\" prop=\"pdSlMgc\">\r\n              <el-select clearable multiple  v-model=\"form.pdSlMgc\">\r\n                <el-option :disabled=\"item.disabled\"\r\n                           :key=\"item.slMgcCode\"\r\n                           :label=\"item.slMgcCode+':'+item.slMgcName\"\r\n                           :value=\"item.slMgcCode\"\r\n                           v-for=\"item in pdSlMgcOptions\">\r\n                </el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('i18nView.SaleChanl')\"prop=\"pdSaleChnl\">\r\n              <cus-multi-select :codetype=\"'pdSlChanl'\" :disabledCodeArray=\"pdSlChanlDisabledCodeArray\"\r\n                                v-model=\"form.pdSaleChnl\"></cus-multi-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('i18nView.pdAgencyCode')\"prop=\"pdAgencyCode\">\r\n              <el-input :disabled=\"form.pdRateType==1\" :placeholder=\"$t('pdtempsaledes.inputAgency')\" v-model=\"form.pdAgencyCode\"></el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n        </cus-row>\r\n        <cus-row >\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('i18nView.pdPolCurr')\" prop=\"pdPolCurr\">\r\n              <el-select clearable filterable multiple v-model=\"form.pdPolCurr\">\r\n                <el-option :key=\"item.value\"\r\n                           :label=\"item.label\"\r\n                           :value=\"item.value\"\r\n                           v-for=\"item in pdPolCurrOptionList\">\r\n                </el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('i18nView.pdPolYear')\" prop=\"pdPolYear\">\r\n              <el-input :placeholder=\"$t('i18nView.pleaseInputYear')\" v-model=\"form.pdPolYear\"></el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n          </el-col>\r\n        </cus-row>\r\n        <cus-row >\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('i18nView.payTerm')\" prop=\"pdPayPeriod\">\r\n              <el-input :placeholder=\"$t('i18nView.pleaseInputFeePeriod')\" v-model=\"form.pdPayPeriod\">\r\n                <cus-select :codetype=\"'saledes'\" class=\"cst\" prop=\"pdPayPeriodUnit\" slot=\"append\"\r\n                            v-model=\"form.pdPayPeriodUnit\"></cus-select>\r\n              </el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('saleFeeDefinition.pdStartAppAge')\" prop=\"pdStartAppAge\">\r\n              <el-input :placeholder=\"$t('i18nView.pleaseInputStartInsureAge')\" v-model=\"form.pdStartAppAge\">\r\n                <template slot=\"suffix\">{{$t('i18nView.age')}}</template>\r\n              </el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('saleFeeDefinition.pdEndAppAge')\" prop=\"pdEndAppAge\">\r\n              <el-input :placeholder=\"$t('i18nView.pleaseInputEndInsureAge')\" v-model=\"form.pdEndAppAge\">\r\n                <template slot=\"suffix\">{{$t('i18nView.age')}}</template>\r\n              </el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n        </cus-row>\r\n        <cus-row >\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('saleFeeDefinition.pdRate')\" prop=\"pdRate\">\r\n              <el-input :placeholder=\"$t('i18nView.pleaseInputRatio')\" v-model=\"form.pdRate\">\r\n                <template slot=\"suffix\">%</template>\r\n              </el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"16\" align=\"right\">\r\n          <el-button dialog-disable=\"disable\"  size=\"small\" @click=\"onSubmit('form')\" icon=\"el-icon-success\" type=\"primary\" v-auth=\"'pdtemp-pd-sale-fee-info:add'\"\r\n                     v-show=\"!this.pageFlag\">{{$t('saleFeeDefinition.submit')}}\r\n          </el-button>\r\n          <el-button dialog-disable=\"disable\"  size=\"small\" @click=\"resetForm('form')\" icon=\"el-icon-refresh\" type=\"primary\">{{$t('saleFeeDefinition.refresh')}}\r\n          </el-button>\r\n          </el-col>\r\n        </cus-row>\r\n      </el-form>\r\n      <!--选中一行显示产品套餐销售费用-->\r\n      <el-form :model=\"formChooseRow\" :rules=\"rules2\" label-width=\"85px\" ref=\"formChooseRow\"\r\n               v-show=\"pageFlag\">\r\n        <el-form-item :label=\"$t('i18nView.feeType')\" prop=\"pdRateType\">\r\n          <cus-radio :codetype=\"'sdRateType'\" v-model=\"formChooseRow.pdRateType\"></cus-radio>\r\n        </el-form-item>\r\n        <cus-row :gutter=\"10\">\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('i18nView.pdSlMgc')\" prop=\"pdSlMgc\">\r\n              <el-select clearable  v-model=\"formChooseRow.pdSlMgc\">\r\n                <el-option :disabled=\"item.disabled\"\r\n                           :key=\"item.slMgcCode\"\r\n                           :label=\"item.slMgcCode+':'+item.slMgcName\"\r\n                           :value=\"item.slMgcCode\"\r\n                           v-for=\"item in pdSlMgcOptions\">\r\n                </el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('i18nView.SaleChanl')\"prop=\"pdSaleChnl\">\r\n              <cus-select :codetype=\"'pdSlChanl'\" :disabledCodeArray=\"pdSlChanlDisabledCodeArray\"\r\n                          v-model=\"formChooseRow.pdSaleChnl\"></cus-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('i18nView.pdAgencyCode')\" prop=\"pdAgencyCode\">\r\n              <el-input :disabled=\"formChooseRow.pdRateType==1\" :placeholder=\"$t('pdtempsaledes.inputAgency')\"\r\n                        v-model=\"formChooseRow.pdAgencyCode\"></el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n        </cus-row>\r\n        <cus-row :gutter=\"10\">\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('i18nView.pdPolCurr')\" prop=\"pdPolCurr\">\r\n              <cus-select :codetype=\"'productCurrency'\" v-model=\"formChooseRow.pdPolCurr\"></cus-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('i18nView.pdPolYear')\" prop=\"pdPolYear\">\r\n              <el-input :placeholder=\"$t('i18nView.pleaseInputYear')\" v-model=\"formChooseRow.pdPolYear\"></el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n          </el-col>\r\n        </cus-row>\r\n        <cus-row :gutter=\"10\">\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('i18nView.payTerm')\" prop=\"pdPayPeriod\">\r\n              <el-input :placeholder=\"$t('i18nView.pleaseInputFeePeriod')\" v-model=\"formChooseRow.pdPayPeriod\">\r\n                <cus-select :codetype=\"'saledes'\" class=\"cst\" prop=\"pdPayPeriodUnit\" slot=\"append\"\r\n                            v-model=\"formChooseRow.pdPayPeriodUnit\"></cus-select>\r\n              </el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('saleFeeDefinition.pdStartAppAge')\" prop=\"pdStartAppAge\">\r\n              <el-input :placeholder=\"$t('i18nView.pleaseInputStartInsureAge')\" v-model=\"formChooseRow.pdStartAppAge\">\r\n                <template slot=\"suffix\">{{$t('i18nView.age')}}</template>\r\n              </el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('saleFeeDefinition.pdEndAppAge')\" prop=\"pdEndAppAge\">\r\n              <el-input :placeholder=\"$t('i18nView.pleaseInputEndInsureAge')\" v-model=\"formChooseRow.pdEndAppAge\">\r\n                <template slot=\"suffix\">{{$t('i18nView.age')}}</template>\r\n              </el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n        </cus-row>\r\n        <cus-row :gutter=\"10\">\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('saleFeeDefinition.pdRate')\" prop=\"pdRate\">\r\n              <el-input :placeholder=\"$t('i18nView.pleaseInputRatio')\" v-model=\"formChooseRow.pdRate\">\r\n                <template slot=\"suffix\">%</template>\r\n              </el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"16\" align=\"right\">\r\n            <el-button dialog-disable=\"disable\" size=\"small\" @click=\"onSubmit('formChooseRow')\" icon=\"el-icon-success\" type=\"primary\"\r\n                       v-auth=\"'pdtemp-pd-sale-fee-info:add'\" v-show=\"this.pageFlag\">{{$t('saleFeeDefinition.update')}}\r\n            </el-button>\r\n            <el-button dialog-disable=\"disable\" size=\"small\" @click=\"deleteData('formChooseRow')\" icon=\"el-icon-delete\"\r\n                       type=\"danger\" v-auth=\"'pdtemp-pd-sale-fee-info:delete'\" v-show=\"this.pageFlag\">{{$t('table.delete')}}\r\n            </el-button>\r\n            <el-button dialog-disable=\"disable\" size=\"small\" @click=\"resetForm('formChooseRow')\" icon=\"el-icon-refresh\"\r\n                       type=\"primary\">{{$t('saleFeeDefinition.refresh')}}\r\n            </el-button>\r\n          </el-col>\r\n        </cus-row>\r\n      </el-form>\r\n    </div>\r\n  </cus-wraper>\r\n</template>\r\n<script>\r\n  import {addPdtempPdSlExp, deletePdtempPdSlExp, selectPdSlExpList, getSlMg,pdtempPdAtrsInfoList} from \"@/api/basicinfo/saleFeeDefinition\";\r\n  import {mapGetters} from \"vuex\";\r\n\r\n  let _this;\r\n  export default {\r\n    name: 'saleFeeDefinition',\r\n    filters: {\r\n      filter_codetype(code, value) {\r\n        if (value === 'pdSlMgc') {\r\n          for (const pdSlMgc of _this.pdSlMgcOptions) {\r\n            if (pdSlMgc.slMgcCode === code) {\r\n              return pdSlMgc.slMgcCode + ':' + pdSlMgc.slMgcName\r\n            }\r\n          }\r\n          return code\r\n        } else if (value == 'pdSaleChnl') {\r\n          return _this.getCodeName('pdSlChanl', code);\r\n        } else if (value == 'pdPolCurr') {\r\n          return _this.getCodeName('productCurrency', code);\r\n        } else if (value == 'pdPayPremMode') {\r\n          return _this.getCodeName('prempayway', code);\r\n        } else if (value == 'pdRateType') {\r\n          return _this.getCodeName('sdRateType', code);\r\n        }\r\n      },\r\n\r\n    },\r\n\r\n    data() {\r\n      _this = this;\r\n      const validatepdEndAppAge = (rule, value, callback) => {\r\n        if (this.form.pdStartAppAge > this.form.pdEndAppAge){\r\n          callback(new Error(\"起始投保年龄不得大于终止投保年龄\"))\r\n        }else{\r\n          callback();\r\n        }\r\n      }\r\n\r\n      const validateUpdateEndAppAge = (rule, value, callback) => {\r\n        if (this.formChooseRow.pdStartAppAge > this.formChooseRow.pdEndAppAge){\r\n          callback(new Error(\"起始投保年龄不得大于终止投保年龄\"))\r\n        }else{\r\n          callback();\r\n        }\r\n      }\r\n      return {\r\n        pageFlag: false,\r\n        form: {\r\n          id: '',\r\n          pdRateType: '1',\r\n          pdSlMgc: [],\r\n          pdSaleChnl: [],\r\n          pdAgencyCode: '',\r\n          pdPolCurr: [],\r\n          pdInfoId: '',\r\n          pdCode: '',\r\n          pdName:'',\r\n          pdVerId: '',\r\n          pdPolYear: '',\r\n          pdPayPremMode: [],\r\n          pdPayPeriod: '',\r\n          pdPayPeriodUnit: 'Y',\r\n          pdStartAppAge: '',\r\n          pdEndAppAge: '',\r\n          pdRate: '1',\r\n        },\r\n        package:{\r\n          pdInfoId:''\r\n        },\r\n        formChooseRow: {\r\n          id: '',\r\n          pdRateType: '1',\r\n          pdSlMgc: '',\r\n          pdSaleChnl: '',\r\n          pdAgencyCode: '',\r\n          pdPolCurr: '',\r\n          pdInfoId: '',\r\n          pdCode: '',\r\n          pdName:'',\r\n          pdVerId: '',\r\n          pdPolYear: '',\r\n          pdPayPremMode: '',\r\n          pdPayPeriod: '',\r\n          pdPayPeriodUnit: 'Y',\r\n          pdStartAppAge: '',\r\n          pdEndAppAge: '',\r\n          pdRate: '',\r\n        },\r\n        //表格选中数据\r\n        checkSaleFee:[],\r\n        tableData: [],\r\n        pdSlMgcOptions: [],\r\n        pdPolCurrOptionList: [],\r\n        pdSlChanlDisabledCodeArray: [],\r\n        rules1: {\r\n          pdRateType:[{required: true, message: this.$t('saleFeeDefinition.please_select') + this.$t('saleFeeDefinition.pdRateType'), trigger: 'change'}],\r\n          pdSlMgc: [{required: true, message: this.$t('saleFeeDefinition.please_select') + this.$t('saleFeeDefinition.pdSlMgc'), trigger: 'change'}],\r\n          pdSaleChnl: [{required: true, message: this.$t('saleFeeDefinition.please_select') + this.$t('saleFeeDefinition.pdSaleChnl'), trigger: 'change'}],\r\n          pdPolCurr: [{required: true,message: this.$t('saleFeeDefinition.please_select') + this.$t('saleFeeDefinition.pdPolCurr'), trigger: 'change'}],\r\n          pdRate: [{required: true, message: this.$t('saleFeeDefinition.please_enter') + this.$t('saleFeeDefinition.pdRate'), trigger: 'blur'}],\r\n          pdEndAppAge:  [{validator: validatepdEndAppAge, trigger: 'blur'}]\r\n        },\r\n        rules2: {\r\n          pdRateType:[{required: true, message: this.$t('saleFeeDefinition.please_select') + this.$t('saleFeeDefinition.pdRateType'), trigger: 'change'}],\r\n          pdSlMgc: [{required: true, message: this.$t('saleFeeDefinition.please_select') + this.$t('saleFeeDefinition.pdSlMgc'), trigger: 'change'}],\r\n          pdSaleChnl: [{required: true, message: this.$t('saleFeeDefinition.please_select') + this.$t('saleFeeDefinition.pdSaleChnl'), trigger: 'change'}],\r\n          pdPolCurr: [{required: true,message: this.$t('saleFeeDefinition.please_select') + this.$t('saleFeeDefinition.pdPolCurr'), trigger: 'change'}],\r\n          pdRate: [{required: true, message: this.$t('saleFeeDefinition.please_enter') + this.$t('saleFeeDefinition.pdRate'), trigger: 'blur'}],\r\n          pdEndAppAge:  [{validator: validateUpdateEndAppAge, trigger: 'blur'}]\r\n        }\r\n      }\r\n    },\r\n    async created() {\r\n      let pdPpInfo = this.getPdData();\r\n      if (pdPpInfo != null) {\r\n        this.form.pdInfoId = pdPpInfo.id;\r\n        this.form.pdVerId = '1';\r\n        this.form.pdCode = pdPpInfo.ppCode;\r\n        this.form.pdName = pdPpInfo.ppName;\r\n\r\n        this.package.pdInfoId=pdPpInfo.pdInfoId;\r\n        this.formChooseRow.pdInfoId = pdPpInfo.id;\r\n        this.formChooseRow.pdVerId = '1';\r\n        this.formChooseRow.pdCode = pdPpInfo.ppCode;\r\n        this.formChooseRow.pdName = pdPpInfo.ppName;\r\n      }\r\n      await this.initQueryDatas();\r\n      await this.initMgcInfo();\r\n      await this.getPdPolCurrOption();\r\n      //初始化保单币种\r\n      this.form.pdPolCurr=['01'];\r\n      this.form.pdSlMgc = ['0000'];\r\n      this.form.pdSaleChnl = ['00']\r\n    },\r\n    watch: {\r\n      'form.pdSlMgc'(selectedCodes) {\r\n        if (selectedCodes.length === 0) {\r\n          for (const pdSlMgc of this.pdSlMgcOptions) {\r\n            pdSlMgc.disabled = false\r\n          }\r\n        } else {\r\n          if (this._.includes(selectedCodes, '0000')) {\r\n            for (const pdSlMgc of this.pdSlMgcOptions) {\r\n              pdSlMgc.disabled = pdSlMgc.slMgcCode !== '0000'\r\n            }\r\n          } else {\r\n            for (const pdSlMgc of this.pdSlMgcOptions) {\r\n              pdSlMgc.disabled = pdSlMgc.slMgcCode === '0000'\r\n            }\r\n          }\r\n        }\r\n      },\r\n      'formChooseRow.pdSlMgc'(selectedCodes) {\r\n        if (selectedCodes.length === 0) {\r\n          for (const pdSlMgc of this.pdSlMgcOptions) {\r\n            pdSlMgc.disabled = false\r\n          }\r\n        } else {\r\n          if (this._.includes(selectedCodes, '0000')) {\r\n            for (const pdSlMgc of this.pdSlMgcOptions) {\r\n              pdSlMgc.disabled = pdSlMgc.slMgcCode !== '0000'\r\n            }\r\n          } else {\r\n            for (const pdSlMgc of this.pdSlMgcOptions) {\r\n              pdSlMgc.disabled = pdSlMgc.slMgcCode === '0000'\r\n            }\r\n          }\r\n        }\r\n      },\r\n      'form.pdSaleChnl'(selectedCodes) {\r\n        if (selectedCodes.length === 0) {\r\n          this.pdSlChanlDisabledCodeArray = []\r\n        } else {\r\n          let allCodes = this._.map(this.ldcodes['pdSlChanl'], 'code');\r\n          if (this._.includes(selectedCodes, '00')) {\r\n            allCodes = allCodes.filter(code => {\r\n              return code !== '00'\r\n            });\r\n            this.pdSlChanlDisabledCodeArray = allCodes\r\n          } else {\r\n            allCodes = allCodes.filter(code => {\r\n              return code === '00'\r\n            });\r\n            this.pdSlChanlDisabledCodeArray = allCodes\r\n          }\r\n        }\r\n      },\r\n      'formChooseRow.pdSaleChnl'(selectedCodes) {\r\n        if (selectedCodes.length === 0) {\r\n          this.pdSlChanlDisabledCodeArray = []\r\n        } else {\r\n          let allCodes = this._.map(this.ldcodes['pdSlChanl'], 'code');\r\n          if (this._.includes(selectedCodes, '00')) {\r\n            allCodes = allCodes.filter(code => {\r\n              return code !== '00'\r\n            });\r\n            this.pdSlChanlDisabledCodeArray = allCodes\r\n          } else {\r\n            allCodes = allCodes.filter(code => {\r\n              return code === '00'\r\n            });\r\n            this.pdSlChanlDisabledCodeArray = allCodes\r\n          }\r\n        }\r\n      },\r\n    },\r\n    computed: {\r\n      ...mapGetters([\r\n        'ldcodes'\r\n      ])\r\n    },\r\n    mounted() {},\r\n    methods: {\r\n      initQueryDatas() {\r\n        let pdPpInfo = this.getPdData();\r\n        selectPdSlExpList(this.buildRequestData({\"pdInfoId\":pdPpInfo.id})).then(res => {\r\n          this.tableData = res.data;\r\n        })\r\n      },\r\n      async initMgcInfo() {\r\n        for (const pdSlMgc of (await getSlMg()).data) {\r\n          this.pdSlMgcOptions.push(pdSlMgc)\r\n        }\r\n        for (const pdSlMgc of this.pdSlMgcOptions) {\r\n          this.$set(pdSlMgc, 'disabled', false)\r\n        }\r\n      },\r\n      checkSaleFeeTable(val){\r\n        this.checkSaleFee=val;\r\n        this.pageFlag=false;\r\n        this.$nextTick(()=>{\r\n          if(this.checkSaleFee.length==1){\r\n            Object.assign(this.formChooseRow,val[0])\r\n            this.pageFlag=true\r\n          }else if(this.checkSaleFee.length==0){\r\n            this.resetFormData()\r\n          }\r\n        })\r\n      },\r\n      getPdPolCurrOption() {\r\n        pdtempPdAtrsInfoList(this.package.pdInfoId).then(response => {\r\n          for (let i = 0; i < response.data.length; i++) {\r\n            if (response.data[i].pdAtrsCode == 'productCurrency') {\r\n              //从产品带入产品币种\r\n              this.pdPolCurrOptionList.push({\r\n                value: response.data[i].pdAtrsVal,\r\n                label: this.getCodeName('productCurrency', response.data[i].pdAtrsVal)\r\n              })\r\n            }\r\n          }\r\n        })\r\n      },\r\n      resetFormData() {\r\n        this.$refs.multipleTable.clearSelection();\r\n        this.$nextTick(function () {\r\n          if (!this.pageFlag) {\r\n            this.$refs['form'].resetFields();\r\n          } else {\r\n            this.$refs['formChooseRow'].resetFields();\r\n          }\r\n        })\r\n      },\r\n      onSubmit(form) {\r\n        this.$refs[form].validate((valid) => {\r\n          if (valid) {\r\n            let mgc = false;\r\n            let cal = false;\r\n            if (this.pageFlag) {\r\n              addPdtempPdSlExp(this.formChooseRow).then(res => {\r\n                if (mgc) {\r\n                  this.form.pdSlMgc = ['0000'];\r\n                }\r\n                if (cal) {\r\n                  this.form.pdSaleChnl = ['00'];\r\n                }\r\n                this.resetForm(form);\r\n                this.initQueryDatas();\r\n                this.notifySuccess(res.message);\r\n              })\r\n            } else {\r\n              addPdtempPdSlExp(this.form).then(res => {\r\n                if (mgc) {\r\n                  this.form.pdSlMgc = ['0000'];\r\n                }\r\n                if (cal) {\r\n                  this.form.pdSaleChnl = ['00'];\r\n                }\r\n                this.resetForm(form);\r\n                this.initQueryDatas();\r\n                this.notifySuccess(res.message);\r\n              })\r\n            }\r\n            //告知父页面已经保存\r\n            this.$emit('childFn', true);\r\n          }\r\n        })\r\n      },\r\n      deleteData(val) {\r\n          let delKeys =  this.checkSaleFee.map(sale => sale.id)\r\n          deletePdtempPdSlExp(this.buildRequestData({\"delKeys\": delKeys})).then(res => {\r\n            this.initQueryDatas();\r\n            this.notifySuccess(this.$t('successMessage.delete'))\r\n            if (val){\r\n              this.resetForm(val);\r\n            }\r\n          })\r\n      },\r\n      deleteMoreFee(){\r\n         this.deleteData()\r\n      },\r\n      resetForm(formName) {\r\n        this.$refs.multipleTable.clearSelection();\r\n        this.$refs[formName].resetFields();\r\n        this.pageFlag = false;\r\n        this.form.pdRateType='1';\r\n        this.form.pdSlMgc=['0000'];\r\n        this.form.pdSaleChnl=['00'];\r\n        this.form.pdPolCurr=['01'];\r\n        this.form.pdPayPeriodUnit='Y';\r\n        this.form.pdRate='1'\r\n      }\r\n    }\r\n  }\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.cst{\r\n  width: 8%;\r\n}\r\n</style>\r\n\r\n"]}]}