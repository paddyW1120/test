{"remainingRequest":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\product-definition\\pd-framework-def\\pd-structure-def\\payment-def\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\product-definition\\pd-framework-def\\pd-structure-def\\payment-def\\index.vue","mtime":1618544604557},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\babel-loader\\lib\\index.js","mtime":1706753193796},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1706753190941}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQoNCmltcG9ydCB7bWFwR2V0dGVyc30gZnJvbSAidnVleCINCmltcG9ydCB7DQogIGFkZFBkdGVtcFBkUHJlbSwNCiAgZGVsZXRlUGR0ZW1wUGRQcmVtLA0KICBnZXRQYXlEYXRlLA0KICBnZXRQZEF0dHJJbmZvLA0KICBnZXRQZENsc0xhYkluZm8sDQogIHVwZGF0ZVBkdGVtcFBkUHJlbQ0KfSBmcm9tICJAL2FwaS9iYXNpY2luZm8vcGR0ZW1wcGRwcmVtIg0KaW1wb3J0IHthZGRQZHRlbXBQZEV4dFByZW0sIGRlbGV0ZVBkdGVtcFBkRXh0UHJlbSwgdXBkYXRlUGR0ZW1wUGRFeHRQcmVtfSBmcm9tICJAL2FwaS9iYXNpY2luZm8vcGR0ZW1wcGRleHRwcmVtIg0KaW1wb3J0IHsNCiAgYWRkUGR0ZW1wUGRDbXBuSW5mbywNCiAgZGVsZXRlUGR0ZW1wUGRDbXBuSW5mbywNCiAgZmluZENtcG5DYWxlQ29kZSwNCiAgZ2V0TWF4UmFuZ2VPcmRlciwNCiAgc2VsZWN0RGlzY291bnRSYW5nZUJ5UGRJbmZvSWQsDQogIHVwZGF0ZVBkdGVtcFBkQ21wbkluZm8NCn0gZnJvbSAiQC9hcGkvYmFzaWNpbmZvL3BkdGVtcHBkY21wbmluZm8iOw0KaW1wb3J0IHBkRGlzY291bnRGb3JtdWxhDQogIGZyb20gIkAvdmlld3MvcHJvZHVjdC1kZWZpbml0aW9uL3BkLWZyYW1ld29yay1kZWYvcGQtc3RydWN0dXJlLWRlZi9wYXltZW50LWRlZi9kaXNjb3VudC1mb3JtdWxhIjsNCmltcG9ydCBwZERpc2NvdW50Rm9ybXVsYVNlbGVjdA0KICBmcm9tICJAL3ZpZXdzL3Byb2R1Y3QtZGVmaW5pdGlvbi9wZC1mcmFtZXdvcmstZGVmL3BkLXN0cnVjdHVyZS1kZWYvcGF5bWVudC1kZWYvZGlzY291bnQtZm9ybXVsYS1zZWxlY3QiOw0KaW1wb3J0IHByZW1BbW91bnRGb3JtdWxhIGZyb20gIkAvdmlld3MvcHJvZHVjdC1kZWZpbml0aW9uL3BkLWZyYW1ld29yay1kZWYvcGQtc3RydWN0dXJlLWRlZi9wYXltZW50LWRlZi9wcmVtLWZvcm11bGEiOw0KaW1wb3J0IHByZW1BbW91bnRGb3JtdWxhU2VsZWN0DQogIGZyb20gIkAvdmlld3MvcHJvZHVjdC1kZWZpbml0aW9uL3BkLWZyYW1ld29yay1kZWYvcGQtc3RydWN0dXJlLWRlZi9wYXltZW50LWRlZi9wcmVtLWZvcm11bGEtc2VsZWN0IjsNCmltcG9ydCBwcmVtUnVsZXMgZnJvbSAiQC92aWV3cy9wcm9kdWN0LWRlZmluaXRpb24vcGQtZnJhbWV3b3JrLWRlZi9wZC1zdHJ1Y3R1cmUtZGVmL3BheW1lbnQtZGVmL3ByZW0tcnVsZSI7DQppbXBvcnQgcHJlbVJ1bGVzU2VsZWN0IGZyb20gIkAvdmlld3MvcHJvZHVjdC1kZWZpbml0aW9uL3BkLWZyYW1ld29yay1kZWYvcGQtc3RydWN0dXJlLWRlZi9wYXltZW50LWRlZi9wcmVtLXJ1bGUtc2VsZWN0IjsNCg0KaW1wb3J0IGd1aWRlIGZyb20gJ0Avdmlld3MvcHJvZHVjdC1kZWZpbml0aW9uL3BkLWZyYW1ld29yay1kZWYvcGQtc3RydWN0dXJlLWRlZi9wYXltZW50LWRlZi9ndWlkZScNCg0KbGV0IF90aGlzDQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogIlBheW1lbnREZWZpbml0aW9uIiwNCiAgZmlsdGVyczogew0KICAgIGZpbHRlcl9jYWxjTWV0aG9kKGNvZGUpIHsNCiAgICAgIHJldHVybiBfdGhpcy5nZXRDb2RlTmFtZSgncGRfcHJlbV9jYWxfbWV0aG9kJywgY29kZSkNCiAgICB9LA0KICAgIGZpbHRlcl9kYXRlU3VmZml4KGNvZGUpIHsNCiAgICAgIHJldHVybiBfdGhpcy5nZXRDb2RlTmFtZSgncGRfcHJlbV9kYXRlX3N1ZmZpeCcsIGNvZGUsIHRydWUpDQogICAgfSwNCiAgICBmaWx0ZXJfZnJlcShjb2RlKSB7DQogICAgICByZXR1cm4gX3RoaXMuZ2V0Q29kZU5hbWUoJ3BkX3ByZW1fZnJlcScsIGNvZGUpDQogICAgfSwNCiAgICBmaWx0ZXJfc3RhcnRDYWxjUnVsZShjb2RlKSB7DQogICAgICByZXR1cm4gX3RoaXMuZ2V0Q29kZU5hbWUoJ3BkX3ByZW1fc3RhcnRfY2FsY19ydWxlJywgY29kZSkNCiAgICB9LA0KICAgIGZpbHRlcl9lbmRDYWxjUnVsZShjb2RlKSB7DQogICAgICByZXR1cm4gX3RoaXMuZ2V0Q29kZU5hbWUoJ3BkX3ByZW1fZW5kX2NhbGNfcnVsZScsIGNvZGUpDQogICAgfSwNCiAgICBmaWx0ZXJfc3RhcnRDYWxjTWV0aG9kKGNvZGUpIHsNCiAgICAgIHJldHVybiBfdGhpcy5nZXRDb2RlTmFtZSgncGRfcHJlbV9zdGFydF9jYWxjX21ldGhvZCcsIGNvZGUpDQogICAgfSwNCiAgICBmaWx0ZXJfZW5kQ2FsY01ldGhvZChjb2RlKSB7DQogICAgICByZXR1cm4gX3RoaXMuZ2V0Q29kZU5hbWUoJ3BkX3ByZW1fZW5kX2NhbGNfbWV0aG9kJywgY29kZSkNCiAgICB9LA0KICAgIGZpbHRlcl9hZGRpdGlvblR5cGUoY29kZSkgew0KICAgICAgcmV0dXJuIF90aGlzLmdldENvZGVOYW1lKCdwZF9wcmVtX2FkZGl0aW9uX3R5cGUnLCBjb2RlKQ0KICAgIH0sDQogICAgZmlsdGVyX2FkZGl0aW9uTW9kZShjb2RlKSB7DQogICAgICByZXR1cm4gX3RoaXMuZ2V0Q29kZU5hbWUoJ3BkX3ByZW1fYWRkaXRpb25fbW9kZScsIGNvZGUpDQogICAgfSwNCiAgICBmaWx0ZXJfYWNjb3VudFR5cGUoY29kZSkgew0KICAgICAgcmV0dXJuIF90aGlzLmdldENvZGVOYW1lKCdwZF9wcmVtX2FjY291bnRfdHlwZScsIGNvZGUpDQogICAgfSwNCiAgICBmaWx0ZXJfYWRkaXRpb25QYXlQZXJzb24oY29kZSkgew0KICAgICAgcmV0dXJuIF90aGlzLmdldENvZGVOYW1lKCdwZEFkZFByZW1PYmonLCBjb2RlKQ0KICAgIH0sDQogICAgZmlsdGVyX2FkZGl0aW9uQWRkaXRpb25Nb2RlKGNvZGUpIHsNCiAgICAgIHJldHVybiBfdGhpcy5nZXRDb2RlTmFtZSgncGRfcHJlbV9hZGRpdGlvbl9hZGRpdGlvbl9tb2RlJywgY29kZSkNCiAgICB9LA0KICAgIGZpbHRlcl9wYXlaZXJvKGNvZGUpIHsNCiAgICAgIHJldHVybiBfdGhpcy5nZXRDb2RlTmFtZSgncGRfcHJlbV96ZXJvJywgY29kZSkNCiAgICB9LA0KICAgIGZpbHRlcl9zZXJ2aWNlQ2hhcmdlT2Zmc2V0KGNvZGUpIHsNCiAgICAgIHJldHVybiBfdGhpcy5nZXRDb2RlTmFtZSgncGRfcHJlbV9zZXJ2aWNlX2NoYXJnZV9vZmZzZXQnLCBjb2RlKQ0KICAgIH0sDQogICAgZmlsdGVyX3BkQ21wblR5cGUoY29kZSkgew0KICAgICAgcmV0dXJuIF90aGlzLmdldENvZGVOYW1lKCdwcmVmZXJlbnRpYWxUeXBlJywgY29kZSkNCiAgICB9LA0KICAgIGZpbHRlcl9wZENtcG5DYWxjTW9kZShjb2RlKSB7DQogICAgICByZXR1cm4gX3RoaXMuZ2V0Q29kZU5hbWUoJ3ByZWZlcmVudGlhbENsY3VsYXRpb25UeXBlJywgY29kZSkNCiAgICB9LA0KICAgIGZpbHRlcl9wZENtcG5SYW5nZShjb2RlKSB7DQogICAgICBmb3IgKGNvbnN0IGRlZiBvZiBfdGhpcy5kZWZUYWJsZURhdGEpIHsNCiAgICAgICAgaWYgKGRlZi5wZFByZW1Db2RlID09PSBjb2RlKSB7DQogICAgICAgICAgcmV0dXJuIGRlZi5wZFByZW1Db2RlICsgIjoiICsgZGVmLnBkUGF5TmFtZQ0KICAgICAgICB9DQogICAgICB9DQogICAgICBmb3IgKGNvbnN0IGRlZiBvZiBfdGhpcy5hZGRpdGlvblRhYmxlRGF0YSkgew0KICAgICAgICBpZiAoZGVmLnBkRXh0UHJlbUNvZGUgPT09IGNvZGUpIHsNCiAgICAgICAgICByZXR1cm4gZGVmLnBkRXh0UHJlbUNvZGUgKyAiOiIgKyBkZWYucGRFeHRQcmVtTmFtZQ0KICAgICAgICB9DQogICAgICB9DQogICAgICByZXR1cm4gY29kZQ0KICAgIH0sDQogICAgZmlsdGVyX3BheVVyZ2luZyhjb2RlKSB7DQogICAgICByZXR1cm4gX3RoaXMuZ2V0Q29kZU5hbWUoJ3BkX3ByZW1fdXJnaW5nJywgY29kZSkNCiAgICB9LA0KICAgIGZpbHRlcl9wYXlGcmVxdWVuY3koY29kZSkgew0KICAgICAgcmV0dXJuIF90aGlzLmdldENvZGVOYW1lKCdwYXltZW50RnJlcXVlbmN5JywgY29kZSkNCiAgICB9LA0KICAgIGZpbHRlcl9wYXlkYXRldmFsdWUoY29kZSl7DQogICAgICByZXR1cm4gX3RoaXMuZ2V0Q29kZU5hbWUoJ3BkUGF5RW5kQ2FsTW9kZScsIGNvZGUpDQogICAgfSwNCiAgICBmaWx0ZXJfcGF5bWVudElkKHBkUHJlbUlkKSB7DQogICAgICBmb3IgKGNvbnN0IGRlZiBvZiBfdGhpcy5kZWZUYWJsZURhdGEpIHsNCiAgICAgICAgaWYgKGRlZi5pZCA9PT0gcGRQcmVtSWQpIHsNCiAgICAgICAgICByZXR1cm4gZGVmLnBkUGF5TmFtZQ0KICAgICAgICB9DQogICAgICB9DQogICAgICByZXR1cm4gJycNCiAgICB9LA0KICAgIGZpbHRlcl9wZFBheVN0YXJ0UGVyaW9kKGxpc3Qpew0KICAgICAgbGV0IHJldHVybkRhdGEgPSAnJw0KICAgICAgaWYobGlzdC5sZW5ndGgpew0KICAgICAgICBsaXN0LmZvckVhY2goZGF0YT0+ew0KICAgICAgICAgIGlmKHJldHVybkRhdGEubGVuZ3RoKXsNCiAgICAgICAgICAgIHJldHVybkRhdGErPScsJw0KICAgICAgICAgIH0NCiAgICAgICAgcmV0dXJuRGF0YSs9ZGF0YS5wZFBheVN0YXJ0UGVyaW9kOw0KICAgICAgICByZXR1cm5EYXRhKz1fdGhpcy5nZXRDb2RlTmFtZSgncGRfcHJlbV9kYXRlX3N1ZmZpeCcsZGF0YS5wZFBheVN0YXJ0UGVyVW5pdCx0cnVlKTsNCiAgICAgIH0pDQogICAgICB9DQogICAgICByZXR1cm4gcmV0dXJuRGF0YQ0KICAgIH0sDQogICAgZmlsdGVyX3BkUGF5RW5kUGVyaW9kKGxpc3Qpew0KICAgICAgbGV0IHJldHVybkRhdGEgPSAnJw0KICAgICAgaWYobGlzdC5sZW5ndGgpew0KICAgICAgICBsaXN0LmZvckVhY2goZGF0YT0+ew0KICAgICAgICAgIGlmKHJldHVybkRhdGEubGVuZ3RoKXsNCiAgICAgICAgICAgIHJldHVybkRhdGErPScsJw0KICAgICAgICAgIH0NCiAgICAgICAgcmV0dXJuRGF0YSs9ZGF0YS5wZFBheUVuZFBlcmlvZDsNCiAgICAgICAgcmV0dXJuRGF0YSs9X3RoaXMuZ2V0Q29kZU5hbWUoJ3BkX3ByZW1fZGF0ZV9zdWZmaXgnLGRhdGEucGRQYXlFbmRVbml0LHRydWUpOw0KICAgICAgfSkNCiAgICAgIH0NCiAgICAgIHJldHVybiByZXR1cm5EYXRhDQogICAgfQ0KICB9LA0KICBwcm9wczogew0KICAgIHByZW1pdW1Db2RlOiB7DQogICAgICByZXF1aXJlZDogZmFsc2UsDQogICAgICB0eXBlOiBTdHJpbmcsDQogICAgICBkZWZhdWx0OiAnJw0KICAgIH0NCiAgfSwNCiAgZGF0YSgpIHsNCg0KICAgIF90aGlzID0gdGhpcw0KICAgIHJldHVybiB7DQogICAgICBwcm9kdWN0Q2FsY1JldmlzaW9uU2hvd0lOZm86ZmFsc2UsDQogICAgICBwZFBheUZyZXFDb3B5OltdLA0KICAgICAgcXVpY2tmaWx0ZXJIYW5kbGVyTGlzdDA6W10sDQogICAgICBxdWlja2ZpbHRlckhhbmRsZXJMaXN0MTpbXSwNCiAgICAgIHF1aWNrZmlsdGVySGFuZGxlckxpc3QyOltdLA0KICAgICAgcXVpY2tmaWx0ZXJIYW5kbGVyTGlzdDM6W10sDQogICAgICBmaWx0ZXJIYW5kbGVyTGlzdDA6W10sDQogICAgICBmaWx0ZXJIYW5kbGVyTGlzdDE6W10sDQogICAgICBmaWx0ZXJIYW5kbGVyTGlzdDI6W10sDQogICAgICBmaWx0ZXJIYW5kbGVyTGlzdDM6W10sDQogICAgICBmaWx0ZXJIYW5kbGVyTGlzdDQ6W10sDQogICAgICBmaWx0ZXJwZEV4dFByZW1OYW1lTGlzdDE6W10sDQogICAgICBmaWx0ZXJwZEV4dFByZW1OYW1lTGlzdDI6W10sDQogICAgICBkZXRhaWxUeXBlT3B0aW9uTGlzdDpbXSwNCiAgICAgIHBheURhdGVGb3JtOnsNCiAgICAgICAgcGF5RGF0ZVRhYmxlOltdLA0KICAgICAgfSwNCiAgICAgIHRhYmxlQ291bnQ6IDAsDQogICAgICB0YWJsZUNvdW50RGlzY291bnQ6IDAsDQogICAgICBwZENtcG5DYWxjQ29kZTE6ICcnLA0KICAgICAgZmxhZzE6MCwNCiAgICAgIC8v5YWs5byPDQogICAgICBkaWFsb2dTaG93OiB7DQogICAgICAgIHByZW1BbW91bnRGb3JtdWxhOiBmYWxzZSwNCiAgICAgICAgcHJlbUFtb3VudEZvcm11bGFTZWxlY3Q6IGZhbHNlLA0KICAgICAgICBwZERpc2NvdW50Rm9ybXVsYTogZmFsc2UsDQogICAgICAgIHBkRGlzY291bnRGb3JtdWxhU2VsZWN0OiBmYWxzZQ0KICAgICAgfSwNCiAgICAgIGd1YXJhbnRlZURldGFpbHM6ICcnLA0KICAgICAgY2FsY3VsYXRpb25Gb3JtdWxhVHlwZTogJycsDQogICAgICBwZFV3U2lUeXBlT3B0aW9uczogJycsDQogICAgICBwZFV3U2lUeXBlRHRPcHRpb25zOiAnJywNCiAgICAgIHBkRGlzQ291bnQ6ICcnLA0KICAgICAgLy/op4TliJkNCiAgICAgIGRpYWxvZ1J1bGVzU2hvdzogew0KICAgICAgICBwcmVtUnVsZXM6IGZhbHNlLA0KICAgICAgICBwcmVtUnVsZXNTZWxlY3Q6IGZhbHNlDQogICAgICB9LA0KICAgICAgc2hvd1BhZ2VGbGFnOiAwLA0KICAgICAgcXVpY2tUYWJsZURhdGE6IFtdLA0KICAgICAgZGVmVGFibGVEYXRhOiBbXSwNCiAgICAgIGFkZGl0aW9uVGFibGVEYXRhOiBbXSwNCiAgICAgIGFkZGl0aW9uQWRkVGFibGVEYXRhOiBbXSwNCiAgICAgIHBkQ21wblR5cGVGaWx0ZXJzOiBbXSwNCiAgICAgIHJvd0luZGV4OiAnLTEnLA0KICAgICAgb3JkZXJJbmRleEFycl9hZGRpdGlvbjogW10sDQogICAgICBvcmRlckluZGV4QXJyX2FkZGl0aW9uX2FkZDogW10sDQogICAgICBvcmRlckluZGV4QXJyX2FkZGl0aW9uX2Rpc2NvdW50OltdLA0KICAgICAgaG92ZXJPcmRlckFycjogW10sDQogICAgICBxdWlja2ljb25fZGlzY291bnQ6ICJlbC1pY29uLWFycm93LXJpZ2h0IiwNCiAgICAgIHF1aWNrc2hvdzogZmFsc2UsDQogICAgICBmaWx0ZXJEaXNjb3VudENvZGU6W10sDQogICAgICBwZENtcG5SYW5nZUZpbHRlcnM6IFtdLA0KICAgICAgcHJvZHVjdE9yaWdpbmFsTGlzdDpbXSwNCiAgICAgIHByb2R1Y3RMaXN0OltdLA0KICAgICAgc2VsZWN0ZWRSZWZlcmVuY2VQcm9kdWN0SWQ6IHVuZGVmaW5lZCwNCiAgICAgIGZvcm1fcXVpY2s6IHsNCiAgICAgICAgdHlwZVJlZ2lvbjogJycsDQogICAgICB9LA0KICAgICAgcGFyYW1zOiB7DQogICAgICAgIGVxX3BkSW5mb0lkOiB1bmRlZmluZWQsDQogICAgICAgIGVxX3BkUHJlbUNhbE1vZGU6ICcnLA0KICAgICAgICBhY2NvdW50UmVsYXRlZDogJycsDQogICAgICAgIGV4dHJhUHJlbWl1bUZsYWc6ICcnLA0KICAgICAgICBlcV9pZDogJycsDQogICAgICAgIGJ5UGFnZTogJ1knLA0KICAgICAgICBmaW5lbGluZXNSZWdpb246ICcnLA0KICAgICAgICBmaXJzdE9wZW5QYWdlRmxhZzogJ1knLA0KICAgICAgfSwNCiAgICAgIHBhcmFtc19jdXJyZW50UHJvZHVjdDogew0KICAgICAgICBlcV9wZEluZm9JZDogdW5kZWZpbmVkLA0KICAgICAgICBsaWtlX3BheU5hbWU6ICcnLA0KICAgICAgICBlcV9wYXlDb2RlOiAnJw0KICAgICAgfSwNCiAgICAgIHBhcmFtc19hZGRpdGlvbjogew0KICAgICAgICBwcmVtaXVtTGlzdDogW10NCiAgICAgIH0sDQogICAgICBkaXNjb3VudFRhYmxlRGF0YTogW10sDQogICAgICBjb25maWdSYW5nZUxlbmd0aDogJycsDQogICAgICBwZERpc2NvdW50UmFuZ2VPcHRpb25zOiBbew0KICAgICAgICBrZXk6ICcwMDAwMDAnLA0KICAgICAgICB2YWx1ZTogJzAwMDAwMCcsDQogICAgICAgIGxhYmVsOiAn5YWo6YOoJywNCiAgICAgICAgZGlzYWJsZWQ6IHRydWUNCiAgICAgIH1dLA0KICAgICAgZmlsdGVyQ21wblR5cGU6ICcxJEQkSScsDQogICAgICBhZGRGZWVGbGFnOiBmYWxzZSwNCiAgICAgIGRpc2NvdW50RmxhZzogJ04nLA0KICAgICAgc2VsZWN0ZWREaXNjb3VudDoge30sDQogICAgICBzZWxlY3RlZERlZjoge30sDQogICAgICBzZWxlY3RlZERlZkluUXVlcnlSZXN1bHQ6IHt9LA0KICAgICAgc2VsZWN0ZWRBZGRpdGlvbjoge30sDQogICAgICBzZWxlY3RlZEFkZGl0aW9uQWRkczogW10sDQogICAgICAvLyDkuqflk4Hkv6Hmga8NCiAgICAgIHByb2R1Y3Q6IHsNCiAgICAgICAgaWQ6IHVuZGVmaW5lZCwNCiAgICAgICAgcGRDb2RlOiAnJywNCiAgICAgICAgcGRFZGl0aW9uOiAnJywNCiAgICAgICAgcGRWZXJJZDogdW5kZWZpbmVkLA0KICAgICAgICBwZFNhbGVjaG5sOiAnJywNCiAgICAgICAgcGROYW1lOiAnJywNCiAgICAgICAgcGRTaG9ydG5hbWU6ICcnLA0KICAgICAgICBwZEVuTmFtZTogJycsDQogICAgICAgIHBkU2hvcnRFbk5hbWU6ICcnLA0KICAgICAgICBvcGVyYXRvcjogJycsDQogICAgICAgIHBkU3RhcnREYXRlUnVsZTogJycsDQogICAgICAgIHBkU3RhcnREYXRlTW9kZTogJycsDQogICAgICAgIHBkU3RhcnRQZXJpb2Q6IHVuZGVmaW5lZCwNCiAgICAgICAgcGRTdGFydFBlcmlvZFVuaXQ6ICcnLA0KICAgICAgICBwZEVuZERhdGVSdWxlOiAnJywNCiAgICAgICAgcGRFbmREYXRlTW9kZTogJycsDQogICAgICAgIHBkRW5kUGVyaW9kOiB1bmRlZmluZWQsDQogICAgICAgIHBkRW5kUGVyaW9kVW5pdDogJycsDQogICAgICAgIHBkR3JhY2VQZXJpb2Q6IHVuZGVmaW5lZCwNCiAgICAgICAgcGRPYnNlcnZhdGlvbkRheTogdW5kZWZpbmVkLA0KICAgICAgICBwZEFwcGxEYXRlOiB1bmRlZmluZWQsDQogICAgICAgIHBkUHJvY2Vzc0lkOiB1bmRlZmluZWQsDQogICAgICAgIHBkU3RhcnREYXRlOiB1bmRlZmluZWQsDQogICAgICAgIHBkU3RvcERhdGU6IHVuZGVmaW5lZCwNCiAgICAgICAgY3JlYXRlVGltZTogdW5kZWZpbmVkLA0KICAgICAgICB1cGRhdGVUaW1lOiB1bmRlZmluZWQNCiAgICAgIH0sDQogICAgICBwcm9kdWN0X2V4dHJhOiB7DQogICAgICAgIHR5cGVSZWdpb246ICcnLA0KICAgICAgICBwZFBheUZyZXE6IFtdDQogICAgICB9LA0KICAgICAgZm9ybV9jb3VudDogew0KICAgICAgICBwZFZlcklkOiAnJywNCiAgICAgICAgb3BlcmF0b3I6ICcnLA0KICAgICAgICBwZFR5cGU6ICcnLA0KICAgICAgICBwZERlZlR5cGU6ICcnLA0KICAgICAgICBwZEluZm9JZDogJycsDQogICAgICAgIHBkQ29kZTogJycsDQogICAgICAgIHBkTmFtZTogJycsDQogICAgICAgIHBkUHJlbUlkczogW10sDQogICAgICAgIHBkUHJlbUlkOicnLA0KICAgICAgICBwZFByZW1Db2RlOiAnJywNCiAgICAgICAgcGRQcmVtQ29kZXM6W10sDQogICAgICAgIHBkQ21wblJhbmdlOiBbXSwNCiAgICAgICAgcGRDbXBuVHlwZTogJycsDQogICAgICAgIGNtcG5JbmZvSWQ6ICcnLA0KICAgICAgICBwZENtcG5Db2RlOiAnJywNCiAgICAgICAgcGRDbXBuT3JkZXI6ICcnLA0KICAgICAgICBwZENtcG5DYWxjTW9kZTogJycsDQogICAgICAgIHBkQ21wblZhbDogJycsDQogICAgICAgIHBkQ21wbkNhbGNDb2RlOiAnJywNCiAgICAgICAgcGRDbXBuRGVzYzogJycNCiAgICAgIH0sDQogICAgICBmb3JtX2RlZkFkZDoge30sDQogICAgICBmb3JtX2RlZjogew0KICAgICAgICBpZDogdW5kZWZpbmVkLA0KICAgICAgICBwZEluZm9JZDogdW5kZWZpbmVkLA0KICAgICAgICBwZFZlcklkOiB1bmRlZmluZWQsDQogICAgICAgIHBkQ29kZTogJycsDQogICAgICAgIHBkTmFtZTogJycsDQogICAgICAgIG9wZXJhdG9yOiAnJywNCiAgICAgICAgcGRQYXlOYW1lOiAnJywNCiAgICAgICAgcGRQcmVtQ29kZTogJycsDQogICAgICAgIHBkUHJlbUNhbE1vZGU6ICdHJywNCiAgICAgICAgcGRQcmVtWmVyb0ZsYWc6ICdZJywNCiAgICAgICAgcGRQcmVtUmVjbEZsYWc6ICdOJywNCiAgICAgICAgcGRVcmdlUGF5RmxhZzogJ1knLA0KICAgICAgICBwZFBheVN0YXJ0UGVyaW9kOiB1bmRlZmluZWQsDQogICAgICAgIHBkUGF5U3RhcnRQZXJVbml0OiAnWScsDQogICAgICAgIHBkUGF5U3RhcnRDYWxSdWxlOiAnJywNCiAgICAgICAgcGRQYXlTdGFydENhbE1vZGU6ICcnLA0KICAgICAgICBwZFBheUVuZFBlcmlvZDogdW5kZWZpbmVkLA0KICAgICAgICBwZFBheUVuZFVuaXQ6ICdZJywNCiAgICAgICAgcGRQYXlFbmRDYWxSdWxlOiAnJywNCiAgICAgICAgcGRQYXlFbmRDYWxNb2RlOiAnJywNCiAgICAgICAgcGRBZGRQcmVtTW9kZTogJycsDQogICAgICAgIHBkUGF5QWNjS2luZDogJycsDQogICAgICAgIHBkUmF0ZUNoYW5nZUZsYWc6ICdOJywNCiAgICAgICAgcGRQcmVtQWRkRmxhZzogJ04nLA0KICAgICAgICBwZFByZW1TdGFydEZsYWc6ICdOJywNCiAgICAgICAgcGRDaGFyUHJlbVJlbDogJ04nLA0KICAgICAgICBwZFByZW1BY2NSZWxhOiAnTicsDQogICAgICAgIHBkUHJlbUNhbGNDb2RlOiAnJywNCiAgICAgICAgcGRQYXlGcmVxdWVuY3k6JycsDQogICAgICAgIHBkUGF5RGF0ZVZhbHVlOicnDQogICAgICB9LA0KICAgICAgZm9ybV9hZGRpdGlvbjogew0KICAgICAgICBpZDogdW5kZWZpbmVkLA0KICAgICAgICBwZFByZW1JZDogdW5kZWZpbmVkLA0KICAgICAgICBwZFZlcklkOiB1bmRlZmluZWQsDQogICAgICAgIG9wZXJhdG9yOiAnJywNCiAgICAgICAgcGRFeHRQcmVtQ29kZTogJycsDQogICAgICAgIHBkRXh0UHJlbU5hbWU6ICcnLA0KICAgICAgICBwZFByZW1OYW1lOiAnJywNCiAgICAgICAgcGRQcmVtQ29kZTogJycsDQogICAgICAgIHBkRXh0UHJlbU9iajogJycsDQogICAgICAgIHBkRXh0UHJlbU1vZGU6ICcnLA0KICAgICAgICBwZEV4dFByZW1UeXBlOiAnJywNCiAgICAgICAgcGRNYXhWYWw6IHVuZGVmaW5lZCwNCiAgICAgICAgcGRFeHRQcmVtQ2FsY0NvZGU6ICcnLA0KICAgICAgICBjcmVhdGVUaW1lOiB1bmRlZmluZWQsDQogICAgICAgIHVwZGF0ZVRpbWU6IHVuZGVmaW5lZA0KICAgICAgfSwNCiAgICAgIGZvcm1fYWRkaXRpb25fYWRkOiB7DQogICAgICAgIGlkOiB1bmRlZmluZWQsDQogICAgICAgIHBkUHJlbUlkOiBbXSwNCiAgICAgICAgcGRFeHRQcmVtT2JqOiBbXSwNCiAgICAgICAgcGRFeHRQcmVtTW9kZTogW10sDQogICAgICAgIHBkRXh0UHJlbVR5cGU6IFtdLA0KICAgICAgICBwZEV4dFByZW1DYWxjQ29kZTogJycNCiAgICAgIH0sDQogICAgICBwYWdlRmxhZzogew0KICAgICAgICB0YWJsZVZpc2libGVfZGVmOiB0cnVlLA0KICAgICAgICBkaWFsb2dWaXNpYmxlX2FkZGl0aW9uVHlwZTogZmFsc2UsDQogICAgICAgIGRpYWxvZ1Zpc2libGVfcXVlcnlSZXN1bHQ6IGZhbHNlLA0KICAgICAgICBhZGRpdGlvbkZsYWc6IGZhbHNlDQogICAgICB9LA0KICAgICAgZGlzcGxheU5hbWVfYWRkaXRpb25UeXBlOiAnJywNCiAgICAgIGlzRml4ZWQ6IGZhbHNlLA0KICAgICAgZml4ZWRDbGFzc05hbWU6ICcnLA0KICAgICAgb2Zmc2V0VG9wOiB1bmRlZmluZWQsDQogICAgICBmaWx0ZXJzOiB7DQogICAgICAgIHBkQWRkUHJlbU1vZGU6IFtdLA0KICAgICAgICBwZFByZW1DYWxNb2RlOiBbXSwNCiAgICAgICAgcGRQYXlBY2NLaW5kOiBbXQ0KICAgICAgfSwNCiAgICAgIHJ1bGVzOiB7DQogICAgICAgIHBkUGF5RW5kUGVyaW9kOiBbew0KICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLA0KICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuJHQoJ3BheV9kZWYubWVzc2FnZS5wbGVhc2VfZW50ZXInKSArIHRoaXMuJHQoJ2kxOG5WaWV3LnBheVRlcm0nKSwNCiAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicNCiAgICAgICAgfV0sDQogICAgICAgIHBkUGF5TmFtZTogW3sNCiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwNCiAgICAgICAgICBtZXNzYWdlOiB0aGlzLiR0KCdwYXlfZGVmLm1lc3NhZ2UucGxlYXNlX2VudGVyJykgKyB0aGlzLiR0KCdwYXlfZGVmLnBheV9uYW1lJyksDQogICAgICAgICAgdHJpZ2dlcjogJ2JsdXInDQogICAgICAgIH1dLA0KDQogICAgICAgIHBkUHJlbUNhbE1vZGU6IFt7DQogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsDQogICAgICAgICAgbWVzc2FnZTogdGhpcy4kdCgncGF5X2RlZi5tZXNzYWdlLnBsZWFzZV9lbnRlcicpICsgdGhpcy4kdCgncGF5X2RlZi5wYXlfY2FsY19tZXRob2QnKSwNCiAgICAgICAgICB0cmlnZ2VyOiAnY2hhbmdlJw0KICAgICAgICB9XSwNCiAgICAgICAgcGRFeHRQcmVtTmFtZTpbe3JlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAi6K+36L6T5YWl5Yqg6LS55ZCN56ewIiwgdHJpZ2dlcjogJ2JsdXInfV0sDQogICAgICAgIHBkUHJlbUlkOiBbe3JlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAi6K+36YCJ5oup5Yqg6LS55a+56LGhIiwgdHJpZ2dlcjogJ2JsdXInfV0sDQogICAgICAgIHBkUHJlbUlkczogW3tyZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuivt+mAieaLqeWKoOi0ueWvueixoSIsIHRyaWdnZXI6ICdibHVyJ31dLA0KICAgICAgICBwZEV4dFByZW1PYmo6IFt7cmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICLor7fpgInmi6nliqDotLnlr7nosaEiLCB0cmlnZ2VyOiAnYmx1cid9XSwNCiAgICAgICAgcGRFeHRQcmVtTW9kZTogW3tyZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuivt+mAieaLqeWKoOi0ueaWueW8jyIsIHRyaWdnZXI6ICdibHVyJ31dLA0KICAgICAgICBwZEV4dFByZW1UeXBlOiBbe3JlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAi6K+36YCJ5oup5Yqg6LS557G75Z6LIiwgdHJpZ2dlcjogJ2JsdXInfV0sDQogICAgICB9LA0KICAgICAgcnVsZXMxOnsNCiAgICAgICAgcGRQYXlGcmVxOiBbew0KICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLA0KICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuJHQoJ3BheV9kZWYubWVzc2FnZS5wbGVhc2VfZW50ZXInKSArIHRoaXMuJHQoJ3BheV9kZWYucGF5X2ZyZXF1ZW5jeScpLA0KICAgICAgICAgIHRyaWdnZXI6ICdibHVyJw0KICAgICAgICB9XSwNCiAgICAgIH0sDQogICAgICBydWxlc19jb3VudDogew0KICAgICAgICBwZFByZW1JZDogW3sNCiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwNCiAgICAgICAgICBtZXNzYWdlOiB0aGlzLiR0KCdwYXlfZGVmLm1lc3NhZ2UucGxlYXNlX2VudGVyJykgKyB0aGlzLiR0KCdwYXlfZGVmLnBheV9uYW1lJyksDQogICAgICAgICAgdHJpZ2dlcjogJ2JsdXInDQogICAgICAgIH1dLA0KICAgICAgICBwZENtcG5SYW5nZTogW3sNCiAgICAgICAgICB0eXBlOiAnYXJyYXknLA0KICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLA0KICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuJHQoJ3BheV9kZWYubWVzc2FnZS5wbGVhc2VfZW50ZXInKSArIHRoaXMuJHQoJ3BheV9kZWYucGF5X2Rpc2NvdW50X3JhbmdlJyksDQogICAgICAgICAgdHJpZ2dlcjogJ2NoYW5nZScNCiAgICAgICAgfV0sDQogICAgICAgIHBkQ21wblR5cGU6IFt7DQogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsDQogICAgICAgICAgbWVzc2FnZTogdGhpcy4kdCgncGF5X2RlZi5tZXNzYWdlLnBsZWFzZV9lbnRlcicpICsgdGhpcy4kdCgncGF5X2RlZi5wYXlfZGlzY291bnRfdHlwZScpLA0KICAgICAgICAgIHRyaWdnZXI6ICdibHVyJw0KICAgICAgICB9XSwNCiAgICAgICAgcGRDbXBuT3JkZXI6IFt7DQogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsDQogICAgICAgICAgbWVzc2FnZTogdGhpcy4kdCgncGF5X2RlZi5tZXNzYWdlLnBsZWFzZV9lbnRlcicpICsgdGhpcy4kdCgncGF5X2RlZi5wYXlfZGlzY291bnRfb3JkZXInKSwNCiAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicNCiAgICAgICAgfV0sDQogICAgICAgIHBkQ21wbkNhbGNNb2RlOiBbew0KICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLA0KICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuJHQoJ3BheV9kZWYubWVzc2FnZS5wbGVhc2VfZW50ZXInKSArIHRoaXMuJHQoJ3BheV9kZWYucGF5X2NhbGNfbWV0aG9kJyksDQogICAgICAgICAgdHJpZ2dlcjogJ2NoYW5nZScNCiAgICAgICAgfV0NCiAgICAgIH0sDQogICAgICBydWxlc19xdWljazogew0KICAgICAgICBmaW5lbGluZXNSZWdpb246IFt7DQogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsDQogICAgICAgICAgbWVzc2FnZTogdGhpcy4kdCgnZm9ybS5wbGVhc2Vfc2VsZWN0JykgKyB0aGlzLiR0KCdwYXlfZGVmLmZpbmVsaW5lc1JlZ2lvbicpLA0KICAgICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnDQogICAgICAgIH1dLA0KICAgICAgfQ0KICAgIH0NCiAgfSwNCiAgY29tcG9uZW50czogew0KICAgIHByZW1BbW91bnRGb3JtdWxhLA0KICAgIHByZW1BbW91bnRGb3JtdWxhU2VsZWN0LA0KICAgIHByZW1SdWxlcywNCiAgICBwcmVtUnVsZXNTZWxlY3QsDQogICAgcGREaXNjb3VudEZvcm11bGEsDQogICAgcGREaXNjb3VudEZvcm11bGFTZWxlY3QsDQogICAgZ3VpZGUNCiAgfSwNCiAgYXN5bmMgY3JlYXRlZCgpIHsNCg0KICAgIHRoaXMuaW5pdFByb2R1Y3RRdWVyeURhdGEoKQ0KDQogICAgdGhpcy5zaG93UGFnZUZsYWcgPSB0aGlzLiRyb3V0ZS5xdWVyeS5zaG93UGFnZUZsYWcNCiAgICBhd2FpdCB0aGlzLmluaXQoKTsNCiAgICB0aGlzLnByb2R1Y3RDYWxjUmV2aXNpb25TaG93SU5mbyA9IHRoaXMuJHJvdXRlLnF1ZXJ5LnByb2R1Y3RDYWxjUmV2aXNpb25TaG93SU5mbyA9PT0gJ3RydWUnDQogICAgaWYgKCF0aGlzLnByb2R1Y3RDYWxjUmV2aXNpb25TaG93SU5mbyl7DQogICAgICB0aGlzLmZvcm1fZGVmLnBkUHJlbUFkZEZsYWcgPSAnWScNCiAgICAgIHRoaXMuZm9ybV9kZWYucGRQYXlTdGFydENhbE1vZGUgPSAnMCcNCiAgICAgIHRoaXMuZm9ybV9kZWYucGRQYXlTdGFydENhbFJ1bGUgPSAnUycNCiAgICAgIHRoaXMuZm9ybV9kZWYucGRQYXlFbmRDYWxNb2RlID0gJzAnDQogICAgICB0aGlzLmZvcm1fZGVmLnBkUGF5RW5kQ2FsUnVsZSA9ICdTJw0KICAgICAgdGhpcy5mb3JtX2RlZi5wZFBheURhdGVWYWx1ZSA9ICcxJw0KICAgICAgdGhpcy4kcmVmcy5wYWdlX2RlZi5idWlsZERhdGEoKS50aGVuKCgpID0+IHsNCiAgICAgICAgdGhpcy4kcmVmcy5wYWdlX2FkZGl0aW9uLmJ1aWxkRGF0YSgpLnRoZW4oKCkgPT57DQogICAgICAgICAgLy8g5bim5YWl6ZyA6KaB5p+l55yL55qE5L+h5oGvDQogICAgICAgICAgaWYgKHRoaXMucHJlbWl1bUNvZGUpIHsNCiAgICAgICAgICAgIGxldCBmbGFnID0gZmFsc2UNCiAgICAgICAgICAgIGZvciAoY29uc3QgcHJlbWl1bSBvZiB0aGlzLmRlZlRhYmxlRGF0YSkgew0KICAgICAgICAgICAgICBpZiAocHJlbWl1bS5wZFByZW1Db2RlID09PSB0aGlzLnByZW1pdW1Db2RlKSB7DQogICAgICAgICAgICAgICAgZmxhZyA9IHRydWUNCiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkRGVmID0gcHJlbWl1bQ0KICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWREZWZDaGFuZ2VkKCkNCiAgICAgICAgICAgICAgICB0aGlzLmZvcm1fZGVmLnBkUHJlbUFkZEZsYWcgPSAnWScNCiAgICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICB9KQ0KICAgICAgfSkNCiAgICB9ZWxzZSB7DQogICAgICAgIHRoaXMuZGlzY291bnRDbGljaygpOw0KICAgICAgICB0aGlzLnNlbGVjdERpc2NvdW50UmFuZ2VUYWJsZSgpDQogICAgICAgIHRoaXMuZm9ybV9kZWYucGRQcmVtQWRkRmxhZyA9ICdZJw0KICAgICAgICB0aGlzLiRyZWZzLnBhZ2VfZGVmLmJ1aWxkRGF0YSgpLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgdGhpcy4kcmVmcy5wYWdlX2FkZGl0aW9uLmJ1aWxkRGF0YSgpLnRoZW4oKCkgPT57DQogICAgICAgICAgICAgICAgLy8g5bim5YWl6ZyA6KaB5p+l55yL55qE5L+h5oGvDQogICAgICAgICAgICAgICAgaWYgKHRoaXMucHJlbWl1bUNvZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgbGV0IGZsYWcgPSBmYWxzZQ0KICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHByZW1pdW0gb2YgdGhpcy5kZWZUYWJsZURhdGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcmVtaXVtLnBkUHJlbUNvZGUgPT09IHRoaXMucHJlbWl1bUNvZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbGFnID0gdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWREZWYgPSBwcmVtaXVtDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZERlZkNoYW5nZWQoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybV9kZWYucGRQcmVtQWRkRmxhZyA9ICdZJw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KQ0KICAgICAgICB9KQ0KICAgIH0NCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICAvLyDlkLjpobbmlYjmnpwNCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5pbml0SGVpZ2h0KTsNCiAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICB0aGlzLm9mZnNldFRvcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0YWJsZV9kZWYnKS5vZmZzZXRUb3A7DQogICAgfSkNCg0KICB9LA0KICBkZXN0cm95ZWQoKSB7DQogICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMuaGFuZGxlU2Nyb2xsKQ0KICB9LA0KICBjb21wdXRlZDogew0KICAgIC4uLm1hcEdldHRlcnMoWw0KICAgICAgJ2xkY29kZXMnLA0KICAgICAgJ3NpZGViYXInDQogICAgXSkNCiAgfSwNCiAgd2F0Y2g6IHsNCiAgICAnZm9ybV9kZWYucGRQYXlFbmRQZXJpb2QnKCkgew0KICAgICAgY29uc3QgdmFsVGltZSA9IHRoaXMuZm9ybV9kZWYucGRQYXlFbmRQZXJpb2Q7DQogICAgICBpZiAodmFsVGltZSkgew0KICAgICAgICBpZiAoIXRoaXMuZm9ybV9kZWYucGRQYXlFbmRVbml0KSB7DQogICAgICAgICAgdGhpcy5mb3JtX2RlZi5wZFBheUVuZFVuaXQgPSAnWScNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0sDQogICAgJ2Zvcm1fZGVmLnBkUGF5U3RhcnRQZXJpb2QnKCkgew0KICAgICAgY29uc3QgdmFsVGltZSA9IHRoaXMuZm9ybV9kZWYucGRQYXlTdGFydFBlcmlvZDsNCiAgICAgIGlmICh2YWxUaW1lKSB7DQogICAgICAgIGlmICghdGhpcy5mb3JtX2RlZi5wZFBheVN0YXJ0UGVyVW5pdCkgew0KICAgICAgICAgIHRoaXMuZm9ybV9kZWYucGRQYXlTdGFydFBlclVuaXQgPSAnWScNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0sDQogICAgJ2Zvcm1fYWRkaXRpb25fYWRkLnBkRXh0UHJlbVR5cGUnKCkgew0KICAgICAgdGhpcy5kaXNwbGF5TmFtZV9hZGRpdGlvblR5cGUgPSAnJw0KICAgICAgY29uc3QgYWRkaXRpb25UeXBlTGlzdF9zZWxlY3RlZCA9IHRoaXMuXy5maWx0ZXIodGhpcy5sZGNvZGVzWydwZF9wcmVtX2FkZGl0aW9uX3R5cGUnXSwgZnVuY3Rpb24gKGFkZGl0aW9uVHlwZSkgew0KICAgICAgICByZXR1cm4gX3RoaXMuaXNJbkFycmF5KGFkZGl0aW9uVHlwZS5jb2RlLCBfdGhpcy5mb3JtX2FkZGl0aW9uX2FkZC5wZEV4dFByZW1UeXBlKTsNCiAgICAgIH0pDQogICAgICBpZiAoYWRkaXRpb25UeXBlTGlzdF9zZWxlY3RlZCAmJiBhZGRpdGlvblR5cGVMaXN0X3NlbGVjdGVkLmxlbmd0aCA+IDApIHsNCiAgICAgICAgYWRkaXRpb25UeXBlTGlzdF9zZWxlY3RlZC5mb3JFYWNoKChhZGRpdGlvblR5cGUsIGluZGV4KSA9PiB7DQogICAgICAgICAgaWYgKGluZGV4ID09PSAwKSB7DQogICAgICAgICAgICB0aGlzLmRpc3BsYXlOYW1lX2FkZGl0aW9uVHlwZSArPSBhZGRpdGlvblR5cGUuY29kZW5hbWUNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGhpcy5kaXNwbGF5TmFtZV9hZGRpdGlvblR5cGUgKz0gJywgJyArIGFkZGl0aW9uVHlwZS5jb2RlbmFtZQ0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuZGlzcGxheU5hbWVfYWRkaXRpb25UeXBlID0gJycNCiAgICAgIH0NCiAgICB9LA0KICAgICdxdWlja1RhYmxlRGF0YScoKXsNCiAgICAgIGlmICh0aGlzLnF1aWNrVGFibGVEYXRhLmxlbmd0aCA+IDApIHsNCiAgICAgICAgdGhpcy5xdWlja2ZpbHRlckhhbmRsZXJMaXN0MCA9IFtdOw0KICAgICAgICB0aGlzLnF1aWNrZmlsdGVySGFuZGxlckxpc3QxID0gW107DQogICAgICAgIHRoaXMucXVpY2tmaWx0ZXJIYW5kbGVyTGlzdDIgPSBbXTsNCiAgICAgICAgdGhpcy5xdWlja2ZpbHRlckhhbmRsZXJMaXN0MyA9IFtdOw0KICAgICAgICB0aGlzLnF1aWNrVGFibGVEYXRhLmZvckVhY2godmFsID0+IHsNCiAgICAgICAgICB0aGlzLnF1aWNrZmlsdGVySGFuZGxlckxpc3QwLnB1c2goew0KICAgICAgICAgICAgdGV4dDogdmFsLnBkUHJlbUNvZGUsDQogICAgICAgICAgICB2YWx1ZTogdmFsLnBkUHJlbUNvZGUNCiAgICAgICAgICB9KTsNCiAgICAgICAgICB0aGlzLnF1aWNrZmlsdGVySGFuZGxlckxpc3QxLnB1c2goew0KICAgICAgICAgICAgdGV4dDogdmFsLnBkUmF0ZUNoYW5nZUZsYWcsDQogICAgICAgICAgICB2YWx1ZTogdmFsLnBkUmF0ZUNoYW5nZUZsYWcNCiAgICAgICAgICB9KTsNCiAgICAgICAgICB0aGlzLnF1aWNrZmlsdGVySGFuZGxlckxpc3QyLnB1c2goew0KICAgICAgICAgICAgdGV4dDogdmFsLnBkUHJlbUFjY1JlbGEsDQogICAgICAgICAgICB2YWx1ZTogdmFsLnBkUHJlbUFjY1JlbGENCiAgICAgICAgICB9KTsNCiAgICAgICAgICB0aGlzLnF1aWNrZmlsdGVySGFuZGxlckxpc3QzLnB1c2goew0KICAgICAgICAgICAgdGV4dDogdmFsLnBkUHJlbUFkZEZsYWcsDQogICAgICAgICAgICB2YWx1ZTogdmFsLnBkUHJlbUFkZEZsYWcNCiAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgICB9DQogICAgICB0aGlzLnF1aWNrZmlsdGVySGFuZGxlckxpc3QwID0gdGhpcy5xdWlja2ZpbHRlckhhbmRsZXJMaXN0MC5yZWR1Y2UoZnVuY3Rpb24ocHJldiwgZWxlbWVudCkgew0KICAgICAgICBpZiAoIXByZXYuZmluZChlbCA9PiBlbC50ZXh0ID09IGVsZW1lbnQudGV4dCkpIHsNCiAgICAgICAgICBwcmV2LnB1c2goZWxlbWVudCk7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHByZXY7DQogICAgICB9LCBbXSk7DQogICAgICB0aGlzLnF1aWNrZmlsdGVySGFuZGxlckxpc3QxID0gdGhpcy5xdWlja2ZpbHRlckhhbmRsZXJMaXN0MS5yZWR1Y2UoZnVuY3Rpb24ocHJldiwgZWxlbWVudCkgew0KICAgICAgICBpZiAoIXByZXYuZmluZChlbCA9PiBlbC50ZXh0ID09IGVsZW1lbnQudGV4dCkpIHsNCiAgICAgICAgICBwcmV2LnB1c2goZWxlbWVudCk7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHByZXY7DQogICAgICB9LCBbXSk7DQogICAgICB0aGlzLnF1aWNrZmlsdGVySGFuZGxlckxpc3QyID0gdGhpcy5xdWlja2ZpbHRlckhhbmRsZXJMaXN0Mi5yZWR1Y2UoZnVuY3Rpb24ocHJldiwgZWxlbWVudCkgew0KICAgICAgICBpZiAoIXByZXYuZmluZChlbCA9PiBlbC50ZXh0ID09IGVsZW1lbnQudGV4dCkpIHsNCiAgICAgICAgICBwcmV2LnB1c2goZWxlbWVudCk7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHByZXY7DQogICAgICB9LCBbXSk7DQogICAgICB0aGlzLnF1aWNrZmlsdGVySGFuZGxlckxpc3QzID0gdGhpcy5xdWlja2ZpbHRlckhhbmRsZXJMaXN0My5yZWR1Y2UoZnVuY3Rpb24ocHJldiwgZWxlbWVudCkgew0KICAgICAgICBpZiAoIXByZXYuZmluZChlbCA9PiBlbC50ZXh0ID09IGVsZW1lbnQudGV4dCkpIHsNCiAgICAgICAgICBwcmV2LnB1c2goZWxlbWVudCk7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHByZXY7DQogICAgICB9LCBbXSk7DQogICAgfSwNCiAgICBkZWZUYWJsZURhdGEoKSB7DQogICAgICBpZiAodGhpcy5kZWZUYWJsZURhdGEubGVuZ3RoID4gMCkgew0KICAgICAgICB0aGlzLmZpbHRlckhhbmRsZXJMaXN0MCA9IFtdOw0KICAgICAgICB0aGlzLmZpbHRlckhhbmRsZXJMaXN0MSA9IFtdOw0KICAgICAgICB0aGlzLmZpbHRlckhhbmRsZXJMaXN0MiA9IFtdOw0KICAgICAgICB0aGlzLmZpbHRlckhhbmRsZXJMaXN0MyA9IFtdOw0KICAgICAgICB0aGlzLmZpbHRlckhhbmRsZXJMaXN0NCA9IFtdOw0KICAgICAgICB0aGlzLmRlZlRhYmxlRGF0YS5mb3JFYWNoKHZhbCA9PiB7DQogICAgICAgICAgdGhpcy5maWx0ZXJIYW5kbGVyTGlzdDAucHVzaCh7DQogICAgICAgICAgICB0ZXh0OiB2YWwucGRQcmVtQ29kZSwNCiAgICAgICAgICAgIHZhbHVlOiB2YWwucGRQcmVtQ29kZQ0KICAgICAgICAgIH0pOw0KICAgICAgICAgIHRoaXMuZmlsdGVySGFuZGxlckxpc3QxLnB1c2goew0KICAgICAgICAgICAgdGV4dDogdmFsLnBkUmF0ZUNoYW5nZUZsYWcsDQogICAgICAgICAgICB2YWx1ZTogdmFsLnBkUmF0ZUNoYW5nZUZsYWcNCiAgICAgICAgICB9KTsNCiAgICAgICAgICB0aGlzLmZpbHRlckhhbmRsZXJMaXN0Mi5wdXNoKHsNCiAgICAgICAgICAgIHRleHQ6IHZhbC5wZFByZW1BY2NSZWxhLA0KICAgICAgICAgICAgdmFsdWU6IHZhbC5wZFByZW1BY2NSZWxhDQogICAgICAgICAgfSk7DQogICAgICAgICAgdGhpcy5maWx0ZXJIYW5kbGVyTGlzdDMucHVzaCh7DQogICAgICAgICAgICB0ZXh0OiB2YWwucGRQcmVtQWRkRmxhZywNCiAgICAgICAgICAgIHZhbHVlOiB2YWwucGRQcmVtQWRkRmxhZw0KICAgICAgICAgIH0pOw0KICAgICAgICAgIHRoaXMuZmlsdGVySGFuZGxlckxpc3Q0LnB1c2goew0KICAgICAgICAgICAgdGV4dDogdmFsLnBkUGF5RW5kUGVyaW9kLA0KICAgICAgICAgICAgdmFsdWU6IHZhbC5wZFBheUVuZFBlcmlvZA0KICAgICAgICAgIH0pOw0KICAgICAgICB9KTsNCiAgICAgIH0NCiAgICAgIHRoaXMuZmlsdGVySGFuZGxlckxpc3QwID0gdGhpcy5maWx0ZXJIYW5kbGVyTGlzdDAucmVkdWNlKGZ1bmN0aW9uKHByZXYsIGVsZW1lbnQpIHsNCiAgICAgICAgaWYgKCFwcmV2LmZpbmQoZWwgPT4gZWwudGV4dCA9PSBlbGVtZW50LnRleHQpKSB7DQogICAgICAgICAgcHJldi5wdXNoKGVsZW1lbnQpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBwcmV2Ow0KICAgICAgfSwgW10pOw0KICAgICAgdGhpcy5maWx0ZXJIYW5kbGVyTGlzdDEgPSB0aGlzLmZpbHRlckhhbmRsZXJMaXN0MS5yZWR1Y2UoZnVuY3Rpb24ocHJldiwgZWxlbWVudCkgew0KICAgICAgICBpZiAoIXByZXYuZmluZChlbCA9PiBlbC50ZXh0ID09IGVsZW1lbnQudGV4dCkpIHsNCiAgICAgICAgICBwcmV2LnB1c2goZWxlbWVudCk7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHByZXY7DQogICAgICB9LCBbXSk7DQogICAgICB0aGlzLmZpbHRlckhhbmRsZXJMaXN0MiA9IHRoaXMuZmlsdGVySGFuZGxlckxpc3QyLnJlZHVjZShmdW5jdGlvbihwcmV2LCBlbGVtZW50KSB7DQogICAgICAgIGlmICghcHJldi5maW5kKGVsID0+IGVsLnRleHQgPT0gZWxlbWVudC50ZXh0KSkgew0KICAgICAgICAgIHByZXYucHVzaChlbGVtZW50KTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gcHJldjsNCiAgICAgIH0sIFtdKTsNCiAgICAgIHRoaXMuZmlsdGVySGFuZGxlckxpc3QzID0gdGhpcy5maWx0ZXJIYW5kbGVyTGlzdDMucmVkdWNlKGZ1bmN0aW9uKHByZXYsIGVsZW1lbnQpIHsNCiAgICAgICAgaWYgKCFwcmV2LmZpbmQoZWwgPT4gZWwudGV4dCA9PSBlbGVtZW50LnRleHQpKSB7DQogICAgICAgICAgcHJldi5wdXNoKGVsZW1lbnQpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBwcmV2Ow0KICAgICAgfSwgW10pOw0KICAgICAgdGhpcy5maWx0ZXJIYW5kbGVyTGlzdDQgPSB0aGlzLmZpbHRlckhhbmRsZXJMaXN0NC5yZWR1Y2UoZnVuY3Rpb24ocHJldiwgZWxlbWVudCkgew0KICAgICAgICBpZiAoIXByZXYuZmluZChlbCA9PiBlbC50ZXh0ID09IGVsZW1lbnQudGV4dCkpIHsNCiAgICAgICAgICBwcmV2LnB1c2goZWxlbWVudCk7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHByZXY7DQogICAgICB9LCBbXSk7DQogICAgICBpZiAodGhpcy50YWJsZUNvdW50ID09IDApIHsNCiAgICAgICAgaWYgKHRoaXMuZGVmVGFibGVEYXRhLmxlbmd0aCA9PT0gMSkgew0KICAgICAgICAgIHRoaXMuJHJlZnMuZGVmVGFibGVEYXRhLnNldEN1cnJlbnRSb3codGhpcy5kZWZUYWJsZURhdGFbMF0pOw0KICAgICAgICAgIHRoaXMuc2VsZWN0ZWREZWYgPSB0aGlzLmRlZlRhYmxlRGF0YVswXQ0KICAgICAgICAgIHRoaXMuc2VsZWN0ZWREZWZDaGFuZ2VkKCk7DQogICAgICAgIH0NCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuJHJlZnMuZGVmVGFibGVEYXRhLnNldEN1cnJlbnRSb3codGhpcy5kZWZUYWJsZURhdGFbMF0pOw0KICAgICAgICB0aGlzLnNlbGVjdGVkRGVmID0gdGhpcy5kZWZUYWJsZURhdGFbMF0NCiAgICAgICAgdGhpcy5zZWxlY3RlZERlZkNoYW5nZWQoKTsNCiAgICAgIH0NCg0KICAgICAgdGhpcy5wYXJhbXNfYWRkaXRpb24ucHJlbWl1bUxpc3QgPSB0aGlzLmRlZlRhYmxlRGF0YQ0KICAgICAgaWYgKHRoaXMuZm9ybV9kZWYucGRQcmVtQWRkRmxhZyA9PT0gJ1knKSB7DQogICAgICAgIHRoaXMuJHJlZnMucGFnZV9hZGRpdGlvbi5yZWxvYWQoKQ0KICAgICAgfQ0KICAgIH0sDQogICAgJ2Rpc2NvdW50VGFibGVEYXRhJygpIHsNCiAgICAgIGlmICh0aGlzLmRpc2NvdW50VGFibGVEYXRhLmxlbmd0aCA9PSAxKSB7DQogICAgICAgIHRoaXMuc2VsZWN0ZWREaXNjb3VudCA9IHRoaXMuZGlzY291bnRUYWJsZURhdGFbMF0NCiAgICAgICAgdGhpcy5zZWxlY3RlZERpc2NvdW50Q2hhbmdlZCgpOw0KICAgICAgfQ0KICAgICAgLy/ojrflj5bkvJjmg6Dpobrluo8NCiAgICAgIGdldE1heFJhbmdlT3JkZXIodGhpcy5idWlsZFJlcXVlc3REYXRhKHsicGRJbmZvSWQiOiB0aGlzLnByb2R1Y3QuaWR9KSkudGhlbihyZXMgPT4gew0KICAgICAgICB0aGlzLmNvbmZpZ1JhbmdlTGVuZ3RoID0gcmVzLmRhdGE7DQogICAgICAgIHRoaXMuZm9ybV9jb3VudC5wZENtcG5PcmRlciA9IHJlcy5kYXRhOw0KICAgICAgfSk7DQogICAgICBpZiAodGhpcy5kaXNjb3VudFRhYmxlRGF0YS5sZW5ndGggPiAwKSB7DQogICAgICAgIHRoaXMuZmlsdGVyRGlzY291bnRDb2RlPVtdOw0KICAgICAgICB0aGlzLnBkQ21wblJhbmdlRmlsdGVycyA9IFtdOw0KICAgICAgICB0aGlzLnBkQ21wblR5cGVGaWx0ZXJzID0gW107DQogICAgICAgIHRoaXMuZGlzY291bnRUYWJsZURhdGEuZm9yRWFjaCh2YWwgPT4gew0KICAgICAgICAgIHRoaXMuZmlsdGVyRGlzY291bnRDb2RlLnB1c2goew0KICAgICAgICAgICAgdGV4dDogdmFsLnBkUHJlbUNvZGUsDQogICAgICAgICAgICB2YWx1ZTogdmFsLnBkUHJlbUNvZGUNCiAgICAgICAgICB9KTsNCiAgICAgICAgICB0aGlzLnBkQ21wblJhbmdlRmlsdGVycy5wdXNoKHsNCiAgICAgICAgICAgIHRleHQ6IHRoaXMuZmlsdGVyX3BkQ21wblJhbmdlcyh2YWwucGRDbXBuUmFuZ2UpLA0KICAgICAgICAgICAgdmFsdWU6IHZhbC5wZENtcG5SYW5nZQ0KICAgICAgICAgIH0pOw0KICAgICAgICAgIHRoaXMucGRDbXBuVHlwZUZpbHRlcnMucHVzaCh7DQogICAgICAgICAgICB0ZXh0OiB0aGlzLmdldENvZGVOYW1lKCdwcmVmZXJlbnRpYWxUeXBlJywgdmFsLnBkQ21wblR5cGUpLA0KICAgICAgICAgICAgdmFsdWU6IHZhbC5wZENtcG5UeXBlDQogICAgICAgICAgfSk7DQogICAgICAgIH0pOw0KICAgICAgICAvL+e8tOi0uee8lueggQ0KICAgICAgICB0aGlzLmZpbHRlckRpc2NvdW50Q29kZSA9IHRoaXMuZmlsdGVyRGlzY291bnRDb2RlLnJlZHVjZShmdW5jdGlvbiAocHJldiwgZWxlbWVudCkgew0KICAgICAgICAgIGlmICghcHJldi5maW5kKGVsID0+IGVsLnRleHQgPT0gZWxlbWVudC50ZXh0KSkgew0KICAgICAgICAgICAgcHJldi5wdXNoKGVsZW1lbnQpOw0KICAgICAgICAgIH0NCiAgICAgICAgICByZXR1cm4gcHJldjsNCiAgICAgICAgfSwgW10pOw0KICAgICAgICAvL+S8mOaDoOiMg+WbtA0KICAgICAgICB0aGlzLnBkQ21wblJhbmdlRmlsdGVycyA9IHRoaXMucGRDbXBuUmFuZ2VGaWx0ZXJzLnJlZHVjZShmdW5jdGlvbiAocHJldiwgZWxlbWVudCkgew0KICAgICAgICAgIGlmICghcHJldi5maW5kKGVsID0+IGVsLnRleHQgPT0gZWxlbWVudC50ZXh0KSkgew0KICAgICAgICAgICAgcHJldi5wdXNoKGVsZW1lbnQpOw0KICAgICAgICAgIH0NCiAgICAgICAgICByZXR1cm4gcHJldjsNCiAgICAgICAgfSwgW10pOw0KICAgICAgICAvL+S8mOaDoOexu+Weiw0KICAgICAgICB0aGlzLnBkQ21wblR5cGVGaWx0ZXJzID0gdGhpcy5wZENtcG5UeXBlRmlsdGVycy5yZWR1Y2UoZnVuY3Rpb24gKHByZXYsIGVsZW1lbnQpIHsNCiAgICAgICAgICBpZiAoIXByZXYuZmluZChlbCA9PiBlbC50ZXh0ID09IGVsZW1lbnQudGV4dCkpIHsNCiAgICAgICAgICAgIHByZXYucHVzaChlbGVtZW50KTsNCiAgICAgICAgICB9DQogICAgICAgICAgcmV0dXJuIHByZXY7DQogICAgICAgIH0sIFtdKTsNCiAgICAgIH0NCiAgICB9LA0KICAgICdzaWRlYmFyLm9wZW5lZCcoKSB7DQogICAgICB0aGlzLmluaXRIZWlnaHQoKQ0KICAgIH0sDQogICAgJ2FkZGl0aW9uVGFibGVEYXRhJygpIHsNCiAgICAgIGlmICh0aGlzLmFkZGl0aW9uVGFibGVEYXRhLmxlbmd0aCA+IDApIHsNCiAgICAgICAgdGhpcy5maWx0ZXJwZEV4dFByZW1OYW1lTGlzdDEgPSBbXTsNCiAgICAgICAgdGhpcy5maWx0ZXJwZEV4dFByZW1OYW1lTGlzdDIgPSBbXTsNCiAgICAgICAgdGhpcy5hZGRpdGlvblRhYmxlRGF0YS5mb3JFYWNoKHZhbCA9PiB7DQogICAgICAgICAgdGhpcy5maWx0ZXJwZEV4dFByZW1OYW1lTGlzdDEucHVzaCh7DQogICAgICAgICAgICB0ZXh0OiB2YWwucGRFeHRQcmVtTmFtZSwNCiAgICAgICAgICAgIHZhbHVlOiB2YWwucGRFeHRQcmVtTmFtZQ0KICAgICAgICAgIH0pOw0KICAgICAgICAgIHRoaXMuZmlsdGVycGRFeHRQcmVtTmFtZUxpc3QyLnB1c2goew0KICAgICAgICAgICAgdGV4dDogdGhpcy5nZXRDb2RlTmFtZSgncGRfcHJlbV9hZGRpdGlvbl90eXBlJywgdmFsLnBkRXh0UHJlbVR5cGUpLA0KICAgICAgICAgICAgdmFsdWU6IHZhbC5wZEV4dFByZW1UeXBlDQogICAgICAgICAgfSk7DQogICAgICAgIH0pOw0KICAgICAgfQ0KICAgICAgdGhpcy5maWx0ZXJwZEV4dFByZW1OYW1lTGlzdDEgPSB0aGlzLmZpbHRlcnBkRXh0UHJlbU5hbWVMaXN0MS5yZWR1Y2UoZnVuY3Rpb24ocHJldiwgZWxlbWVudCkgew0KICAgICAgICBpZiAoIXByZXYuZmluZChlbCA9PiBlbC50ZXh0ID09IGVsZW1lbnQudGV4dCkpIHsNCiAgICAgICAgICBwcmV2LnB1c2goZWxlbWVudCk7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHByZXY7DQogICAgICB9LCBbXSk7DQogICAgICB0aGlzLmZpbHRlcnBkRXh0UHJlbU5hbWVMaXN0MiA9IHRoaXMuZmlsdGVycGRFeHRQcmVtTmFtZUxpc3QyLnJlZHVjZShmdW5jdGlvbihwcmV2LCBlbGVtZW50KSB7DQogICAgICAgIGlmICghcHJldi5maW5kKGVsID0+IGVsLnRleHQgPT0gZWxlbWVudC50ZXh0KSkgew0KICAgICAgICAgIHByZXYucHVzaChlbGVtZW50KTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gcHJldjsNCiAgICAgIH0sIFtdKTsNCiAgICAgIHRoaXMuc2VsZWN0ZWRBZGRpdGlvbiA9IHt9DQogICAgICB0aGlzLnJlc2V0Rm9ybUFkZGl0aW9uKCkNCiAgICAgIGlmICh0aGlzLmFkZGl0aW9uVGFibGVEYXRhLmxlbmd0aCA9PTEpIHsNCiAgICAgICAgdGhpcy5zZWxlY3RlZEFkZGl0aW9uID0gdGhpcy5hZGRpdGlvblRhYmxlRGF0YVswXQ0KICAgICAgICB0aGlzLnNlbGVjdGVkQWRkaXRpb25DaGFuZ2VkKCk7DQogICAgICB9DQogICAgfSwNCiAgICAnZm9ybV9jb3VudC5wZENtcG5DYWxjTW9kZScoKSB7DQogICAgICBjb25zdCB2YWwgPSB0aGlzLmZvcm1fY291bnQucGRDbXBuQ2FsY01vZGUNCiAgICAgIGlmICh2YWwgPT09ICcxJykgew0KICAgICAgICB0aGlzLmZvcm1fY291bnQucGRDbXBuQ2FsY0NvZGUgPSAnJw0KICAgICAgfSBlbHNlIGlmICh2YWwgPT09ICcyJykgew0KICAgICAgICB0aGlzLmZvcm1fY291bnQucGRDbXBuVmFsID0gJycNCiAgICAgIH0NCiAgICB9LA0KICAgICdmb3JtX2NvdW50LnBkQ21wblJhbmdlJyhzZWxlY3RlZENvZGVzKSB7DQogICAgICBpZiAoc2VsZWN0ZWRDb2Rlcy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgZm9yIChjb25zdCBwZERpc2NvdW50IG9mIHRoaXMucGREaXNjb3VudFJhbmdlT3B0aW9ucykgew0KICAgICAgICAgIHBkRGlzY291bnQuZGlzYWJsZWQgPSBmYWxzZQ0KICAgICAgICB9DQogICAgICB9IGVsc2Ugew0KICAgICAgICBpZiAodGhpcy5fLmluY2x1ZGVzKHNlbGVjdGVkQ29kZXMsICcwMDAwMDAnKSkgew0KICAgICAgICAgIGZvciAoY29uc3QgcGREaXNjb3VudCBvZiB0aGlzLnBkRGlzY291bnRSYW5nZU9wdGlvbnMpIHsNCiAgICAgICAgICAgIHBkRGlzY291bnQuZGlzYWJsZWQgPSBwZERpc2NvdW50LnZhbHVlICE9PSAnMDAwMDAwJw0KICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICBmb3IgKGNvbnN0IHBkRGlzY291bnQgb2YgdGhpcy5wZERpc2NvdW50UmFuZ2VPcHRpb25zKSB7DQogICAgICAgICAgICBwZERpc2NvdW50LmRpc2FibGVkID0gcGREaXNjb3VudC52YWx1ZSA9PT0gJzAwMDAwMCcNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBiYWNrMigpew0KICAgICAgdGhpcy4kcm91dGVyLnB1c2goe25hbWU6ICfkuqflk4HlhazlvI/orqLmraPkuLvpobUnLCBwYXJhbXM6IHt9fSkNCiAgICB9LA0KICAgIGNoYW5nZVBkQ21wbkNhbGNNb2RlKCl7DQogICAgICAvL2NvbnNvbGUubG9nKHRoaXMuZm9ybV9jb3VudC5wZENtcG5DYWxjTW9kZSkNCiAgICB9LA0KDQogICAgYnJpbmdJbkNhbGNDb2RlKHBkQnVzc0RldGFpbFR5cGUsIHBkQnVzc0lkLCBjYWxjQ29kZSkgew0KICAgICAgc3dpdGNoIChwZEJ1c3NEZXRhaWxUeXBlKSB7DQogICAgICAgIGNhc2UgJzE3JzoNCiAgICAgICAgICBmb3IgKGNvbnN0IHByZW0gb2YgdGhpcy5kZWZUYWJsZURhdGEpIHsNCiAgICAgICAgICAgIGlmIChwcmVtLmlkID09PSBOdW1iZXIocGRCdXNzSWQpKSB7DQogICAgICAgICAgICAgIHRoaXMuJHNldChwcmVtLCAncGRQcmVtQ2FsY0NvZGUnLCBjYWxjQ29kZSkNCiAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgICAgaWYgKHRoaXMuZm9ybV9kZWYuaWQgPT09IE51bWJlcihwZEJ1c3NJZCkpIHsNCiAgICAgICAgICAgIHRoaXMuZm9ybV9kZWYucGRQcmVtQ2FsY0NvZGUgPSBjYWxjQ29kZQ0KICAgICAgICAgIH0NCiAgICAgICAgICBicmVhaw0KICAgICAgICBjYXNlICcxOSc6DQogICAgICAgICAgZm9yIChjb25zdCBleHRQcmVtIG9mIHRoaXMuYWRkaXRpb25UYWJsZURhdGEpIHsNCiAgICAgICAgICAgIGlmIChleHRQcmVtLmlkID09PSBOdW1iZXIocGRCdXNzSWQpKSB7DQogICAgICAgICAgICAgIHRoaXMuJHNldChleHRQcmVtLCAncGRFeHRQcmVtQ2FsY0NvZGUnLCBjYWxjQ29kZSkNCiAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgICAgaWYgKHRoaXMuZm9ybV9hZGRpdGlvbi5pZCA9PT0gTnVtYmVyKHBkQnVzc0lkKSkgew0KICAgICAgICAgICAgdGhpcy5mb3JtX2FkZGl0aW9uLnBkRXh0UHJlbUNhbGNDb2RlID0gY2FsY0NvZGUNCiAgICAgICAgICB9DQogICAgICAgICAgYnJlYWsNCiAgICAgICAgY2FzZSAnNDAnOg0KICAgICAgICAgIGZvciAoY29uc3QgZGlzY291bnQgb2YgdGhpcy5kaXNjb3VudFRhYmxlRGF0YSkgew0KICAgICAgICAgICAgaWYgKGRpc2NvdW50LmlkID09PSBOdW1iZXIocGRCdXNzSWQpKSB7DQogICAgICAgICAgICAgIHRoaXMuJHNldChkaXNjb3VudCwgJ3BkQ21wbkNhbGNDb2RlJywgY2FsY0NvZGUpDQogICAgICAgICAgICAgIGJyZWFrDQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICAgIGlmICh0aGlzLmZvcm1fY291bnQuaWQgPT09IE51bWJlcihwZEJ1c3NJZCkpIHsNCiAgICAgICAgICAgIHRoaXMuZm9ybV9jb3VudC5wZENtcG5DYWxjQ29kZSA9IGNhbGNDb2RlDQogICAgICAgICAgfQ0KICAgICAgICAgIGJyZWFrDQogICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgYnJlYWsNCiAgICAgIH0NCiAgICB9LA0KICAgIGRpc2NvdW50Q2xpY2soKSB7DQogICAgICBpZiAodGhpcy5kaXNjb3VudEZsYWcgPT09ICdOJykgew0KICAgICAgICB0aGlzLnF1aWNraWNvbl9kaXNjb3VudCA9ICJlbC1pY29uLWFycm93LWRvd24iDQogICAgICAgIHRoaXMuZGlzY291bnRGbGFnID0gJ1knDQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLnF1aWNraWNvbl9kaXNjb3VudCA9ICJlbC1pY29uLWFycm93LXJpZ2h0Ig0KICAgICAgICB0aGlzLmRpc2NvdW50RmxhZyA9ICdOJw0KICAgICAgfQ0KICAgIH0sDQogICAgLy/lhazlvI8NCiAgICBnb0NsaWNrcyhudW0xLCBudW0yKSB7DQogICAgICB0aGlzLmd1YXJhbnRlZURldGFpbHMgPSBudW0xOy8v5Lia5Yqh5aSn57G7DQogICAgICB0aGlzLmNhbGN1bGF0aW9uRm9ybXVsYVR5cGUgPSBudW0yOy8v5Lia5Yqh57uG57G7DQogICAgICBpZiAobnVtMiA9PT0gJzE5Jykgey8v5Yqg6LS5DQogICAgICAgIHRoaXMucGRVd1NpVHlwZU9wdGlvbnMgPSB0aGlzLnNlbGVjdGVkQWRkaXRpb24ucGRQcmVtSWQgKyAiOiIgKyB0aGlzLnNlbGVjdGVkQWRkaXRpb24ucGRQcmVtQ29kZTsNCiAgICAgICAgdGhpcy5wZFV3U2lUeXBlRHRPcHRpb25zID0gdGhpcy5zZWxlY3RlZEFkZGl0aW9uLmlkICsgIjoiICsgdGhpcy5zZWxlY3RlZEFkZGl0aW9uLnBkRXh0UHJlbUNvZGU7DQogICAgICB9IGVsc2Ugey8v57y06LS5DQogICAgICAgIHRoaXMucGRVd1NpVHlwZU9wdGlvbnMgPSB0aGlzLnNlbGVjdGVkRGVmLmlkID8gdGhpcy5zZWxlY3RlZERlZi5pZCArICI6IiArIHRoaXMuc2VsZWN0ZWREZWYucGRQcmVtQ29kZSA6IHRoaXMuZm9ybV9kZWZBZGQuaWQgKyAiOiIgKyB0aGlzLmZvcm1fZGVmQWRkLnBkUHJlbUNvZGUNCiAgICAgICAgdGhpcy5wZFV3U2lUeXBlRHRPcHRpb25zID0gJycNCiAgICAgIH0NCiAgICAgIHRoaXMuZGlhbG9nU2hvdy5wcmVtQW1vdW50Rm9ybXVsYSA9IHRydWU7DQogICAgfSwNCiAgICBnZXRQZERpc2NvdW50UmFuZ2UodmFsKSB7DQogICAgICB0aGlzLnBkRGlzY291bnRSYW5nZU9wdGlvbnMgPSBbXQ0KICAgICAgLy/mt7vliqDlhajpg6jpgInpobkNCiAgICAgIHRoaXMucGREaXNjb3VudFJhbmdlT3B0aW9ucy5wdXNoKHsNCiAgICAgICAgdmFsdWU6ICcwMDAwMDAnLA0KICAgICAgICBsYWJlbDogJ+WFqOmDqCcNCiAgICAgIH0pDQogICAgICAvL+a3u+WKoOe8tOi0uemAiemhuQ0KICAgICAgZm9yIChjb25zdCBwZERpc0NvdW50IG9mIHRoaXMuZGVmVGFibGVEYXRhKSB7DQogICAgICAgIGlmICh2YWwuaW5jbHVkZXMocGREaXNDb3VudC5pZCkpIHsNCiAgICAgICAgICB0aGlzLnBkRGlzY291bnRSYW5nZU9wdGlvbnMucHVzaCh7DQogICAgICAgICAgICB2YWx1ZTogcGREaXNDb3VudC5wZFByZW1Db2RlLA0KICAgICAgICAgICAgbGFiZWw6IHBkRGlzQ291bnQucGRQcmVtQ29kZSArICI6IiArIHBkRGlzQ291bnQucGRQYXlOYW1lDQogICAgICAgICAgfSkNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgLy/mt7vliqDliqDotLnpgInpobkNCiAgICAgIGZvciAoY29uc3QgcGREaXNDb3VudCBvZiB0aGlzLmFkZGl0aW9uVGFibGVEYXRhKSB7DQogICAgICAgIGlmICh2YWwuaW5jbHVkZXMocGREaXNDb3VudC5wZFByZW1JZCkpIHsNCiAgICAgICAgICB0aGlzLnBkRGlzY291bnRSYW5nZU9wdGlvbnMucHVzaCh7DQogICAgICAgICAgICB2YWx1ZTogcGREaXNDb3VudC5wZEV4dFByZW1Db2RlLA0KICAgICAgICAgICAgbGFiZWw6IHBkRGlzQ291bnQucGRFeHRQcmVtQ29kZSArICItIiArIHBkRGlzQ291bnQucGRFeHRQcmVtTmFtZQ0KICAgICAgICAgIH0pDQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIC8v6K6+572u572u54Gw5bGe5oCnDQogICAgICBmb3IgKGNvbnN0IHBkRGlzY291bnQgb2YgdGhpcy5wZERpc2NvdW50UmFuZ2VPcHRpb25zKSB7DQogICAgICAgIHRoaXMuJHNldChwZERpc2NvdW50LCAnZGlzYWJsZWQnLCBmYWxzZSkNCiAgICAgIH0NCiAgICB9LA0KICAgIGNoYW5nZURpYWxvZ1Zpc2libGVfZm9ybXVsYShmbGFnKSB7DQogICAgICBpZiAoZmxhZyA9PT0gdHJ1ZSkgew0KICAgICAgICB0aGlzLnBkVXdTaVR5cGVPcHRpb25zID0gdGhpcy5wZHRlbXBQZEJuZnQNCiAgICAgIH0NCiAgICAgIHRoaXMuZGlhbG9nU2hvdy5wcmVtQW1vdW50Rm9ybXVsYSA9IGZsYWcNCiAgICB9LA0KICAgIGNoYW5nZURpYWxvZ1Zpc2libGVfZm9ybXVsYVNlbGVjdChmbGFnLCBndWFyYW50ZWVEZXRhaWxzLCBjYWxjdWxhdGlvbkZvcm11bGFUeXBlLCBwcmVtLCBleHRQcmVtKSB7DQogICAgICBpZiAoZmxhZyA9PT0gdHJ1ZSkgew0KICAgICAgICB0aGlzLnBkVXdTaVR5cGVPcHRpb25zID0gcHJlbQ0KICAgICAgICB0aGlzLnBkVXdTaVR5cGVEdE9wdGlvbnMgPSBleHRQcmVtDQogICAgICAgIHRoaXMuZ3VhcmFudGVlRGV0YWlscyA9IGd1YXJhbnRlZURldGFpbHMNCiAgICAgICAgdGhpcy5jYWxjdWxhdGlvbkZvcm11bGFUeXBlID0gY2FsY3VsYXRpb25Gb3JtdWxhVHlwZQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy5kaWFsb2dTaG93LnByZW1BbW91bnRGb3JtdWxhID0gZmFsc2UNCiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gew0KICAgICAgICAgIHRoaXMuZGlhbG9nU2hvdy5wcmVtQW1vdW50Rm9ybXVsYSA9IHRydWUNCiAgICAgICAgfSkNCiAgICAgIH0NCiAgICAgIHRoaXMuZGlhbG9nU2hvdy5wcmVtQW1vdW50Rm9ybXVsYVNlbGVjdCA9IGZsYWcNCiAgICB9LA0KICAgIGNoYW5nZURpYWxvZ1Zpc2libGVfcGREaXNjb3VudFNlbGVjdChmbGFnKSB7DQogICAgICB0aGlzLmRpYWxvZ1Nob3cucGREaXNjb3VudEZvcm11bGFTZWxlY3QgPSBmbGFnDQogICAgICBpZiAoZmxhZyA9PT0gZmFsc2UpIHsNCiAgICAgICAgdGhpcy5kaWFsb2dTaG93LnBkRGlzY291bnRGb3JtdWxhID0gZmFsc2UNCiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gew0KICAgICAgICAgIHRoaXMuZGlhbG9nU2hvdy5wZERpc2NvdW50Rm9ybXVsYSA9IHRydWUNCiAgICAgICAgfSkNCiAgICAgIH0NCiAgICB9LA0KICAgIGZpbHRlckhhbmRsZXIodmFsdWUsIHJvdywgY29sdW1uKSB7DQogICAgICBpZiAoY29sdW1uKSB7DQogICAgICAgIGNvbnN0IHByb3BlcnR5ID0gY29sdW1uWyJwcm9wZXJ0eSJdOw0KICAgICAgICByZXR1cm4gcm93W3Byb3BlcnR5XSA9PT0gdmFsdWU7DQogICAgICB9DQogICAgfSwNCiAgICBmaWx0ZXJIYW5kbGVyRGlzY291bnQodmFsdWUsIHJvdywgY29sdW1uKSB7DQogICAgICBpZiAoY29sdW1uKSB7DQogICAgICAgIGNvbnN0IHByb3BlcnR5ID0gY29sdW1uWyJwcm9wZXJ0eSJdOw0KICAgICAgICByZXR1cm4gcm93W3Byb3BlcnR5XSA9PT0gdmFsdWU7DQogICAgICB9DQogICAgfSwNCiAgICAvL+inhOWImQ0KICAgIGdvUnVsZXMobnVtMSwgbnVtMikgew0KICAgICAgdGhpcy5ndWFyYW50ZWVEZXRhaWxzID0gbnVtMTsvL+S4muWKoeWkp+exuw0KICAgICAgdGhpcy5jYWxjdWxhdGlvbkZvcm11bGFUeXBlID0gbnVtMjsvL+S4muWKoee7huexuw0KICAgICAgdGhpcy5kaWFsb2dSdWxlc1Nob3cucHJlbVJ1bGVzID0gdHJ1ZTsNCiAgICAgIHRoaXMucGRVd1NpVHlwZU9wdGlvbnMgPSB0aGlzLmZvcm1fZGVmLmlkICsgIjoiICsgdGhpcy5mb3JtX2RlZi5wZFByZW1Db2RlOw0KICAgIH0sDQogICAgZ29QZERpc2NvdW50U2VsZWN0KG51bTEsIG51bTIpIHsNCiAgICAgIHRoaXMuZ3VhcmFudGVlRGV0YWlscyA9IG51bTE7Ly/kuJrliqHlpKfnsbsNCiAgICAgIHRoaXMuY2FsY3VsYXRpb25Gb3JtdWxhVHlwZSA9IG51bTI7Ly/kuJrliqHnu4bnsbsNCiAgICAgIHRoaXMuZGlhbG9nU2hvdy5wZERpc2NvdW50Rm9ybXVsYSA9IHRydWU7DQogICAgICB0aGlzLnBkVXdTaVR5cGVPcHRpb25zID0gdGhpcy5mb3JtX2RlZjsNCiAgICAgIHRoaXMucGREaXNDb3VudCA9IHRoaXMuZm9ybV9jb3VudA0KICAgIH0sDQogICAgZmlsdGVyX3BkQ21wblJhbmdlcyhjb2RlKSB7DQogICAgICBmb3IgKGNvbnN0IGRlZiBvZiBfdGhpcy5kZWZUYWJsZURhdGEpIHsNCiAgICAgICAgaWYgKGRlZi5wZFByZW1Db2RlID09PSBjb2RlKSB7DQogICAgICAgICAgcmV0dXJuIGRlZi5wZFByZW1Db2RlICsgIjoiICsgZGVmLnBkUGF5TmFtZQ0KICAgICAgICB9DQogICAgICB9DQogICAgICBmb3IgKGNvbnN0IGRlZiBvZiBfdGhpcy5hZGRpdGlvblRhYmxlRGF0YSkgew0KICAgICAgICBpZiAoZGVmLnBkRXh0UHJlbUNvZGUgPT09IGNvZGUpIHsNCiAgICAgICAgICByZXR1cm4gZGVmLnBkRXh0UHJlbUNvZGUgKyAiOiIgKyBkZWYucGRFeHRQcmVtTmFtZQ0KICAgICAgICB9DQogICAgICB9DQogICAgICByZXR1cm4gY29kZQ0KICAgIH0sDQogICAgY2hhbmdlRGlhbG9nVmlzaWJsZV9ydWxlcyhmbGFnKSB7DQogICAgICBpZiAoZmxhZyA9PT0gdHJ1ZSkgew0KICAgICAgICB0aGlzLnBkVXdTaVR5cGVPcHRpb25zID0gdGhpcy5wZHRlbXBQZEJuZnQNCiAgICAgIH0NCiAgICAgIHRoaXMuZGlhbG9nUnVsZXNTaG93LnByZW1SdWxlcyA9IGZsYWcNCiAgICB9LA0KICAgIGNoYW5nZURpYWxvZ1Zpc2libGVfcGREaXNjb3VudChmbGFnKSB7DQogICAgICBpZiAoZmxhZyA9PT0gdHJ1ZSkgew0KICAgICAgICB0aGlzLnBkVXdTaVR5cGVPcHRpb25zID0gdGhpcy5wZHRlbXBQZEJuZnQNCiAgICAgIH0NCiAgICAgIHRoaXMuZGlhbG9nU2hvdy5wZERpc2NvdW50Rm9ybXVsYSA9IGZsYWcNCiAgICB9LA0KICAgIGNoYW5nZURpYWxvZ1Zpc2libGVfcnVsZXNTZWxlY3QoZmxhZywgZ3VhcmFudGVlRGV0YWlscywgY2FsY3VsYXRpb25Gb3JtdWxhVHlwZSwgcHJlbSwgZXh0UHJlbSkgew0KICAgICAgaWYgKGZsYWcgPT09IHRydWUpIHsNCiAgICAgICAgdGhpcy5wZFV3U2lUeXBlT3B0aW9ucyA9IHByZW0NCiAgICAgICAgdGhpcy5wZFV3U2lUeXBlRHRPcHRpb25zID0gZXh0UHJlbQ0KICAgICAgICB0aGlzLmd1YXJhbnRlZURldGFpbHMgPSBndWFyYW50ZWVEZXRhaWxzDQogICAgICAgIHRoaXMuY2FsY3VsYXRpb25Gb3JtdWxhVHlwZSA9IGNhbGN1bGF0aW9uRm9ybXVsYVR5cGUNCiAgICAgIH0NCiAgICAgIHRoaXMuZGlhbG9nUnVsZXNTaG93LnByZW1SdWxlc1NlbGVjdCA9IGZsYWcNCiAgICB9LA0KICAgIC8vIOmhtemdouWIneWni+WMlg0KICAgIGluaXQoKSB7DQogICAgICB0aGlzLmdldFByb2R1Y3RJbmZvKCk7DQogICAgICB0aGlzLmluaXRfZmlsdGVycygpOw0KICAgICAgdGhpcy5pbml0X3BheV9mcmVxdWVuY3koKTsNCiAgICAgIHRoaXMuc2VsZWN0RGlzY291bnRSYW5nZVRhYmxlKCk7DQogICAgICB0aGlzLmluaXRfcGF5X2RhdGUoKTsNCiAgICAgIHRoaXMuaW5pdF90eXBlUmVnaW9uKCk7DQogICAgfSwNCiAgICBnZXRQcm9kdWN0SW5mbygpIHsNCiAgICAgIC8vIOW4puWFpeS6p+WTgeS/oeaBrw0KICAgICAgdGhpcy5wcm9kdWN0ID0gdGhpcy5nZXRQZERhdGEoKQ0KICAgICAgdGhpcy5wYXJhbXNfY3VycmVudFByb2R1Y3QuZXFfcGRJbmZvSWQgPSB0aGlzLnByb2R1Y3QuaWQNCiAgICAgIHRoaXMuZm9ybV9kZWYucGRJbmZvSWQgPSB0aGlzLnByb2R1Y3QuaWQNCiAgICAgIHRoaXMuZm9ybV9kZWYucGRWZXJJZCA9IHRoaXMucHJvZHVjdC5wZFZlcklkDQogICAgICB0aGlzLmZvcm1fZGVmLnBkQ29kZSA9IHRoaXMucHJvZHVjdC5wZENvZGUNCiAgICAgIHRoaXMuZm9ybV9kZWYucGROYW1lID0gdGhpcy5wcm9kdWN0LnBkTmFtZTsNCiAgICAgIHRoaXMucGFyYW1zLmZpbmVsaW5lc1JlZ2lvbiA9IHRoaXMuZ2V0UGREYXRhKCkuY1R5cGU7DQogICAgfSwNCiAgICAvLyDojrflj5bnvLTotLnpopHnjocNCiAgICBpbml0X3BheV9mcmVxdWVuY3koKSB7DQogICAgICBjb25zdCBwYXJhbXNNYXAgPSB7DQogICAgICAgIHBkX2luZm9faWQ6IHRoaXMucGFyYW1zX2N1cnJlbnRQcm9kdWN0LmVxX3BkSW5mb0lkLA0KICAgICAgICBwZF9hdHJzX2NvZGU6ICdwYXlpbnR2Jw0KICAgICAgfQ0KICAgICAgZ2V0UGRBdHRySW5mbyh0aGlzLmJ1aWxkUmVxdWVzdERhdGEocGFyYW1zTWFwKSkudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgIGNvbnN0IHBkVGVtcEF0cnNMaXN0ID0gcmVzcG9uc2UuZGF0YQ0KICAgICAgICB0aGlzLnByb2R1Y3RfZXh0cmEucGRQYXlGcmVxID0gdGhpcy5fLm1hcChwZFRlbXBBdHJzTGlzdCwgJ3BkQXRyc1ZhbCcpOw0KICAgICAgICB0aGlzLnBkUGF5RnJlcUNvcHkgPSB0aGlzLl8ubWFwKHBkVGVtcEF0cnNMaXN0LCAncGRBdHJzVmFsJyk7DQogICAgICAgIGNvbnNvbGUubG9nKCJBQUFBQUFBQUFBQUFBQUFBQUFBQSIsIHRoaXMucGRQYXlGcmVxQ29weSk7DQogICAgICB9KQ0KICAgIH0sDQogICAgLy/ojrflj5bkuqflk4HliIbnsbvmoIforrDooajkv6Hmga/lgqznvLTmoIforrANCiAgICBpbml0X3R5cGVSZWdpb24oKSB7DQogICAgICBjb25zdCBwYXJhbXNNYXAgPSB7DQogICAgICAgIHBkX2luZm9faWQ6IHRoaXMucGFyYW1zX2N1cnJlbnRQcm9kdWN0LmVxX3BkSW5mb0lkLA0KICAgICAgICBwZF9jbHNfdHlwZTogJzInDQogICAgICB9DQogICAgICBnZXRQZENsc0xhYkluZm8odGhpcy5idWlsZFJlcXVlc3REYXRhKHBhcmFtc01hcCkpLnRoZW4ocmVzcG9uc2UgPT4gew0KICAgICAgICBjb25zdCBwZFRlbXBDbHNMYWJMaXN0ID0gcmVzcG9uc2UuZGF0YQ0KICAgICAgICBjb25zdCBwZENsczZBcnJheSA9IHRoaXMuXy5tYXAocGRUZW1wQ2xzTGFiTGlzdCwgJ3BkQ2xzNicpDQogICAgICAgIGlmIChwZENsczZBcnJheS5sZW5ndGggPiAwKSB7DQogICAgICAgICAgdGhpcy5mb3JtX2RlZi5wZFVyZ2VQYXlGbGFnID0gcGRDbHM2QXJyYXlbMF0NCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9LA0KICAgIC8v6I635Y+W57y06LS55pyf6Ze0DQogICAgaW5pdF9wYXlfZGF0ZSgpew0KICAgICAgY29uc3QgcGF5TWFwID0gew0KICAgICAgICBwZF9pbmZvX2lkOiB0aGlzLnBhcmFtc19jdXJyZW50UHJvZHVjdC5lcV9wZEluZm9JZA0KICAgICAgfQ0KICAgICAgZ2V0UGF5RGF0ZSh0aGlzLmJ1aWxkUmVxdWVzdERhdGEocGF5TWFwKSkudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgIHRoaXMuZm9ybV9kZWYucGRQYXlFbmRQZXJpb2QgPSByZXNwb25zZS5kYXRhLnBkUGF5UGVyaW9kDQogICAgICB9KQ0KICAgIH0sDQogICAgLy8g5Yid5aeL5YyW562b6YCJ5ZmoDQogICAgaW5pdF9maWx0ZXJzKCkgew0KICAgICAgbGV0IGxkY29kZV9wZFByZW1DYWxNb2RlID0gdGhpcy5sZGNvZGVzWydwZF9wcmVtX2NhbF9tZXRob2QnXQ0KICAgICAgbGV0IGxkY29kZV9wZEFkZFByZW1Nb2RlID0gdGhpcy5sZGNvZGVzWydwZF9wcmVtX2FkZGl0aW9uX21vZGUnXQ0KICAgICAgbGV0IGxkY29kZV9wZFBheUFjY0tpbmQgPSB0aGlzLmxkY29kZXNbJ3BkX3ByZW1fYWNjb3VudF90eXBlJ10NCiAgICAgIGlmIChsZGNvZGVfcGRQcmVtQ2FsTW9kZSBpbnN0YW5jZW9mIEFycmF5KSB7DQogICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBsZGNvZGVfcGRQcmVtQ2FsTW9kZSkgew0KICAgICAgICAgIHRoaXMuZmlsdGVycy5wZFByZW1DYWxNb2RlLnB1c2goe3RleHQ6IGl0ZW0uY29kZW5hbWUsIHZhbHVlOiBpdGVtLmNvZGV9KQ0KICAgICAgICB9DQogICAgICB9DQogICAgICBpZiAobGRjb2RlX3BkQWRkUHJlbU1vZGUgaW5zdGFuY2VvZiBBcnJheSkgew0KICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgbGRjb2RlX3BkQWRkUHJlbU1vZGUpIHsNCiAgICAgICAgICB0aGlzLmZpbHRlcnMucGRBZGRQcmVtTW9kZS5wdXNoKHt0ZXh0OiBpdGVtLmNvZGVuYW1lLCB2YWx1ZTogaXRlbS5jb2RlfSkNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgaWYgKGxkY29kZV9wZFBheUFjY0tpbmQgaW5zdGFuY2VvZiBBcnJheSkgew0KICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgbGRjb2RlX3BkUGF5QWNjS2luZCkgew0KICAgICAgICAgIHRoaXMuZmlsdGVycy5wZFBheUFjY0tpbmQucHVzaCh7dGV4dDogaXRlbS5jb2RlbmFtZSwgdmFsdWU6IGl0ZW0uY29kZX0pDQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9LA0KICAgIGZpbHRlcl9wZFByZW1DYWxNb2RlKHZhbHVlLCByb3cpIHsNCiAgICAgIHJldHVybiByb3cucGRQcmVtQ2FsTW9kZSA9PT0gdmFsdWU7DQogICAgfSwNCiAgICBmaWx0ZXJfcGRBZGRQcmVtTW9kZSh2YWx1ZSwgcm93KSB7DQogICAgICByZXR1cm4gcm93LnBkQWRkUHJlbU1vZGUgPT09IHZhbHVlOw0KICAgIH0sDQogICAgZmlsdGVyX3BkUGF5QWNjS2luZCh2YWx1ZSwgcm93KSB7DQogICAgICByZXR1cm4gcm93LnBkUGF5QWNjS2luZCA9PT0gdmFsdWU7DQogICAgfSwNCiAgICBpbml0SGVpZ2h0KCkgew0KICAgICAgbGV0IHNjcm9sbFRvcCA9IHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wIHx8IGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wDQogICAgICB0aGlzLmlzRml4ZWQgPSB0aGlzLmZvcm1fZGVmLnBkUHJlbUFkZEZsYWcgPT09ICdZJyAmJiBzY3JvbGxUb3AgPiB0aGlzLm9mZnNldFRvcCArIDEzMA0KICAgICAgdGhpcy5maXhlZENsYXNzTmFtZSA9IHRoaXMuZ2V0Rml4ZWRDbGFzc05hbWUoKQ0KICAgIH0sDQogICAgZ2V0Rml4ZWRDbGFzc05hbWUoKSB7DQogICAgICBjb25zdCBvcGVuZWQgPSB0aGlzLnNpZGViYXIub3BlbmVkDQogICAgICBpZiAodGhpcy5pc0ZpeGVkID09PSB0cnVlKSB7DQogICAgICAgIGlmIChvcGVuZWQgPT09IHRydWUpIHsNCiAgICAgICAgICByZXR1cm4gJ2lzX2ZpeGVkX3NpZGViYXJPcGVuZWQnDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgcmV0dXJuICdpc19maXhlZF9zaWRlYmFyQ2xvc2VkJw0KICAgICAgICB9DQogICAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gJycNCiAgICAgIH0NCiAgICB9LA0KICAgIGluaXRQcm9kdWN0UXVlcnlEYXRhKCl7DQogICAgICB0aGlzLmZpbHRlclByb2R1Y3RCeU5vZGUodGhpcywnMScpDQogICAgfSwNCiAgICBzZWxlY3RlZERldGFpbFR5cGVDaGFuZ2VkKHZhbCkgew0KICAgICAgdGhpcy5wYXJhbXMuZXFfcGRJbmZvSWQgPSAnJw0KICAgICAgdmFsID09PSAnJz8gIHRoaXMuaW5pdFByb2R1Y3RRdWVyeURhdGEoKSA6IHRoaXMuZmlsdGVyUHJvZHVjdEJ5Q2F0ZWdvcnkodGhpcyx2YWwpDQogICAgfSwNCiAgICBoYW5kbGVTZWFyY2hJbkFsbFByZW1pdW0oKSB7DQogICAgICB0aGlzLiRyZWZzLmZvcm1fcXVpY2sudmFsaWRhdGUocGFzcyA9PiB7DQogICAgICAgIGlmIChwYXNzKSB7DQogICAgICAgICAgdGhpcy5wYXJhbXMuZmlyc3RPcGVuUGFnZUZsYWcgPSAnTicNCiAgICAgICAgICB0aGlzLnBhcmFtcy5ieVBhZ2UgPSAnWScNCiAgICAgICAgICB0aGlzLiRyZWZzLnBhZ2VfcXVpY2sucmVsb2FkKCkNCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9LA0KICAgIGNvcHlQcmVtaXVtVG9DdXJyZW50UHJvZHVjdChyb3cpIHsNCiAgICAgIGxldCBhZGQgPSB7fQ0KICAgICAgT2JqZWN0LmFzc2lnbihhZGQsIHJvdykNCiAgICAgIC8vIOa4hemZpOW4puWFpeeahOS4u+mUru+8jOS9v+WQjuWPsOaJp+ihjOaWsOWinuiAjOS4jeaYr+abtOaWsA0KICAgICAgYWRkLmlkID0gdW5kZWZpbmVkDQogICAgICAvLyDkvb/nlKjlvZPliY3kuqflk4Hkv6Hmga/opobnm5bljp/mnInkuqflk4Hkv6Hmga8NCiAgICAgIGFkZC5wZEluZm9JZCA9IHRoaXMucHJvZHVjdC5pZA0KICAgICAgYWRkLnBkQ29kZSA9IHRoaXMucHJvZHVjdC5wZENvZGUNCiAgICAgIGFkZC5wZE5hbWUgPSB0aGlzLnByb2R1Y3QucGROYW1lDQogICAgICBhZGQucGRWZXJJZCA9IHRoaXMucHJvZHVjdC5wZFZlcklkDQogICAgICBjb25zdCBkYXRhID0gew0KICAgICAgICBwcmVtaXVtOiBhZGQNCiAgICAgIH0NCiAgICAgIGFkZFBkdGVtcFBkUHJlbShkYXRhKS50aGVuKCgpID0+IHsNCiAgICAgICAgdGhpcy4kcmVmcy5wYWdlX2RlZi5idWlsZERhdGEoKS50aGVuKCgpID0+IHsNCiAgICAgICAgICB0aGlzLiRlbWl0KCdjaGlsZEZuJywgdHJ1ZSk7DQogICAgICAgICAgdGhpcy5ub3RpZnlTdWNjZXNzKHRoaXMuJHQoJ3N1Y2Nlc3NNZXNzYWdlLmFkZCcpKQ0KICAgICAgICAgIHRoaXMuc2VsZWN0ZWREZWZJblF1ZXJ5UmVzdWx0ID0ge30NCiAgICAgICAgfSkNCiAgICAgIH0pDQogICAgfSwNCiAgICBicmluZ0ludG9Gb3JtRGVmKCkgew0KICAgICAgdGhpcy5yZXNldEZvcm1EZWYoKQ0KICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmZvcm1fZGVmLCB0aGlzLnNlbGVjdGVkRGVmSW5RdWVyeVJlc3VsdCkNCiAgICAgIC8vIOa4hemZpOW4puWFpeeahOS4u+mUru+8jOihqOekuui/meaYr+aWsOWinuiAjOS4jeaYr+abtOaWsA0KICAgICAgdGhpcy5mb3JtX2RlZi5pZCA9IHVuZGVmaW5lZA0KICAgICAgLy8g5L2/55So5b2T5YmN5Lqn5ZOB5L+h5oGv6KaG55uW5Y6f5pyJ5Lqn5ZOB5L+h5oGvDQogICAgICB0aGlzLmZvcm1fZGVmLnBkSW5mb0lkID0gdGhpcy5wcm9kdWN0LmlkDQogICAgICB0aGlzLmZvcm1fZGVmLnBkVmVySWQgPSB0aGlzLnByb2R1Y3QucGRWZXJJZA0KICAgICAgdGhpcy5mb3JtX2RlZi5wZENvZGUgPSB0aGlzLnByb2R1Y3QucGRDb2RlDQogICAgICB0aGlzLmZvcm1fZGVmLnBkTmFtZSA9IHRoaXMucHJvZHVjdC5wZE5hbWUNCiAgICAgIGlmICghdGhpcy5zZWxlY3RlZERlZi5wZFByZW1aZXJvRmxhZykgew0KICAgICAgICB0aGlzLmZvcm1fZGVmLnBkUHJlbVplcm9GbGFnID0gJ04nDQogICAgICB9DQogICAgICBpZiAoIXRoaXMuc2VsZWN0ZWREZWYucGRVcmdlUGF5RmxhZykgew0KICAgICAgICB0aGlzLmZvcm1fZGVmLnBkVXJnZVBheUZsYWcgPSAnWScNCiAgICAgIH0NCiAgICAgIGlmICghdGhpcy5zZWxlY3RlZERlZi5wZENoYXJQcmVtUmVsKSB7DQogICAgICAgIHRoaXMuZm9ybV9kZWYucGRDaGFyUHJlbVJlbCA9ICdOJw0KICAgICAgfQ0KICAgICAgdGhpcy5wYXJhbXNfYWRkaXRpb24ucHJlbWl1bUxpc3QgPSBbdGhpcy5zZWxlY3RlZERlZl0NCiAgICAgIGlmICh0aGlzLiRyZWZzLnBhZ2VfYWRkaXRpb24pIHsNCiAgICAgICAgdGhpcy4kcmVmcy5wYWdlX2FkZGl0aW9uLnJlbG9hZCgpDQogICAgICB9DQogICAgICB0aGlzLnNlbGVjdGVkRGVmSW5RdWVyeVJlc3VsdCA9IHt9DQogICAgfSwNCiAgICBoYW5kbGVTZWFyY2hJbkN1cnJlbnRQcm9kdWN0KCkgew0KICAgICAgdGhpcy4kcmVmcy5wYWdlX2RlZi5yZWxvYWQoKQ0KICAgIH0sDQogICAgLy/liJ3lp4vljJbnvLTotLnkvJjmg6DooajmoLwNCiAgICBzZWxlY3REaXNjb3VudFJhbmdlVGFibGUoKSB7DQogICAgICB0aGlzLmRpc2NvdW50VGFibGVEYXRhID0gW10NCiAgICAgIHNlbGVjdERpc2NvdW50UmFuZ2VCeVBkSW5mb0lkKHRoaXMuYnVpbGRSZXF1ZXN0RGF0YSh7InBkSW5mb0lkIjogdGhpcy5wcm9kdWN0LmlkfSkpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgdGhpcy5kaXNjb3VudFRhYmxlRGF0YSA9IHJlcy5kYXRhDQogICAgICAgIHRoaXMuZ2V0T3JkZXJOdW1iZXIoJ2FkZGl0aW9uX2Rpc2NvdW50JykNCiAgICAgICAgaWYgKHRoaXMuZmxhZzEgPT0gMSl7DQogICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGk8IHRoaXMuZGlzY291bnRUYWJsZURhdGEubGVuZ3RoOyBpICsrKXsNCiAgICAgICAgICAgIGlmIChpID0gdGhpcy5kaXNjb3VudFRhYmxlRGF0YS5sZW5ndGggLSAxKXsNCiAgICAgICAgICAgICAgdGhpcy5mb3JtX2NvdW50LnBkQ21wbkNhbGNDb2RlID0gdGhpcy5kaXNjb3VudFRhYmxlRGF0YVtpXS5wZENtcG5DYWxjQ29kZQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9LA0KICAgIHJvd0NsaWNrX3F1aWNrKHJvdywgY29sdW1uLCBldmVudCkgew0KICAgICAgaWYgKGV2ZW50LnRhcmdldC5ub2RlTmFtZSA9PT0gIklOUFVUIikgew0KICAgICAgICBpZiAocm93LmlkID09PSB0aGlzLnNlbGVjdGVkRGVmSW5RdWVyeVJlc3VsdC5pZCkgew0KICAgICAgICAgIHRoaXMuc2VsZWN0ZWREZWZJblF1ZXJ5UmVzdWx0ID0ge30NCiAgICAgICAgICB0aGlzLnJlc2V0Rm9ybURlZigpDQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9LA0KICAgIHJvd0NsaWNrX2RlZihyb3csIGNvbHVtbiwgZXZlbnQpIHsNCiAgICAgIGlmIChldmVudC50YXJnZXQubm9kZU5hbWUgPT09ICJJTlBVVCIpIHsNCiAgICAgICAgaWYgKHJvdy5pZCA9PT0gdGhpcy5zZWxlY3RlZERlZi5pZCkgew0KICAgICAgICAgIHRoaXMuY2FuY2VsVXBkYXRlRGVmKCk7DQogICAgICAgICAgdGhpcy5pbml0X3BheV9kYXRlKCk7DQogICAgICAgICAgdGhpcy5mb3JtX2RlZi5wZFBheVN0YXJ0Q2FsTW9kZSA9ICcwJw0KICAgICAgICAgIHRoaXMuZm9ybV9kZWYucGRQYXlTdGFydENhbFJ1bGUgPSAnUycNCiAgICAgICAgICB0aGlzLmZvcm1fZGVmLnBkUGF5RW5kQ2FsTW9kZSA9ICcwJw0KICAgICAgICAgIHRoaXMuZm9ybV9kZWYucGRQYXlFbmRDYWxSdWxlID0gJ1MnDQogICAgICAgICAgdGhpcy5mb3JtX2RlZi5wZFBheURhdGVWYWx1ZSA9ICcxJw0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCiAgICBzZWxlY3RlZERlZkNoYW5nZWQoKSB7DQogICAgICB0aGlzLnJlc2V0Rm9ybURlZigpDQogICAgICBPYmplY3QuYXNzaWduKHRoaXMuZm9ybV9kZWYsIHRoaXMuc2VsZWN0ZWREZWYpDQogICAgICB0aGlzLnBheURhdGVGb3JtLnBheURhdGVUYWJsZSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5mb3JtX2RlZi5wZHRlbXBQZFByZW1QZXJpb2RMaXN0KSkNCiAgICAgIGlmICghdGhpcy5zZWxlY3RlZERlZi5wZFByZW1aZXJvRmxhZykgew0KICAgICAgICB0aGlzLmZvcm1fZGVmLnBkUHJlbVplcm9GbGFnID0gJ04nDQogICAgICB9DQogICAgICBpZiAoIXRoaXMuc2VsZWN0ZWREZWYucGRVcmdlUGF5RmxhZykgew0KICAgICAgICB0aGlzLmZvcm1fZGVmLnBkVXJnZVBheUZsYWcgPSAnWScNCiAgICAgIH0NCiAgICAgIGlmICghdGhpcy5zZWxlY3RlZERlZi5wZENoYXJQcmVtUmVsKSB7DQogICAgICAgIHRoaXMuZm9ybV9kZWYucGRDaGFyUHJlbVJlbCA9ICdOJw0KICAgICAgfQ0KDQogICAgICBpZiAodGhpcy5zZWxlY3RlZERlZi5wZFBheVN0YXJ0Q2FsUnVsZSB8fCB0aGlzLnNlbGVjdGVkRGVmLnBkUGF5U3RhcnRDYWxNb2RlIHx8IHRoaXMuc2VsZWN0ZWREZWYucGRQYXlTdGFydFBlcmlvZCl7DQogICAgICAgIHRoaXMuZm9ybV9kZWYucGRQcmVtU3RhcnRGbGFnPSdZJw0KICAgICAgfQ0KDQogICAgICB0aGlzLnBhcmFtc19hZGRpdGlvbi5wcmVtaXVtTGlzdCA9IFt0aGlzLnNlbGVjdGVkRGVmXQ0KDQogICAgICB2YXIgYXJyID0gdGhpcy5mb3JtX2RlZi5wZFBheUZyZXF1ZW5jeTsNCiAgICAgIGlmIChhcnIpew0KICAgICAgICB0aGlzLnByb2R1Y3RfZXh0cmEucGRQYXlGcmVxID0gZXZhbCgnKCcgKyBhcnIgKyAnKScpOw0KICAgICAgfWVsc2Ugew0KICAgICAgICB0aGlzLnByb2R1Y3RfZXh0cmEucGRQYXlGcmVxPVtdDQogICAgICB9DQogICAgICBpZiAodGhpcy4kcmVmcy5wYWdlX2FkZGl0aW9uKSB7DQogICAgICAgIHRoaXMuJHJlZnMucGFnZV9hZGRpdGlvbi5yZWxvYWQoKQ0KICAgICAgfQ0KDQogICAgfSwNCiAgICBjYW5jZWxVcGRhdGVEZWYoKSB7DQogICAgICB0aGlzLnJlc2V0Rm9ybURlZigpDQogICAgICB0aGlzLnNlbGVjdGVkRGVmID0ge30NCiAgICAgIHRoaXMucGFyYW1zX2FkZGl0aW9uLnByZW1pdW1MaXN0ID0gdGhpcy5kZWZUYWJsZURhdGENCiAgICAgIGlmICh0aGlzLiRyZWZzLnBhZ2VfYWRkaXRpb24pIHsNCiAgICAgICAgdGhpcy4kcmVmcy5wYWdlX2FkZGl0aW9uLnJlbG9hZCgpDQogICAgICB9DQogICAgfSwNCiAgICBoYW5kbGVBZGREZWYoKSB7DQogICAgICB0aGlzLiRyZWZzLmZvcm1fZGVmLnZhbGlkYXRlKHBhc3MgPT4gew0KICAgICAgICB0aGlzLiRyZWZzLnByb2R1Y3RfZXh0cmEudmFsaWRhdGUocGFzczIgPT4gew0KICAgICAgICAgIGlmIChwYXNzICYmIHBhc3MyKSB7DQogICAgICAgICAgICB0aGlzLiRyZWZzLnJ1bGVGb3JtMS52YWxpZGF0ZSh2YWwgPT4gew0KICAgICAgICAgICAgICBpZiAodmFsKSB7DQogICAgICAgICAgICAgICAgaWYgKCF0aGlzLnByb2R1Y3RfZXh0cmEucGRQYXlGcmVxLmV2ZXJ5KHZhbCA9PiB0aGlzLnBkUGF5RnJlcUNvcHkuaW5jbHVkZXModmFsKSkpIHsNCiAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5RXJyb3IoIue8tOi0uemikeeOh+S4jeWPr+i2hei/h+S6p+WTgee8tOi0ueiMg+WbtCIpDQogICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICghdGhpcy5wYXlEYXRlRm9ybS5wYXlEYXRlVGFibGUubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeUVycm9yKCLor7flvZXlhaXoh7PlsJHkuIDmnaHnvLTotLnmnJ/pl7QiKQ0KICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAodGhpcy5hZGRpdGlvblRhYmxlRGF0YS5sZW5ndGggIT0gMCkgew0KICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtX2RlZi5wZFByZW1BZGRGbGFnID0gJ1knDQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybV9kZWYucGRQcmVtQWRkRmxhZyA9ICdOJw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAodGhpcy5mb3JtX2RlZi5wZFBheVN0YXJ0UGVyaW9kID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtX2RlZi5wZFBheVN0YXJ0UGVyVW5pdCA9IHVuZGVmaW5lZA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAodGhpcy5mb3JtX2RlZi5wZFBheUVuZFBlcmlvZCA9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybV9kZWYucGRQYXlFbmRVbml0ID0gdW5kZWZpbmVkDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRoaXMuZm9ybV9kZWYucGRQYXlGcmVxdWVuY3kgPSB0aGlzLnByb2R1Y3RfZXh0cmEucGRQYXlGcmVxOw0KICAgICAgICAgICAgICAgIC8vIOa4hemZpOW4puWFpeeahOS4u+mUru+8jOS9v+WQjuWPsOaJp+ihjOaWsOWinuiAjOS4jeaYr+abtOaWsA0KICAgICAgICAgICAgICAgIHRoaXMuZm9ybV9kZWYuaWQgPSB1bmRlZmluZWQNCiAgICAgICAgICAgICAgICB0aGlzLmZvcm1fZGVmLnBkUHJlbVN0YXJ0RmxhZyA9ICcnOw0KICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB7DQogICAgICAgICAgICAgICAgICBwcmVtaXVtOiB0aGlzLmZvcm1fZGVmLA0KICAgICAgICAgICAgICAgICAgcGF5RGF0ZVRhYmxlOiB0aGlzLnBheURhdGVGb3JtLnBheURhdGVUYWJsZQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBhZGRQZHRlbXBQZFByZW0oZGF0YSkudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgICAgICAgICAgICAvLyB0aGlzLmZvcm1fZGVmQWRkID0gcmVzcG9uc2UuZGF0YQ0KICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtX2RlZkFkZCA9IHt9Ow0KICAgICAgICAgICAgICAgICAgdGhpcy4kcmVmcy5wYWdlX2RlZi5idWlsZERhdGEoKS50aGVuKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNldEZvcm1EZWYoKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdjaGlsZEZuJywgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5U3VjY2Vzcyh0aGlzLiR0KCdzdWNjZXNzTWVzc2FnZS5hZGQnKSkNCiAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICB0aGlzLnRhYmxlQ291bnQrKzsNCiAgICAgICAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvdygpOw0KICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KQ0KDQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRoaXMubm90aWZ5RXJyb3IodGhpcy4kdCgncGF5X2RlZi5tZXNzYWdlLmZvcm1fdmFsaWRhdGlvbl9mYWlsZWQnKSkNCiAgICAgICAgICB9DQogICAgICAgIH0pDQogICAgICB9KQ0KICAgIH0sDQogICAgaGFuZGxlVXBkYXRlRGVmKCkgew0KICAgICAgdGhpcy4kcmVmcy5mb3JtX2RlZi52YWxpZGF0ZShwYXNzID0+IHsNCiAgICAgICAgaWYgKHBhc3MpIHsNCiAgICAgICAgICB0aGlzLiRyZWZzLnJ1bGVGb3JtMS52YWxpZGF0ZSh2YWw9PnsNCiAgICAgICAgICAgIGlmKHZhbCl7DQogICAgICAgICAgICBpZighdGhpcy5wcm9kdWN0X2V4dHJhLnBkUGF5RnJlcS5ldmVyeSh2YWwgPT4gdGhpcy5wZFBheUZyZXFDb3B5LmluY2x1ZGVzKHZhbCkpKXsNCiAgICAgICAgICAgIHRoaXMubm90aWZ5RXJyb3IoIue8tOi0uemikeeOh+S4jeWPr+i2hei/h+S6p+WTgee8tOi0ueiMg+WbtCIpDQogICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgfQ0KICAgICAgICAgIHZhciBpZFJvdyA9IHRoaXMuZm9ybV9kZWYuaWQ7DQogICAgICAgICAgdGhpcy5mb3JtX2RlZi5wZFBheUZyZXF1ZW5jeSA9IHRoaXMucHJvZHVjdF9leHRyYS5wZFBheUZyZXE7DQogICAgICAgICAgdGhpcy5mb3JtX2RlZi5wZFByZW1TdGFydEZsYWcgPScnOw0KICAgICAgICAgIGxldCBwZHRlbXBQZFByZW0gPSB0aGlzLmZvcm1fZGVmOw0KICAgICAgICAgIGxldCBwZHRlbXBQZFByZW1QZXJpb2RzID0gW107DQogICAgICAgICAgaWYodGhpcy5wYXlEYXRlRm9ybS5wYXlEYXRlVGFibGUubGVuZ3RoKXsNCiAgICAgICAgICAgIHRoaXMucGF5RGF0ZUZvcm0ucGF5RGF0ZVRhYmxlLmZvckVhY2godmFsPT57DQogICAgICAgICAgICBwZHRlbXBQZFByZW1QZXJpb2RzLnB1c2goew0KICAgICAgICAgICAgcGRQYXlTdGFydFBlcmlvZDp2YWwucGRQYXlTdGFydFBlcmlvZCwNCiAgICAgICAgICAgIHBkUGF5U3RhcnRQZXJVbml0OnZhbC5wZFBheVN0YXJ0UGVyVW5pdCwNCiAgICAgICAgICAgIHBkUGF5RW5kUGVyaW9kOnZhbC5wZFBheUVuZFBlcmlvZCwNCiAgICAgICAgICAgIHBkUGF5RW5kVW5pdDp2YWwucGRQYXlFbmRVbml0DQogICAgICAgICAgfSkNCiAgICAgICAgICB9KQ0KICAgICAgICAgIH0NCiAgICAgICAgICBsZXQgZGF0YSA9IHsNCiAgICAgICAgICAgIHBkdGVtcFBkUHJlbSwNCiAgICAgICAgICAgIHBkdGVtcFBkUHJlbVBlcmlvZHMNCiAgICAgICAgICB9DQogICAgICAgICAgdXBkYXRlUGR0ZW1wUGRQcmVtKHRoaXMuYnVpbGRSZXF1ZXN0RGF0YShkYXRhKSkudGhlbihyZXMgPT4gew0KICAgICAgICAgICAgdGhpcy4kcmVmcy5wYWdlX2RlZi5idWlsZERhdGEoKS50aGVuKCgpID0+IHsNCiAgICAgICAgICAgICAgdGhpcy5yZXNldEZvcm1EZWYoKQ0KICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkRGVmID0ge30NCiAgICAgICAgICAgICAgdGhpcy4kZW1pdCgnY2hpbGRGbicsIHRydWUpOw0KICAgICAgICAgICAgICB0aGlzLm5vdGlmeVN1Y2Nlc3MocmVzLm1lc3NhZ2UpDQogICAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsNCiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUm93KGlkUm93KTsNCiAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIH0pDQogICAgICAgICAgfSkNCg0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pDQoNCg0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQoNCiAgICAvL+mAieS4ree8tOi0ueS/ruaUuemhuQ0KICAgIHNlbGVjdGVkUm93KGlkKSB7DQogICAgICB0aGlzLiRyZWZzLnBhZ2VfZGVmLmJ1aWxkRGF0YSgpLnRoZW4oKCkgPT4gew0KICAgICAgICBpZiAoaWQpIHsNCiAgICAgICAgICB2YXIgaWRSb3cgPSBpZDsNCiAgICAgICAgICBsZXQgbnVtID0gMDsNCiAgICAgICAgICBmb3IgKG51bSA9IDA7IG51bSA8IHRoaXMuZGVmVGFibGVEYXRhLmxlbmd0aDsgbnVtKyspIHsNCiAgICAgICAgICAgIGlmICh0aGlzLmRlZlRhYmxlRGF0YVtudW1dLmlkID09PSBpZFJvdykgew0KICAgICAgICAgICAgICB0aGlzLiRyZWZzLmRlZlRhYmxlRGF0YS5zZXRDdXJyZW50Um93KHRoaXMuZGVmVGFibGVEYXRhW251bV0pOw0KICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkRGVmID0gdGhpcy5kZWZUYWJsZURhdGFbbnVtXQ0KICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkRGVmQ2hhbmdlZCgpOw0KICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdGhpcy4kcmVmcy5kZWZUYWJsZURhdGEuc2V0Q3VycmVudFJvdyh0aGlzLmRlZlRhYmxlRGF0YVswXSk7DQogICAgICAgICAgdGhpcy5zZWxlY3RlZERlZiA9IHRoaXMuZGVmVGFibGVEYXRhWzBdDQogICAgICAgICAgdGhpcy5zZWxlY3RlZERlZkNoYW5nZWQoKTsNCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9LA0KICAgIGhhbmRsZURlbGV0ZURlZihyb3cpIHsNCiAgICAgIGRlbGV0ZVBkdGVtcFBkUHJlbShyb3cuaWQpLnRoZW4oKCkgPT4gew0KICAgICAgICBpZiAocm93LnBkUHJlbUNvZGUgPT09IHRoaXMuZm9ybV9kZWZBZGQucGRQcmVtQ29kZSkgew0KICAgICAgICAgIHRoaXMuZm9ybV9kZWZBZGQgPSB7fQ0KICAgICAgICB9DQogICAgICAgIC8vIOWIoOmZpOWKoOi0ueWKqOaAgeihqOagvOS4reWxnuS6juivpeadoee8tOi0ueeahOWKoOi0uQ0KICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYWRkaXRpb25BZGRUYWJsZURhdGEubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICBsZXQgYWRkaXRpb25BZGQgPSB0aGlzLmFkZGl0aW9uQWRkVGFibGVEYXRhW2ldDQogICAgICAgICAgaWYgKGFkZGl0aW9uQWRkLnBkUHJlbUlkID09PSB0aGlzLnNlbGVjdGVkRGVmLmlkKSB7DQogICAgICAgICAgICB0aGlzLmFkZGl0aW9uQWRkVGFibGVEYXRhLnNwbGljZShpLCAxKQ0KICAgICAgICAgICAgaS0tDQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGxldCBvcGVyYXRpb25GbGFnDQogICAgICAgIGlmICh0aGlzLl8uaW5jbHVkZXModGhpcy5kZWZUYWJsZURhdGEsIHRoaXMuc2VsZWN0ZWREZWYpKSB7DQogICAgICAgICAgaWYgKHRoaXMuZGVmVGFibGVEYXRhLmxlbmd0aCA9PT0gMSAmJiB0aGlzLiRyZWZzLnBhZ2VfZGVmLnBhZ2UgPiAxKSB7DQogICAgICAgICAgICB0aGlzLiRyZWZzLnBhZ2VfZGVmLnBhZ2UgLT0gMQ0KICAgICAgICAgIH0NCiAgICAgICAgICBvcGVyYXRpb25GbGFnID0gJ2J1aWxkRGF0YScNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICBvcGVyYXRpb25GbGFnID0gJ3JlbG9hZCcNCiAgICAgICAgfQ0KICAgICAgICBzd2l0Y2ggKG9wZXJhdGlvbkZsYWcpIHsNCiAgICAgICAgICBjYXNlICdidWlsZERhdGEnOg0KICAgICAgICAgICAgdGhpcy4kcmVmcy5wYWdlX2RlZi5idWlsZERhdGEoKS50aGVuKCgpID0+IHsNCiAgICAgICAgICAgICAgdGhpcy5yZXNldEZvcm1EZWYoKQ0KICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkRGVmID0ge30NCiAgICAgICAgICAgICAgdGhpcy5ub3RpZnlTdWNjZXNzKHRoaXMuJHQoJ3N1Y2Nlc3NNZXNzYWdlLmRlbGV0ZScpKQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIGJyZWFrDQogICAgICAgICAgY2FzZSAncmVsb2FkJzoNCiAgICAgICAgICAgIHRoaXMuJHJlZnMucGFnZV9kZWYucmVsb2FkKCkudGhlbigoKSA9PiB7DQogICAgICAgICAgICAgIHRoaXMucmVzZXRGb3JtRGVmKCkNCiAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZERlZiA9IHt9DQogICAgICAgICAgICAgIHRoaXMubm90aWZ5U3VjY2Vzcyh0aGlzLiR0KCdzdWNjZXNzTWVzc2FnZS5kZWxldGUnKSkNCiAgICAgICAgICAgIH0pDQogICAgICAgICAgICBicmVhaw0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQogICAgcm93Q2xpY2tfYWRkaXRpb24ocm93LCBjb2x1bW4sIGV2ZW50KSB7DQogICAgICBpZiAoZXZlbnQudGFyZ2V0Lm5vZGVOYW1lID09PSAiSU5QVVQiKSB7DQogICAgICAgIGlmIChyb3cuaWQgPT09IHRoaXMuc2VsZWN0ZWRBZGRpdGlvbi5pZCkgew0KICAgICAgICAgIHRoaXMuY2FuY2VsVXBkYXRlQWRkaXRpb24oKQ0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCiAgICByb3dDbGlja19kaXNjb3VudChyb3csIGNvbHVtbiwgZXZlbnQpIHsNCiAgICAgIGlmIChldmVudC50YXJnZXQubm9kZU5hbWUgPT09ICJJTlBVVCIpIHsNCiAgICAgICAgaWYgKHJvdy5pZCA9PT0gdGhpcy5zZWxlY3RlZERpc2NvdW50LmlkKSB7DQogICAgICAgICAgdGhpcy5zZWxlY3RlZERpc2NvdW50ID0ge30NCiAgICAgICAgICB0aGlzLnJlc2V0RGlzY291bnRGb3JtKCkNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0sDQogICAgc2VsZWN0ZWRBZGRpdGlvbkNoYW5nZWQoKSB7DQogICAgICB0aGlzLnJlc2V0Rm9ybUFkZGl0aW9uKCkNCiAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5mb3JtX2FkZGl0aW9uLCB0aGlzLnNlbGVjdGVkQWRkaXRpb24pDQogICAgfSwNCiAgICBzZWxlY3RlZERpc2NvdW50Q2hhbmdlZCgpIHsNCiAgICAgIHRoaXMucmVzZXREaXNjb3VudEZvcm0oKQ0KICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmZvcm1fY291bnQsIHRoaXMuc2VsZWN0ZWREaXNjb3VudCkNCiAgICAgIHRoaXMuZm9ybV9jb3VudC5wZFByZW1JZHMgPSBbdGhpcy5zZWxlY3RlZERpc2NvdW50LnBkUHJlbUlkXQ0KICAgICAgdGhpcy5nZXRQZERpc2NvdW50UmFuZ2UoW3RoaXMuc2VsZWN0ZWREaXNjb3VudC5wZFByZW1JZF0pDQogICAgICAvL+iOt+WPluS8mOaDoOiMg+WbtA0KICAgICAgdGhpcy5mb3JtX2NvdW50LnBkQ21wblJhbmdlID0gW3RoaXMuc2VsZWN0ZWREaXNjb3VudC5wZENtcG5SYW5nZV0NCiAgICB9LA0KICAgIHNlbGVjdEFsbEFkZGl0aW9uVHlwZSgpIHsNCiAgICAgIGZvciAoY29uc3QgYWRkaXRpb25UeXBlIG9mIHRoaXMubGRjb2Rlc1sncGRfcHJlbV9hZGRpdGlvbl90eXBlJ10pIHsNCiAgICAgICAgdGhpcy5mb3JtX2FkZGl0aW9uX2FkZC5wZEV4dFByZW1UeXBlLnB1c2goYWRkaXRpb25UeXBlLmNvZGUpDQogICAgICB9DQogICAgfSwNCiAgICBoYW5kbGVBZGRBZGRpdGlvbigpIHsNCiAgICAgIHRoaXMuJHJlZnMuZm9ybV9hZGRpdGlvbl9hZGQudmFsaWRhdGUocGFzcyA9PiB7DQogICAgICAgIGlmIChwYXNzKSB7DQogICAgICAgICAgaWYgKHRoaXMuZm9ybV9hZGRpdGlvbl9hZGQucGRQcmVtSWQubGVuZ3RoID09PSAwIHx8IHRoaXMuZm9ybV9hZGRpdGlvbl9hZGQucGRFeHRQcmVtT2JqLmxlbmd0aCA9PT0gMCB8fCB0aGlzLmZvcm1fYWRkaXRpb25fYWRkLnBkRXh0UHJlbU1vZGUubGVuZ3RoID09PSAwIHx8IHRoaXMuZm9ybV9hZGRpdGlvbl9hZGQucGRFeHRQcmVtVHlwZS5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgIHRoaXMubm90aWZ5RXJyb3IodGhpcy4kdCgncGF5X2RlZi5tZXNzYWdlLmVycm9yX2luY29tcGxldGVfaW5mb3JtYXRpb24nKSkNCiAgICAgICAgICAgIHJldHVybg0KICAgICAgICAgIH0NCiAgICAgICAgICBpZiAodGhpcy5kZWZUYWJsZURhdGEgJiYgdGhpcy5kZWZUYWJsZURhdGEubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgLy8g6aqM6K+B6YCJ5oup55qE57y06LS55L+h5oGv5piv5ZCm5YWo6YOo5pyJ5pWIDQogICAgICAgICAgICBsZXQgcGF5bWVudElkcyA9IHRoaXMuZm9ybV9hZGRpdGlvbl9hZGQucGRQcmVtSWQNCiAgICAgICAgICAgIGxldCBwYXltZW50SWRzX2F2YWlsYWJsZSA9IHRoaXMuXy5tYXAodGhpcy5kZWZUYWJsZURhdGEsICdpZCcpDQogICAgICAgICAgICBmb3IgKGNvbnN0IHBheW1lbnRJZCBvZiBwYXltZW50SWRzKSB7DQogICAgICAgICAgICAgIGlmICghdGhpcy5pc0luQXJyYXkocGF5bWVudElkLCBwYXltZW50SWRzX2F2YWlsYWJsZSkpIHsNCiAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeUVycm9yKHRoaXMuJHQoJ3BheV9kZWYubWVzc2FnZS5lcnJvcl91bmF2YWlsYWJsZV9kZWYnKSkNCiAgICAgICAgICAgICAgICByZXR1cm4NCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy8g6YCa6L+H6aqM6K+B77yM5byA5aeL5Yib5bu6DQogICAgICAgICAgICBsZXQgYXJyYXkgPSB0aGlzLmJ1aWxkQXJyYXkocGF5bWVudElkcywgdGhpcy5mb3JtX2FkZGl0aW9uX2FkZC5wZEV4dFByZW1PYmosIHRoaXMuZm9ybV9hZGRpdGlvbl9hZGQucGRFeHRQcmVtTW9kZSwgdGhpcy5mb3JtX2FkZGl0aW9uX2FkZC5wZEV4dFByZW1UeXBlKQ0KICAgICAgICAgICAgZm9yIChjb25zdCBhcnJheUl0ZW0gb2YgYXJyYXkpIHsNCiAgICAgICAgICAgICAgdGhpcy5mb3JtX2FkZGl0aW9uID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5mb3JtX2FkZGl0aW9uX2FkZCkNCiAgICAgICAgICAgICAgYXJyYXlJdGVtLmZvckVhY2goKHZhbHVlLCBpbmRleCkgPT4gew0KICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtX2FkZGl0aW9uLnBkUHJlbUlkID0gdmFsdWUNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluZGV4ID09PSAxKSB7DQogICAgICAgICAgICAgICAgICB0aGlzLmZvcm1fYWRkaXRpb24ucGRFeHRQcmVtT2JqID0gdmFsdWUNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluZGV4ID09PSAyKSB7DQogICAgICAgICAgICAgICAgICB0aGlzLmZvcm1fYWRkaXRpb24ucGRFeHRQcmVtTW9kZSA9IHZhbHVlDQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbmRleCA9PT0gMykgew0KICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtX2FkZGl0aW9uLnBkRXh0UHJlbVR5cGUgPSB2YWx1ZQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgLy8g5Li6IHBheU5hbWUg5ZKMIHBheUNvZGUg6LWL5YC8DQogICAgICAgICAgICAgIGZvciAoY29uc3QgZGVmIG9mIHRoaXMuZGVmVGFibGVEYXRhKSB7DQogICAgICAgICAgICAgICAgaWYgKGRlZi5pZCA9PT0gdGhpcy5mb3JtX2FkZGl0aW9uLnBkUHJlbUlkKSB7DQogICAgICAgICAgICAgICAgICB0aGlzLmZvcm1fYWRkaXRpb24ucGRQcmVtTmFtZSA9IGRlZi5wZFBheU5hbWUNCiAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybV9hZGRpdGlvbi5wZFByZW1Db2RlID0gZGVmLnBkUHJlbUNvZGUNCiAgICAgICAgICAgICAgICAgIGJyZWFrDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIC8vIOS4uiBwZEluZm9JZCDotYvlgLwNCiAgICAgICAgICAgICAgdGhpcy5mb3JtX2FkZGl0aW9uLnBkSW5mb0lkID0gdGhpcy5wcm9kdWN0LmlkDQogICAgICAgICAgICAgIC8vIOS4uiBwZENvZGUg6LWL5YC8DQogICAgICAgICAgICAgIHRoaXMuZm9ybV9hZGRpdGlvbi5wZENvZGUgPSB0aGlzLnByb2R1Y3QucGRDb2RlDQogICAgICAgICAgICAgIC8vIOS4uiBwZFZlcklkIOi1i+WAvA0KICAgICAgICAgICAgICB0aGlzLmZvcm1fYWRkaXRpb24ucGRWZXJJZCA9IHRoaXMucHJvZHVjdC5wZFZlcklkDQogICAgICAgICAgICAgIC8vIOS4uiBwZFByZW1DYWxjQ29kZSDotYvlgLwNCiAgICAgICAgICAgICAgdGhpcy5mb3JtX2FkZGl0aW9uLnBkRXh0UHJlbUNhbGNDb2RlID0gdGhpcy5mb3JtX2FkZGl0aW9uX2FkZC5wZEV4dFByZW1DYWxjQ29kZQ0KICAgICAgICAgICAgICAvL+S4uuWKoOi0ueWQjeensOi1i+WIneWni+WAvA0KICAgICAgICAgICAgICBsZXQgcGRBZGRQcmVtT2JqID0gdGhpcy5nZXRDb2RlTmFtZSgncGRBZGRQcmVtT2JqJywgdGhpcy5mb3JtX2FkZGl0aW9uLnBkRXh0UHJlbU9iaix0cnVlKTsNCiAgICAgICAgICAgICAgbGV0IHBkX3ByZW1fYWRkaXRpb25fYWRkaXRpb25fbW9kZSA9IHRoaXMuZ2V0Q29kZU5hbWUoJ3BkX3ByZW1fYWRkaXRpb25fYWRkaXRpb25fbW9kZScsIHRoaXMuZm9ybV9hZGRpdGlvbi5wZEV4dFByZW1Nb2RlLHRydWUpOw0KICAgICAgICAgICAgICBsZXQgcGRfcHJlbV9hZGRpdGlvbl90eXBlID0gdGhpcy5nZXRDb2RlTmFtZSgncGRfcHJlbV9hZGRpdGlvbl90eXBlJywgdGhpcy5mb3JtX2FkZGl0aW9uLnBkRXh0UHJlbVR5cGUsdHJ1ZSk7DQogICAgICAgICAgICAgIHRoaXMuJHNldCh0aGlzLmZvcm1fYWRkaXRpb24sICdwZEV4dFByZW1OYW1lJywgcGRBZGRQcmVtT2JqK3BkX3ByZW1fYWRkaXRpb25fYWRkaXRpb25fbW9kZStwZF9wcmVtX2FkZGl0aW9uX3R5cGUpDQogICAgICAgICAgICAgIHRoaXMuYWRkaXRpb25BZGRUYWJsZURhdGEucHVzaCh0aGlzLmZvcm1fYWRkaXRpb24pDQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLmdldE9yZGVyTnVtYmVyKCdhZGRpdGlvbl9hZGQnKQ0KICAgICAgICAgICAgdGhpcy5yZXNldEZvcm1BZGRpdGlvbigpDQogICAgICAgICAgICB0aGlzLnJlc2V0Rm9ybUFkZGl0aW9uQWRkKCkNCiAgICAgICAgICAgIHRoaXMubm90aWZ5U3VjY2Vzcyh0aGlzLiR0KCdzdWNjZXNzTWVzc2FnZS5hZGQnKSkNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGhpcy5ub3RpZnlFcnJvcih0aGlzLiR0KCdwYXlfZGVmLm1lc3NhZ2UuZXJyb3JfZGVmX25vX2RlZmluZScpKQ0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfSkNCg0KICAgIH0sDQogICAgYnVpbGRBcnJheShwYXltZW50SWRzLCBhZGRpdGlvblBheVBlcnNvblR5cGVzLCBhZGRpdGlvbk1vZGVzLCBhZGRpdGlvblR5cGVzKSB7DQogICAgICBsZXQgYXJyYXkgPSBbXQ0KICAgICAgbGV0IGFycmF5X2l0ZW0gPSBbXQ0KICAgICAgbGV0IGFycmF5X3BheW1lbnRJZCA9ICcnDQogICAgICBsZXQgYXJyYXlfYWRkaXRpb25QYXlQZXJzb25UeXBlID0gJycNCiAgICAgIGxldCBhcnJheV9hZGRpdGlvbk1vZGUgPSAnJw0KICAgICAgbGV0IGFycmF5X2FkZGl0aW9uVHlwZSA9ICcnDQogICAgICBmb3IgKGNvbnN0IHBheW1lbnRJZCBvZiBwYXltZW50SWRzKSB7DQogICAgICAgIGFycmF5X3BheW1lbnRJZCA9IHBheW1lbnRJZA0KICAgICAgICBmb3IgKGNvbnN0IGFkZGl0aW9uUGF5UGVyc29uVHlwZSBvZiBhZGRpdGlvblBheVBlcnNvblR5cGVzKSB7DQogICAgICAgICAgYXJyYXlfYWRkaXRpb25QYXlQZXJzb25UeXBlID0gYWRkaXRpb25QYXlQZXJzb25UeXBlDQogICAgICAgICAgZm9yIChjb25zdCBhZGRpdGlvbk1vZGUgb2YgYWRkaXRpb25Nb2Rlcykgew0KICAgICAgICAgICAgYXJyYXlfYWRkaXRpb25Nb2RlID0gYWRkaXRpb25Nb2RlDQogICAgICAgICAgICBmb3IgKGNvbnN0IGFkZGl0aW9uVHlwZSBvZiBhZGRpdGlvblR5cGVzKSB7DQogICAgICAgICAgICAgIGFycmF5X2FkZGl0aW9uVHlwZSA9IGFkZGl0aW9uVHlwZQ0KICAgICAgICAgICAgICBhcnJheV9pdGVtLnB1c2goYXJyYXlfcGF5bWVudElkLCBhcnJheV9hZGRpdGlvblBheVBlcnNvblR5cGUsIGFycmF5X2FkZGl0aW9uTW9kZSwgYXJyYXlfYWRkaXRpb25UeXBlKQ0KICAgICAgICAgICAgICBhcnJheS5wdXNoKGFycmF5X2l0ZW0pDQogICAgICAgICAgICAgIGFycmF5X2l0ZW0gPSBbXQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgcmV0dXJuIGFycmF5DQogICAgfSwNCiAgICBoYW5kbGVVcGRhdGVBZGRpdGlvbigpIHsNCiAgICAgIHRoaXMuJHJlZnMuZm9ybV9hZGRpdGlvbi52YWxpZGF0ZShwYXNzID0+IHsNCiAgICAgICAgaWYgKHBhc3MpIHsNCiAgICAgICAgICB1cGRhdGVQZHRlbXBQZEV4dFByZW0odGhpcy5mb3JtX2FkZGl0aW9uKS50aGVuKCgpID0+IHsNCiAgICAgICAgICAgIHRoaXMuJHJlZnMucGFnZV9hZGRpdGlvbi5idWlsZERhdGEoKS50aGVuKCgpID0+IHsNCiAgICAgICAgICAgICAgdGhpcy5yZXNldEZvcm1BZGRpdGlvbigpDQogICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRBZGRpdGlvbiA9IHt9DQogICAgICAgICAgICAgIHRoaXMubm90aWZ5U3VjY2Vzcyh0aGlzLiR0KCdzdWNjZXNzTWVzc2FnZS51cGRhdGUnKSkNCiAgICAgICAgICAgIH0pDQogICAgICAgICAgfSkNCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9LA0KICAgIGNhbmNlbFVwZGF0ZUFkZGl0aW9uKCkgew0KICAgICAgdGhpcy5yZXNldEZvcm1BZGRpdGlvbigpDQogICAgICB0aGlzLnNlbGVjdGVkQWRkaXRpb24gPSB7fQ0KICAgIH0sDQogICAgaGFuZGxlRGVsZXRlQWRkaXRpb24ocm93KSB7DQogICAgICBkZWxldGVQZHRlbXBQZEV4dFByZW0ocm93LmlkKS50aGVuKCgpID0+IHsNCiAgICAgICAgbGV0IG9wZXJhdGlvbkZsYWcNCiAgICAgICAgaWYgKHRoaXMuXy5pbmNsdWRlcyh0aGlzLmFkZGl0aW9uVGFibGVEYXRhLCB0aGlzLnNlbGVjdGVkQWRkaXRpb24pKSB7DQogICAgICAgICAgaWYgKHRoaXMuYWRkaXRpb25UYWJsZURhdGEubGVuZ3RoID09PSAxICYmIHRoaXMuJHJlZnMucGFnZV9hZGRpdGlvbi5wYWdlID4gMSkgew0KICAgICAgICAgICAgdGhpcy4kcmVmcy5wYWdlX2FkZGl0aW9uLnBhZ2UgLT0gMQ0KICAgICAgICAgIH0NCiAgICAgICAgICBvcGVyYXRpb25GbGFnID0gJ2J1aWxkRGF0YScNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICBvcGVyYXRpb25GbGFnID0gJ3JlbG9hZCcNCiAgICAgICAgfQ0KICAgICAgICBzd2l0Y2ggKG9wZXJhdGlvbkZsYWcpIHsNCiAgICAgICAgICBjYXNlICdidWlsZERhdGEnOg0KICAgICAgICAgICAgdGhpcy4kcmVmcy5wYWdlX2FkZGl0aW9uLmJ1aWxkRGF0YSgpLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgICB0aGlzLnJlc2V0Rm9ybUFkZGl0aW9uKCkNCiAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEFkZGl0aW9uID0ge30NCiAgICAgICAgICAgICAgdGhpcy5ub3RpZnlTdWNjZXNzKHRoaXMuJHQoJ3N1Y2Nlc3NNZXNzYWdlLmRlbGV0ZScpKQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIGJyZWFrDQogICAgICAgICAgY2FzZSAncmVsb2FkJzoNCiAgICAgICAgICAgIHRoaXMuJHJlZnMucGFnZV9hZGRpdGlvbi5yZWxvYWQoKS50aGVuKCgpID0+IHsNCiAgICAgICAgICAgICAgdGhpcy5yZXNldEZvcm1BZGRpdGlvbigpDQogICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRBZGRpdGlvbiA9IHt9DQogICAgICAgICAgICAgIHRoaXMubm90aWZ5U3VjY2Vzcyh0aGlzLiR0KCdzdWNjZXNzTWVzc2FnZS5kZWxldGUnKSkNCiAgICAgICAgICAgIH0pDQogICAgICAgICAgICBicmVhaw0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQogICAgLy8g5Yqo5oCB6KGo5qC85aSa6YCJ5qGGDQogICAgaGFuZGxlU2VsZWN0aW9uQ2hhbmdlKHZhbCkgew0KICAgICAgdGhpcy5zZWxlY3RlZEFkZGl0aW9uQWRkcyA9IHZhbA0KICAgIH0sDQogICAgaGFuZGxlRGVsZXRlQWRkaXRpb25BZGQoZm9ybV9hZGRpdGlvbikgew0KICAgICAgdGhpcy5hZGRpdGlvbkFkZFRhYmxlRGF0YS5zcGxpY2UodGhpcy5hZGRpdGlvbkFkZFRhYmxlRGF0YS5pbmRleE9mKGZvcm1fYWRkaXRpb24pLCAxKQ0KICAgICAgdGhpcy5zZWxlY3RlZEFkZGl0aW9uQWRkcy5zcGxpY2UodGhpcy5hZGRpdGlvbkFkZFRhYmxlRGF0YS5pbmRleE9mKGZvcm1fYWRkaXRpb24pLCAxKQ0KICAgICAgdGhpcy5nZXRPcmRlck51bWJlcignYWRkaXRpb25fYWRkJykNCiAgICAgIHRoaXMubm90aWZ5U3VjY2Vzcyh0aGlzLiR0KCdzdWNjZXNzTWVzc2FnZS5kZWxldGUnKSkNCiAgICB9LA0KICAgIGhhbmRsZVNhdmVBZGRpdGlvbkFkZCgpIHsNCiAgICAgIGxldCBudW0gPSAwOw0KICAgICAgZm9yIChudW0gPSAwOyBudW0gPCB0aGlzLnNlbGVjdGVkQWRkaXRpb25BZGRzLmxlbmd0aDsgbnVtKyspIHsNCiAgICAgICAgaWYgKCF0aGlzLnNlbGVjdGVkQWRkaXRpb25BZGRzW251bV0ucGRFeHRQcmVtTmFtZSkgew0KICAgICAgICAgIHRoaXMubm90aWZ5RXJyb3IoIuivt+i+k+WFpeWKoOi0ueWQjeensCIpDQogICAgICAgICAgcmV0dXJuDQogICAgICAgIH0NCiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRBZGRpdGlvbkFkZHNbbnVtXS5wZEV4dFByZW1Nb2RlID09ICcwMScgJiYgIXRoaXMuc2VsZWN0ZWRBZGRpdGlvbkFkZHNbbnVtXS5wZE1heFZhbCkgew0KICAgICAgICAgIHRoaXMubm90aWZ5RXJyb3IoIuivt+i+k+WFpeWKoOi0ueS4iumZkOWAvCIpDQogICAgICAgICAgcmV0dXJuDQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIGNvbnN0IHBhcmFtcyA9IHsNCiAgICAgICAgZXh0UHJlbUxpc3Q6IHRoaXMuc2VsZWN0ZWRBZGRpdGlvbkFkZHMNCiAgICAgIH0NCiAgICAgIGFkZFBkdGVtcFBkRXh0UHJlbSh0aGlzLmJ1aWxkUmVxdWVzdERhdGEocGFyYW1zKSkudGhlbigoKSA9PiB7DQogICAgICAgIHRoaXMuJHJlZnMucGFnZV9hZGRpdGlvbi5idWlsZERhdGEoKS50aGVuKCgpID0+IHsNCiAgICAgICAgICBmb3IgKGNvbnN0IHNlbGVjdGVkQWRkaXRpb25BZGQgb2YgdGhpcy5zZWxlY3RlZEFkZGl0aW9uQWRkcykgew0KICAgICAgICAgICAgdGhpcy5hZGRpdGlvbkFkZFRhYmxlRGF0YS5zcGxpY2UodGhpcy5hZGRpdGlvbkFkZFRhYmxlRGF0YS5pbmRleE9mKHNlbGVjdGVkQWRkaXRpb25BZGQpLCAxKQ0KICAgICAgICAgIH0NCiAgICAgICAgICB0aGlzLnNlbGVjdGVkQWRkaXRpb25BZGRzID0gW10NCiAgICAgICAgICB0aGlzLmdldE9yZGVyTnVtYmVyKCdhZGRpdGlvbl9hZGQnKQ0KICAgICAgICAgIHRoaXMubm90aWZ5U3VjY2Vzcyh0aGlzLiR0KCdzdWNjZXNzTWVzc2FnZS5zYXZlJykpDQogICAgICAgIH0pDQogICAgICB9KQ0KICAgIH0sDQogICAgYXN5bmMgc2F2ZURpc0NvdW50KCkgew0KICAgICAgdGhpcy4kcmVmc1siZm9ybV9jb3VudCJdLnZhbGlkYXRlKGFzeW5jIHZhbGlkMSA9PiB7DQogICAgICAgIGlmICh2YWxpZDEpIHsNCiAgICAgICAgICBsZXQgcGFyYW0gPSB7DQogICAgICAgICAgICBwZENtcG5UeXBlOiB0aGlzLmZvcm1fY291bnQucGRDbXBuVHlwZQ0KICAgICAgICAgIH07DQogICAgICAgICAgYXdhaXQgZmluZENtcG5DYWxlQ29kZSh0aGlzLmJ1aWxkUmVxdWVzdERhdGEocGFyYW0pKS50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsNCiAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubGVuZ3RoIDwgMiAmJiByZXNwb25zZS5kYXRhLmxlbmd0aCA+IDAgJiYgdGhpcy5mb3JtX2NvdW50LnBkQ21wbkNhbGNNb2RlID09IDIpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmRldGFpbFR5cGVPcHRpb25MaXN0ID0gcmVzcG9uc2UuZGF0YTsNCiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHByb2R1Y3Qgb2YgdGhpcy5kZXRhaWxUeXBlT3B0aW9uTGlzdCkgew0KICAgICAgICAgICAgICAgICAgaWYgKHByb2R1Y3QuY21wbkNhbGNDb2RlID09IG51bGwpew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm1fY291bnQucGRDbXBuQ2FsY0NvZGUgPSAnJzsNCiAgICAgICAgICAgICAgICAgIH1lbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtX2NvdW50LnBkQ21wbkNhbGNDb2RlID0gcHJvZHVjdC5jbXBuQ2FsY0NvZGU7DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9ZWxzZSB7DQogICAgICAgICAgICAgICAgdGhpcy5mb3JtX2NvdW50LnBkQ21wbkNhbGNDb2RlID0gJyc7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pDQogICAgICAgICAgfSk7DQoNCiAgICAgICAgICBsZXQgUGR0ZW1wUGRDbXBuSW5mb3MgPSBbXQ0KICAgICAgICAgIGxldCBwZENtcG5SYW5nZSA9IHRoaXMuZm9ybV9jb3VudC5wZENtcG5SYW5nZQ0KICAgICAgICAgIGlmICh0aGlzLl8uaW5jbHVkZXMocGRDbXBuUmFuZ2UsICcwMDAwMDAnKSkgew0KICAgICAgICAgICAgcGRDbXBuUmFuZ2UgPSBbXQ0KICAgICAgICAgICAgZm9yIChjb25zdCBwZERpc2NvdW50IG9mIHRoaXMucGREaXNjb3VudFJhbmdlT3B0aW9ucykgew0KICAgICAgICAgICAgICBpZiAocGREaXNjb3VudC52YWx1ZSAhPT0gJzAwMDAwMCcpIHsNCiAgICAgICAgICAgICAgICBwZENtcG5SYW5nZS5wdXNoKHBkRGlzY291bnQudmFsdWUpDQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgICAgdGhpcy5mb3JtX2NvdW50LnBkVmVySWQgPSB0aGlzLnByb2R1Y3QucGRWZXJJZA0KICAgICAgICAgIHRoaXMuZm9ybV9jb3VudC5vcGVyYXRvciA9IHRoaXMucHJvZHVjdC5vcGVyYXRvcg0KICAgICAgICAgIHRoaXMuZm9ybV9jb3VudC5wZEluZm9JZCA9IHRoaXMucHJvZHVjdC5pZA0KICAgICAgICAgIHRoaXMuZm9ybV9jb3VudC5wZENvZGUgPSB0aGlzLnByb2R1Y3QucGRDb2RlDQogICAgICAgICAgdGhpcy5mb3JtX2NvdW50LnBkTmFtZSA9IHRoaXMucHJvZHVjdC5wZE5hbWUNCiAgICAgICAgICAvL+iOt+WPlue8tOi0uee8lueggQ0KICAgICAgICAgIGZvciAoY29uc3QgZGVmIG9mIF90aGlzLmRlZlRhYmxlRGF0YSkgew0KICAgICAgICAgICAgaWYgKHRoaXMuZm9ybV9jb3VudC5wZFByZW1JZHMuaW5jbHVkZXMoZGVmLmlkKSkgew0KICAgICAgICAgICAgICB0aGlzLmZvcm1fY291bnQucGRQcmVtQ29kZXMucHVzaChkZWYucGRQcmVtQ29kZSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwZENtcG5SYW5nZS5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgZm9yKGxldCBqID0gMDsgaiA8IHRoaXMuZm9ybV9jb3VudC5wZFByZW1JZHMubGVuZ3RoOyBqKyspew0KICAgICAgICAgICAgICBsZXQgUGR0ZW1wUGRDbXBuSW5mbyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5mb3JtX2NvdW50KSkNCiAgICAgICAgICAgICAgUGR0ZW1wUGRDbXBuSW5mby5wZFByZW1JZCA9IHRoaXMuZm9ybV9jb3VudC5wZFByZW1JZHNbal0NCiAgICAgICAgICAgICAgUGR0ZW1wUGRDbXBuSW5mby5wZFByZW1Db2RlID0gdGhpcy5mb3JtX2NvdW50LnBkUHJlbUNvZGVzW2pdDQogICAgICAgICAgICAgIFBkdGVtcFBkQ21wbkluZm8ucGRDbXBuUmFuZ2UgPSBwZENtcG5SYW5nZVtpXQ0KICAgICAgICAgICAgICBQZHRlbXBQZENtcG5JbmZvcy5wdXNoKFBkdGVtcFBkQ21wbkluZm8pDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICB9DQogICAgICAgICAgY29uc3QgZGF0YSA9IHsNCiAgICAgICAgICAgIFBkdGVtcFBkQ21wbkluZm9zOiBQZHRlbXBQZENtcG5JbmZvcw0KICAgICAgICAgIH0NCiAgICAgICAgICB0aGlzLmZsYWcxID0gMTsNCiAgICAgICAgICBhZGRQZHRlbXBQZENtcG5JbmZvKHRoaXMuYnVpbGRSZXF1ZXN0RGF0YShkYXRhKSkudGhlbihyZXMgPT4gew0KICAgICAgICAgICAgdGhpcy4kZW1pdCgiY2hpbGRGbiIsICJyZWxvYWQiKTsNCiAgICAgICAgICAgIGlmIChyZXMuY29kZSA9PSAyMDApIHsNCiAgICAgICAgICAgICAgdGhpcy5ub3RpZnlTdWNjZXNzKHJlcy5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgdGhpcy5jbGVhckZvcm1EaXNjb3VudCgpDQogICAgICAgICAgICAgIHRoaXMuc2VsZWN0RGlzY291bnRSYW5nZVRhYmxlKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgfSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdGhpcy5mb2N1c0l0ZW0oKQ0KICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgICB1cGRhdGVEaXNDb3VudCgpIHsNCiAgICAgIHRoaXMuJHJlZnNbImZvcm1fY291bnQiXS52YWxpZGF0ZSh2YWxpZDEgPT4gew0KICAgICAgICBpZiAodmFsaWQxKSB7DQogICAgICAgICAgY29uc3QgUGR0ZW1wUGRDbXBuSW5mbyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5mb3JtX2NvdW50KSkNCiAgICAgICAgICBQZHRlbXBQZENtcG5JbmZvLnBkQ21wblJhbmdlID0gUGR0ZW1wUGRDbXBuSW5mby5wZENtcG5SYW5nZVswXQ0KICAgICAgICAgIHVwZGF0ZVBkdGVtcFBkQ21wbkluZm8odGhpcy5idWlsZFJlcXVlc3REYXRhKHsiUGR0ZW1wUGRDbXBuSW5mbyI6IFBkdGVtcFBkQ21wbkluZm99KSkudGhlbigoKSA9PiB7DQogICAgICAgICAgICB0aGlzLiRlbWl0KCJjaGlsZEZuIiwgInJlbG9hZCIpDQogICAgICAgICAgICB0aGlzLm5vdGlmeVN1Y2Nlc3ModGhpcy4kdCgnc3VjY2Vzc01lc3NhZ2UudXBkYXRlJykpDQogICAgICAgICAgICB0aGlzLnNlbGVjdERpc2NvdW50UmFuZ2VUYWJsZSgpOw0KICAgICAgICAgICAgdGhpcy5zZWxlY3RlZERpc2NvdW50ID0ge307DQogICAgICAgICAgICB0aGlzLmNsZWFyRm9ybURpc2NvdW50KCkNCiAgICAgICAgICB9KTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0aGlzLmZvY3VzSXRlbSgpDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfSwNCiAgICAvL+mAieS4reaKmOaJo+aVsOaNrg0KICAgIHNlbGVjdGVkUm93RGlzY291bnQoZWVpZCkgew0KICAgICAgdmFyIGxpZCA9IGVlaWQ7DQogICAgICBpZiAobGlkKSB7DQogICAgICAgIGxldCBudW0gPSAwOw0KICAgICAgICBmb3IgKG51bSA9IDA7IG51bSA8IHRoaXMuZGlzY291bnRUYWJsZURhdGEubGVuZ3RoOyBudW0rKykgew0KICAgICAgICAgIGlmICh0aGlzLmRpc2NvdW50VGFibGVEYXRhW251bV0uY21wbkluZm9JZCA9PSBsaWQpIHsNCiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWREaXNjb3VudCA9IHRoaXMuZGlzY291bnRUYWJsZURhdGFbbnVtXQ0KICAgICAgICAgICAgdGhpcy5zZWxlY3RlZERpc2NvdW50Q2hhbmdlZCgpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9IGVsc2UgaWYgKGxpZCA9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgdGhpcy5zZWxlY3RlZERpc2NvdW50ID0gdGhpcy5kaXNjb3VudFRhYmxlRGF0YVt0aGlzLmRpc2NvdW50VGFibGVEYXRhLmxlbmd0aCAtIDFdDQogICAgICAgIHRoaXMuc2VsZWN0ZWREaXNjb3VudENoYW5nZWQoKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGRlbGV0ZURpc0NvdW50KHJvdykgew0KICAgICAgZGVsZXRlUGR0ZW1wUGRDbXBuSW5mbyhyb3cuaWQpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgdGhpcy4kZW1pdCgiY2hpbGRGbiIsICJyZWxvYWQiKTsNCiAgICAgICAgaWYgKHJlcy5jb2RlID09IDIwMCkgew0KICAgICAgICAgIHRoaXMubm90aWZ5U3VjY2VzcyhyZXMubWVzc2FnZSk7DQogICAgICAgICAgdGhpcy5zZWxlY3RlZERpc2NvdW50ID0ge307DQogICAgICAgICAgdGhpcy5yZXNldERpc2NvdW50Rm9ybSgpOw0KICAgICAgICAgIHRoaXMuc2VsZWN0RGlzY291bnRSYW5nZVRhYmxlKCk7DQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfSwNCiAgICAvLyDojrflj5bnm7jlkIznvJblj7fnmoTmlbDnu4QNCiAgICBnZXRPcmRlck51bWJlcihhcnJheU5hbWUpIHsNCiAgICAgIGxldCB0YWJsZURhdGENCiAgICAgIGxldCBvcmRlckluZGV4QXJyDQogICAgICBpZiAoYXJyYXlOYW1lID09PSAnYWRkaXRpb24nKSB7DQogICAgICAgIHRhYmxlRGF0YSA9IHRoaXMuYWRkaXRpb25UYWJsZURhdGENCiAgICAgIH0gZWxzZSBpZiAoYXJyYXlOYW1lID09PSAnYWRkaXRpb25fYWRkJykgew0KICAgICAgICB0YWJsZURhdGEgPSB0aGlzLmFkZGl0aW9uQWRkVGFibGVEYXRhDQogICAgICB9IGVsc2UgaWYgKGFycmF5TmFtZSA9PT0gJ2FkZGl0aW9uX2Rpc2NvdW50Jykgew0KICAgICAgICB0YWJsZURhdGEgPSB0aGlzLmRpc2NvdW50VGFibGVEYXRhDQogICAgICB9DQogICAgICBlbHNlIHsNCiAgICAgICAgcmV0dXJuDQogICAgICB9DQogICAgICBvcmRlckluZGV4QXJyID0gW10NCiAgICAgIC8vIOaMieeFpyBwYXltZW50SWQg5o6S5bqP77yM5bCGIHBheW1lbnRJZCDnm7jlkIznmoTmlbDmja7ov57lnKjkuIDotbcNCiAgICAgIHRhYmxlRGF0YSA9IHRoaXMuXy5vcmRlckJ5KHRhYmxlRGF0YSwgJ3BkUHJlbUlkJywgJ2FzYycpDQogICAgICBpZiAoYXJyYXlOYW1lID09PSAnYWRkaXRpb24nKSB7DQogICAgICAgIHRoaXMuYWRkaXRpb25UYWJsZURhdGEgPSB0YWJsZURhdGENCiAgICAgIH0gZWxzZSBpZiAoYXJyYXlOYW1lID09PSAnYWRkaXRpb25fYWRkJykgew0KICAgICAgICB0aGlzLmFkZGl0aW9uQWRkVGFibGVEYXRhID0gdGFibGVEYXRhDQogICAgICB9ZWxzZSBpZiAoYXJyYXlOYW1lID09PSAnYWRkaXRpb25fZGlzY291bnQnKSB7DQogICAgICAgIHRoaXMuZGlzY291bnRUYWJsZURhdGE9dGFibGVEYXRhDQogICAgICB9DQogICAgICBsZXQgb3JkZXJPYmogPSB7fQ0KICAgICAgdGFibGVEYXRhLmZvckVhY2goKGVsZW1lbnQsIGluZGV4KSA9PiB7DQogICAgICAgIGVsZW1lbnQucm93SW5kZXggPSBpbmRleA0KICAgICAgICBpZiAob3JkZXJPYmpbZWxlbWVudC5wZFByZW1JZF0pIHsNCiAgICAgICAgICBvcmRlck9ialtlbGVtZW50LnBkUHJlbUlkXS5wdXNoKGluZGV4KQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIG9yZGVyT2JqW2VsZW1lbnQucGRQcmVtSWRdID0gW10NCiAgICAgICAgICBvcmRlck9ialtlbGVtZW50LnBkUHJlbUlkXS5wdXNoKGluZGV4KQ0KICAgICAgICB9DQogICAgICB9KQ0KICAgICAgLy8g6ZyA6KaB5ZCI5bm255qE6KGM55qEaW5kZXjlt7Lnu4/lrZjlnKjkuoblkIzkuIDkuKrmlbDnu4Tph4zvvIzmiorov5nkupvmlbDnu4TlrZjlgqjliLAgdGhpcy5vcmRlckluZGV4QXJyDQogICAgICBmb3IgKGxldCBrIGluIG9yZGVyT2JqKSB7DQogICAgICAgIG9yZGVySW5kZXhBcnIucHVzaChvcmRlck9ialtrXSkNCiAgICAgIH0NCiAgICAgIGlmIChhcnJheU5hbWUgPT09ICdhZGRpdGlvbicpIHsNCiAgICAgICAgdGhpcy5vcmRlckluZGV4QXJyX2FkZGl0aW9uID0gb3JkZXJJbmRleEFycg0KICAgICAgfSBlbHNlIGlmIChhcnJheU5hbWUgPT09ICdhZGRpdGlvbl9hZGQnKSB7DQogICAgICAgIHRoaXMub3JkZXJJbmRleEFycl9hZGRpdGlvbl9hZGQgPSBvcmRlckluZGV4QXJyDQogICAgICB9DQogICAgICBlbHNlIGlmIChhcnJheU5hbWUgPT09ICdhZGRpdGlvbl9kaXNjb3VudCcpIHsNCiAgICAgICAgdGhpcy5vcmRlckluZGV4QXJyX2FkZGl0aW9uX2Rpc2NvdW50ID0gb3JkZXJJbmRleEFycg0KICAgICAgfQ0KICAgIH0sDQogICAgLy8g5ZCI5bm25Y2V5YWD5qC8DQogICAgb2JqZWN0U3Bhbk1ldGhvZF9hZGRpdGlvbih7cm93LCBjb2x1bW4sIHJvd0luZGV4LCBjb2x1bW5JbmRleH0pIHsNCiAgICAgIGlmIChjb2x1bW5JbmRleCA9PT0gMiB8fCBjb2x1bW5JbmRleCA9PT0gMykgew0KICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMub3JkZXJJbmRleEFycl9hZGRpdGlvbi5sZW5ndGg7IGkrKykgew0KICAgICAgICAgIGxldCBlbGVtZW50ID0gdGhpcy5vcmRlckluZGV4QXJyX2FkZGl0aW9uW2ldDQogICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBlbGVtZW50Lmxlbmd0aDsgaisrKSB7DQogICAgICAgICAgICBsZXQgaXRlbSA9IGVsZW1lbnRbal0NCiAgICAgICAgICAgIGlmIChyb3dJbmRleCA9PT0gaXRlbSkgew0KICAgICAgICAgICAgICBpZiAoaiA9PT0gMCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgICByb3dzcGFuOiBlbGVtZW50Lmxlbmd0aCwNCiAgICAgICAgICAgICAgICAgIGNvbHNwYW46IDENCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAgIHJvd3NwYW46IDAsDQogICAgICAgICAgICAgICAgICBjb2xzcGFuOiAwDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCiAgICBvYmplY3RTcGFuTWV0aG9kX2FkZGl0aW9uX2FkZCh7cm93LCBjb2x1bW4sIHJvd0luZGV4LCBjb2x1bW5JbmRleH0pIHsNCiAgICAgIGlmIChjb2x1bW5JbmRleCA9PT0gMiB8fCBjb2x1bW5JbmRleCA9PT0gMykgew0KICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMub3JkZXJJbmRleEFycl9hZGRpdGlvbl9hZGQubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICBsZXQgZWxlbWVudCA9IHRoaXMub3JkZXJJbmRleEFycl9hZGRpdGlvbl9hZGRbaV0NCiAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGVsZW1lbnQubGVuZ3RoOyBqKyspIHsNCiAgICAgICAgICAgIGxldCBpdGVtID0gZWxlbWVudFtqXQ0KICAgICAgICAgICAgaWYgKHJvd0luZGV4ID09PSBpdGVtKSB7DQogICAgICAgICAgICAgIGlmIChqID09PSAwKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAgIHJvd3NwYW46IGVsZW1lbnQubGVuZ3RoLA0KICAgICAgICAgICAgICAgICAgY29sc3BhbjogMQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgcm93c3BhbjogMCwNCiAgICAgICAgICAgICAgICAgIGNvbHNwYW46IDANCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9LA0KICAgIC8v5LyY5oOg6KGo5qC85ZCI5bm2DQogICAgb2JqZWN0U3Bhbk1ldGhvZF9kaXNjb3VudCh7cm93LCBjb2x1bW4sIHJvd0luZGV4LCBjb2x1bW5JbmRleH0pIHsNCiAgICAgIGlmIChjb2x1bW5JbmRleCA9PT0gMiB8fCBjb2x1bW5JbmRleCA9PT0gMykgew0KICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMub3JkZXJJbmRleEFycl9hZGRpdGlvbl9kaXNjb3VudC5sZW5ndGg7IGkrKykgew0KICAgICAgICAgIGxldCBlbGVtZW50ID0gdGhpcy5vcmRlckluZGV4QXJyX2FkZGl0aW9uX2Rpc2NvdW50W2ldDQogICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBlbGVtZW50Lmxlbmd0aDsgaisrKSB7DQogICAgICAgICAgICBsZXQgaXRlbSA9IGVsZW1lbnRbal0NCiAgICAgICAgICAgIGlmIChyb3dJbmRleCA9PT0gaXRlbSkgew0KICAgICAgICAgICAgICBpZiAoaiA9PT0gMCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgICByb3dzcGFuOiBlbGVtZW50Lmxlbmd0aCwNCiAgICAgICAgICAgICAgICAgIGNvbHNwYW46IDENCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAgIHJvd3NwYW46IDAsDQogICAgICAgICAgICAgICAgICBjb2xzcGFuOiAwDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCiAgICAvLyDmuIXnqbrnvLTotLnlrprkuYnooajljZUNCiAgICBjbGVhckZvcm1EZWYoKSB7DQogICAgICBjb25zdCBpZCA9IHRoaXMuZm9ybV9kZWYuaWQ7DQogICAgICBjb25zdCBmcmVxdWVuY3kgPSB0aGlzLmZvcm1fZGVmLmZyZXF1ZW5jeQ0KICAgICAgaWYgKGlkKSB7DQogICAgICAgIHRoaXMuZm9ybV9kZWYuZnJlcXVlbmN5ID0gZnJlcXVlbmN5DQogICAgICAgIHRoaXMuZm9ybV9kZWYgPSB0aGlzLnNlbGVjdGVkRGVmDQogICAgICAgIHZhciBhcnIgPSB0aGlzLmZvcm1fZGVmLnBkUGF5RnJlcXVlbmN5Ow0KICAgICAgICBpZiAoYXJyKXsNCiAgICAgICAgICB0aGlzLnByb2R1Y3RfZXh0cmEucGRQYXlGcmVxID0gZXZhbCgnKCcgKyBhcnIgKyAnKScpOw0KICAgICAgICB9ZWxzZSB7DQogICAgICAgICAgdGhpcy5wcm9kdWN0X2V4dHJhLnBkUGF5RnJlcT1bXQ0KICAgICAgICB9DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLmluaXRfcGF5X2ZyZXF1ZW5jeSgpOw0KICAgICAgICB0aGlzLnJlc2V0Rm9ybURlZigpOw0KICAgICAgICB0aGlzLmZvcm1fZGVmLmlkID0gaWQNCiAgICAgICAgdGhpcy5mb3JtX2RlZi5mcmVxdWVuY3kgPSBmcmVxdWVuY3kNCiAgICAgICAgdGhpcy5zZWxlY3RlZERlZiA9IHt9DQogICAgICAgIHRoaXMuZm9ybV9kZWYucGRQcmVtQWRkRmxhZyA9ICdZJw0KICAgICAgICB0aGlzLmZvcm1fZGVmLnBkUGF5U3RhcnRDYWxNb2RlID0gJzAnDQogICAgICAgIHRoaXMuZm9ybV9kZWYucGRQYXlTdGFydENhbFJ1bGUgPSAnUycNCiAgICAgICAgdGhpcy5mb3JtX2RlZi5wZFBheUVuZENhbE1vZGUgPSAnMCcNCiAgICAgICAgdGhpcy5mb3JtX2RlZi5wZFBheUVuZENhbFJ1bGUgPSAnUycNCiAgICAgICAgdGhpcy5mb3JtX2RlZi5wZFBheURhdGVWYWx1ZSA9ICcxJw0KICAgICAgICB0aGlzLmluaXRfcGF5X2RhdGUoKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIC8vIOa4heepuuWKoOi0ueWumuS5ieihqOWNlQ0KICAgIGNsZWFyRm9ybUFkZGl0aW9uKCkgew0KICAgICAgdGhpcy5zZWxlY3RlZEFkZGl0aW9uQ2hhbmdlZCgpOw0KICAgICAgLyogICAgICB0aGlzLmZvcm1fYWRkaXRpb24ucGRFeHRQcmVtTmFtZSA9ICcnDQogICAgICAgICAgICB0aGlzLmZvcm1fYWRkaXRpb24ucGRFeHRQcmVtT2JqID0gJycNCiAgICAgICAgICAgIHRoaXMuZm9ybV9hZGRpdGlvbi5wZEV4dFByZW1Nb2RlID0gJycNCiAgICAgICAgICAgIHRoaXMuZm9ybV9hZGRpdGlvbi5wZEV4dFByZW1UeXBlID0gJycNCiAgICAgICAgICAgIHRoaXMuZm9ybV9hZGRpdGlvbi5wZE1heFZhbCA9IHVuZGVmaW5lZA0KICAgICAgICAgICAgdGhpcy5mb3JtX2FkZGl0aW9uLnBkRXh0UHJlbUNhbGNDb2RlID0gJycqLw0KICAgIH0sDQogICAgY2xlYXJGb3JtRGlzY291bnQoKSB7DQogICAgIC8qIGlmICh0aGlzLnNlbGVjdGVkRGlzY291bnQuaWQpIHsNCiAgICAgICAgdGhpcy5zZWxlY3RlZERpc2NvdW50Q2hhbmdlZCgpOw0KICAgICAgfSBlbHNlIHt9Ki8NCiAgICAgICAgdGhpcy5zZWxlY3RlZERpc2NvdW50ID0ge30NCiAgICAgICAgdGhpcy5yZXNldERpc2NvdW50Rm9ybSgpDQogICAgfSwNCiAgICAvL+mHjee9ruS8mOaDoOWvueixoQ0KICAgIHJlc2V0RGlzY291bnRGb3JtKCkgew0KICAgICAgdGhpcy5wZERpc2NvdW50UmFuZ2VPcHRpb25zID0gW3sNCiAgICAgICAga2V5OiAnMDAwMDAwJywNCiAgICAgICAgdmFsdWU6ICcwMDAwMDAnLA0KICAgICAgICBsYWJlbDogJ+WFqOmDqCcsDQogICAgICAgIGRpc2FibGVkOiB0cnVlDQogICAgICB9XQ0KICAgICAgdGhpcy5mb3JtX2NvdW50ID0gew0KICAgICAgICBwZFZlcklkOiAnJywNCiAgICAgICAgb3BlcmF0b3I6ICcnLA0KICAgICAgICBwZFR5cGU6ICcnLA0KICAgICAgICBwZERlZlR5cGU6ICcnLA0KICAgICAgICBwZEluZm9JZDogJycsDQogICAgICAgIHBkQ29kZTogJycsDQogICAgICAgIHBkTmFtZTogJycsDQogICAgICAgIHBkUHJlbUlkOiAnJywNCiAgICAgICAgcGRQcmVtQ29kZTogJycsDQogICAgICAgIHBkUHJlbUNvZGVzOiBbXSwNCiAgICAgICAgcGRDbXBuUmFuZ2U6IFtdLA0KICAgICAgICBwZENtcG5UeXBlOiAnJywNCiAgICAgICAgY21wbkluZm9JZDogJycsDQogICAgICAgIHBkQ21wbkNvZGU6ICcnLA0KICAgICAgICBwZENtcG5PcmRlcjogdGhpcy5jb25maWdSYW5nZUxlbmd0aCwNCiAgICAgICAgcGRDbXBuQ2FsY01vZGU6ICcnLA0KICAgICAgICBwZENtcG5WYWw6ICcnLA0KICAgICAgICBwZENtcG5DYWxjQ29kZTogJycsDQogICAgICAgIHBkQ21wbkRlc2M6ICcnDQogICAgICB9DQogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgIHRoaXMuJHJlZnMuZm9ybV9jb3VudC5jbGVhclZhbGlkYXRlKCkNCiAgICAgIH0pDQogICAgfSwNCiAgICAvLyDph43nva7nvLTotLnlr7nosaHvvIjnm7jlvZPkuo4gbmV3IOS6huS4gOS4quWvueixoe+8jOWFt+acieino+mZpOWPjOWQkee7keWumueahOaViOaenO+8iQ0KICAgIHJlc2V0Rm9ybURlZigpIHsNCiAgICAgIHRoaXMuZm9ybV9kZWYgPSB7DQogICAgICAgIGlkOiB1bmRlZmluZWQsDQogICAgICAgIHBkSW5mb0lkOiB1bmRlZmluZWQsDQogICAgICAgIHBkVmVySWQ6IHVuZGVmaW5lZCwNCiAgICAgICAgcGRDb2RlOiAnJywNCiAgICAgICAgcGROYW1lOiAnJywNCiAgICAgICAgb3BlcmF0b3I6ICcnLA0KICAgICAgICBwZFBheU5hbWU6ICcnLA0KICAgICAgICBwZFByZW1Db2RlOiAnJywNCiAgICAgICAgcGRQcmVtQ2FsTW9kZTogJ0cnLA0KICAgICAgICBwZFByZW1aZXJvRmxhZzogJ1knLA0KICAgICAgICBwZFByZW1SZWNsRmxhZzogJ04nLA0KICAgICAgICBwZFVyZ2VQYXlGbGFnOiAnWScsDQogICAgICAgIHBkUGF5U3RhcnRQZXJpb2Q6IHVuZGVmaW5lZCwNCiAgICAgICAgcGRQYXlTdGFydFBlclVuaXQ6ICdZJywNCiAgICAgICAgcGRQYXlTdGFydENhbFJ1bGU6ICdTJywNCiAgICAgICAgcGRQYXlTdGFydENhbE1vZGU6ICcwJywNCiAgICAgICAgcGRQYXlFbmRQZXJpb2Q6IHVuZGVmaW5lZCwNCiAgICAgICAgcGRQYXlFbmRVbml0OiAnWScsDQogICAgICAgIHBkUGF5RW5kQ2FsUnVsZTogJ1MnLA0KICAgICAgICBwZFBheUVuZENhbE1vZGU6ICcwJywNCiAgICAgICAgcGRBZGRQcmVtTW9kZTogJycsDQogICAgICAgIHBkUGF5QWNjS2luZDogJycsDQogICAgICAgIHBkQ2hhclByZW1SZWw6ICdOJywNCiAgICAgICAgcGRSYXRlQ2hhbmdlRmxhZzogJ04nLA0KICAgICAgICBwZFByZW1BZGRGbGFnOiAnTicsDQogICAgICAgIHBkUHJlbVN0YXJ0RmxhZzogJ04nLA0KICAgICAgICBwZFByZW1BY2NSZWxhOiAnTicsDQogICAgICAgIHBkUHJlbUNhbGNDb2RlOiAnJywNCiAgICAgICAgcGRQYXlEYXRlVmFsdWU6JzEnDQogICAgICB9DQogICAgICB0aGlzLmZvcm1fZGVmLnBkSW5mb0lkID0gdGhpcy5wcm9kdWN0LmlkDQogICAgICB0aGlzLmZvcm1fZGVmLnBkVmVySWQgPSB0aGlzLnByb2R1Y3QucGRWZXJJZA0KICAgICAgdGhpcy5mb3JtX2RlZi5wZENvZGUgPSB0aGlzLnByb2R1Y3QucGRDb2RlDQogICAgICB0aGlzLmZvcm1fZGVmLnBkTmFtZSA9IHRoaXMucHJvZHVjdC5wZE5hbWUNCiAgICAgIHRoaXMucGF5RGF0ZUZvcm0gPSB7DQogICAgICAgIHBheURhdGVUYWJsZTpbXSwNCiAgICAgIH0sDQogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgIHRoaXMuJHJlZnMuZm9ybV9kZWYuY2xlYXJWYWxpZGF0ZSgpDQogICAgICB9KQ0KICAgIH0sDQogICAgLy8g6YeN572u5Yqg6LS55a+56LGh77yI55u45b2T5LqOIG5ldyDkuobkuIDkuKrlr7nosaHvvIzlhbfmnInop6PpmaTlj4zlkJHnu5HlrprnmoTmlYjmnpzvvIkNCiAgICByZXNldEZvcm1BZGRpdGlvbigpIHsNCiAgICAgIHRoaXMuZm9ybV9hZGRpdGlvbiA9IHsNCiAgICAgICAgaWQ6IHVuZGVmaW5lZCwNCiAgICAgICAgcGRQcmVtSWQ6IHVuZGVmaW5lZCwNCiAgICAgICAgcGRWZXJJZDogdW5kZWZpbmVkLA0KICAgICAgICBvcGVyYXRvcjogJycsDQogICAgICAgIHBkRXh0UHJlbUNvZGU6ICcnLA0KICAgICAgICBwZEV4dFByZW1OYW1lOiAnJywNCiAgICAgICAgcGRQcmVtTmFtZTogJycsDQogICAgICAgIHBkUHJlbUNvZGU6ICcnLA0KICAgICAgICBwZEV4dFByZW1PYmo6ICcnLA0KICAgICAgICBwZEV4dFByZW1Nb2RlOiAnJywNCiAgICAgICAgcGRFeHRQcmVtVHlwZTogJycsDQogICAgICAgIHBkTWF4VmFsOiB1bmRlZmluZWQsDQogICAgICAgIHBkRXh0UHJlbUNhbGNDb2RlOiAnJywNCiAgICAgICAgY3JlYXRlVGltZTogdW5kZWZpbmVkLA0KICAgICAgICB1cGRhdGVUaW1lOiB1bmRlZmluZWQNCiAgICAgIH0NCiAgICAgIGlmICh0aGlzLiRyZWZzLmZvcm1fYWRkaXRpb24pIHsNCiAgICAgICAgdGhpcy4kcmVmcy5mb3JtX2FkZGl0aW9uLmNsZWFyVmFsaWRhdGUoKQ0KICAgICAgfQ0KICAgIH0sDQogICAgLy8g6YeN572u5Li05pe25Yqg6LS55a+56LGh77yI55u45b2T5LqOIG5ldyDkuobkuIDkuKrlr7nosaHvvIzlhbfmnInop6PpmaTlj4zlkJHnu5HlrprnmoTmlYjmnpzvvIkNCiAgICByZXNldEZvcm1BZGRpdGlvbkFkZCgpIHsNCiAgICAgIHRoaXMuZm9ybV9hZGRpdGlvbl9hZGQgPSB7DQogICAgICAgIGlkOiB1bmRlZmluZWQsDQogICAgICAgIHBkUHJlbUlkOiBbXSwNCiAgICAgICAgcGRFeHRQcmVtT2JqOiBbXSwNCiAgICAgICAgcGRFeHRQcmVtTW9kZTogW10sDQogICAgICAgIHBkRXh0UHJlbVR5cGU6IFtdLA0KICAgICAgICBwZEV4dFByZW1DYWxjQ29kZTogJycNCiAgICAgIH0NCiAgICAgIGlmICh0aGlzLiRyZWZzLmZvcm1fYWRkaXRpb25fYWRkKSB7DQogICAgICAgIHRoaXMuJHJlZnMuZm9ybV9hZGRpdGlvbl9hZGQuY2xlYXJWYWxpZGF0ZSgpDQogICAgICB9DQogICAgfSwNCiAgICBzaG93QWRkRmVlKCl7DQogICAgICB0aGlzLmFkZEZlZUZsYWcgPSAgIXRoaXMuYWRkRmVlRmxhZw0KICAgIH0sDQogICAgYWRkUGF5Um93KCl7DQogICAgICB0aGlzLnBheURhdGVGb3JtLnBheURhdGVUYWJsZS5wdXNoKHsNCiAgICAgICAgcGRQYXlFbmRQZXJpb2Q6dGhpcy5wcm9kdWN0LnBkUGF5UGVyaW9kLA0KICAgICAgICBwZFBheUVuZFVuaXQ6J1knLA0KICAgICAgICBwZFBheVN0YXJ0UGVyaW9kOicwJywNCiAgICAgICAgcGRQYXlTdGFydFBlclVuaXQ6J1knDQogICAgICB9KQ0KICAgIH0sDQogICAgZGVsUGF5Um93KGluZGV4LCByb3cpew0KICAgICAgdGhpcy5wYXlEYXRlRm9ybS5wYXlEYXRlVGFibGUuc3BsaWNlKGluZGV4LDEpOw0KICAgIH0sDQogIH0NCn0NCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAs4BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/product-definition/pd-framework-def/pd-structure-def/payment-def","sourcesContent":["<template>\r\n  <cus-wraper>\r\n    <div v-show=\"!productCalcRevisionShowINfo\">\r\n      <div :class=\"{ 'showDiv': this.showPageFlag == 1 }\"></div>\r\n      <cus-page-title :label=\"$t('pay_def.payment_database')\">\r\n        <guide id=\"guide\" v-if=\"!premiumCode\" />\r\n      </cus-page-title>\r\n      <!--  -->\r\n      <cus-product-info></cus-product-info>\r\n      <!--  -->\r\n      <div>\r\n        <cus-condition :disabled=\"!!premiumCode\" :label=\"$t('pay_def.quick_def')\" @show=\"quickshow = !quickshow\"></cus-condition>\r\n      </div>\r\n      <div v-if=\"quickshow\" >\r\n        <cus-form-title :first=\"true\" :label=\"$t('pay_def.paymentquickdef')\"></cus-form-title>\r\n        <el-form ref=\"form_quick\" :model=\"params\" :rules=\"rules_quick\" label-width=\"auto\">\r\n          <el-row :gutter=\"10\">\r\n            <el-col :span=\"6\">\r\n              <el-form-item :label=\"$t('pay_def.finelinesRegion')\" prop=\"finelinesRegion\">\r\n                <cus-select v-model=\"params.finelinesRegion\" @change=\"selectedDetailTypeChanged\"\r\n                            :codetype=\"'ProductCategory'\"></cus-select>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"6\">\r\n              <el-form-item :label=\"$t('pay_def.referenceProduct')\" prop=\"eq_pdInfoId\">\r\n                <el-select v-model=\"params.eq_pdInfoId\"\r\n                           :placeholder=\"$t('pay_def.message.typeRegion_finelinesRegion_first')\" clearable filterable>\r\n                  <el-option v-for=\"product in productList\" :label=\"product.pdCode + ':' + product.pdName\"\r\n                             :value=\"product.id\"></el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col  :span=\"6\">\r\n              <el-button  size=\"small\" v-if=\"!premiumCode\"  icon=\"el-icon-search\" style=\"margin-left: 5px\" dialog-disable=\"disable\"\r\n                         type=\"primary\"\r\n                         @click=\"handleSearchInAllPremium\">\r\n                {{ $t('table.search') }}\r\n              </el-button>\r\n            </el-col>\r\n          </el-row>\r\n          <el-row :gutter=\"10\" class=\"row-bg\" justify=\"center\" type=\"flex\">\r\n\r\n          </el-row>\r\n        </el-form>\r\n        <cus-table-title :label=\"$t('pay_def.def_list')\"></cus-table-title>\r\n        <el-table v-if=\"!isFixed || isFixed && pageFlag.tableVisible_def\" :data=\"quickTableData\" border\r\n                  element-loading-text=\"Loading\" fit\r\n                  highlight-current-row size=\"mini\" @row-click=\"rowClick_quick\">\r\n\r\n          <el-table-column :label=\"$t('table.id')\" align=\"center\" type=\"index\"></el-table-column>\r\n          <el-table-column :label=\"$t('table.detail')\" type=\"expand\">\r\n            <template slot-scope=\"props\">\r\n              <el-form class=\"demo-table-expand\" inline label-position=\"left\">\r\n                <el-form-item :label=\"$t('pay_def.pay_calc_method')\">\r\n                  <span>{{ props.row.pdPremCalMode | filter_calcMethod }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_zero')\">\r\n                  <span>{{ props.row.pdPremZeroFlag | filter_payZero }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('i18nView.pay_start_interval')\">\r\n                  <!-- <span>{{ props.row.pdPayStartPeriod }}{{ props.row.pdPayStartPerUnit | filter_dateSuffix }}</span> -->\r\n                  <span>{{ props.row.pdtempPdPremPeriodList|filter_pdPayStartPeriod}}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_start_calc_basis')\">\r\n                  <span>{{ props.row.pdPayStartCalRule | filter_startCalcRule }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_start_calc_valuetypes')\">\r\n                  <span>{{ props.row.pdPayStartCalMode | filter_startCalcMethod }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('i18nView.payTerm')\">\r\n                  <!-- <span>{{ props.row.pdPayEndPeriod }}{{ props.row.pdPayEndUnit | filter_dateSuffix }}</span> -->\r\n                  <span>{{ props.row.pdtempPdPremPeriodList|filter_pdPayEndPeriod}}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_end_calc_basis')\">\r\n                  <span>{{ props.row.pdPayEndCalRule | filter_endCalcRule }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_end_calc_method')\">\r\n                  <span>{{ props.row.pdPayEndCalMode | filter_endCalcMethod }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_calc_formula_code')\">\r\n                  <span>{{ props.row.pdPremCalcCode }}</span>\r\n                </el-form-item>\r\n              </el-form>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('i18nView.pdCode')\" align=\"center\" prop=\"pdCode\"></el-table-column>\r\n          <el-table-column :label=\"$t('i18nView.pdName')\" align=\"center\" prop=\"pdName\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_code')\" align=\"center\" prop=\"pdPremCode\" sortable :filters=\"quickfilterHandlerList0\"\r\n                           :filter-method=\"filterHandler\" ></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_name')\" align=\"center\" prop=\"pdPayName\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_calc_method')\" align=\"center\" prop=\"pdPremCalMode\">\r\n            <template v-slot=\"scope\">{{ scope.row.pdPremCalMode | filter_calcMethod }}</template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_prem_changeFlag')\" align=\"center\"  :filters=\"quickfilterHandlerList1\"\r\n                           :filter-method=\"filterHandler\"\r\n                           prop=\"pdRateChangeFlag\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pd_prem_acc_relaFlag')\" align=\"center\"  :filters=\"quickfilterHandlerList2\"\r\n                           :filter-method=\"filterHandler\"\r\n                           prop=\"pdPremAccRela\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.extra_payFlag')\" align=\"center\" prop=\"pdPremAddFlag\"  :filters=\"quickfilterHandlerList3\"\r\n                           :filter-method=\"filterHandler\" ></el-table-column>\r\n\r\n          <el-table-column v-if=\"!premiumCode\" :label=\"$t('pdtempPdInsuAgeInfo.operation')\" align=\"center\" width=\"150px\">\r\n            <template slot-scope=\"scope\">\r\n              <el-button  size=\"small\" v-auth=\"'pdtemp-pd-prem:copyPremium'\" type=\"primary\"\r\n                         @click=\"copyPremiumToCurrentProduct(scope.row)\"><i\r\n                class=\"el-icon-document-copy\"></i>{{ $t('pay_def.copyPremium') }}\r\n              </el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n        <!--  -->\r\n        <cus-pagination ref=\"page_quick\" v-model=\"quickTableData\"  :pageSize=\"5\"\r\n                        :params=\"params\" url=\"/pdtemp-pd-prem/base/quickQuery\"/>\r\n      </div>\r\n      <!--  -->\r\n      <cus-table-title :label=\"$t('pay_def.pay_premium')\"></cus-table-title>\r\n      <div id=\"table_def\" :class=\"fixedClassName\">\r\n        <div style=\"text-align: center\">\r\n          <div>\r\n            <cus-form-title v-if=\"isFixed\" style=\"float: left\" :label=\"$t('pay_def.pay_premium')\" :showArrow=\"true\" :display=\"true\" @show=\"pageFlag.tableVisible_def =! pageFlag.tableVisible_def\" >\r\n\r\n            </cus-form-title>\r\n<!--            <el-button   v-if=\"isFixed\" size=\"mini\" style=\"float: right\" @click=\"pageFlag.tableVisible_def =! pageFlag.tableVisible_def\">-->\r\n<!--              {{ $t('pay_def.display_or_not') }}-->\r\n<!--            </el-button>-->\r\n          </div>\r\n        </div>\r\n        <el-table v-show=\"!isFixed || isFixed && pageFlag.tableVisible_def\" ref=\"defTableData\" :data=\"defTableData\" border\r\n                  element-loading-text=\"Loading\"\r\n                  fit highlight-current-row size=\"mini\"\r\n                  @row-click=\"rowClick_def\">\r\n          <el-table-column :label=\"$t('table.select')\" align=\"center\" width=\"60px\">\r\n            <template slot-scope=\"scope\">\r\n              <el-radio-group v-model=\"selectedDef\" @change=\"selectedDefChanged\">\r\n                <el-radio :label=\"scope.row\">{{ '' }}</el-radio>\r\n              </el-radio-group>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('table.detail')\" type=\"expand\">\r\n            <template slot-scope=\"props\">\r\n              <el-form class=\"demo-table-expand\" inline label-position=\"left\">\r\n                <el-form-item :label=\"$t('pay_def.pay_calc_method')\">\r\n                  <span>{{ props.row.pdPremCalMode | filter_calcMethod }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_zero')\">\r\n                  <span>{{ props.row.pdPremZeroFlag | filter_payZero }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('i18nView.pay_start_interval')\">\r\n                  <!-- <span>{{ props.row.pdPayStartPeriod }}{{ props.row.pdPayStartPerUnit | filter_dateSuffix }}</span> -->\r\n                  <span>{{ props.row.pdtempPdPremPeriodList|filter_pdPayStartPeriod}}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_start_calc_basis')\">\r\n                  <span>{{ props.row.pdPayStartCalRule | filter_startCalcRule }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_start_calc_valuetypes')\">\r\n                  <span>{{ props.row.pdPayStartCalMode | filter_startCalcMethod }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('i18nView.payTerm')\">\r\n                  <!-- <span>{{ props.row.pdPayEndPeriod }}{{ props.row.pdPayEndUnit | filter_dateSuffix }}</span> -->\r\n                  <span>{{ props.row.pdtempPdPremPeriodList|filter_pdPayEndPeriod}}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_end_calc_basis')\">\r\n                  <span>{{ props.row.pdPayEndCalRule | filter_endCalcRule }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_end_calc_method')\">\r\n                  <span>{{ props.row.pdPayEndCalMode | filter_endCalcMethod }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_calc_formula_code')\">\r\n                  <span>{{ props.row.pdPremCalcCode }}</span>\r\n                </el-form-item>\r\n              </el-form>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('table.id')\" align=\"center\" width=\"50\">\r\n            <template v-slot=\"scope\">\r\n              {{ initTableIndex('page_def', scope.$index) }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_code')\" align=\"center\" prop=\"pdPremCode\" sortable :filters=\"filterHandlerList0\"\r\n                           :filter-method=\"filterHandler\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_name')\" align=\"center\" prop=\"pdPayName\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_prem_changeFlag')\" align=\"center\" :filters=\"filterHandlerList1\"\r\n                           :filter-method=\"filterHandler\"\r\n                           prop=\"pdRateChangeFlag\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pd_prem_acc_relaFlag')\" align=\"center\"  :filters=\"filterHandlerList2\"\r\n                           :filter-method=\"filterHandler\"\r\n                           prop=\"pdPremAccRela\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.operation')\" v-if=\"!premiumCode\" align=\"center\" width=\"100px\">\r\n            <template slot-scope=\"scope\">\r\n              <cus-del-btn v-auth=\"'pdtemp-pd-prem:delete'\" :disabled=\"!!premiumCode\"\r\n                           @ok=\"handleDeleteDef(scope.row)\"></cus-del-btn>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </div>\r\n      <!--  -->\r\n      <cus-pagination ref=\"page_def\" v-model=\"defTableData\" :autoBuild=\"false\" :pageSize=\"10\"\r\n                      :params=\"params_currentProduct\" url=\"/pdtemp-pd-prem/base/list\"/>\r\n      <!--  -->\r\n      <cus-form-title :first=\"true\" :label=\"$t('pay_def.pay_def')\"></cus-form-title>\r\n      <div>\r\n        <el-form id=\"paymentBase\" ref=\"form_def\" :disabled=\"!!premiumCode\"  :model=\"form_def\" :rules=\"rules\"\r\n                  label-width=\"auto\">\r\n          <cus-row>\r\n            <cus-col :span=\"12\">\r\n              <el-form-item :label=\"$t('pay_def.pay_name')\" prop=\"pdPayName\">\r\n                <el-input v-model=\"form_def.pdPayName\" maxlength=\"60\" show-word-limit ></el-input>\r\n              </el-form-item>\r\n            </cus-col>\r\n            <cus-col >\r\n              <el-form-item :label=\"$t('pay_def.pay_calc_method')\" prop=\"pdPremCalMode\">\r\n                <cus-select v-model=\"form_def.pdPremCalMode\" :codetype=\"'pd_prem_cal_method'\"></cus-select>\r\n              </el-form-item>\r\n            </cus-col>\r\n          </cus-row>\r\n          <cus-row >\r\n            <cus-col>\r\n              <el-form-item :label=\"$t('pay_def.pd_prem_acc_rela')\">\r\n                <el-switch v-model=\"form_def.pdPremAccRela\" active-value=\"Y\" inactive-value=\"N\"></el-switch>\r\n              </el-form-item>\r\n            </cus-col>\r\n            <cus-col >\r\n              <el-form-item :label=\"$t('pay_def.pay_zero')\">\r\n                <el-switch v-model=\"form_def.pdPremZeroFlag\" active-value=\"Y\" inactive-value=\"N\"></el-switch>\r\n              </el-form-item>\r\n            </cus-col>\r\n            <cus-col >\r\n              <el-form-item :label=\"$t('pay_def.pay_prem_change')\">\r\n                <el-switch v-model=\"form_def.pdRateChangeFlag\" active-value=\"Y\" inactive-value=\"N\"></el-switch>\r\n              </el-form-item>\r\n            </cus-col>\r\n\r\n\r\n            <div v-if=\"false\">\r\n            <cus-col >\r\n              <el-form-item :label=\"$t('pay_def.extra_pay')\">\r\n                <el-switch v-model=\"form_def.pdPremAddFlag\" active-value=\"Y\" inactive-value=\"N\"></el-switch>\r\n              </el-form-item>\r\n            </cus-col>\r\n            </div>\r\n          </cus-row>\r\n          <el-form id=\"paymentBase1\" ref=\"product_extra\" :model=\"product_extra\" :rules=\"rules1\"\r\n                   label-width=\"auto\">\r\n            <cus-row>\r\n              <cus-col :span=\"24\">\r\n                <el-form-item :label=\"$t('pay_def.pay_frequency')\" prop=\"pdPayFreq\">\r\n                  <cus-checkbox v-model=\"product_extra.pdPayFreq\" :codetype=\"'paymentFrequency'\"\r\n                  ></cus-checkbox>\r\n                </el-form-item>\r\n              </cus-col>\r\n              <!--            -->\r\n            </cus-row>\r\n          </el-form>\r\n          <cus-form-title :first=\"true\" :label=\"$t('pay_def.pay_def_time')\"></cus-form-title>\r\n          <cus-table-title :label=\"$t('i18nView.payTerm')\"></cus-table-title>\r\n          <el-form ref=\"ruleForm1\" :model=\"payDateForm\" :rules=\"rules\" class=\"payForm\">\r\n          <el-table ref=\"payDateTable\" :data=\"payDateForm.payDateTable\" align=\"center\" border class=\"wraper-table\" fit highlight-current-row>\r\n            <el-table-column :label=\"$t('table.id')\" align=\"center\" type=\"index\" width=\"80px\"></el-table-column>\r\n            <el-table-column :label=\"$t('i18nView.payTerm')\" align=\"center\" prop=\"pdPayEndPeriod\" >\r\n              <template slot-scope=\"scope\">\r\n                <el-form-item :prop=\"'payDateTable.' + scope.$index + '.pdPayEndPeriod'\" :rules='rules.pdPayEndPeriod'>\r\n                  <el-input v-model.number=\"scope.row.pdPayEndPeriod\" :placeholder=\"$t('i18nView.placeholderNum')\"  type=\"number\"></el-input>\r\n                </el-form-item>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column :label=\"$t('i18nView.pay_date_unit')\" align=\"center\" prop=\"pdPayEndUnit\" >\r\n              <template slot-scope=\"scope\">\r\n                <cus-select v-model=\"scope.row.pdPayEndUnit\" :codetype=\"'pdsbnftdy'\"></cus-select>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column :label=\"$t('i18nView.pay_start_interval')\" align=\"center\"prop=\"pdPayStartPeriod\" >\r\n              <template slot-scope=\"scope\">\r\n                <el-form-item :prop=\"'payDateTable.' + scope.$index + '.pdPayStartPeriod'\" :rules='rules.pdPayEndPeriod'>\r\n                  <el-input v-model.number=\"scope.row.pdPayStartPeriod\" :placeholder=\"$t('i18nView.placeholderNum')\"  type=\"number\"></el-input>\r\n                </el-form-item>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column :label=\"$t('i18nView.pay_start_interval_unit')\" align=\"center\" prop=\"pdPayStartPerUnit\" >\r\n              <template slot-scope=\"scope\">\r\n                <cus-select v-model=\"scope.row.pdPayStartPerUnit\" :codetype=\"'pdsbnftdy'\"></cus-select>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column :label=\"$t('pay_def.operation')\" v-if=\"!premiumCode\" align=\"center\" width=\"100px\">\r\n              <template slot-scope=\"scope\">\r\n                <cus-popover @confirm=\"delPayRow(scope.$index, scope.row)\"  icon=\"el-icon-minus\" style=\"margin-right: 5px;margin-left: 5px\" type=\"danger\"  :content=\"$t('confirmMessage.delete')\">\r\n                </cus-popover>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n          </el-form>\r\n          <el-row>\r\n            <el-button v-if=\"!premiumCode\" size=\"mini\" type=\"primary\" icon=\"el-icon-plus\" @click=\"addPayRow\" dialog-disable=\"disable\"></el-button>\r\n          </el-row>\r\n          <!-- <el-row>\r\n            <el-col :span=\"7\">\r\n              <el-form-item :label=\"$t('pay_def.pay_calc_method')\" prop=\"pdPremCalMode\">\r\n                <cus-select v-model=\"form_def.pdPremCalMode\" :codetype=\"'pd_prem_cal_method'\"></cus-select>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"8\">\r\n              <el-form-item :label=\"$t('pay_def.pay_date')\" prop=\"pdPayEndPeriod\">\r\n                <el-input v-model=\"form_def.pdPayEndPeriod\" placeholder=\"\"  type=\"number\">\r\n                  <cus-select slot=\"append\" v-model=\"form_def.pdPayEndUnit\" :codetype=\"'pdsbnftdy'\"\r\n                              class=\"cst\"></cus-select>\r\n                </el-input>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"8\">\r\n              <el-form-item :label=\"$t('pay_def.pay_start_interval')\" prop=\"pdPayStartPeriod\">\r\n                <el-input v-model=\"form_def.pdPayStartPeriod\" placeholder=\"\"  type=\"number\">\r\n                  <cus-select slot=\"append\" v-model=\"form_def.pdPayStartPerUnit\" :codetype=\"'pdsbnftdy'\"\r\n                              class=\"cst\"></cus-select>\r\n                </el-input>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row> -->\r\n\r\n\r\n          <el-row>\r\n            <el-col :span=\"8\" style=\"white-space: nowrap;\" >\r\n              <el-form-item :label=\"$t('pay_def.pay_start_calc_basis')\">\r\n                <cus-radio v-model=\"form_def.pdPayStartCalRule\" :codetype=\"'pd_prem_start_calc_rule'\"></cus-radio>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n          <cus-col :span=\"24\">\r\n            <el-form-item :label=\"$t('pay_def.pay_date_value')\" >\r\n                <cus-radio v-model=\"form_def.pdPayDateValue\" :codetype=\"'pdPayEndCalMode'\"></cus-radio>\r\n            </el-form-item>\r\n          </cus-col>\r\n          <cus-row>\r\n\r\n          </cus-row>\r\n          <div v-if=\"false\">\r\n            <el-row>\r\n              <cus-col >\r\n                <el-form-item :label=\"$t('pay_def.pay_start_menu')\">\r\n                  <el-switch v-model=\"form_def.pdPremStartFlag\" active-value=\"Y\" inactive-value=\"N\"></el-switch>\r\n                </el-form-item>\r\n              </cus-col>\r\n            </el-row>\r\n          </div>\r\n              <el-row>\r\n                <el-col :span=\"8\" style=\"white-space: nowrap;\" >\r\n                  <el-form-item :label=\"$t('pay_def.pay_start_calc_valuetypes')\">\r\n                    <cus-radio v-model=\"form_def.pdPayStartCalMode\" :codetype=\"'pd_prem_start_calc_method'\"></cus-radio>\r\n                  </el-form-item>\r\n                </el-col>\r\n              </el-row>\r\n            <cus-row>\r\n              <el-col :span=\"8\" style=\"white-space: nowrap;\" >\r\n                <el-form-item :label=\"$t('pay_def.pay_end_calc_basis')\">\r\n                  <cus-radio v-model=\"form_def.pdPayEndCalRule\" :codetype=\"'pd_prem_end_calc_rule'\"></cus-radio>\r\n                </el-form-item>\r\n              </el-col>\r\n            </cus-row>\r\n            <cus-row>\r\n              <el-col :span=\"8\" style=\"white-space: nowrap;\" >\r\n                <el-form-item :label=\"$t('pay_def.pay_end_calc_method')\">\r\n                  <cus-radio v-model=\"form_def.pdPayEndCalMode\" :codetype=\"'pd_prem_end_calc_method'\"></cus-radio>\r\n                </el-form-item>\r\n              </el-col>\r\n            </cus-row>\r\n          <el-row>\r\n            <el-form-item style=\"float: right\">\r\n              <el-button  size=\"small\"  v-if=\"!selectedDef.id&&!premiumCode\" v-auth=\"'pdtemp-pd-prem:add'\" icon=\"el-icon-success\" dialog-disable=\"disable\"\r\n                         type=\"primary\" @click=\"handleAddDef\">{{ $t('pay_def.save') }}\r\n              </el-button>\r\n              <el-button  size=\"small\"  v-if=\"selectedDef.id&&!premiumCode\" v-auth=\"'pdtemp-pd-prem:update'\" icon=\"el-icon-success\" dialog-disable=\"disable\"\r\n                         type=\"primary\" @click=\"handleUpdateDef\">{{ $t('pay_def.update') }}\r\n              </el-button>\r\n              <el-button  size=\"small\" v-if=\"!premiumCode\"  icon=\"el-icon-refresh\" type=\"primary\" @click=\"clearFormDef\" dialog-disable=\"disable\">\r\n                {{ $t('pay_def.refresh') }}\r\n              </el-button>\r\n            </el-form-item>\r\n          </el-row>\r\n          <cus-form-title :label=\"$t('pay_def.pay_calc_formula')\"></cus-form-title>\r\n          <el-row id=\"payCalcFormula\">\r\n            <el-col :span=\"8\">\r\n              <el-form-item :label=\"$t('pay_def.pay_code')\">\r\n                <el-tag type=\"info\" style=\"width: 220px\">{{ form_def.pdPremCode || form_defAdd.pdPremCode }}</el-tag>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"8\">\r\n              <el-form-item :label=\"$t('pay_def.pay_calc_formula1')\">\r\n                <el-input v-model=\"form_def.pdPremCalcCode\" readonly style=\"width: 220px\">\r\n                  <el-tooltip\r\n                    slot=\"suffix\"\r\n                    :content=\"premiumCode?$t('pay_def.message.readonly'):(Object.keys(selectedDef).length===0&&Object.keys(form_defAdd).length===0?$t('pay_def.message.pleaseSelectPremium'):'')\"\r\n                    :disabled=\"!premiumCode && (Object.keys(selectedDef).length>0||Object.keys(form_defAdd).length>0)\"\r\n                    effect=\"dark\" placement=\"top\">\r\n                    <svg-icon\r\n                      :style=\"{cursor:!premiumCode && (Object.keys(selectedDef).length>0||Object.keys(form_defAdd).length>0)?'pointer':'not-allowed'}\"\r\n                      icon-class=\"calc\"\r\n                      style=\"color: #606266;font-size: 18px\"\r\n                      @click=\"!premiumCode && (Object.keys(selectedDef).length>0||Object.keys(form_defAdd).length>0) && goClicks('1','17')\"/>\r\n                  </el-tooltip>\r\n                </el-input>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n        </el-form>\r\n      </div>\r\n      <!--  -->\r\n\r\n      <cus-form-title v-show=\"false\" :label=\"$t('pay_def.pay_extra_def')\" :realFirst=\"true\" @show=\"showAddFee\" :showArrow=\"true\"></cus-form-title>\r\n      <div  v-show=\"addFeeFlag\">\r\n        <!--  -->\r\n        <cus-table-title :label=\"$t('pay_def.addition_list') \"></cus-table-title>\r\n        <el-table :data=\"additionTableData\" :span-method=\"objectSpanMethod_addition\" border element-loading-text=\"Loading\"\r\n                  fit size=\"mini\" @row-click=\"rowClick_addition\">\r\n          <el-table-column :label=\"$t('table.select')\" align=\"center\" width=\"60px\">\r\n            <template slot-scope=\"scope\">\r\n              <el-radio-group v-model=\"selectedAddition\" @change=\"selectedAdditionChanged\">\r\n                <el-radio :label=\"scope.row\">{{ '' }}</el-radio>\r\n              </el-radio-group>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('table.id')\" align=\"center\" width=\"50\">\r\n            <template v-slot=\"scope\">\r\n              {{ initTableIndex('page_addition', scope.$index) }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_code')\" align=\"center\" prop=\"pdPremCode\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_name')\" align=\"center\" prop=\"pdPremName\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.addition_pay_code')\" align=\"center\" prop=\"pdExtPremCode\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.addition_pay_name')\" sortable :filters=\"filterpdExtPremNameList1\"\r\n                           :filter-method=\"filterHandler\" align=\"center\" prop=\"pdExtPremName\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.addition_pay_person')\" align=\"center\" prop=\"pdExtPremObj\">\r\n            <template v-slot=\"scope\">{{ scope.row.pdExtPremObj | filter_additionPayPerson }}</template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.addition_type')\" align=\"center\" prop=\"pdExtPremType\" sortable  :filters=\"filterpdExtPremNameList2\"\r\n                           :filter-method=\"filterHandler\" >\r\n            <template v-slot=\"scope\">{{ scope.row.pdExtPremType | filter_additionType }}</template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.addition_mode')\" align=\"center\" prop=\"pdExtPremMode\">\r\n            <template v-slot=\"scope\">{{ scope.row.pdExtPremMode | filter_additionAdditionMode }}</template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.operation')\" v-if=\"!premiumCode\" align=\"center\" width=\"100px\">\r\n            <template slot-scope=\"scope\">\r\n              <cus-del-btn v-auth=\"'pdtemp-pd-ext-prem:delete'\" :disabled=\"!!premiumCode\"\r\n                           @ok=\"handleDeleteAddition(scope.row)\"></cus-del-btn>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n        <!--  -->\r\n        <cus-pagination ref=\"page_addition\" v-model=\"additionTableData\" :mergedAttrName=\"'pdPremId'\"\r\n                        :needMerging=\"true\" :orderIndexArrName=\"'orderIndexArr_addition'\" :pageSize=\"10\"\r\n                        :params=\"params_addition\" :tableData=\"additionTableData\" url=\"/pdtemp-pd-ext-prem/base/list\"\r\n                        @updateOrderIndexArr=\"updateOrderIndexArr\"/>\r\n      </div>\r\n      <!--  -->\r\n      <div v-if=\"!selectedAddition.id && addFeeFlag\">\r\n        <br>\r\n        <cus-form-title :first=\"true\" :label=\"$t('pay_def.addition_info')\"></cus-form-title>\r\n        <el-form ref=\"form_addition_add\" :disabled=\"!!premiumCode\" :model=\"form_addition_add\" :rules=\"rules\" label-width=\"auto\" >\r\n          <cus-row>\r\n            <cus-col :span=\"11\">\r\n              <el-form-item :label=\"$t('pay_def.pay_name')\" prop=\"pdPremId\">\r\n                <el-select v-model=\"form_addition_add.pdPremId\" :placeholder=\"$t('pay_def.please_select')\" clearable\r\n                           filterable multiple>\r\n                  <el-option v-for=\"def in defTableData\" :label=\"def.pdPayName\" :value=\"def.id\"></el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n            </cus-col>\r\n          </cus-row>\r\n          <cus-row>\r\n            <cus-col :span=\"11\">\r\n              <el-form-item :label=\"$t('pay_def.addition_pay_person')\" prop=\"pdExtPremObj\">\r\n                <cus-checkbox v-model=\"form_addition_add.pdExtPremObj\"\r\n                              :codetype=\"'pdAddPremObj'\"></cus-checkbox>\r\n              </el-form-item>\r\n            </cus-col>\r\n            </cus-row>\r\n            <cus-row>\r\n            <cus-col :span=\"11\">\r\n              <el-form-item :label=\"$t('pay_def.addition_mode')\" prop=\"pdExtPremMode\">\r\n                <cus-checkbox v-model=\"form_addition_add.pdExtPremMode\"\r\n                              :codetype=\"'pd_prem_addition_addition_mode'\"></cus-checkbox>\r\n              </el-form-item>\r\n            </cus-col>\r\n          </cus-row>\r\n          <el-row>\r\n            <el-col :span=\"11\">\r\n              <el-form-item :label=\"$t('pay_def.addition_type')\" prop=\"pdExtPremType\">\r\n                <el-input v-model=\"displayName_additionType\" :placeholder=\"$t('pay_def.unselected')\" readonly></el-input>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-button v-if=\"!premiumCode\"  size=\"small\" style=\"margin-left: 5px\" @click=\"pageFlag.dialogVisible_additionType = true\">\r\n              {{ $t('pay_def.please_select') }}\r\n            </el-button>\r\n          </el-row>\r\n          <el-dialog ref=\"additionType\" v-dialog-drag :visible.sync=\"pageFlag.dialogVisible_additionType\"\r\n                     width=\"45%\">\r\n            <cus-page-title :label=\"$t('pay_def.addition_type')\"></cus-page-title>\r\n            <el-form-item>\r\n              <cus-checkbox v-model=\"form_addition_add.pdExtPremType\"\r\n                            :codetype=\"'pd_prem_addition_type'\"></cus-checkbox>\r\n            </el-form-item>\r\n            <el-button-group>\r\n              <el-button v-if=\"!premiumCode\"  size=\"small\" type=\"primary\" icon=\"el-icon-success\" @click=\"selectAllAdditionType\" dialog-disable=\"disable\">{{ $t('pay_def.select_all') }}</el-button>\r\n              <el-button v-if=\"!premiumCode\"  size=\"small\" type=\"primary\" icon=\"el-icon-refresh\" @click=\"form_addition_add.pdExtPremType = []\" dialog-disable=\"disable\">{{ $t('pay_def.refresh') }}</el-button>\r\n            </el-button-group>\r\n            <div style=\"float: right\">\r\n              <el-button-group>\r\n                <el-button v-if=\"!premiumCode\"  size=\"small\" type=\"primary\" icon=\"el-icon-success\" @click=\"pageFlag.dialogVisible_additionType = false\" dialog-disable=\"disable\">\r\n                  {{ $t('pay_def.add') }}\r\n                </el-button>\r\n              </el-button-group>\r\n            </div>\r\n          </el-dialog>\r\n          <el-row>\r\n            <el-form-item style=\"float: right\">\r\n              <el-button v-if=\"!premiumCode\"  size=\"small\" icon=\"el-icon-success\" type=\"primary\" @click=\"handleAddAddition\" dialog-disable=\"disable\">\r\n                {{ $t('pay_def.add') }}\r\n              </el-button>\r\n              <el-button v-if=\"!premiumCode\" size=\"small\" icon=\"el-icon-refresh\" type=\"primary\" @click=\"resetFormAdditionAdd\" dialog-disable=\"disable\">\r\n                {{ $t('pay_def.refresh') }}\r\n              </el-button>\r\n            </el-form-item>\r\n          </el-row>\r\n\r\n          <!--  -->\r\n          <div v-if=\"additionAddTableData.length > 0\">\r\n            <cus-form-title :label=\"$t('pay_def.to_add_additionitem')\"></cus-form-title>\r\n            <cus-table-title :label=\"$t('pay_def.addition_add_list')\"></cus-table-title>\r\n            <el-table :data=\"additionAddTableData\" :span-method=\"objectSpanMethod_addition_add\"\r\n                      border element-loading-text=\"Loading\" fit max-height=\"500\" size=\"mini\"\r\n                      @selection-change=\"handleSelectionChange\">\r\n              <el-table-column align=\"center\" type=\"selection\" width=\"50\"></el-table-column>\r\n              <el-table-column :label=\"$t('table.id')\" align=\"center\" type=\"index\" width=\"50\"></el-table-column>\r\n              <el-table-column :label=\"$t('pay_def.pay_code')\" align=\"center\" prop=\"pdPremCode\"></el-table-column>\r\n              <el-table-column :label=\"$t('pay_def.pay_name')\" align=\"center\" prop=\"pdPremName\"></el-table-column>\r\n              <el-table-column :label=\"$t('pay_def.addition_pay_name')\" align=\"center\" width=\"300px\">\r\n                <template v-slot=\"scope\">\r\n                  <el-input v-model=\"scope.row.pdExtPremName\" :placeholder=\"$t('form.please_enter')\" maxlength=\"60\"\r\n                            show-word-limit></el-input>\r\n                </template>\r\n              </el-table-column>\r\n              <el-table-column :label=\"$t('pay_def.addition_pay_person')\" align=\"center\" prop=\"additionPayPersonType\">\r\n                <template v-slot=\"scope\">{{ scope.row.pdExtPremObj | filter_additionPayPerson }}</template>\r\n              </el-table-column>\r\n              <el-table-column :label=\"$t('pay_def.addition_mode')\" align=\"center\" prop=\"additionMode\">\r\n                <template v-slot=\"scope\">{{ scope.row.pdExtPremMode | filter_additionAdditionMode }}</template>\r\n              </el-table-column>\r\n              <el-table-column :label=\"$t('pay_def.addition_type')\" align=\"center\" prop=\"additionType\">\r\n                <template v-slot=\"scope\">{{ scope.row.pdExtPremType | filter_additionType }}</template>\r\n              </el-table-column>\r\n              <el-table-column :label=\"$t('pay_def.addition_maximum')\" align=\"center\" width=\"140px\">\r\n                <template slot-scope=\"scope\">\r\n                  <el-input-number v-model=\"scope.row.pdMaxVal\" style=\"width: 120px;\"\r\n                                   :disabled=\"scope.row.pdExtPremMode!=='01'\" :placeholder=\"$('i18nView.placeholderNum')\"></el-input-number>\r\n                </template>\r\n              </el-table-column>\r\n              <el-table-column :label=\"$t('table.actions')\" v-if=\"!premiumCode\" align=\"center\" width=\"100px\">\r\n                <template slot-scope=\"scope\">\r\n                  <el-button  slot=\"reference\" size=\"mini\"\r\n                              type=\"danger\" @click=\"handleDeleteAdditionAdd(scope.row)\"><i class=\"el-icon-minus\" dialog-disable=\"disable\"></i>\r\n                  </el-button>\r\n                </template>\r\n              </el-table-column>\r\n            </el-table>\r\n            <el-form>\r\n              <el-row v-if=\"selectedAdditionAdds.length > 0\" style=\"margin: 20px auto 50px auto;\">\r\n                <el-form-item align=\"right\" style=\"float: right\">\r\n                  <el-button v-if=\"!premiumCode\"  size=\"small\" v-auth=\"'pdtemp-pd-ext-prem:add'\" icon=\"el-icon-success\" type=\"primary\" dialog-disable=\"disable\"\r\n                              @click=\"handleSaveAdditionAdd\">{{ $t('pay_def.save') }}\r\n                  </el-button>\r\n                </el-form-item>\r\n              </el-row>\r\n            </el-form>\r\n            <br/>\r\n          </div>\r\n\r\n\r\n          <cus-form-title :label=\"$t('pay_def.addition_calc_formula_code')\"></cus-form-title>\r\n          <cus-row>\r\n            <cus-col>\r\n              <el-form-item :label=\"$t('pay_def.addition_calc_formula_code1')\">\r\n                <el-input v-model=\"form_addition.pdExtPremCalcCode\" readonly >\r\n                  <el-tooltip\r\n                    slot=\"suffix\"\r\n                    :content=\"premiumCode?$t('pay_def.message.readonly'):(Object.keys(selectedAddition).length===0?$t('pay_def.message.pleaseSelectAddPremium'):'')\"\r\n                    :disabled=\"!premiumCode && Object.keys(selectedAddition).length>0\" effect=\"dark\"\r\n                    placement=\"top\">\r\n                    <svg-icon\r\n                      :style=\"{cursor:!premiumCode && Object.keys(selectedAddition).length>0?'pointer':'not-allowed'}\"\r\n                      icon-class=\"calc\"\r\n                      style=\"color: #606266;font-size: 18px\"\r\n                      @click=\"!premiumCode && Object.keys(selectedAddition).length>0 && goClicks('1','19')\"/>\r\n                  </el-tooltip>\r\n                </el-input>\r\n              </el-form-item>\r\n            </cus-col>\r\n          </cus-row>\r\n          <el-row v-if=\"false\">\r\n            <el-button  size=\"small\" icon=\"el-icon-monitor\" type=\"primary\" @click=\"goRules('1','1')\">\r\n              {{ $t('pay_def.premium_rule_def') }}\r\n            </el-button>\r\n          </el-row>\r\n\r\n        </el-form>\r\n      </div>\r\n      <!--  -->\r\n      <div v-if=\"selectedAddition.id && addFeeFlag\">\r\n        <cus-form-title :first=\"true\" :label=\"$t('pay_def.addition_info')\"></cus-form-title>\r\n        <el-form ref=\"form_addition\" :disabled=\"!!premiumCode\"  :model=\"form_addition\"\r\n                 :rules=\"rules\" label-position=\"right\" label-width=\"auto\">\r\n          <el-row>\r\n            <el-col :span=\"10\">\r\n              <el-form-item :label=\"$t('pay_def.pay_code')\">\r\n                <div>{{ form_addition.pdPremCode }}</div>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"10\">\r\n              <el-form-item :label=\"$t('pay_def.pay_name')\">\r\n                <div>{{ form_addition.pdPremId | filter_paymentId }}</div>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n          <el-row>\r\n            <el-col :span=\"10\">\r\n              <el-form-item :label=\"$t('pay_def.addition_pay_code')\">\r\n                <div>{{ form_addition.pdExtPremCode }}</div>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"10\">\r\n              <el-form-item :label=\"$t('pay_def.addition_pay_name')\" prop=\"pdExtPremName\">\r\n                <el-input v-model=\"form_addition.pdExtPremName\" maxlength=\"60\" show-word-limit></el-input>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n          <el-row>\r\n            <el-col :span=\"10\">\r\n              <el-form-item :label=\"$t('pay_def.addition_pay_person')\" prop=\"pdExtPremObj\">\r\n                <cus-radio v-model=\"form_addition.pdExtPremObj\" :codetype=\"'pdAddPremObj'\"></cus-radio>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"10\">\r\n              <el-form-item :label=\"$t('pay_def.addition_mode')\" prop=\"pdExtPremMode\">\r\n                <cus-radio v-model=\"form_addition.pdExtPremMode\"\r\n                           :codetype=\"'pd_prem_addition_addition_mode'\"></cus-radio>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n          <el-row>\r\n            <el-col :span=\"10\">\r\n              <el-form-item :label=\"$t('pay_def.addition_type')\" prop=\"pdExtPremType\">\r\n                <cus-select v-model=\"form_addition.pdExtPremType\" :codetype=\"'pd_prem_addition_type'\"></cus-select>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col  :span=\"10\" v-if=\"form_addition.pdExtPremMode === '01'\">\r\n              <el-form-item :label=\"$t('pay_def.addition_maximum')\" prop=\"pdMaxVal\">\r\n                <el-input-number v-model=\"form_addition.pdMaxVal\" :placeholder=\"$t('i18nView.placeholderNum')\"></el-input-number>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n\r\n          <cus-form-title :label=\"$t('pay_def.addition_calc_formula_code')\"></cus-form-title>\r\n          <el-row>\r\n            <el-col :span=\"6\">\r\n              <el-form-item :label=\"$t('pay_def.addition_calc_formula_code1')\">\r\n                <el-input v-model=\"form_addition.pdExtPremCalcCode\">\r\n                  <el-tooltip\r\n                    slot=\"suffix\"\r\n                    :content=\"premiumCode?$t('pay_def.message.readonly'):(Object.keys(selectedAddition).length===0?$t('pay_def.message.pleaseSelectAddPremium'):'')\"\r\n                    :disabled=\"!premiumCode && Object.keys(selectedAddition).length>0\" effect=\"dark\"\r\n                    placement=\"top\">\r\n                    <svg-icon\r\n                      :style=\"{cursor:!premiumCode && Object.keys(selectedAddition).length>0?'pointer':'not-allowed'}\"\r\n                      icon-class=\"calc\"\r\n                      style=\"color: #606266;font-size: 18px\"\r\n                      @click=\"!premiumCode && Object.keys(selectedAddition).length>0 && goClicks('1','19')\"/>\r\n                  </el-tooltip>\r\n                </el-input>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n          <el-row>\r\n            <el-form-item style=\"float: right\">\r\n              <el-button  size=\"small\" v-if=\"!premiumCode\" v-auth=\"'pdtemp-pd-ext-prem:update'\" icon=\"el-icon-success\" dialog-disable=\"disable\"\r\n                          type=\"primary\" @click=\"handleUpdateAddition\">{{ $t('pay_def.update') }}\r\n              </el-button>\r\n              <!-- <el-button  size=\"small\" @click=\"handleDeleteAddition\" style=\"margin: 0 10px 0 0\"\r\n                          type=\"danger\" v-auth=\"'pdtemp-pd-ext-prem:delete'\">{{ $t('table.delete') }}\r\n               </el-button>-->\r\n              <el-button  size=\"small\" v-if=\"!premiumCode\" icon=\"el-icon-refresh\" type=\"primary\" @click=\"clearFormAddition\" dialog-disable=\"disable\">\r\n                {{ $t('pay_def.refresh') }}\r\n              </el-button>\r\n            </el-form-item>\r\n          </el-row>\r\n        </el-form>\r\n      </div>\r\n      <!---->\r\n      <br/>\r\n    </div>\r\n\r\n    <div v-show=\"productCalcRevisionShowINfo\">\r\n      <cus-page-title-back :label=\"$t('i18nView.pdFormulaQuery')\" @backTo=\"back2\"></cus-page-title-back>\r\n      <cus-product-info></cus-product-info>\r\n    </div>\r\n\r\n    <el-form ref=\"form_count\"  :model=\"form_count\" :rules=\"rules_count\" label-position=\"right\" label-width=\"auto\">\r\n      <cus-form-title @show=\"discountClick\" :showArrow=\"true\" :realFirst=\"true\" :label=\"$t('pay_def.pay_discount')\"></cus-form-title>\r\n\r\n      <div v-if=\"discountFlag==='Y'\">\r\n        <cus-table-title :label=\"$t('pay_def.pd_pay_discount')\"></cus-table-title>\r\n        <el-table ref=\"discountTableData\" :data=\"discountTableData\" :span-method=\"objectSpanMethod_discount\"\r\n                  border element-loading-text=\"Loading\" fit size=\"mini\" @row-click=\"rowClick_discount\">\r\n          <el-table-column :label=\"$t('table.select')\" align=\"center\" width=\"60px\">\r\n            <template slot-scope=\"scope\">\r\n              <el-radio-group v-model=\"selectedDiscount\" @change=\"selectedDiscountChanged\">\r\n                <el-radio :label=\"scope.row\">{{ '' }}</el-radio>\r\n              </el-radio-group>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('table.id')\" align=\"center\" width=\"50\" type=\"index\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_code')\" align=\"center\"\r\n                           sortable :filters=\"filterDiscountCode\"\r\n                           :filter-method=\"filterHandlerDiscount\" prop=\"pdPremCode\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_name')\" align=\"center\"\r\n                           prop=\"pdPayName\"></el-table-column>\r\n          <el-table-column :filter-method=\"filterHandler\" :filters=\"pdCmpnRangeFilters\"\r\n                           :label=\"$t('pay_def.pay_discount_range')\"\r\n                           align=\"center\"\r\n                           prop=\"pdCmpnRange\">\r\n            <template v-slot=\"scope\">{{ scope.row.pdCmpnRange | filter_pdCmpnRange }}</template>\r\n          </el-table-column>\r\n          <el-table-column :filter-method=\"filterHandler\" :filters=\"pdCmpnTypeFilters\"\r\n                           :label=\"$t('pay_def.pay_discount_type')\"\r\n                           align=\"center\"\r\n                           prop=\"pdCmpnType\">\r\n            <template v-slot=\"scope\">{{ scope.row.pdCmpnType | filter_pdCmpnType }}</template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_discount_calc')\" align=\"center\" prop=\"pdCmpnCalcMode\">\r\n            <template v-slot=\"scope\">{{ scope.row.pdCmpnCalcMode | filter_pdCmpnCalcMode }}</template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_discount_val')\" align=\"center\" prop=\"pdCmpnVal\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_discount_calc_code')\" align=\"center\"\r\n                           prop=\"pdCmpnCalcCode\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.operation')\" v-if=\"!premiumCode\" align=\"center\" width=\"100px\">\r\n            <template slot-scope=\"scope\">\r\n              <cus-del-btn :disabled=\"!!premiumCode\" @ok=\"deleteDisCount(scope.row)\"></cus-del-btn>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n        <div v-show=\"!productCalcRevisionShowINfo\">\r\n          <cus-form-title :label=\"$t('pay_def.pay_discount_menu')\" ></cus-form-title>\r\n          <cus-row>\r\n            <cus-col >\r\n              <el-form-item :label=\"$t('pay_def.pay_name')\" prop=\"pdPremIds\">\r\n                <el-select v-model=\"form_count.pdPremIds\" :disabled=\"!!selectedDiscount.id\" clearable multiple\r\n                           filterable @change=\"getPdDiscountRange\">\r\n                  <el-option v-for=\"def in defTableData\" :label=\"def.pdPayName\" :value=\"def.id\"></el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n            </cus-col>\r\n            <cus-col >\r\n              <el-form-item :label=\"$t('pay_def.pay_discount_order')\" prop=\"pdCmpnOrder\">\r\n                <el-input v-model=\"form_count.pdCmpnOrder\" :placeholder=\"$t('i18nView.placeholderNum')\" type=\"number\"></el-input>\r\n              </el-form-item>\r\n            </cus-col>\r\n            <cus-col >\r\n              <el-form-item :label=\"$t('pay_def.pay_discount_type')\" prop=\"pdCmpnType\" >\r\n                <cus-select v-model=\"form_count.pdCmpnType\" :codetype=\"'preferentialType'\"\r\n                            :disabled=\"!!selectedDiscount.id\" :filter=\"filterCmpnType\"></cus-select>\r\n              </el-form-item>\r\n            </cus-col>\r\n          </cus-row>\r\n          <cus-row>\r\n            <cus-col :span=\"24\">\r\n              <el-form-item :label=\"$t('pay_def.pay_discount_range')\" prop=\"pdCmpnRange\">\r\n                <el-checkbox-group v-model=\"form_count.pdCmpnRange\" :disabled=\"!!selectedDiscount.id\">\r\n                  <el-checkbox v-for=\"item in pdDiscountRangeOptions\" :key=\"item.value\" :disabled=\"item.disabled\"\r\n                               :label=\"item.value\">{{ item.label }}\r\n                  </el-checkbox>\r\n                </el-checkbox-group>\r\n              </el-form-item>\r\n            </cus-col>\r\n          </cus-row>\r\n          <cus-row>\r\n            <cus-col >\r\n              <el-form-item :label=\"$t('pay_def.pay_discount_calc')\" prop=\"pdCmpnCalcMode\" @change=\"changePdCmpnCalcMode\">\r\n                <cus-radio v-model=\"form_count.pdCmpnCalcMode\" :codetype=\"'preferentialClculationType'\"\r\n                ></cus-radio>\r\n              </el-form-item>\r\n            </cus-col>\r\n            <cus-col >\r\n              <el-form-item :label=\"$t('pay_def.pay_discount_val')\">\r\n                <el-input v-model=\"form_count.pdCmpnVal\" :disabled=\"form_count.pdCmpnCalcMode!=='1'\" :placeholder=\"$t('i18nView.placeholderNum')\"\r\n                          type=\"number\"></el-input>\r\n              </el-form-item>\r\n            </cus-col>\r\n            <cus-col >\r\n            </cus-col >\r\n          </cus-row>\r\n          <el-row>\r\n            <el-form-item style=\"float: right\">\r\n              <el-button  size=\"small\" v-if=\"!selectedDiscount.id&&!premiumCode\" :disabled=\"!!premiumCode\" icon=\"el-icon-success\" type=\"primary\" dialog-disable=\"disable\"\r\n                         @click=\"saveDisCount\">\r\n                {{ $t('pay_def.save') }}\r\n              </el-button>\r\n              <el-button  size=\"small\" v-if=\"selectedDiscount.id&&!premiumCode\" :disabled=\"!!premiumCode\" icon=\"el-icon-success\" type=\"primary\" dialog-disable=\"disable\"\r\n                         @click=\"updateDisCount\">\r\n                {{ $t('pay_def.update') }}\r\n              </el-button>\r\n              <el-button  size=\"small\" v-if=\"!premiumCode\" :disabled=\"!!premiumCode\" icon=\"el-icon-refresh\" type=\"primary\" @click=\"clearFormDiscount\" dialog-disable=\"disable\">\r\n                {{ $t('pay_def.refresh') }}\r\n              </el-button>\r\n            </el-form-item>\r\n          </el-row>\r\n        </div>\r\n\r\n        <cus-form-title :label=\"$t('pay_def.pay_discount_calc_code')\"></cus-form-title>\r\n        <cus-row>\r\n          <cus-col >\r\n            <el-form-item :label=\"$t('pay_def.pay_discount_calc_code1')\" >\r\n              <el-input v-model=\"form_count.pdCmpnCalcCode\" :disabled=\"form_count.pdCmpnCalcMode!=='2'\" readonly>\r\n                <el-tooltip\r\n                  slot=\"suffix\"\r\n                  :content=\"premiumCode?$t('pay_def.message.readonly'):(Object.keys(selectedDiscount).length===0?$t('pay_def.message.pleaseSelectRange'):'')\"\r\n                  :disabled=\"!premiumCode && Object.keys(selectedDiscount).length>0\" effect=\"dark\"\r\n                  placement=\"top\">\r\n                  <svg-icon\r\n                    :style=\"{cursor:form_count.pdCmpnCalcMode==='2' && !premiumCode && Object.keys(selectedDiscount).length>0?'pointer':'not-allowed'}\"\r\n                    icon-class=\"calc\"\r\n                    style=\"color: #606266;font-size: 18px\"\r\n                    @click=\"form_count.pdCmpnCalcMode==='2' && !premiumCode && Object.keys(selectedDiscount).length>0 && goPdDiscountSelect('1','40')\"/>\r\n                </el-tooltip>\r\n              </el-input>\r\n            </el-form-item>\r\n          </cus-col>\r\n        </cus-row>\r\n\r\n      </div>\r\n    </el-form>\r\n\r\n    <!--  -->\r\n    <el-dialog v-if=\"dialogShow.premAmountFormula\" v-dialog-drag :close-on-click-modal=\"false\"\r\n               :visible.sync=\"dialogShow.premAmountFormula\" center width=\"80%\"\r\n               @close=\"changeDialogVisible_formula(false)\">\r\n      <premAmountFormula :calculationFormulaType=\"calculationFormulaType\" :guaranteeDetails=\"guaranteeDetails\"\r\n                         :pdUwSiTypeDtOptions=\"pdUwSiTypeDtOptions\" :pdUwSiTypeOptions=\"pdUwSiTypeOptions\"\r\n                         @bringInCalcCode=\"bringInCalcCode\"\r\n                         @changeDialogVisible_formula=\"changeDialogVisible_formula\"\r\n                         @changeDialogVisible_formulaSelect=\"changeDialogVisible_formulaSelect\"></premAmountFormula>\r\n      <!--  -->\r\n      <el-dialog v-if=\"dialogShow.premAmountFormulaSelect\" v-dialog-drag :close-on-click-modal=\"false\"\r\n                 :visible.sync=\"dialogShow.premAmountFormulaSelect\" append-to-body center\r\n                 width=\"70%\" @close=\"changeDialogVisible_formulaSelect(false)\">\r\n        <premAmountFormulaSelect :calculationFormulaType=\"calculationFormulaType\" :guaranteeDetails=\"guaranteeDetails\"\r\n                                 :pdUwSiTypeDtOptions=\"pdUwSiTypeDtOptions\" :pdUwSiTypeOptions=\"pdUwSiTypeOptions\"\r\n                                 @bringInCalcCode=\"bringInCalcCode\"\r\n                                 @changeDialogVisible_formulaSelect=\"changeDialogVisible_formulaSelect\"></premAmountFormulaSelect>\r\n      </el-dialog>\r\n    </el-dialog>\r\n\r\n    <!--  -->\r\n    <el-dialog v-if=\"dialogRulesShow.premRules\" v-dialog-drag :close-on-click-modal=\"false\"\r\n               :visible.sync=\"dialogRulesShow.premRules\"\r\n               center width=\"80%\" @close=\"changeDialogVisible_rules(false)\">\r\n      <premRules :calculationFormulaType=\"calculationFormulaType\"\r\n                 :guaranteeDetails=\"guaranteeDetails\"\r\n                 :pdUwSiTypeDtOptions=\"pdUwSiTypeDtOptions\"\r\n                 :pdUwSiTypeOptions=\"pdUwSiTypeOptions\"\r\n                 @changeDialogVisible_formula=\"changeDialogVisible_rules\"\r\n                 @changeDialogVisible_formulaSelect=\"changeDialogVisible_rulesSelect\"></premRules>\r\n      <!--  -->\r\n      <el-dialog v-if=\"dialogRulesShow.premRulesSelect\" v-dialog-drag :close-on-click-modal=\"false\"\r\n                 :visible.sync=\"dialogRulesShow.premRulesSelect\" append-to-body\r\n                 center width=\"70%\" @close=\"changeDialogVisible_rulesSelect(false)\">\r\n        <premRulesSelect :calculationFormulaType=\"calculationFormulaType\" :guaranteeDetails=\"guaranteeDetails\"\r\n                         :pdUwSiTypeDtOptions=\"pdUwSiTypeDtOptions\"\r\n                         :pdUwSiTypeOptions=\"pdUwSiTypeOptions\"\r\n                         @changeDialogVisible_formulaSelect=\"changeDialogVisible_rulesSelect\"></premRulesSelect>\r\n      </el-dialog>\r\n    </el-dialog>\r\n\r\n    <!---->\r\n    <el-dialog v-if=\"dialogShow.pdDiscountFormula\" v-dialog-drag :close-on-click-modal=\"false\"\r\n               :visible.sync=\"dialogShow.pdDiscountFormula\" center width=\"80%\"\r\n               @close=\"changeDialogVisible_pdDiscount(false)\">\r\n      <pdDiscountFormula :calculationFormulaType=\"calculationFormulaType\" :guaranteeDetails=\"guaranteeDetails\"\r\n                         :pdDisCount=\"pdDisCount\" :pdDiscountRangeOptions=\"pdDiscountRangeOptions\"\r\n                         @bringInCalcCode=\"bringInCalcCode\"\r\n                         @changeDialogVisible_pdDiscount=\"changeDialogVisible_pdDiscount\"\r\n                         @changeDialogVisible_pdDiscountSelect=\"changeDialogVisible_pdDiscountSelect\"></pdDiscountFormula>\r\n      <!--  -->\r\n      <el-dialog v-if=\"dialogShow.pdDiscountFormulaSelect\" v-dialog-drag :close-on-click-modal=\"false\"\r\n                 :visible.sync=\"dialogShow.pdDiscountFormulaSelect\" append-to-body center\r\n                 width=\"70%\" @close=\"changeDialogVisible_pdDiscountSelect(false)\">\r\n        <pdDiscountFormulaSelect :calculationFormulaType=\"calculationFormulaType\" :guaranteeDetails=\"guaranteeDetails\"\r\n                                 :pdDisCount=\"pdDisCount\" @bringInCalcCode=\"bringInCalcCode\"\r\n                                 @changeDialogVisible_pdDiscountSelect=\"changeDialogVisible_pdDiscountSelect\"></pdDiscountFormulaSelect>\r\n      </el-dialog>\r\n    </el-dialog>\r\n\r\n  </cus-wraper>\r\n</template>\r\n<script>\r\n\r\nimport {mapGetters} from \"vuex\"\r\nimport {\r\n  addPdtempPdPrem,\r\n  deletePdtempPdPrem,\r\n  getPayDate,\r\n  getPdAttrInfo,\r\n  getPdClsLabInfo,\r\n  updatePdtempPdPrem\r\n} from \"@/api/basicinfo/pdtemppdprem\"\r\nimport {addPdtempPdExtPrem, deletePdtempPdExtPrem, updatePdtempPdExtPrem} from \"@/api/basicinfo/pdtemppdextprem\"\r\nimport {\r\n  addPdtempPdCmpnInfo,\r\n  deletePdtempPdCmpnInfo,\r\n  findCmpnCaleCode,\r\n  getMaxRangeOrder,\r\n  selectDiscountRangeByPdInfoId,\r\n  updatePdtempPdCmpnInfo\r\n} from \"@/api/basicinfo/pdtemppdcmpninfo\";\r\nimport pdDiscountFormula\r\n  from \"@/views/product-definition/pd-framework-def/pd-structure-def/payment-def/discount-formula\";\r\nimport pdDiscountFormulaSelect\r\n  from \"@/views/product-definition/pd-framework-def/pd-structure-def/payment-def/discount-formula-select\";\r\nimport premAmountFormula from \"@/views/product-definition/pd-framework-def/pd-structure-def/payment-def/prem-formula\";\r\nimport premAmountFormulaSelect\r\n  from \"@/views/product-definition/pd-framework-def/pd-structure-def/payment-def/prem-formula-select\";\r\nimport premRules from \"@/views/product-definition/pd-framework-def/pd-structure-def/payment-def/prem-rule\";\r\nimport premRulesSelect from \"@/views/product-definition/pd-framework-def/pd-structure-def/payment-def/prem-rule-select\";\r\n\r\nimport guide from '@/views/product-definition/pd-framework-def/pd-structure-def/payment-def/guide'\r\n\r\nlet _this\r\n\r\nexport default {\r\n  name: \"PaymentDefinition\",\r\n  filters: {\r\n    filter_calcMethod(code) {\r\n      return _this.getCodeName('pd_prem_cal_method', code)\r\n    },\r\n    filter_dateSuffix(code) {\r\n      return _this.getCodeName('pd_prem_date_suffix', code, true)\r\n    },\r\n    filter_freq(code) {\r\n      return _this.getCodeName('pd_prem_freq', code)\r\n    },\r\n    filter_startCalcRule(code) {\r\n      return _this.getCodeName('pd_prem_start_calc_rule', code)\r\n    },\r\n    filter_endCalcRule(code) {\r\n      return _this.getCodeName('pd_prem_end_calc_rule', code)\r\n    },\r\n    filter_startCalcMethod(code) {\r\n      return _this.getCodeName('pd_prem_start_calc_method', code)\r\n    },\r\n    filter_endCalcMethod(code) {\r\n      return _this.getCodeName('pd_prem_end_calc_method', code)\r\n    },\r\n    filter_additionType(code) {\r\n      return _this.getCodeName('pd_prem_addition_type', code)\r\n    },\r\n    filter_additionMode(code) {\r\n      return _this.getCodeName('pd_prem_addition_mode', code)\r\n    },\r\n    filter_accountType(code) {\r\n      return _this.getCodeName('pd_prem_account_type', code)\r\n    },\r\n    filter_additionPayPerson(code) {\r\n      return _this.getCodeName('pdAddPremObj', code)\r\n    },\r\n    filter_additionAdditionMode(code) {\r\n      return _this.getCodeName('pd_prem_addition_addition_mode', code)\r\n    },\r\n    filter_payZero(code) {\r\n      return _this.getCodeName('pd_prem_zero', code)\r\n    },\r\n    filter_serviceChargeOffset(code) {\r\n      return _this.getCodeName('pd_prem_service_charge_offset', code)\r\n    },\r\n    filter_pdCmpnType(code) {\r\n      return _this.getCodeName('preferentialType', code)\r\n    },\r\n    filter_pdCmpnCalcMode(code) {\r\n      return _this.getCodeName('preferentialClculationType', code)\r\n    },\r\n    filter_pdCmpnRange(code) {\r\n      for (const def of _this.defTableData) {\r\n        if (def.pdPremCode === code) {\r\n          return def.pdPremCode + \":\" + def.pdPayName\r\n        }\r\n      }\r\n      for (const def of _this.additionTableData) {\r\n        if (def.pdExtPremCode === code) {\r\n          return def.pdExtPremCode + \":\" + def.pdExtPremName\r\n        }\r\n      }\r\n      return code\r\n    },\r\n    filter_payUrging(code) {\r\n      return _this.getCodeName('pd_prem_urging', code)\r\n    },\r\n    filter_payFrequency(code) {\r\n      return _this.getCodeName('paymentFrequency', code)\r\n    },\r\n    filter_paydatevalue(code){\r\n      return _this.getCodeName('pdPayEndCalMode', code)\r\n    },\r\n    filter_paymentId(pdPremId) {\r\n      for (const def of _this.defTableData) {\r\n        if (def.id === pdPremId) {\r\n          return def.pdPayName\r\n        }\r\n      }\r\n      return ''\r\n    },\r\n    filter_pdPayStartPeriod(list){\r\n      let returnData = ''\r\n      if(list.length){\r\n        list.forEach(data=>{\r\n          if(returnData.length){\r\n            returnData+=','\r\n          }\r\n        returnData+=data.pdPayStartPeriod;\r\n        returnData+=_this.getCodeName('pd_prem_date_suffix',data.pdPayStartPerUnit,true);\r\n      })\r\n      }\r\n      return returnData\r\n    },\r\n    filter_pdPayEndPeriod(list){\r\n      let returnData = ''\r\n      if(list.length){\r\n        list.forEach(data=>{\r\n          if(returnData.length){\r\n            returnData+=','\r\n          }\r\n        returnData+=data.pdPayEndPeriod;\r\n        returnData+=_this.getCodeName('pd_prem_date_suffix',data.pdPayEndUnit,true);\r\n      })\r\n      }\r\n      return returnData\r\n    }\r\n  },\r\n  props: {\r\n    premiumCode: {\r\n      required: false,\r\n      type: String,\r\n      default: ''\r\n    }\r\n  },\r\n  data() {\r\n\r\n    _this = this\r\n    return {\r\n      productCalcRevisionShowINfo:false,\r\n      pdPayFreqCopy:[],\r\n      quickfilterHandlerList0:[],\r\n      quickfilterHandlerList1:[],\r\n      quickfilterHandlerList2:[],\r\n      quickfilterHandlerList3:[],\r\n      filterHandlerList0:[],\r\n      filterHandlerList1:[],\r\n      filterHandlerList2:[],\r\n      filterHandlerList3:[],\r\n      filterHandlerList4:[],\r\n      filterpdExtPremNameList1:[],\r\n      filterpdExtPremNameList2:[],\r\n      detailTypeOptionList:[],\r\n      payDateForm:{\r\n        payDateTable:[],\r\n      },\r\n      tableCount: 0,\r\n      tableCountDiscount: 0,\r\n      pdCmpnCalcCode1: '',\r\n      flag1:0,\r\n      //\r\n      dialogShow: {\r\n        premAmountFormula: false,\r\n        premAmountFormulaSelect: false,\r\n        pdDiscountFormula: false,\r\n        pdDiscountFormulaSelect: false\r\n      },\r\n      guaranteeDetails: '',\r\n      calculationFormulaType: '',\r\n      pdUwSiTypeOptions: '',\r\n      pdUwSiTypeDtOptions: '',\r\n      pdDisCount: '',\r\n      //\r\n      dialogRulesShow: {\r\n        premRules: false,\r\n        premRulesSelect: false\r\n      },\r\n      showPageFlag: 0,\r\n      quickTableData: [],\r\n      defTableData: [],\r\n      additionTableData: [],\r\n      additionAddTableData: [],\r\n      pdCmpnTypeFilters: [],\r\n      rowIndex: '-1',\r\n      orderIndexArr_addition: [],\r\n      orderIndexArr_addition_add: [],\r\n      orderIndexArr_addition_discount:[],\r\n      hoverOrderArr: [],\r\n      quickicon_discount: \"el-icon-arrow-right\",\r\n      quickshow: false,\r\n      filterDiscountCode:[],\r\n      pdCmpnRangeFilters: [],\r\n      productOriginalList:[],\r\n      productList:[],\r\n      selectedReferenceProductId: undefined,\r\n      form_quick: {\r\n        typeRegion: '',\r\n      },\r\n      params: {\r\n        eq_pdInfoId: undefined,\r\n        eq_pdPremCalMode: '',\r\n        accountRelated: '',\r\n        extraPremiumFlag: '',\r\n        eq_id: '',\r\n        byPage: 'Y',\r\n        finelinesRegion: '',\r\n        firstOpenPageFlag: 'Y',\r\n      },\r\n      params_currentProduct: {\r\n        eq_pdInfoId: undefined,\r\n        like_payName: '',\r\n        eq_payCode: ''\r\n      },\r\n      params_addition: {\r\n        premiumList: []\r\n      },\r\n      discountTableData: [],\r\n      configRangeLength: '',\r\n      pdDiscountRangeOptions: [{\r\n        key: '000000',\r\n        value: '000000',\r\n        label: '',\r\n        disabled: true\r\n      }],\r\n      filterCmpnType: '1$D$I',\r\n      addFeeFlag: false,\r\n      discountFlag: 'N',\r\n      selectedDiscount: {},\r\n      selectedDef: {},\r\n      selectedDefInQueryResult: {},\r\n      selectedAddition: {},\r\n      selectedAdditionAdds: [],\r\n      // \r\n      product: {\r\n        id: undefined,\r\n        pdCode: '',\r\n        pdEdition: '',\r\n        pdVerId: undefined,\r\n        pdSalechnl: '',\r\n        pdName: '',\r\n        pdShortname: '',\r\n        pdEnName: '',\r\n        pdShortEnName: '',\r\n        operator: '',\r\n        pdStartDateRule: '',\r\n        pdStartDateMode: '',\r\n        pdStartPeriod: undefined,\r\n        pdStartPeriodUnit: '',\r\n        pdEndDateRule: '',\r\n        pdEndDateMode: '',\r\n        pdEndPeriod: undefined,\r\n        pdEndPeriodUnit: '',\r\n        pdGracePeriod: undefined,\r\n        pdObservationDay: undefined,\r\n        pdApplDate: undefined,\r\n        pdProcessId: undefined,\r\n        pdStartDate: undefined,\r\n        pdStopDate: undefined,\r\n        createTime: undefined,\r\n        updateTime: undefined\r\n      },\r\n      product_extra: {\r\n        typeRegion: '',\r\n        pdPayFreq: []\r\n      },\r\n      form_count: {\r\n        pdVerId: '',\r\n        operator: '',\r\n        pdType: '',\r\n        pdDefType: '',\r\n        pdInfoId: '',\r\n        pdCode: '',\r\n        pdName: '',\r\n        pdPremIds: [],\r\n        pdPremId:'',\r\n        pdPremCode: '',\r\n        pdPremCodes:[],\r\n        pdCmpnRange: [],\r\n        pdCmpnType: '',\r\n        cmpnInfoId: '',\r\n        pdCmpnCode: '',\r\n        pdCmpnOrder: '',\r\n        pdCmpnCalcMode: '',\r\n        pdCmpnVal: '',\r\n        pdCmpnCalcCode: '',\r\n        pdCmpnDesc: ''\r\n      },\r\n      form_defAdd: {},\r\n      form_def: {\r\n        id: undefined,\r\n        pdInfoId: undefined,\r\n        pdVerId: undefined,\r\n        pdCode: '',\r\n        pdName: '',\r\n        operator: '',\r\n        pdPayName: '',\r\n        pdPremCode: '',\r\n        pdPremCalMode: 'G',\r\n        pdPremZeroFlag: 'Y',\r\n        pdPremReclFlag: 'N',\r\n        pdUrgePayFlag: 'Y',\r\n        pdPayStartPeriod: undefined,\r\n        pdPayStartPerUnit: 'Y',\r\n        pdPayStartCalRule: '',\r\n        pdPayStartCalMode: '',\r\n        pdPayEndPeriod: undefined,\r\n        pdPayEndUnit: 'Y',\r\n        pdPayEndCalRule: '',\r\n        pdPayEndCalMode: '',\r\n        pdAddPremMode: '',\r\n        pdPayAccKind: '',\r\n        pdRateChangeFlag: 'N',\r\n        pdPremAddFlag: 'N',\r\n        pdPremStartFlag: 'N',\r\n        pdCharPremRel: 'N',\r\n        pdPremAccRela: 'N',\r\n        pdPremCalcCode: '',\r\n        pdPayFrequency:'',\r\n        pdPayDateValue:''\r\n      },\r\n      form_addition: {\r\n        id: undefined,\r\n        pdPremId: undefined,\r\n        pdVerId: undefined,\r\n        operator: '',\r\n        pdExtPremCode: '',\r\n        pdExtPremName: '',\r\n        pdPremName: '',\r\n        pdPremCode: '',\r\n        pdExtPremObj: '',\r\n        pdExtPremMode: '',\r\n        pdExtPremType: '',\r\n        pdMaxVal: undefined,\r\n        pdExtPremCalcCode: '',\r\n        createTime: undefined,\r\n        updateTime: undefined\r\n      },\r\n      form_addition_add: {\r\n        id: undefined,\r\n        pdPremId: [],\r\n        pdExtPremObj: [],\r\n        pdExtPremMode: [],\r\n        pdExtPremType: [],\r\n        pdExtPremCalcCode: ''\r\n      },\r\n      pageFlag: {\r\n        tableVisible_def: true,\r\n        dialogVisible_additionType: false,\r\n        dialogVisible_queryResult: false,\r\n        additionFlag: false\r\n      },\r\n      displayName_additionType: '',\r\n      isFixed: false,\r\n      fixedClassName: '',\r\n      offsetTop: undefined,\r\n      filters: {\r\n        pdAddPremMode: [],\r\n        pdPremCalMode: [],\r\n        pdPayAccKind: []\r\n      },\r\n      rules: {\r\n        pdPayEndPeriod: [{\r\n          required: true,\r\n          message: this.$t('pay_def.message.please_enter') + this.$t('i18nView.payTerm'),\r\n          trigger: 'blur'\r\n        }],\r\n        pdPayName: [{\r\n          required: true,\r\n          message: this.$t('pay_def.message.please_enter') + this.$t('pay_def.pay_name'),\r\n          trigger: 'blur'\r\n        }],\r\n\r\n        pdPremCalMode: [{\r\n          required: true,\r\n          message: this.$t('pay_def.message.please_enter') + this.$t('pay_def.pay_calc_method'),\r\n          trigger: 'change'\r\n        }],\r\n        pdExtPremName:[{required: true, message: \"\", trigger: 'blur'}],\r\n        pdPremId: [{required: true, message: \"\", trigger: 'blur'}],\r\n        pdPremIds: [{required: true, message: \"\", trigger: 'blur'}],\r\n        pdExtPremObj: [{required: true, message: \"\", trigger: 'blur'}],\r\n        pdExtPremMode: [{required: true, message: \"\", trigger: 'blur'}],\r\n        pdExtPremType: [{required: true, message: \"\", trigger: 'blur'}],\r\n      },\r\n      rules1:{\r\n        pdPayFreq: [{\r\n          required: true,\r\n          message: this.$t('pay_def.message.please_enter') + this.$t('pay_def.pay_frequency'),\r\n          trigger: 'blur'\r\n        }],\r\n      },\r\n      rules_count: {\r\n        pdPremId: [{\r\n          required: true,\r\n          message: this.$t('pay_def.message.please_enter') + this.$t('pay_def.pay_name'),\r\n          trigger: 'blur'\r\n        }],\r\n        pdCmpnRange: [{\r\n          type: 'array',\r\n          required: true,\r\n          message: this.$t('pay_def.message.please_enter') + this.$t('pay_def.pay_discount_range'),\r\n          trigger: 'change'\r\n        }],\r\n        pdCmpnType: [{\r\n          required: true,\r\n          message: this.$t('pay_def.message.please_enter') + this.$t('pay_def.pay_discount_type'),\r\n          trigger: 'blur'\r\n        }],\r\n        pdCmpnOrder: [{\r\n          required: true,\r\n          message: this.$t('pay_def.message.please_enter') + this.$t('pay_def.pay_discount_order'),\r\n          trigger: 'blur'\r\n        }],\r\n        pdCmpnCalcMode: [{\r\n          required: true,\r\n          message: this.$t('pay_def.message.please_enter') + this.$t('pay_def.pay_calc_method'),\r\n          trigger: 'change'\r\n        }]\r\n      },\r\n      rules_quick: {\r\n        finelinesRegion: [{\r\n          required: true,\r\n          message: this.$t('form.please_select') + this.$t('pay_def.finelinesRegion'),\r\n          trigger: 'change'\r\n        }],\r\n      }\r\n    }\r\n  },\r\n  components: {\r\n    premAmountFormula,\r\n    premAmountFormulaSelect,\r\n    premRules,\r\n    premRulesSelect,\r\n    pdDiscountFormula,\r\n    pdDiscountFormulaSelect,\r\n    guide\r\n  },\r\n  async created() {\r\n\r\n    this.initProductQueryData()\r\n\r\n    this.showPageFlag = this.$route.query.showPageFlag\r\n    await this.init();\r\n    this.productCalcRevisionShowINfo = this.$route.query.productCalcRevisionShowINfo === 'true'\r\n    if (!this.productCalcRevisionShowINfo){\r\n      this.form_def.pdPremAddFlag = 'Y'\r\n      this.form_def.pdPayStartCalMode = '0'\r\n      this.form_def.pdPayStartCalRule = 'S'\r\n      this.form_def.pdPayEndCalMode = '0'\r\n      this.form_def.pdPayEndCalRule = 'S'\r\n      this.form_def.pdPayDateValue = '1'\r\n      this.$refs.page_def.buildData().then(() => {\r\n        this.$refs.page_addition.buildData().then(() =>{\r\n          // \r\n          if (this.premiumCode) {\r\n            let flag = false\r\n            for (const premium of this.defTableData) {\r\n              if (premium.pdPremCode === this.premiumCode) {\r\n                flag = true\r\n                this.selectedDef = premium\r\n                this.selectedDefChanged()\r\n                this.form_def.pdPremAddFlag = 'Y'\r\n                break\r\n              }\r\n            }\r\n          }\r\n        })\r\n      })\r\n    }else {\r\n        this.discountClick();\r\n        this.selectDiscountRangeTable()\r\n        this.form_def.pdPremAddFlag = 'Y'\r\n        this.$refs.page_def.buildData().then(() => {\r\n            this.$refs.page_addition.buildData().then(() =>{\r\n                // \r\n                if (this.premiumCode) {\r\n                    let flag = false\r\n                    for (const premium of this.defTableData) {\r\n                        if (premium.pdPremCode === this.premiumCode) {\r\n                            flag = true\r\n                            this.selectedDef = premium\r\n                            this.selectedDefChanged()\r\n                            this.form_def.pdPremAddFlag = 'Y'\r\n                            break\r\n                        }\r\n                    }\r\n                }\r\n            })\r\n        })\r\n    }\r\n  },\r\n  mounted() {\r\n    // \r\n    window.addEventListener('scroll', this.initHeight);\r\n    this.$nextTick(() => {\r\n      this.offsetTop = document.querySelector('#table_def').offsetTop;\r\n    })\r\n\r\n  },\r\n  destroyed() {\r\n    window.removeEventListener('scroll', this.handleScroll)\r\n  },\r\n  computed: {\r\n    ...mapGetters([\r\n      'ldcodes',\r\n      'sidebar'\r\n    ])\r\n  },\r\n  watch: {\r\n    'form_def.pdPayEndPeriod'() {\r\n      const valTime = this.form_def.pdPayEndPeriod;\r\n      if (valTime) {\r\n        if (!this.form_def.pdPayEndUnit) {\r\n          this.form_def.pdPayEndUnit = 'Y'\r\n        }\r\n      }\r\n    },\r\n    'form_def.pdPayStartPeriod'() {\r\n      const valTime = this.form_def.pdPayStartPeriod;\r\n      if (valTime) {\r\n        if (!this.form_def.pdPayStartPerUnit) {\r\n          this.form_def.pdPayStartPerUnit = 'Y'\r\n        }\r\n      }\r\n    },\r\n    'form_addition_add.pdExtPremType'() {\r\n      this.displayName_additionType = ''\r\n      const additionTypeList_selected = this._.filter(this.ldcodes['pd_prem_addition_type'], function (additionType) {\r\n        return _this.isInArray(additionType.code, _this.form_addition_add.pdExtPremType);\r\n      })\r\n      if (additionTypeList_selected && additionTypeList_selected.length > 0) {\r\n        additionTypeList_selected.forEach((additionType, index) => {\r\n          if (index === 0) {\r\n            this.displayName_additionType += additionType.codename\r\n          } else {\r\n            this.displayName_additionType += ', ' + additionType.codename\r\n          }\r\n        })\r\n      } else {\r\n        this.displayName_additionType = ''\r\n      }\r\n    },\r\n    'quickTableData'(){\r\n      if (this.quickTableData.length > 0) {\r\n        this.quickfilterHandlerList0 = [];\r\n        this.quickfilterHandlerList1 = [];\r\n        this.quickfilterHandlerList2 = [];\r\n        this.quickfilterHandlerList3 = [];\r\n        this.quickTableData.forEach(val => {\r\n          this.quickfilterHandlerList0.push({\r\n            text: val.pdPremCode,\r\n            value: val.pdPremCode\r\n          });\r\n          this.quickfilterHandlerList1.push({\r\n            text: val.pdRateChangeFlag,\r\n            value: val.pdRateChangeFlag\r\n          });\r\n          this.quickfilterHandlerList2.push({\r\n            text: val.pdPremAccRela,\r\n            value: val.pdPremAccRela\r\n          });\r\n          this.quickfilterHandlerList3.push({\r\n            text: val.pdPremAddFlag,\r\n            value: val.pdPremAddFlag\r\n          });\r\n        });\r\n      }\r\n      this.quickfilterHandlerList0 = this.quickfilterHandlerList0.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n      this.quickfilterHandlerList1 = this.quickfilterHandlerList1.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n      this.quickfilterHandlerList2 = this.quickfilterHandlerList2.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n      this.quickfilterHandlerList3 = this.quickfilterHandlerList3.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n    },\r\n    defTableData() {\r\n      if (this.defTableData.length > 0) {\r\n        this.filterHandlerList0 = [];\r\n        this.filterHandlerList1 = [];\r\n        this.filterHandlerList2 = [];\r\n        this.filterHandlerList3 = [];\r\n        this.filterHandlerList4 = [];\r\n        this.defTableData.forEach(val => {\r\n          this.filterHandlerList0.push({\r\n            text: val.pdPremCode,\r\n            value: val.pdPremCode\r\n          });\r\n          this.filterHandlerList1.push({\r\n            text: val.pdRateChangeFlag,\r\n            value: val.pdRateChangeFlag\r\n          });\r\n          this.filterHandlerList2.push({\r\n            text: val.pdPremAccRela,\r\n            value: val.pdPremAccRela\r\n          });\r\n          this.filterHandlerList3.push({\r\n            text: val.pdPremAddFlag,\r\n            value: val.pdPremAddFlag\r\n          });\r\n          this.filterHandlerList4.push({\r\n            text: val.pdPayEndPeriod,\r\n            value: val.pdPayEndPeriod\r\n          });\r\n        });\r\n      }\r\n      this.filterHandlerList0 = this.filterHandlerList0.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n      this.filterHandlerList1 = this.filterHandlerList1.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n      this.filterHandlerList2 = this.filterHandlerList2.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n      this.filterHandlerList3 = this.filterHandlerList3.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n      this.filterHandlerList4 = this.filterHandlerList4.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n      if (this.tableCount == 0) {\r\n        if (this.defTableData.length === 1) {\r\n          this.$refs.defTableData.setCurrentRow(this.defTableData[0]);\r\n          this.selectedDef = this.defTableData[0]\r\n          this.selectedDefChanged();\r\n        }\r\n      } else {\r\n        this.$refs.defTableData.setCurrentRow(this.defTableData[0]);\r\n        this.selectedDef = this.defTableData[0]\r\n        this.selectedDefChanged();\r\n      }\r\n\r\n      this.params_addition.premiumList = this.defTableData\r\n      if (this.form_def.pdPremAddFlag === 'Y') {\r\n        this.$refs.page_addition.reload()\r\n      }\r\n    },\r\n    'discountTableData'() {\r\n      if (this.discountTableData.length == 1) {\r\n        this.selectedDiscount = this.discountTableData[0]\r\n        this.selectedDiscountChanged();\r\n      }\r\n      //\r\n      getMaxRangeOrder(this.buildRequestData({\"pdInfoId\": this.product.id})).then(res => {\r\n        this.configRangeLength = res.data;\r\n        this.form_count.pdCmpnOrder = res.data;\r\n      });\r\n      if (this.discountTableData.length > 0) {\r\n        this.filterDiscountCode=[];\r\n        this.pdCmpnRangeFilters = [];\r\n        this.pdCmpnTypeFilters = [];\r\n        this.discountTableData.forEach(val => {\r\n          this.filterDiscountCode.push({\r\n            text: val.pdPremCode,\r\n            value: val.pdPremCode\r\n          });\r\n          this.pdCmpnRangeFilters.push({\r\n            text: this.filter_pdCmpnRanges(val.pdCmpnRange),\r\n            value: val.pdCmpnRange\r\n          });\r\n          this.pdCmpnTypeFilters.push({\r\n            text: this.getCodeName('preferentialType', val.pdCmpnType),\r\n            value: val.pdCmpnType\r\n          });\r\n        });\r\n        //\r\n        this.filterDiscountCode = this.filterDiscountCode.reduce(function (prev, element) {\r\n          if (!prev.find(el => el.text == element.text)) {\r\n            prev.push(element);\r\n          }\r\n          return prev;\r\n        }, []);\r\n        //\r\n        this.pdCmpnRangeFilters = this.pdCmpnRangeFilters.reduce(function (prev, element) {\r\n          if (!prev.find(el => el.text == element.text)) {\r\n            prev.push(element);\r\n          }\r\n          return prev;\r\n        }, []);\r\n        //\r\n        this.pdCmpnTypeFilters = this.pdCmpnTypeFilters.reduce(function (prev, element) {\r\n          if (!prev.find(el => el.text == element.text)) {\r\n            prev.push(element);\r\n          }\r\n          return prev;\r\n        }, []);\r\n      }\r\n    },\r\n    'sidebar.opened'() {\r\n      this.initHeight()\r\n    },\r\n    'additionTableData'() {\r\n      if (this.additionTableData.length > 0) {\r\n        this.filterpdExtPremNameList1 = [];\r\n        this.filterpdExtPremNameList2 = [];\r\n        this.additionTableData.forEach(val => {\r\n          this.filterpdExtPremNameList1.push({\r\n            text: val.pdExtPremName,\r\n            value: val.pdExtPremName\r\n          });\r\n          this.filterpdExtPremNameList2.push({\r\n            text: this.getCodeName('pd_prem_addition_type', val.pdExtPremType),\r\n            value: val.pdExtPremType\r\n          });\r\n        });\r\n      }\r\n      this.filterpdExtPremNameList1 = this.filterpdExtPremNameList1.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n      this.filterpdExtPremNameList2 = this.filterpdExtPremNameList2.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n      this.selectedAddition = {}\r\n      this.resetFormAddition()\r\n      if (this.additionTableData.length ==1) {\r\n        this.selectedAddition = this.additionTableData[0]\r\n        this.selectedAdditionChanged();\r\n      }\r\n    },\r\n    'form_count.pdCmpnCalcMode'() {\r\n      const val = this.form_count.pdCmpnCalcMode\r\n      if (val === '1') {\r\n        this.form_count.pdCmpnCalcCode = ''\r\n      } else if (val === '2') {\r\n        this.form_count.pdCmpnVal = ''\r\n      }\r\n    },\r\n    'form_count.pdCmpnRange'(selectedCodes) {\r\n      if (selectedCodes.length === 0) {\r\n        for (const pdDiscount of this.pdDiscountRangeOptions) {\r\n          pdDiscount.disabled = false\r\n        }\r\n      } else {\r\n        if (this._.includes(selectedCodes, '000000')) {\r\n          for (const pdDiscount of this.pdDiscountRangeOptions) {\r\n            pdDiscount.disabled = pdDiscount.value !== '000000'\r\n          }\r\n        } else {\r\n          for (const pdDiscount of this.pdDiscountRangeOptions) {\r\n            pdDiscount.disabled = pdDiscount.value === '000000'\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    back2(){\r\n      this.$router.push({name: '', params: {}})\r\n    },\r\n    changePdCmpnCalcMode(){\r\n      //console.log(this.form_count.pdCmpnCalcMode)\r\n    },\r\n\r\n    bringInCalcCode(pdBussDetailType, pdBussId, calcCode) {\r\n      switch (pdBussDetailType) {\r\n        case '17':\r\n          for (const prem of this.defTableData) {\r\n            if (prem.id === Number(pdBussId)) {\r\n              this.$set(prem, 'pdPremCalcCode', calcCode)\r\n              break\r\n            }\r\n          }\r\n          if (this.form_def.id === Number(pdBussId)) {\r\n            this.form_def.pdPremCalcCode = calcCode\r\n          }\r\n          break\r\n        case '19':\r\n          for (const extPrem of this.additionTableData) {\r\n            if (extPrem.id === Number(pdBussId)) {\r\n              this.$set(extPrem, 'pdExtPremCalcCode', calcCode)\r\n              break\r\n            }\r\n          }\r\n          if (this.form_addition.id === Number(pdBussId)) {\r\n            this.form_addition.pdExtPremCalcCode = calcCode\r\n          }\r\n          break\r\n        case '40':\r\n          for (const discount of this.discountTableData) {\r\n            if (discount.id === Number(pdBussId)) {\r\n              this.$set(discount, 'pdCmpnCalcCode', calcCode)\r\n              break\r\n            }\r\n          }\r\n          if (this.form_count.id === Number(pdBussId)) {\r\n            this.form_count.pdCmpnCalcCode = calcCode\r\n          }\r\n          break\r\n        default:\r\n          break\r\n      }\r\n    },\r\n    discountClick() {\r\n      if (this.discountFlag === 'N') {\r\n        this.quickicon_discount = \"el-icon-arrow-down\"\r\n        this.discountFlag = 'Y'\r\n      } else {\r\n        this.quickicon_discount = \"el-icon-arrow-right\"\r\n        this.discountFlag = 'N'\r\n      }\r\n    },\r\n    //\r\n    goClicks(num1, num2) {\r\n      this.guaranteeDetails = num1;//\r\n      this.calculationFormulaType = num2;//\r\n      if (num2 === '19') {//\r\n        this.pdUwSiTypeOptions = this.selectedAddition.pdPremId + \":\" + this.selectedAddition.pdPremCode;\r\n        this.pdUwSiTypeDtOptions = this.selectedAddition.id + \":\" + this.selectedAddition.pdExtPremCode;\r\n      } else {//\r\n        this.pdUwSiTypeOptions = this.selectedDef.id ? this.selectedDef.id + \":\" + this.selectedDef.pdPremCode : this.form_defAdd.id + \":\" + this.form_defAdd.pdPremCode\r\n        this.pdUwSiTypeDtOptions = ''\r\n      }\r\n      this.dialogShow.premAmountFormula = true;\r\n    },\r\n    getPdDiscountRange(val) {\r\n      this.pdDiscountRangeOptions = []\r\n      //\r\n      this.pdDiscountRangeOptions.push({\r\n        value: '000000',\r\n        label: ''\r\n      })\r\n      //\r\n      for (const pdDisCount of this.defTableData) {\r\n        if (val.includes(pdDisCount.id)) {\r\n          this.pdDiscountRangeOptions.push({\r\n            value: pdDisCount.pdPremCode,\r\n            label: pdDisCount.pdPremCode + \":\" + pdDisCount.pdPayName\r\n          })\r\n        }\r\n      }\r\n      //\r\n      for (const pdDisCount of this.additionTableData) {\r\n        if (val.includes(pdDisCount.pdPremId)) {\r\n          this.pdDiscountRangeOptions.push({\r\n            value: pdDisCount.pdExtPremCode,\r\n            label: pdDisCount.pdExtPremCode + \"-\" + pdDisCount.pdExtPremName\r\n          })\r\n        }\r\n      }\r\n      //\r\n      for (const pdDiscount of this.pdDiscountRangeOptions) {\r\n        this.$set(pdDiscount, 'disabled', false)\r\n      }\r\n    },\r\n    changeDialogVisible_formula(flag) {\r\n      if (flag === true) {\r\n        this.pdUwSiTypeOptions = this.pdtempPdBnft\r\n      }\r\n      this.dialogShow.premAmountFormula = flag\r\n    },\r\n    changeDialogVisible_formulaSelect(flag, guaranteeDetails, calculationFormulaType, prem, extPrem) {\r\n      if (flag === true) {\r\n        this.pdUwSiTypeOptions = prem\r\n        this.pdUwSiTypeDtOptions = extPrem\r\n        this.guaranteeDetails = guaranteeDetails\r\n        this.calculationFormulaType = calculationFormulaType\r\n      } else {\r\n        this.dialogShow.premAmountFormula = false\r\n        this.$nextTick(() => {\r\n          this.dialogShow.premAmountFormula = true\r\n        })\r\n      }\r\n      this.dialogShow.premAmountFormulaSelect = flag\r\n    },\r\n    changeDialogVisible_pdDiscountSelect(flag) {\r\n      this.dialogShow.pdDiscountFormulaSelect = flag\r\n      if (flag === false) {\r\n        this.dialogShow.pdDiscountFormula = false\r\n        this.$nextTick(() => {\r\n          this.dialogShow.pdDiscountFormula = true\r\n        })\r\n      }\r\n    },\r\n    filterHandler(value, row, column) {\r\n      if (column) {\r\n        const property = column[\"property\"];\r\n        return row[property] === value;\r\n      }\r\n    },\r\n    filterHandlerDiscount(value, row, column) {\r\n      if (column) {\r\n        const property = column[\"property\"];\r\n        return row[property] === value;\r\n      }\r\n    },\r\n    //\r\n    goRules(num1, num2) {\r\n      this.guaranteeDetails = num1;//\r\n      this.calculationFormulaType = num2;//\r\n      this.dialogRulesShow.premRules = true;\r\n      this.pdUwSiTypeOptions = this.form_def.id + \":\" + this.form_def.pdPremCode;\r\n    },\r\n    goPdDiscountSelect(num1, num2) {\r\n      this.guaranteeDetails = num1;//\r\n      this.calculationFormulaType = num2;//\r\n      this.dialogShow.pdDiscountFormula = true;\r\n      this.pdUwSiTypeOptions = this.form_def;\r\n      this.pdDisCount = this.form_count\r\n    },\r\n    filter_pdCmpnRanges(code) {\r\n      for (const def of _this.defTableData) {\r\n        if (def.pdPremCode === code) {\r\n          return def.pdPremCode + \":\" + def.pdPayName\r\n        }\r\n      }\r\n      for (const def of _this.additionTableData) {\r\n        if (def.pdExtPremCode === code) {\r\n          return def.pdExtPremCode + \":\" + def.pdExtPremName\r\n        }\r\n      }\r\n      return code\r\n    },\r\n    changeDialogVisible_rules(flag) {\r\n      if (flag === true) {\r\n        this.pdUwSiTypeOptions = this.pdtempPdBnft\r\n      }\r\n      this.dialogRulesShow.premRules = flag\r\n    },\r\n    changeDialogVisible_pdDiscount(flag) {\r\n      if (flag === true) {\r\n        this.pdUwSiTypeOptions = this.pdtempPdBnft\r\n      }\r\n      this.dialogShow.pdDiscountFormula = flag\r\n    },\r\n    changeDialogVisible_rulesSelect(flag, guaranteeDetails, calculationFormulaType, prem, extPrem) {\r\n      if (flag === true) {\r\n        this.pdUwSiTypeOptions = prem\r\n        this.pdUwSiTypeDtOptions = extPrem\r\n        this.guaranteeDetails = guaranteeDetails\r\n        this.calculationFormulaType = calculationFormulaType\r\n      }\r\n      this.dialogRulesShow.premRulesSelect = flag\r\n    },\r\n    // \r\n    init() {\r\n      this.getProductInfo();\r\n      this.init_filters();\r\n      this.init_pay_frequency();\r\n      this.selectDiscountRangeTable();\r\n      this.init_pay_date();\r\n      this.init_typeRegion();\r\n    },\r\n    getProductInfo() {\r\n      // \r\n      this.product = this.getPdData()\r\n      this.params_currentProduct.eq_pdInfoId = this.product.id\r\n      this.form_def.pdInfoId = this.product.id\r\n      this.form_def.pdVerId = this.product.pdVerId\r\n      this.form_def.pdCode = this.product.pdCode\r\n      this.form_def.pdName = this.product.pdName;\r\n      this.params.finelinesRegion = this.getPdData().cType;\r\n    },\r\n    // \r\n    init_pay_frequency() {\r\n      const paramsMap = {\r\n        pd_info_id: this.params_currentProduct.eq_pdInfoId,\r\n        pd_atrs_code: 'payintv'\r\n      }\r\n      getPdAttrInfo(this.buildRequestData(paramsMap)).then(response => {\r\n        const pdTempAtrsList = response.data\r\n        this.product_extra.pdPayFreq = this._.map(pdTempAtrsList, 'pdAtrsVal');\r\n        this.pdPayFreqCopy = this._.map(pdTempAtrsList, 'pdAtrsVal');\r\n        console.log(\"AAAAAAAAAAAAAAAAAAAA\", this.pdPayFreqCopy);\r\n      })\r\n    },\r\n    //\r\n    init_typeRegion() {\r\n      const paramsMap = {\r\n        pd_info_id: this.params_currentProduct.eq_pdInfoId,\r\n        pd_cls_type: '2'\r\n      }\r\n      getPdClsLabInfo(this.buildRequestData(paramsMap)).then(response => {\r\n        const pdTempClsLabList = response.data\r\n        const pdCls6Array = this._.map(pdTempClsLabList, 'pdCls6')\r\n        if (pdCls6Array.length > 0) {\r\n          this.form_def.pdUrgePayFlag = pdCls6Array[0]\r\n        }\r\n      })\r\n    },\r\n    //\r\n    init_pay_date(){\r\n      const payMap = {\r\n        pd_info_id: this.params_currentProduct.eq_pdInfoId\r\n      }\r\n      getPayDate(this.buildRequestData(payMap)).then(response => {\r\n        this.form_def.pdPayEndPeriod = response.data.pdPayPeriod\r\n      })\r\n    },\r\n    // \r\n    init_filters() {\r\n      let ldcode_pdPremCalMode = this.ldcodes['pd_prem_cal_method']\r\n      let ldcode_pdAddPremMode = this.ldcodes['pd_prem_addition_mode']\r\n      let ldcode_pdPayAccKind = this.ldcodes['pd_prem_account_type']\r\n      if (ldcode_pdPremCalMode instanceof Array) {\r\n        for (const item of ldcode_pdPremCalMode) {\r\n          this.filters.pdPremCalMode.push({text: item.codename, value: item.code})\r\n        }\r\n      }\r\n      if (ldcode_pdAddPremMode instanceof Array) {\r\n        for (const item of ldcode_pdAddPremMode) {\r\n          this.filters.pdAddPremMode.push({text: item.codename, value: item.code})\r\n        }\r\n      }\r\n      if (ldcode_pdPayAccKind instanceof Array) {\r\n        for (const item of ldcode_pdPayAccKind) {\r\n          this.filters.pdPayAccKind.push({text: item.codename, value: item.code})\r\n        }\r\n      }\r\n    },\r\n    filter_pdPremCalMode(value, row) {\r\n      return row.pdPremCalMode === value;\r\n    },\r\n    filter_pdAddPremMode(value, row) {\r\n      return row.pdAddPremMode === value;\r\n    },\r\n    filter_pdPayAccKind(value, row) {\r\n      return row.pdPayAccKind === value;\r\n    },\r\n    initHeight() {\r\n      let scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop\r\n      this.isFixed = this.form_def.pdPremAddFlag === 'Y' && scrollTop > this.offsetTop + 130\r\n      this.fixedClassName = this.getFixedClassName()\r\n    },\r\n    getFixedClassName() {\r\n      const opened = this.sidebar.opened\r\n      if (this.isFixed === true) {\r\n        if (opened === true) {\r\n          return 'is_fixed_sidebarOpened'\r\n        } else {\r\n          return 'is_fixed_sidebarClosed'\r\n        }\r\n      } else {\r\n        return ''\r\n      }\r\n    },\r\n    initProductQueryData(){\r\n      this.filterProductByNode(this,'1')\r\n    },\r\n    selectedDetailTypeChanged(val) {\r\n      this.params.eq_pdInfoId = ''\r\n      val === ''?  this.initProductQueryData() : this.filterProductByCategory(this,val)\r\n    },\r\n    handleSearchInAllPremium() {\r\n      this.$refs.form_quick.validate(pass => {\r\n        if (pass) {\r\n          this.params.firstOpenPageFlag = 'N'\r\n          this.params.byPage = 'Y'\r\n          this.$refs.page_quick.reload()\r\n        }\r\n      })\r\n    },\r\n    copyPremiumToCurrentProduct(row) {\r\n      let add = {}\r\n      Object.assign(add, row)\r\n      // \r\n      add.id = undefined\r\n      // \r\n      add.pdInfoId = this.product.id\r\n      add.pdCode = this.product.pdCode\r\n      add.pdName = this.product.pdName\r\n      add.pdVerId = this.product.pdVerId\r\n      const data = {\r\n        premium: add\r\n      }\r\n      addPdtempPdPrem(data).then(() => {\r\n        this.$refs.page_def.buildData().then(() => {\r\n          this.$emit('childFn', true);\r\n          this.notifySuccess(this.$t('successMessage.add'))\r\n          this.selectedDefInQueryResult = {}\r\n        })\r\n      })\r\n    },\r\n    bringIntoFormDef() {\r\n      this.resetFormDef()\r\n      Object.assign(this.form_def, this.selectedDefInQueryResult)\r\n      // \r\n      this.form_def.id = undefined\r\n      // \r\n      this.form_def.pdInfoId = this.product.id\r\n      this.form_def.pdVerId = this.product.pdVerId\r\n      this.form_def.pdCode = this.product.pdCode\r\n      this.form_def.pdName = this.product.pdName\r\n      if (!this.selectedDef.pdPremZeroFlag) {\r\n        this.form_def.pdPremZeroFlag = 'N'\r\n      }\r\n      if (!this.selectedDef.pdUrgePayFlag) {\r\n        this.form_def.pdUrgePayFlag = 'Y'\r\n      }\r\n      if (!this.selectedDef.pdCharPremRel) {\r\n        this.form_def.pdCharPremRel = 'N'\r\n      }\r\n      this.params_addition.premiumList = [this.selectedDef]\r\n      if (this.$refs.page_addition) {\r\n        this.$refs.page_addition.reload()\r\n      }\r\n      this.selectedDefInQueryResult = {}\r\n    },\r\n    handleSearchInCurrentProduct() {\r\n      this.$refs.page_def.reload()\r\n    },\r\n    //\r\n    selectDiscountRangeTable() {\r\n      this.discountTableData = []\r\n      selectDiscountRangeByPdInfoId(this.buildRequestData({\"pdInfoId\": this.product.id})).then(res => {\r\n        this.discountTableData = res.data\r\n        this.getOrderNumber('addition_discount')\r\n        if (this.flag1 == 1){\r\n          for (let i = 0; i< this.discountTableData.length; i ++){\r\n            if (i = this.discountTableData.length - 1){\r\n              this.form_count.pdCmpnCalcCode = this.discountTableData[i].pdCmpnCalcCode\r\n            }\r\n          }\r\n        }\r\n      })\r\n    },\r\n    rowClick_quick(row, column, event) {\r\n      if (event.target.nodeName === \"INPUT\") {\r\n        if (row.id === this.selectedDefInQueryResult.id) {\r\n          this.selectedDefInQueryResult = {}\r\n          this.resetFormDef()\r\n        }\r\n      }\r\n    },\r\n    rowClick_def(row, column, event) {\r\n      if (event.target.nodeName === \"INPUT\") {\r\n        if (row.id === this.selectedDef.id) {\r\n          this.cancelUpdateDef();\r\n          this.init_pay_date();\r\n          this.form_def.pdPayStartCalMode = '0'\r\n          this.form_def.pdPayStartCalRule = 'S'\r\n          this.form_def.pdPayEndCalMode = '0'\r\n          this.form_def.pdPayEndCalRule = 'S'\r\n          this.form_def.pdPayDateValue = '1'\r\n        }\r\n      }\r\n    },\r\n    selectedDefChanged() {\r\n      this.resetFormDef()\r\n      Object.assign(this.form_def, this.selectedDef)\r\n      this.payDateForm.payDateTable = JSON.parse(JSON.stringify(this.form_def.pdtempPdPremPeriodList))\r\n      if (!this.selectedDef.pdPremZeroFlag) {\r\n        this.form_def.pdPremZeroFlag = 'N'\r\n      }\r\n      if (!this.selectedDef.pdUrgePayFlag) {\r\n        this.form_def.pdUrgePayFlag = 'Y'\r\n      }\r\n      if (!this.selectedDef.pdCharPremRel) {\r\n        this.form_def.pdCharPremRel = 'N'\r\n      }\r\n\r\n      if (this.selectedDef.pdPayStartCalRule || this.selectedDef.pdPayStartCalMode || this.selectedDef.pdPayStartPeriod){\r\n        this.form_def.pdPremStartFlag='Y'\r\n      }\r\n\r\n      this.params_addition.premiumList = [this.selectedDef]\r\n\r\n      var arr = this.form_def.pdPayFrequency;\r\n      if (arr){\r\n        this.product_extra.pdPayFreq = eval('(' + arr + ')');\r\n      }else {\r\n        this.product_extra.pdPayFreq=[]\r\n      }\r\n      if (this.$refs.page_addition) {\r\n        this.$refs.page_addition.reload()\r\n      }\r\n\r\n    },\r\n    cancelUpdateDef() {\r\n      this.resetFormDef()\r\n      this.selectedDef = {}\r\n      this.params_addition.premiumList = this.defTableData\r\n      if (this.$refs.page_addition) {\r\n        this.$refs.page_addition.reload()\r\n      }\r\n    },\r\n    handleAddDef() {\r\n      this.$refs.form_def.validate(pass => {\r\n        this.$refs.product_extra.validate(pass2 => {\r\n          if (pass && pass2) {\r\n            this.$refs.ruleForm1.validate(val => {\r\n              if (val) {\r\n                if (!this.product_extra.pdPayFreq.every(val => this.pdPayFreqCopy.includes(val))) {\r\n                  this.notifyError(\"\")\r\n                  return;\r\n                }\r\n                if (!this.payDateForm.payDateTable.length) {\r\n                  this.notifyError(\"\")\r\n                  return;\r\n                }\r\n                if (this.additionTableData.length != 0) {\r\n                  this.form_def.pdPremAddFlag = 'Y'\r\n                } else {\r\n                  this.form_def.pdPremAddFlag = 'N'\r\n                }\r\n                if (this.form_def.pdPayStartPeriod == undefined) {\r\n                  this.form_def.pdPayStartPerUnit = undefined\r\n                }\r\n                if (this.form_def.pdPayEndPeriod == undefined) {\r\n                  this.form_def.pdPayEndUnit = undefined\r\n                }\r\n                this.form_def.pdPayFrequency = this.product_extra.pdPayFreq;\r\n                // \r\n                this.form_def.id = undefined\r\n                this.form_def.pdPremStartFlag = '';\r\n                const data = {\r\n                  premium: this.form_def,\r\n                  payDateTable: this.payDateForm.payDateTable\r\n                }\r\n                addPdtempPdPrem(data).then(response => {\r\n                  // this.form_defAdd = response.data\r\n                  this.form_defAdd = {};\r\n                  this.$refs.page_def.buildData().then(() => {\r\n                    this.resetFormDef()\r\n                    this.$emit('childFn', true);\r\n                    this.notifySuccess(this.$t('successMessage.add'))\r\n                  })\r\n                  this.tableCount++;\r\n                  this.$nextTick(() => {\r\n                    this.selectedRow();\r\n                  })\r\n                })\r\n              }\r\n            })\r\n\r\n          } else {\r\n            this.notifyError(this.$t('pay_def.message.form_validation_failed'))\r\n          }\r\n        })\r\n      })\r\n    },\r\n    handleUpdateDef() {\r\n      this.$refs.form_def.validate(pass => {\r\n        if (pass) {\r\n          this.$refs.ruleForm1.validate(val=>{\r\n            if(val){\r\n            if(!this.product_extra.pdPayFreq.every(val => this.pdPayFreqCopy.includes(val))){\r\n            this.notifyError(\"\")\r\n            return;\r\n          }\r\n          var idRow = this.form_def.id;\r\n          this.form_def.pdPayFrequency = this.product_extra.pdPayFreq;\r\n          this.form_def.pdPremStartFlag ='';\r\n          let pdtempPdPrem = this.form_def;\r\n          let pdtempPdPremPeriods = [];\r\n          if(this.payDateForm.payDateTable.length){\r\n            this.payDateForm.payDateTable.forEach(val=>{\r\n            pdtempPdPremPeriods.push({\r\n            pdPayStartPeriod:val.pdPayStartPeriod,\r\n            pdPayStartPerUnit:val.pdPayStartPerUnit,\r\n            pdPayEndPeriod:val.pdPayEndPeriod,\r\n            pdPayEndUnit:val.pdPayEndUnit\r\n          })\r\n          })\r\n          }\r\n          let data = {\r\n            pdtempPdPrem,\r\n            pdtempPdPremPeriods\r\n          }\r\n          updatePdtempPdPrem(this.buildRequestData(data)).then(res => {\r\n            this.$refs.page_def.buildData().then(() => {\r\n              this.resetFormDef()\r\n              this.selectedDef = {}\r\n              this.$emit('childFn', true);\r\n              this.notifySuccess(res.message)\r\n              this.$nextTick(() => {\r\n                this.selectedRow(idRow);\r\n              })\r\n            })\r\n          })\r\n\r\n            }\r\n          })\r\n\r\n\r\n        }\r\n      })\r\n    },\r\n\r\n    //\r\n    selectedRow(id) {\r\n      this.$refs.page_def.buildData().then(() => {\r\n        if (id) {\r\n          var idRow = id;\r\n          let num = 0;\r\n          for (num = 0; num < this.defTableData.length; num++) {\r\n            if (this.defTableData[num].id === idRow) {\r\n              this.$refs.defTableData.setCurrentRow(this.defTableData[num]);\r\n              this.selectedDef = this.defTableData[num]\r\n              this.selectedDefChanged();\r\n              break;\r\n            }\r\n          }\r\n        } else {\r\n          this.$refs.defTableData.setCurrentRow(this.defTableData[0]);\r\n          this.selectedDef = this.defTableData[0]\r\n          this.selectedDefChanged();\r\n        }\r\n      })\r\n    },\r\n    handleDeleteDef(row) {\r\n      deletePdtempPdPrem(row.id).then(() => {\r\n        if (row.pdPremCode === this.form_defAdd.pdPremCode) {\r\n          this.form_defAdd = {}\r\n        }\r\n        // \r\n        for (let i = 0; i < this.additionAddTableData.length; i++) {\r\n          let additionAdd = this.additionAddTableData[i]\r\n          if (additionAdd.pdPremId === this.selectedDef.id) {\r\n            this.additionAddTableData.splice(i, 1)\r\n            i--\r\n          }\r\n        }\r\n        let operationFlag\r\n        if (this._.includes(this.defTableData, this.selectedDef)) {\r\n          if (this.defTableData.length === 1 && this.$refs.page_def.page > 1) {\r\n            this.$refs.page_def.page -= 1\r\n          }\r\n          operationFlag = 'buildData'\r\n        } else {\r\n          operationFlag = 'reload'\r\n        }\r\n        switch (operationFlag) {\r\n          case 'buildData':\r\n            this.$refs.page_def.buildData().then(() => {\r\n              this.resetFormDef()\r\n              this.selectedDef = {}\r\n              this.notifySuccess(this.$t('successMessage.delete'))\r\n            })\r\n            break\r\n          case 'reload':\r\n            this.$refs.page_def.reload().then(() => {\r\n              this.resetFormDef()\r\n              this.selectedDef = {}\r\n              this.notifySuccess(this.$t('successMessage.delete'))\r\n            })\r\n            break\r\n        }\r\n      })\r\n    },\r\n    rowClick_addition(row, column, event) {\r\n      if (event.target.nodeName === \"INPUT\") {\r\n        if (row.id === this.selectedAddition.id) {\r\n          this.cancelUpdateAddition()\r\n        }\r\n      }\r\n    },\r\n    rowClick_discount(row, column, event) {\r\n      if (event.target.nodeName === \"INPUT\") {\r\n        if (row.id === this.selectedDiscount.id) {\r\n          this.selectedDiscount = {}\r\n          this.resetDiscountForm()\r\n        }\r\n      }\r\n    },\r\n    selectedAdditionChanged() {\r\n      this.resetFormAddition()\r\n      Object.assign(this.form_addition, this.selectedAddition)\r\n    },\r\n    selectedDiscountChanged() {\r\n      this.resetDiscountForm()\r\n      Object.assign(this.form_count, this.selectedDiscount)\r\n      this.form_count.pdPremIds = [this.selectedDiscount.pdPremId]\r\n      this.getPdDiscountRange([this.selectedDiscount.pdPremId])\r\n      //\r\n      this.form_count.pdCmpnRange = [this.selectedDiscount.pdCmpnRange]\r\n    },\r\n    selectAllAdditionType() {\r\n      for (const additionType of this.ldcodes['pd_prem_addition_type']) {\r\n        this.form_addition_add.pdExtPremType.push(additionType.code)\r\n      }\r\n    },\r\n    handleAddAddition() {\r\n      this.$refs.form_addition_add.validate(pass => {\r\n        if (pass) {\r\n          if (this.form_addition_add.pdPremId.length === 0 || this.form_addition_add.pdExtPremObj.length === 0 || this.form_addition_add.pdExtPremMode.length === 0 || this.form_addition_add.pdExtPremType.length === 0) {\r\n            this.notifyError(this.$t('pay_def.message.error_incomplete_information'))\r\n            return\r\n          }\r\n          if (this.defTableData && this.defTableData.length > 0) {\r\n            // \r\n            let paymentIds = this.form_addition_add.pdPremId\r\n            let paymentIds_available = this._.map(this.defTableData, 'id')\r\n            for (const paymentId of paymentIds) {\r\n              if (!this.isInArray(paymentId, paymentIds_available)) {\r\n                this.notifyError(this.$t('pay_def.message.error_unavailable_def'))\r\n                return\r\n              }\r\n            }\r\n            // \r\n            let array = this.buildArray(paymentIds, this.form_addition_add.pdExtPremObj, this.form_addition_add.pdExtPremMode, this.form_addition_add.pdExtPremType)\r\n            for (const arrayItem of array) {\r\n              this.form_addition = Object.assign({}, this.form_addition_add)\r\n              arrayItem.forEach((value, index) => {\r\n                if (index === 0) {\r\n                  this.form_addition.pdPremId = value\r\n                } else if (index === 1) {\r\n                  this.form_addition.pdExtPremObj = value\r\n                } else if (index === 2) {\r\n                  this.form_addition.pdExtPremMode = value\r\n                } else if (index === 3) {\r\n                  this.form_addition.pdExtPremType = value\r\n                }\r\n              })\r\n              //  payName  payCode \r\n              for (const def of this.defTableData) {\r\n                if (def.id === this.form_addition.pdPremId) {\r\n                  this.form_addition.pdPremName = def.pdPayName\r\n                  this.form_addition.pdPremCode = def.pdPremCode\r\n                  break\r\n                }\r\n              }\r\n              //  pdInfoId \r\n              this.form_addition.pdInfoId = this.product.id\r\n              //  pdCode \r\n              this.form_addition.pdCode = this.product.pdCode\r\n              //  pdVerId \r\n              this.form_addition.pdVerId = this.product.pdVerId\r\n              //  pdPremCalcCode \r\n              this.form_addition.pdExtPremCalcCode = this.form_addition_add.pdExtPremCalcCode\r\n              //\r\n              let pdAddPremObj = this.getCodeName('pdAddPremObj', this.form_addition.pdExtPremObj,true);\r\n              let pd_prem_addition_addition_mode = this.getCodeName('pd_prem_addition_addition_mode', this.form_addition.pdExtPremMode,true);\r\n              let pd_prem_addition_type = this.getCodeName('pd_prem_addition_type', this.form_addition.pdExtPremType,true);\r\n              this.$set(this.form_addition, 'pdExtPremName', pdAddPremObj+pd_prem_addition_addition_mode+pd_prem_addition_type)\r\n              this.additionAddTableData.push(this.form_addition)\r\n            }\r\n            this.getOrderNumber('addition_add')\r\n            this.resetFormAddition()\r\n            this.resetFormAdditionAdd()\r\n            this.notifySuccess(this.$t('successMessage.add'))\r\n          } else {\r\n            this.notifyError(this.$t('pay_def.message.error_def_no_define'))\r\n          }\r\n        }\r\n      })\r\n\r\n    },\r\n    buildArray(paymentIds, additionPayPersonTypes, additionModes, additionTypes) {\r\n      let array = []\r\n      let array_item = []\r\n      let array_paymentId = ''\r\n      let array_additionPayPersonType = ''\r\n      let array_additionMode = ''\r\n      let array_additionType = ''\r\n      for (const paymentId of paymentIds) {\r\n        array_paymentId = paymentId\r\n        for (const additionPayPersonType of additionPayPersonTypes) {\r\n          array_additionPayPersonType = additionPayPersonType\r\n          for (const additionMode of additionModes) {\r\n            array_additionMode = additionMode\r\n            for (const additionType of additionTypes) {\r\n              array_additionType = additionType\r\n              array_item.push(array_paymentId, array_additionPayPersonType, array_additionMode, array_additionType)\r\n              array.push(array_item)\r\n              array_item = []\r\n            }\r\n          }\r\n        }\r\n      }\r\n      return array\r\n    },\r\n    handleUpdateAddition() {\r\n      this.$refs.form_addition.validate(pass => {\r\n        if (pass) {\r\n          updatePdtempPdExtPrem(this.form_addition).then(() => {\r\n            this.$refs.page_addition.buildData().then(() => {\r\n              this.resetFormAddition()\r\n              this.selectedAddition = {}\r\n              this.notifySuccess(this.$t('successMessage.update'))\r\n            })\r\n          })\r\n        }\r\n      })\r\n    },\r\n    cancelUpdateAddition() {\r\n      this.resetFormAddition()\r\n      this.selectedAddition = {}\r\n    },\r\n    handleDeleteAddition(row) {\r\n      deletePdtempPdExtPrem(row.id).then(() => {\r\n        let operationFlag\r\n        if (this._.includes(this.additionTableData, this.selectedAddition)) {\r\n          if (this.additionTableData.length === 1 && this.$refs.page_addition.page > 1) {\r\n            this.$refs.page_addition.page -= 1\r\n          }\r\n          operationFlag = 'buildData'\r\n        } else {\r\n          operationFlag = 'reload'\r\n        }\r\n        switch (operationFlag) {\r\n          case 'buildData':\r\n            this.$refs.page_addition.buildData().then(() => {\r\n              this.resetFormAddition()\r\n              this.selectedAddition = {}\r\n              this.notifySuccess(this.$t('successMessage.delete'))\r\n            })\r\n            break\r\n          case 'reload':\r\n            this.$refs.page_addition.reload().then(() => {\r\n              this.resetFormAddition()\r\n              this.selectedAddition = {}\r\n              this.notifySuccess(this.$t('successMessage.delete'))\r\n            })\r\n            break\r\n        }\r\n      })\r\n    },\r\n    // \r\n    handleSelectionChange(val) {\r\n      this.selectedAdditionAdds = val\r\n    },\r\n    handleDeleteAdditionAdd(form_addition) {\r\n      this.additionAddTableData.splice(this.additionAddTableData.indexOf(form_addition), 1)\r\n      this.selectedAdditionAdds.splice(this.additionAddTableData.indexOf(form_addition), 1)\r\n      this.getOrderNumber('addition_add')\r\n      this.notifySuccess(this.$t('successMessage.delete'))\r\n    },\r\n    handleSaveAdditionAdd() {\r\n      let num = 0;\r\n      for (num = 0; num < this.selectedAdditionAdds.length; num++) {\r\n        if (!this.selectedAdditionAdds[num].pdExtPremName) {\r\n          this.notifyError(\"\")\r\n          return\r\n        }\r\n        if (this.selectedAdditionAdds[num].pdExtPremMode == '01' && !this.selectedAdditionAdds[num].pdMaxVal) {\r\n          this.notifyError(\"\")\r\n          return\r\n        }\r\n      }\r\n      const params = {\r\n        extPremList: this.selectedAdditionAdds\r\n      }\r\n      addPdtempPdExtPrem(this.buildRequestData(params)).then(() => {\r\n        this.$refs.page_addition.buildData().then(() => {\r\n          for (const selectedAdditionAdd of this.selectedAdditionAdds) {\r\n            this.additionAddTableData.splice(this.additionAddTableData.indexOf(selectedAdditionAdd), 1)\r\n          }\r\n          this.selectedAdditionAdds = []\r\n          this.getOrderNumber('addition_add')\r\n          this.notifySuccess(this.$t('successMessage.save'))\r\n        })\r\n      })\r\n    },\r\n    async saveDisCount() {\r\n      this.$refs[\"form_count\"].validate(async valid1 => {\r\n        if (valid1) {\r\n          let param = {\r\n            pdCmpnType: this.form_count.pdCmpnType\r\n          };\r\n          await findCmpnCaleCode(this.buildRequestData(param)).then(response => {\r\n            this.$nextTick(() => {\r\n              if (response.data.length < 2 && response.data.length > 0 && this.form_count.pdCmpnCalcMode == 2) {\r\n                this.detailTypeOptionList = response.data;\r\n                for (const product of this.detailTypeOptionList) {\r\n                  if (product.cmpnCalcCode == null){\r\n                    this.form_count.pdCmpnCalcCode = '';\r\n                  }else {\r\n                    this.form_count.pdCmpnCalcCode = product.cmpnCalcCode;\r\n                  }\r\n                }\r\n              }else {\r\n                this.form_count.pdCmpnCalcCode = '';\r\n              }\r\n            })\r\n          });\r\n\r\n          let PdtempPdCmpnInfos = []\r\n          let pdCmpnRange = this.form_count.pdCmpnRange\r\n          if (this._.includes(pdCmpnRange, '000000')) {\r\n            pdCmpnRange = []\r\n            for (const pdDiscount of this.pdDiscountRangeOptions) {\r\n              if (pdDiscount.value !== '000000') {\r\n                pdCmpnRange.push(pdDiscount.value)\r\n              }\r\n            }\r\n          }\r\n          this.form_count.pdVerId = this.product.pdVerId\r\n          this.form_count.operator = this.product.operator\r\n          this.form_count.pdInfoId = this.product.id\r\n          this.form_count.pdCode = this.product.pdCode\r\n          this.form_count.pdName = this.product.pdName\r\n          //\r\n          for (const def of _this.defTableData) {\r\n            if (this.form_count.pdPremIds.includes(def.id)) {\r\n              this.form_count.pdPremCodes.push(def.pdPremCode)\r\n            }\r\n          }\r\n          for (let i = 0; i < pdCmpnRange.length; i++) {\r\n            for(let j = 0; j < this.form_count.pdPremIds.length; j++){\r\n              let PdtempPdCmpnInfo = JSON.parse(JSON.stringify(this.form_count))\r\n              PdtempPdCmpnInfo.pdPremId = this.form_count.pdPremIds[j]\r\n              PdtempPdCmpnInfo.pdPremCode = this.form_count.pdPremCodes[j]\r\n              PdtempPdCmpnInfo.pdCmpnRange = pdCmpnRange[i]\r\n              PdtempPdCmpnInfos.push(PdtempPdCmpnInfo)\r\n            }\r\n\r\n          }\r\n          const data = {\r\n            PdtempPdCmpnInfos: PdtempPdCmpnInfos\r\n          }\r\n          this.flag1 = 1;\r\n          addPdtempPdCmpnInfo(this.buildRequestData(data)).then(res => {\r\n            this.$emit(\"childFn\", \"reload\");\r\n            if (res.code == 200) {\r\n              this.notifySuccess(res.message);\r\n              this.clearFormDiscount()\r\n              this.selectDiscountRangeTable();\r\n            }\r\n          });\r\n        } else {\r\n          this.focusItem()\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    updateDisCount() {\r\n      this.$refs[\"form_count\"].validate(valid1 => {\r\n        if (valid1) {\r\n          const PdtempPdCmpnInfo = JSON.parse(JSON.stringify(this.form_count))\r\n          PdtempPdCmpnInfo.pdCmpnRange = PdtempPdCmpnInfo.pdCmpnRange[0]\r\n          updatePdtempPdCmpnInfo(this.buildRequestData({\"PdtempPdCmpnInfo\": PdtempPdCmpnInfo})).then(() => {\r\n            this.$emit(\"childFn\", \"reload\")\r\n            this.notifySuccess(this.$t('successMessage.update'))\r\n            this.selectDiscountRangeTable();\r\n            this.selectedDiscount = {};\r\n            this.clearFormDiscount()\r\n          });\r\n        } else {\r\n          this.focusItem()\r\n        }\r\n      })\r\n    },\r\n    //\r\n    selectedRowDiscount(eeid) {\r\n      var lid = eeid;\r\n      if (lid) {\r\n        let num = 0;\r\n        for (num = 0; num < this.discountTableData.length; num++) {\r\n          if (this.discountTableData[num].cmpnInfoId == lid) {\r\n            this.selectedDiscount = this.discountTableData[num]\r\n            this.selectedDiscountChanged();\r\n            break;\r\n          }\r\n        }\r\n      } else if (lid == undefined) {\r\n        this.selectedDiscount = this.discountTableData[this.discountTableData.length - 1]\r\n        this.selectedDiscountChanged();\r\n      }\r\n    },\r\n    deleteDisCount(row) {\r\n      deletePdtempPdCmpnInfo(row.id).then(res => {\r\n        this.$emit(\"childFn\", \"reload\");\r\n        if (res.code == 200) {\r\n          this.notifySuccess(res.message);\r\n          this.selectedDiscount = {};\r\n          this.resetDiscountForm();\r\n          this.selectDiscountRangeTable();\r\n        }\r\n      })\r\n    },\r\n    // \r\n    getOrderNumber(arrayName) {\r\n      let tableData\r\n      let orderIndexArr\r\n      if (arrayName === 'addition') {\r\n        tableData = this.additionTableData\r\n      } else if (arrayName === 'addition_add') {\r\n        tableData = this.additionAddTableData\r\n      } else if (arrayName === 'addition_discount') {\r\n        tableData = this.discountTableData\r\n      }\r\n      else {\r\n        return\r\n      }\r\n      orderIndexArr = []\r\n      //  paymentId  paymentId \r\n      tableData = this._.orderBy(tableData, 'pdPremId', 'asc')\r\n      if (arrayName === 'addition') {\r\n        this.additionTableData = tableData\r\n      } else if (arrayName === 'addition_add') {\r\n        this.additionAddTableData = tableData\r\n      }else if (arrayName === 'addition_discount') {\r\n        this.discountTableData=tableData\r\n      }\r\n      let orderObj = {}\r\n      tableData.forEach((element, index) => {\r\n        element.rowIndex = index\r\n        if (orderObj[element.pdPremId]) {\r\n          orderObj[element.pdPremId].push(index)\r\n        } else {\r\n          orderObj[element.pdPremId] = []\r\n          orderObj[element.pdPremId].push(index)\r\n        }\r\n      })\r\n      // index this.orderIndexArr\r\n      for (let k in orderObj) {\r\n        orderIndexArr.push(orderObj[k])\r\n      }\r\n      if (arrayName === 'addition') {\r\n        this.orderIndexArr_addition = orderIndexArr\r\n      } else if (arrayName === 'addition_add') {\r\n        this.orderIndexArr_addition_add = orderIndexArr\r\n      }\r\n      else if (arrayName === 'addition_discount') {\r\n        this.orderIndexArr_addition_discount = orderIndexArr\r\n      }\r\n    },\r\n    // \r\n    objectSpanMethod_addition({row, column, rowIndex, columnIndex}) {\r\n      if (columnIndex === 2 || columnIndex === 3) {\r\n        for (let i = 0; i < this.orderIndexArr_addition.length; i++) {\r\n          let element = this.orderIndexArr_addition[i]\r\n          for (let j = 0; j < element.length; j++) {\r\n            let item = element[j]\r\n            if (rowIndex === item) {\r\n              if (j === 0) {\r\n                return {\r\n                  rowspan: element.length,\r\n                  colspan: 1\r\n                }\r\n              } else {\r\n                return {\r\n                  rowspan: 0,\r\n                  colspan: 0\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    },\r\n    objectSpanMethod_addition_add({row, column, rowIndex, columnIndex}) {\r\n      if (columnIndex === 2 || columnIndex === 3) {\r\n        for (let i = 0; i < this.orderIndexArr_addition_add.length; i++) {\r\n          let element = this.orderIndexArr_addition_add[i]\r\n          for (let j = 0; j < element.length; j++) {\r\n            let item = element[j]\r\n            if (rowIndex === item) {\r\n              if (j === 0) {\r\n                return {\r\n                  rowspan: element.length,\r\n                  colspan: 1\r\n                }\r\n              } else {\r\n                return {\r\n                  rowspan: 0,\r\n                  colspan: 0\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    },\r\n    //\r\n    objectSpanMethod_discount({row, column, rowIndex, columnIndex}) {\r\n      if (columnIndex === 2 || columnIndex === 3) {\r\n        for (let i = 0; i < this.orderIndexArr_addition_discount.length; i++) {\r\n          let element = this.orderIndexArr_addition_discount[i]\r\n          for (let j = 0; j < element.length; j++) {\r\n            let item = element[j]\r\n            if (rowIndex === item) {\r\n              if (j === 0) {\r\n                return {\r\n                  rowspan: element.length,\r\n                  colspan: 1\r\n                }\r\n              } else {\r\n                return {\r\n                  rowspan: 0,\r\n                  colspan: 0\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    },\r\n    // \r\n    clearFormDef() {\r\n      const id = this.form_def.id;\r\n      const frequency = this.form_def.frequency\r\n      if (id) {\r\n        this.form_def.frequency = frequency\r\n        this.form_def = this.selectedDef\r\n        var arr = this.form_def.pdPayFrequency;\r\n        if (arr){\r\n          this.product_extra.pdPayFreq = eval('(' + arr + ')');\r\n        }else {\r\n          this.product_extra.pdPayFreq=[]\r\n        }\r\n      } else {\r\n        this.init_pay_frequency();\r\n        this.resetFormDef();\r\n        this.form_def.id = id\r\n        this.form_def.frequency = frequency\r\n        this.selectedDef = {}\r\n        this.form_def.pdPremAddFlag = 'Y'\r\n        this.form_def.pdPayStartCalMode = '0'\r\n        this.form_def.pdPayStartCalRule = 'S'\r\n        this.form_def.pdPayEndCalMode = '0'\r\n        this.form_def.pdPayEndCalRule = 'S'\r\n        this.form_def.pdPayDateValue = '1'\r\n        this.init_pay_date();\r\n      }\r\n    },\r\n    // \r\n    clearFormAddition() {\r\n      this.selectedAdditionChanged();\r\n      /*      this.form_addition.pdExtPremName = ''\r\n            this.form_addition.pdExtPremObj = ''\r\n            this.form_addition.pdExtPremMode = ''\r\n            this.form_addition.pdExtPremType = ''\r\n            this.form_addition.pdMaxVal = undefined\r\n            this.form_addition.pdExtPremCalcCode = ''*/\r\n    },\r\n    clearFormDiscount() {\r\n     /* if (this.selectedDiscount.id) {\r\n        this.selectedDiscountChanged();\r\n      } else {}*/\r\n        this.selectedDiscount = {}\r\n        this.resetDiscountForm()\r\n    },\r\n    //\r\n    resetDiscountForm() {\r\n      this.pdDiscountRangeOptions = [{\r\n        key: '000000',\r\n        value: '000000',\r\n        label: '',\r\n        disabled: true\r\n      }]\r\n      this.form_count = {\r\n        pdVerId: '',\r\n        operator: '',\r\n        pdType: '',\r\n        pdDefType: '',\r\n        pdInfoId: '',\r\n        pdCode: '',\r\n        pdName: '',\r\n        pdPremId: '',\r\n        pdPremCode: '',\r\n        pdPremCodes: [],\r\n        pdCmpnRange: [],\r\n        pdCmpnType: '',\r\n        cmpnInfoId: '',\r\n        pdCmpnCode: '',\r\n        pdCmpnOrder: this.configRangeLength,\r\n        pdCmpnCalcMode: '',\r\n        pdCmpnVal: '',\r\n        pdCmpnCalcCode: '',\r\n        pdCmpnDesc: ''\r\n      }\r\n      this.$nextTick(() => {\r\n        this.$refs.form_count.clearValidate()\r\n      })\r\n    },\r\n    //  new \r\n    resetFormDef() {\r\n      this.form_def = {\r\n        id: undefined,\r\n        pdInfoId: undefined,\r\n        pdVerId: undefined,\r\n        pdCode: '',\r\n        pdName: '',\r\n        operator: '',\r\n        pdPayName: '',\r\n        pdPremCode: '',\r\n        pdPremCalMode: 'G',\r\n        pdPremZeroFlag: 'Y',\r\n        pdPremReclFlag: 'N',\r\n        pdUrgePayFlag: 'Y',\r\n        pdPayStartPeriod: undefined,\r\n        pdPayStartPerUnit: 'Y',\r\n        pdPayStartCalRule: 'S',\r\n        pdPayStartCalMode: '0',\r\n        pdPayEndPeriod: undefined,\r\n        pdPayEndUnit: 'Y',\r\n        pdPayEndCalRule: 'S',\r\n        pdPayEndCalMode: '0',\r\n        pdAddPremMode: '',\r\n        pdPayAccKind: '',\r\n        pdCharPremRel: 'N',\r\n        pdRateChangeFlag: 'N',\r\n        pdPremAddFlag: 'N',\r\n        pdPremStartFlag: 'N',\r\n        pdPremAccRela: 'N',\r\n        pdPremCalcCode: '',\r\n        pdPayDateValue:'1'\r\n      }\r\n      this.form_def.pdInfoId = this.product.id\r\n      this.form_def.pdVerId = this.product.pdVerId\r\n      this.form_def.pdCode = this.product.pdCode\r\n      this.form_def.pdName = this.product.pdName\r\n      this.payDateForm = {\r\n        payDateTable:[],\r\n      },\r\n      this.$nextTick(() => {\r\n        this.$refs.form_def.clearValidate()\r\n      })\r\n    },\r\n    //  new \r\n    resetFormAddition() {\r\n      this.form_addition = {\r\n        id: undefined,\r\n        pdPremId: undefined,\r\n        pdVerId: undefined,\r\n        operator: '',\r\n        pdExtPremCode: '',\r\n        pdExtPremName: '',\r\n        pdPremName: '',\r\n        pdPremCode: '',\r\n        pdExtPremObj: '',\r\n        pdExtPremMode: '',\r\n        pdExtPremType: '',\r\n        pdMaxVal: undefined,\r\n        pdExtPremCalcCode: '',\r\n        createTime: undefined,\r\n        updateTime: undefined\r\n      }\r\n      if (this.$refs.form_addition) {\r\n        this.$refs.form_addition.clearValidate()\r\n      }\r\n    },\r\n    //  new \r\n    resetFormAdditionAdd() {\r\n      this.form_addition_add = {\r\n        id: undefined,\r\n        pdPremId: [],\r\n        pdExtPremObj: [],\r\n        pdExtPremMode: [],\r\n        pdExtPremType: [],\r\n        pdExtPremCalcCode: ''\r\n      }\r\n      if (this.$refs.form_addition_add) {\r\n        this.$refs.form_addition_add.clearValidate()\r\n      }\r\n    },\r\n    showAddFee(){\r\n      this.addFeeFlag =  !this.addFeeFlag\r\n    },\r\n    addPayRow(){\r\n      this.payDateForm.payDateTable.push({\r\n        pdPayEndPeriod:this.product.pdPayPeriod,\r\n        pdPayEndUnit:'Y',\r\n        pdPayStartPeriod:'0',\r\n        pdPayStartPerUnit:'Y'\r\n      })\r\n    },\r\n    delPayRow(index, row){\r\n      this.payDateForm.payDateTable.splice(index,1);\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n.input-with-select .el-input-group__append {\r\n  background-color: #fff;\r\n}\r\n\r\n\r\n\r\n.is_fixed_sidebarClosed {\r\n  position: fixed;\r\n  top: 0;\r\n  z-index: 98;\r\n  background: #ebebeb;\r\n  width: 81%;\r\n  padding: 10px;\r\n}\r\n\r\n.is_fixed_sidebarOpened {\r\n  position: fixed;\r\n  top: 0;\r\n  z-index: 98;\r\n  background: #ebebeb;\r\n  padding: 10px;\r\n  width: 74%;\r\n}\r\n\r\n.showDiv {\r\n  width: 90%;\r\n  height: 100%;\r\n  margin-top: -40px;\r\n  margin-left: -40px;\r\n  position: absolute;\r\n  background: #ffffff00;\r\n  z-index: 999;\r\n}\r\n\r\n.formtitle2 {\r\n  padding-top: 10px;\r\n  font-size: 20px;\r\n  font-weight: bold;\r\n}\r\n\r\n.divider {\r\n  background-color: black;\r\n  margin-left: 4px;\r\n}\r\n\r\n.payForm{\r\n  .el-form-item {\r\n    margin-bottom: 0px;\r\n  }\r\n}\r\n\r\n</style>\r\n"]}]}