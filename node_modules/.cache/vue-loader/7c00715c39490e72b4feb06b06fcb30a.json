{"remainingRequest":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\wecom-login\\index.vue?vue&type=style&index=0&id=5d6cc028&scoped=true&lang=css&","dependencies":[{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\wecom-login\\index.vue","mtime":1609847107212},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\css-loader\\dist\\cjs.js","mtime":1706753188288},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1706753191924},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\postcss-loader\\src\\index.js","mtime":1706753189537},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1706753190941}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLndyYXBwZXIgew0KICBkaXNwbGF5OiBmbGV4Ow0KICBhbGlnbi1pdGVtczogY2VudGVyOw0KICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgaGVpZ2h0OiAxMDAlOw0KfQ0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwGA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/wecom-login","sourcesContent":["<template>\r\n  <el-dialog :close-on-click-modal=\"false\" center  :visible.sync=\"dialogVisible\" width=\"40%\">\r\n    <cus-page-title :label=\"$t('i18nView.comSelect')\"></cus-page-title>\r\n    <el-table :data=\"tenantList\" align=\"center\" border class=\"wraper-table\" element-loading-text=\"Loading\" fit\r\n              highlight-current-row\r\n              size=\"mini\">>\r\n      <el-table-column :label=\"$t('table.select')\" align=\"center\" width=\"50px\">\r\n        <template slot-scope=\"scope\">\r\n          <el-radio :label=\"scope.row.tenantId\" @change=\"selectTenant(scope.row)\" v-model=\"radio\">\r\n            {{ '' }}\r\n          </el-radio>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('table.id')\" align=\"center\" type=\"index\"  width=\"50px\">\r\n      </el-table-column>\r\n      <el-table-column align=\"center\" :label=\"$t('i18nView.lesseeNme')\" prop=\"tenantName\"></el-table-column>\r\n      <el-table-column align=\"center\" :label=\"$t('i18nView.comCode')\" prop=\"tenantCode\"></el-table-column>\r\n    </el-table>\r\n    <span slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button size=\"small\" :disabled=\"radio===''\"  type=\"primary\" @click=\"submitForm\"><i class=\"el-icon-success el-icon--left\"></i>\r\n            {{\r\n              $t('table.confirm')\r\n            }} </el-button>\r\n        </span>\r\n  </el-dialog>\r\n\r\n</template>\r\n<script>\r\n\r\nimport auth from '@/api/wecom-login/userauth'\r\nimport { setAesKey, setDebug } from '@/utils/auth'\r\nimport { weComLogin } from '@/api/system/user'\r\n\r\nexport default {\r\n  name: 'auth',\r\n  data() {\r\n    return {\r\n      dialogVisible: false,\r\n      radio: '',\r\n      tenantList: [],\r\n      loginForm: {\r\n        username: '',\r\n        tenantCode: '',\r\n        tenantId: ''\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    doRealLogin() {\r\n      this.$store.dispatch('user/login', this.loginForm)\r\n        .then(() => {\r\n          this.$store.dispatch('ldcode/storageSelect')\r\n          let flag = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)\r\n          if (flag == null) {\r\n            this.$store.dispatch('ruleMessage/storageRuleMessage')\r\n            this.$store.dispatch('ruleCache/storageRuleCache')\r\n            this.$router.push({ path: 'dashboard' }).catch(() => {\r\n            })\r\n          } else {\r\n            this.$router.push({ path: 'weComDashboard' })\r\n          }\r\n        })\r\n        .catch(error => {\r\n          alert(error)\r\n        })\r\n    },\r\n    selectTenant(row) {\r\n      this.loginForm.tenantId = row.tenantId\r\n      this.loginForm.password = row.tenantCode\r\n    },\r\n    submitForm() {\r\n      this.doRealLogin()\r\n    }\r\n  },\r\n  created() {\r\n    setDebug('true')\r\n    //企业微信登录\r\n    auth.getCode().then(res => {\r\n      let weComId = res.data.userId\r\n      let param = { weComId: weComId }\r\n      weComLogin({ 'params': param }).then(response => {\r\n        let data = response.data\r\n        setAesKey(data.aesKey)\r\n        setDebug(data.debug)\r\n        let tenantList = data.tenants\r\n        this.loginForm.username = data.weComId\r\n        this.loginForm.weComFlag = '1'\r\n        if (tenantList.length === 1) {\r\n          this.loginForm.tenantId = tenantList[0].tenantId\r\n          this.loginForm.password = tenantList[0].tenantCode\r\n          this.doRealLogin()\r\n        } else {\r\n          this.tenantList = tenantList\r\n          this.dialogVisible = true\r\n        }\r\n      })\r\n    }).catch(error => {\r\n      alert(error)\r\n    })\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.wrapper {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  height: 100%;\r\n}\r\n</style>\r\n"]}]}