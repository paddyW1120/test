{"remainingRequest":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\product-package-definition\\pp-operation-def\\pp-acceptance-def\\accpt-rule-def\\index.vue?vue&type=style&index=0&id=1d0a021c&lang=scss&scoped=true&","dependencies":[{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\product-package-definition\\pp-operation-def\\pp-acceptance-def\\accpt-rule-def\\index.vue","mtime":1609847107020},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\css-loader\\dist\\cjs.js","mtime":1706753188288},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1706753191924},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\postcss-loader\\src\\index.js","mtime":1706753189537},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1706753187424},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1706753190941}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouc2hvd0RpdiB7DQogIHdpZHRoOiAxMDAlOw0KICBoZWlnaHQ6IDEwMCU7DQogIG1hcmdpbi10b3A6IC00MHB4Ow0KICBtYXJnaW4tbGVmdDogLTQwcHg7DQogIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgYmFja2dyb3VuZDogI2ZmZmZmZjAwOw0KICB6LWluZGV4OiA5OTk7DQp9DQoNCi5jc3Qgew0KICB3aWR0aDogMTUlOw0KICBtYXJnaW4tcmlnaHQ6IC01cHg7DQogIGJvcmRlcjogMDsNCn0NCg0KaHIgew0KICBtYXJnaW4tdG9wOiA3cHg7DQogICptYXJnaW46IDA7DQogIGJvcmRlcjogMDsNCiAgY29sb3I6IGJsYWNrOw0KICBiYWNrZ3JvdW5kLWNvbG9yOiBibGFjazsNCiAgaGVpZ2h0OiAycHg7DQp9DQoNCi5kaXZpZGVyIHsNCiAgY29sb3I6IGJsYWNrOw0KICBiYWNrZ3JvdW5kLWNvbG9yOiBibGFjazsNCiAgd2lkdGg6IDFweDsNCn0NCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAygCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/product-package-definition/pp-operation-def/pp-acceptance-def/accpt-rule-def","sourcesContent":["<template>\r\n  <cus-wraper>\r\n    <div :class=\"{ 'showDiv': showPageFlag == 1 }\"></div>\r\n\r\n    <cus-page-title-back v-if=\"revisionFlag\" :label=\"$t('route.comboRuleRevision')\" @backTo=\"back\"/>\r\n      <el-form label-width=\"auto\" :model=\"pdPpInfo\" ref=\"form\" style=\"margin-left: 20px\">\r\n          <el-form-item :label=\"$t('acceptanceDefinitionMain.productMeat')\">\r\n            <el-tag type=\"info\">{{ pdPpInfo.ppCode + ' : ' + pdPpInfo.ppName }}</el-tag>\r\n          </el-form-item>\r\n      </el-form>\r\n    <div v-if=\"!revisionFlag\">\r\n      <cus-form-title :first=\"true\" :label=\"$t('insureRuleDefinition.ageRuleConfiguration')\"/>\r\n      <cus-table-title :label=\"$t('insureRuleDefinition.ageRule')\"/>\r\n      <el-table ref=\"ageTable\" :data=\"ageConfigs\" align=\"center\" border class=\"wraper-table\"\r\n                element-loading-text=\"Loading\"\r\n                fit highlight-current-row max-height=\"500px\" size=\"mini\" @row-click=\"chooseOne1\">\r\n        <el-table-column :label=\"$t('insureRuleDefinition.choose')\" align=\"center\" width=\"50px\">\r\n          <template slot-scope=\"scope\">\r\n            <el-radio v-model=\"radio1\" :label=\"scope.row.id\">\r\n              <span class=\"el-radio__label\"></span>\r\n            </el-radio>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('table.id')\" align=\"center\" type=\"index\" width=\"50\"></el-table-column>\r\n        <el-table-column :label=\"$t('insureRuleDefinition.ruleDef')\" align=\"center\" prop=\"pdRuleDef\" width=\"150px\">\r\n          <template v-slot=\"scope\">{{ scope.row.pdRuleDef | filter_pdRuleDef }}:{{ scope.row.pdRuleDefCode }}</template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('login.role')\" align=\"center\" prop=\"pdRoleCode\">\r\n          <template v-slot=\"scope\">{{ scope.row.pdRoleCode | filter_pdRoleCode }}</template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('insureRuleDefinition.pdRoleNo')\" align=\"center\" prop=\"pdRoleNo\"></el-table-column>\r\n        <el-table-column :label=\"$t('insureRuleDefinition.pdRoleSex')\" align=\"center\" prop=\"pdRoleSex\">\r\n          <template v-slot=\"scope\">{{ scope.row.pdRoleSex | filter_pdRoleSex }}</template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('insureRuleDefinition.pdInsuPeriod')\" align=\"center\" prop=\"pdInsuPeriod\">\r\n          <template v-slot=\"scope\">\r\n            {{ scope.row.pdInsuPeriod }}{{ scope.row.pdInsuPeriodUnit | filter_pdMaxAppAgeUnit }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('i18nView.payTerm')\" align=\"center\" prop=\"pdPayPeriod\">\r\n          <template v-slot=\"scope\">{{ scope.row.pdPayPeriod }}{{ scope.row.pdPayPeriodUnit | filter_pdMaxAppAgeUnit }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('insureRuleDefinition.pdPayFreq')\" align=\"center\" prop=\"pdPayFreq\">\r\n          <template v-slot=\"scope\">{{ scope.row.pdPayFreq | filter_pdPayFreq }}</template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('insureRuleDefinition.pdMaxAppAge')\" align=\"center\" prop=\"pdMaxAppAge\">\r\n          <template v-slot=\"scope\">{{ scope.row.pdMaxAppAge }}{{ scope.row.pdMaxAppAgeUnit | filter_pdMaxAppAgeUnit }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('insureRuleDefinition.pdMinAppAge')\" align=\"center\" prop=\"pdMinAppAge\">\r\n          <template v-slot=\"scope\">{{ scope.row.pdMinAppAge }}{{ scope.row.pdMinAppAgeUnit | filter_pdMaxAppAgeUnit }}\r\n          </template>\r\n        </el-table-column>\r\n      <el-table-column  :label=\"$t('insureRuleDefinition.operation')\" align=\"center\" fixed=\"right\"\r\n                       width=\"120\">\r\n        <template slot-scope=\"scope\">\r\n          <cus-del-btn v-auth=\"'pd-insure-rule-def:deleteRule'\" @ok=\"delRoleRow(scope.row)\"></cus-del-btn>\r\n        </template>\r\n      </el-table-column>\r\n      </el-table>\r\n      <br/>\r\n      <!--cus-form-title :first=\"true\" :label=\"$t('insureRuleDefinition.ageRuleDefinition')\"/-->\r\n      <el-form ref=\"ageForm\" :model=\"ageForm\" :rules=\"rules\" label-width=\"auto\">\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('insureRuleDefinition.ruleDef')\" prop=\"pdRuleDef\">\r\n              <cus-radio v-model=\"ageForm.pdRuleDef\" :codetype=\"'ruleProperties'\" :filter=\"rulePropertiesFilter\"\r\n                         :isRequired=\"true\"></cus-radio>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n            <el-form-item v-show=\"showAgeProductFlag\" :label=\"$t('insureRuleDefinition.product')\" prop=\"pdDefCode\">\r\n              <el-select v-model=\"ageForm.pdDefCode\">\r\n                <el-option v-for=\"item in productOptions\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\">\r\n                </el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\"></el-col>\r\n        </el-row>\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('login.role')\" prop=\"pdRoleCode\"  >\r\n              <cus-radio v-model=\"ageForm.pdRoleCode\" :codetype=\"'pdexptrole'\" :isRequired=\"true\"  :changeMethod=\"changeRoleNo\"></cus-radio>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('insureRuleDefinition.pdRoleNo')\" prop=\"pdRoleNo\">\r\n              <el-input v-model=\"ageForm.pdRoleNo\"></el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('insureRuleDefinition.pdRoleSex')\" prop=\"pdRoleSex\">\r\n              <cus-radio v-model=\"ageForm.pdRoleSex\" :codetype=\"'productRuleSex'\" :isRequired=\"true\"></cus-radio>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('pdtempPdInsuAgeInfo.pdInsuPeriod')\" prop=\"pdInsuPeriod\">\r\n              <el-input v-model=\"ageForm.pdInsuPeriod\">\r\n                <cus-select slot=\"append\" v-model=\"ageForm.pdInsuPeriodUnit\" :codetype=\"'pdsbnftdy'\" class=\"cst\"\r\n                            filter=\"1$Y$M$D$A\"\r\n                ></cus-select>\r\n              </el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('insureRuleDefinition.pdPayPeriod')\" prop=\"pdPayPeriod\">\r\n              <el-input v-model=\"ageForm.pdPayPeriod\">\r\n                <cus-select slot=\"append\" v-model=\"ageForm.pdPayPeriodUnit\" :codetype=\"'pdsbnftdy'\" class=\"cst\"\r\n                            filter=\"1$Y$M$D$A\"\r\n                ></cus-select>\r\n              </el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('insureRuleDefinition.pdPayFreq')\" prop=\"pdPayFreq\">\r\n              <el-select v-model=\"ageForm.pdPayFreq\" :placeholder=\"$t('pdtempPdBnft.pleaseChoose')\" clearable\r\n                         filterable>\r\n                <el-option v-for=\"item in pdPayFreqOptions\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\">\r\n                </el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('pdtempPdInsuAgeInfo.pdMaxAppAge')\" prop=\"pdMaxAppAge\">\r\n              <el-input v-model=\"ageForm.pdMaxAppAge\">\r\n                <cus-select slot=\"append\" v-model=\"ageForm.pdMaxAppAgeUnit\" :codetype=\"'pdsbnftdy'\" class=\"cst\"\r\n                            filter=\"1$M$D$A\"\r\n                ></cus-select>\r\n              </el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('pdtempPdInsuAgeInfo.pdMinAppAge')\" prop=\"pdMinAppAge\">\r\n              <el-input v-model=\"ageForm.pdMinAppAge\">\r\n                <cus-select slot=\"append\" v-model=\"ageForm.pdMinAppAgeUnit\" :codetype=\"'pdsbnftdy'\" class=\"cst\"\r\n                            filter=\"1$M$D$A\"\r\n                ></cus-select>\r\n              </el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n          </el-col>\r\n        </el-row>\r\n        <el-row :gutter=\"20\">\r\n          <el-form-item align=\"right\">\r\n            <el-button dialog-disable=\"disable\" v-if=\"!radio1\" v-auth=\"'pd-insure-rule-def:add'\" icon=\"el-icon-success\" size=\"small\"\r\n                       type=\"primary\"\r\n                       @click=\"saveAgeForm\">\r\n              {{ $t('insureRuleDefinition.save') }}\r\n            </el-button>\r\n            <el-button dialog-disable=\"disable\" v-if=\"radio1\" v-auth=\"'pd-insure-rule-def:update'\" icon=\"el-icon-success\" size=\"small\"\r\n                       type=\"primary\"\r\n                       @click=\"updateAgeForm\">\r\n              {{ $t('insureRuleDefinition.update') }}\r\n            </el-button>\r\n            <el-button dialog-disable=\"disable\" icon=\"el-icon-refresh\" size=\"small\" type=\"primary\" @click=\"cleanAgeForm\">\r\n              {{ $t('insureRuleDefinition.delete') }}\r\n            </el-button>\r\n          </el-form-item>\r\n        </el-row>\r\n      </el-form>\r\n    </div>\r\n    <cus-form-title :label=\"$t('insureRuleDefinition.packageRuleConfiguration')\"></cus-form-title>\r\n    <cus-form-title :label=\"$t('insureRuleDefinition.customRuleConfiguration')\"></cus-form-title>\r\n    <el-form ref=\"insuranceRuleForm\" :model=\"insuranceRuleForm\" :rules=\"insuranceRuleFormRule\" label-width=\"auto\">\r\n      <el-row :gutter=\"20\">\r\n        <el-col :span=\"7\">\r\n          <el-form-item :label=\"$t('insureRuleDefinition.pdRuleGrade')\">\r\n            <cus-radio v-model=\"insuranceRuleForm.pdRuleGrade\" :codetype=\"'ruleProperties'\"\r\n                       :filter=\"rulePropertiesFilter\"\r\n                       :isRequired=\"true\"></cus-radio>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"7\">\r\n          <el-form-item v-show=\"showRuleProductFlag\" :label=\"$t('customComponents.product')\"\r\n                        prop=\"pdGradeCode\">\r\n            <el-select v-model=\"insuranceRuleForm.pdGradeCode\" clearable filterable>\r\n              <el-option v-for=\"item in productOptions\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\">\r\n              </el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <cus-btn-wrapper>\r\n          <el-button dialog-disable=\"disable\" icon=\"el-icon-connection\" size=\"small\" type=\"primary\" @click=\"findRulesOptions\">\r\n            {{ $t('insureRuleDefinition.ruleSelect') }}\r\n          </el-button>\r\n        </cus-btn-wrapper>\r\n      </el-row>\r\n    </el-form>\r\n    <cus-form-title :label=\"$t('rule.selectedRule')\"></cus-form-title>\r\n    <cus-table-title :label=\"$t('insureRuleDefinition.packageRules')\"/>\r\n    <el-table ref=\"cusTable\" :data=\"cusConfigs\" align=\"center\" border class=\"wraper-table\"\r\n              element-loading-text=\"Loading\"\r\n              fit highlight-current-row max-height=\"500px\" size=\"mini\" @row-click=\"chooseOne2\">\r\n      <el-table-column :label=\"$t('pdtempPdBnft.choose')\" width=\"50\">\r\n        <template slot-scope=\"scope\">\r\n          <el-radio v-model=\"radio2\" :label=\"scope.row.id\">\r\n            <span class=\"el-radio__label\"></span>\r\n          </el-radio>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('insureRuleDefinition.index')\" align=\"center\" type=\"index\"\r\n                       width=\"50\"></el-table-column>\r\n      <el-table-column :label=\"$t('insureRuleDefinition.pdRuleGrade')\" align=\"center\" prop=\"pdType\">\r\n        <template v-slot=\"scope\">{{ scope.row.pdType | filter_pdRuleDef }}</template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('rule.ruleAttr')\" align=\"center\" prop=\"pdRuleGrade\">\r\n        <template v-slot=\"scope\">\r\n          {{\r\n            scope.row.pdRuleGrade === '1' ? '通用' : scope.row.pdRuleGrade === '2' ? '产品:' + scope.row.pdPackageCode : '套餐:' + scope.row.pdPackageCode\r\n          }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('insureRuleDefinition.pdRuleCode')\" align=\"center\"\r\n                       prop=\"pdRuleCode\"></el-table-column>\r\n      <el-table-column :label=\"$t('insureRuleDefinition.pdRuleDesc')\" align=\"center\"\r\n                       prop=\"pdRuleDesc\"></el-table-column>\r\n      <el-table-column :label=\"$t('insureRuleDefinition.details')\" align=\"center\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button dialog-disable=\"disable\" size=\"small\" type=\"text\" @click=\"showRules(scope.row.pdRuleCode)\">>></el-button>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('insureRuleDefinition.operation')\" align=\"center\" width=\"65px\">\r\n        <template slot-scope=\"scope\">\r\n          <cus-del-btn v-auth=\"'pdtemppdinsuageinfo:delete'\" @ok=\"delCusRow(scope.row)\"></cus-del-btn>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <el-dialog v-dialog-drag :close-on-click-modal=\"false\" :visible.sync=\"showRule\" center\r\n               top=\"8vh\" width=\"70%\">\r\n      <cus-page-title-back :isDialog=\"true\" :label=\"$t('insureRuleDefinition.customRuleConfiguration')\"\r\n                           @backTo=\"showRule = false\"/>\r\n      <el-form ref=\"productForm\" :model=\"productForm\" label-width=\"auto\">\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('insureRuleDefinition.packageMenu')\">\r\n              <el-tag type=\"info\">{{ productForm.product }}</el-tag>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n            <el-form-item v-show=\"showRuleProductFlag\" :label=\"$t('customComponents.product')\">\r\n              <el-select v-model=\"productCode\" :disabled=\"true\" clearable filterable>\r\n                <el-option v-for=\"item in productOptions\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\">\r\n                </el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n      </el-form>\r\n      <cus-form-title :first=\"true\" :label=\"$t('insureRuleDefinition.ruleSelect')\"/>\r\n      <el-form ref=\"cusForm\" :model=\"cusForm\" label-width=\"auto\">\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('insureRuleDefinition.appointPackage')\">\r\n              <el-select v-model=\"cusForm.package\" clearable filterable @change=\"findProductByPackageId\">\r\n                <el-option v-for=\"item in packageOptions\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\">\r\n                </el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('insureRuleDefinition.designatedProducts')\">\r\n              <el-select v-model=\"cusForm.product\" :placeholder=\"$t('pdtempPdBnft.pleaseChoose')\" clearable\r\n                         filterable>\r\n                <el-option v-for=\"item in appointProductOptions\" :key=\"item.value\" :label=\"item.label\"\r\n                           :value=\"item.value\">\r\n                </el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('insureRuleDefinition.ruleCode')\" prop=\"ruleCode\">\r\n              <el-input v-model=\"cusForm.ruleCode\"></el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"24\">\r\n            <el-form-item align=\"right\">\r\n              <el-button dialog-disable=\"disable\" icon=\"el-icon-search\" size=\"small\" type=\"primary\" @click=\"searchRules\">\r\n                {{ $t('insureRuleDefinition.search') }}\r\n              </el-button>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n      </el-form>\r\n      <el-button  dialog-disable=\"disable\" size=\"small\" type=\"primary\" @click=\"addRules\"><i\r\n        class=\"el-icon-plus el-icon--left\"></i>{{ $t('insureRuleDefinition.newRule') }}\r\n      </el-button>\r\n      <cus-table-title :label=\"$t('insureRuleDefinition.rules')\"></cus-table-title>\r\n      <el-table ref=\"configsTable\" :data=\"ruleConfigs\" align=\"center\" border class=\"wraper-table\"\r\n                element-loading-text=\"Loading\"\r\n                fit highlight-current-row size=\"mini\" @selection-change=\"handleSelectionChange\">\r\n        <el-table-column type=\"selection\" width=\"50\"></el-table-column>\r\n        <el-table-column :label=\"$t('table.id')\" align=\"center\" type=\"index\" width=\"50\"></el-table-column>\r\n        <el-table-column :label=\"$t('insureRuleDefinition.ruleDef')\" align=\"center\" prop=\"pdRuleGrade\">\r\n          <template v-slot=\"scope\">\r\n            {{\r\n              scope.row.pdRuleGrade === '1' ? '通用' : scope.row.pdRuleGrade === '2' ? '产品:' + scope.row.pdCode : '套餐:' + scope.row.pdCode\r\n            }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :filter-method=\"filterHandler\" :filters=\"codeFilters\"\r\n                         :label=\"$t('insureRuleDefinition.ruleCode')\"\r\n                         align=\"center\" prop=\"pdRuleCode\"></el-table-column>\r\n        <el-table-column :label=\"$t('insureRuleDefinition.ruleDesc')\" align=\"center\"\r\n                         prop=\"pdRuleDesc\"></el-table-column>\r\n        <el-table-column :label=\"$t('insureRuleDefinition.details')\" align=\"center\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button dialog-disable=\"disable\" size=\"small\" type=\"text\" @click=\"showRules(scope.row.pdRuleCode)\">>></el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <br/>\r\n      <div style=\"float:right\">\r\n        <el-button dialog-disable=\"disable\" icon=\"el-icon-connection\" size=\"small\" type=\"primary\" @click=\"connRules\">\r\n          {{ $t('insureRuleDefinition.choice') }}\r\n        </el-button>\r\n        <el-button dialog-disable=\"disable\" icon=\"el-icon-refresh\" size=\"small\" type=\"primary\" @click=\"refreshRuleConfigs\">\r\n          {{ $t('insureRuleDefinition.refresh') }}\r\n        </el-button>\r\n      </div>\r\n      <br/>\r\n    </el-dialog>\r\n    <!-- 规则引擎定义弹窗 -->\r\n    <cus-rule-definition :attributeObj=\"attributeObj\" :ruleDefinitionClosed=\"ruleModuleClosed\"\r\n                         :visible=\"ruleVisible\"></cus-rule-definition>\r\n\r\n    <!-- 规则查看弹窗 -->\r\n    <cus-rule-modify :flag=\"ruleView.flag\" :ruleCode=\"ruleView.ruleCode\" :ruleModifyClosed=\"ruleMakeClosed\" :performType=\"ruleView.ruleType\"\r\n                     :ruleType=\"'1'\" :visible=\"ruleView.visible\"></cus-rule-modify>\r\n  </cus-wraper>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  addPdtempPdInsuAgeInfo,\r\n  connRules,\r\n  deletePdtempPdInsuAgeInfo,\r\n  deleteRules,\r\n  findPdPayFrequency,\r\n  findProductList,\r\n  findRulesByParams,\r\n  findRulesList,\r\n  getMaxAgeOrder,\r\n  getRuleCode,\r\n  insureRuleDefinitionList,\r\n  packageList,\r\n  updatePdtempPdInsuAgeInfo,\r\n  pdtempPdClsLabList\r\n} from \"@/api/basicinfo/insureRuleDefinition\";\r\nimport {mapGetters} from \"vuex\"\r\nimport ruleModule from '@/views/ibrms/ruleManagement/ruleModule/index'\r\nimport ruleMake from '@/views/ibrms/ruleManagement/ruleMake/index'\r\n\r\nlet _this;\r\n\r\nexport default {\r\n  name: \"insureRuleDefinition\",\r\n  filters: {\r\n    filter_pdRoleCode(code) {\r\n      return _this.getCodeName(\"pdexptrole\", code);\r\n    },\r\n    filter_pdRuleDef(code) {\r\n      return _this.getCodeName(\"ruleProperties\", code, true);\r\n    },\r\n    filter_pdRoleSex(code) {\r\n      return _this.getCodeName(\"productRuleSex\", code);\r\n    },\r\n    filter_pdMaxAppAgeUnit(code) {\r\n      return _this.getCodeName(\"pdsbnftdy\", code, true);\r\n    },\r\n    filter_pdPayFreq(code) {\r\n      return _this.getCodeName(\"paymentFrequency\", code);\r\n    },\r\n    filter_pdRulePropDtCls(code) {\r\n      if (code) {\r\n        return _this.getCascaderCodeName('ruleAscrDeta', code);\r\n      } else {\r\n        return '';\r\n      }\r\n    }\r\n  },\r\n  data() {\r\n    _this = this;\r\n    const validatepdMaxAppAge = (rule, value, callback) => {\r\n      if (this.ageForm.pdMaxAppAge < this.ageForm.pdMinAppAge){\r\n        callback(new Error(\"最大年龄不能小于最小年龄\"))\r\n      }else{\r\n        callback()\r\n      }\r\n    }\r\n    const validateRoleNo = (rule, value, callback) => {\r\n\r\n      if(_this.ageConfigs.length > 0){\r\n        let roleNo = [];\r\n        _this.ageConfigs.forEach(config =>{\r\n          if(_this.ageForm.pdRuleDef == config.pdRuleDef\r\n            && (_this.ageForm.pdDefCode != ''?_this.ageForm.pdDefCode == config.pdRuleDefCode:true)\r\n            && _this.ageForm.pdRoleCode == config.pdRoleCode){\r\n            roleNo.push(config.pdRoleNo)\r\n          }\r\n        })\r\n        if(roleNo.indexOf(parseInt(value)) > -1){\r\n          callback(new Error(this.$t('insureRuleDefinition.repeatRoleNo')))\r\n        }\r\n      }else{\r\n        callback()\r\n      }\r\n    }\r\n    return {\r\n      ruleView: {\r\n        visible: false,\r\n        updateDynamicTable: false,\r\n        flag: '',\r\n        ruleCode: '',\r\n        ruleQuery: undefined,\r\n        ruleType: '1'\r\n      },\r\n      attributeObj: {},\r\n      ruleVisible: false,\r\n      pdPpInfo: {},\r\n      productCode: '',\r\n      radio1: null,\r\n      radio2: null,\r\n      pdType: null,\r\n      pdDetailType: null,\r\n      showRule: false,\r\n      language: null,\r\n      ruleMessageInfoBom: [],\r\n      ageConfigs: [],\r\n      cusConfigs: [],\r\n      ruleConfigs: [],\r\n      pdPayFreqOptions: [],\r\n      Options: [\r\n        {\r\n          value: \"3\",\r\n          label: \"3\"\r\n        },\r\n        {\r\n          value: \"5\",\r\n          label: \"5\"\r\n        },\r\n        {\r\n          value: \"10\",\r\n          label: \"10\"\r\n        }\r\n      ],\r\n      productOptions: [],\r\n      showAgeProductFlag: true,\r\n      showRuleProductFlag: true,\r\n      packageOptions: [],\r\n      showPageFlag: '',\r\n      revisionFlag: false,\r\n      appointProductOptions: [],\r\n      rulePropertiesFilter: '1$2$3',\r\n      codeFilters: [],\r\n      chooseRules: [],\r\n      configAgeLength: '',\r\n      //套餐投保年龄规则配置\r\n      ageForm: {\r\n        pdRoleCode: '00',\r\n        pdRuleDef: '2',\r\n        pdDefCode: '',\r\n        pdRoleNo: '',\r\n        pdRoleSex: '1',\r\n        pdInsuPeriod: '',\r\n        pdInsuPeriodUnit: 'Y',\r\n        pdPayPeriod: '',\r\n        pdPayPeriodUnit: 'Y',\r\n        pdPayFreq: '',\r\n        pdMaxAppAge: '',\r\n        pdMaxAppAgeUnit: 'A',\r\n        pdMinAppAge: '',\r\n        pdMinAppAgeUnit: 'A'\r\n      },\r\n      //套餐自定义投保规则配置\r\n      insuranceRuleForm: {\r\n        pdRuleGrade: '2',\r\n        pdGradeCode: ''\r\n      },\r\n      //选择规则\r\n      cusForm: {\r\n        package: '',\r\n        product: '',\r\n        ruleCode: '',\r\n        ruleDesc: ''\r\n      },\r\n      productForm: {\r\n        product: ''\r\n      },\r\n      rules: {\r\n        pdRoleCode: [{required: true, message: \"请选择角色\", trigger: \"blur\"}],\r\n        pdRuleDef: [{required: true, message: \"请选择规则属性\", trigger: \"blur\"}],\r\n        pdDefCode: [{required: true, message: \"请选择规则属性关联编码\", trigger: \"blur\"}],\r\n        pdRoleNo: [{required: true, message: \"请输入角色顺序\", trigger: \"blur\"},\r\n          {pattern: /^[1-6]$/, message: \"只能输入1-6的数字\", trigger: \"blur\"},\r\n          {validator: validateRoleNo,trigger:'blur'}],\r\n        pdRoleSex: [{required: true, message: \"请选择性别\", trigger: \"blur\"}],\r\n        pdMaxAppAge: [{pattern: /^[0-9]*$/, message: \"最大投保年龄必须为数字\", trigger: \"blur\"}, {validator: validatepdMaxAppAge, trigger: 'blur'}],\r\n        pdMinAppAge: [{pattern: /^[0-9]*$/, message: \"最小投保年龄必须为数字\", trigger: \"blur\"}]\r\n      },\r\n      insuranceRuleFormRule: {\r\n        pdRuleGrade: [{required: true, message: \"请选择规则所属级别\", trigger: \"blur\"}],\r\n        pdGradeCode: [{required: true, message: \"请选择产品\", trigger: \"blur\"}]\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters([\r\n      'ruleMassages',\r\n    ])\r\n  },\r\n  components: {ruleModule, ruleMake},\r\n  mounted() {\r\n    this.language = this.$store.state.app.language;\r\n    this.ruleMessageInfoBom = this.$store.state.ruleMessage.ruleMessages;\r\n  },\r\n  created() {\r\n    this.showPageFlag = this.$route.query.showPageFlag\r\n    this.revisionFlag = this.$route.query.productCalcRevisionShowINfo === 'true'\r\n    this.pdPpInfo = this.getPdData();\r\n    this.productForm.product = this.pdPpInfo.ppCode + \":\" + this.pdPpInfo.ppName;\r\n    if (this.revisionFlag) {\r\n      this.findCusConfigsData()\r\n      this.findProductList()\r\n    } else {\r\n      if (this.pdPpInfo.pdInfoId) {\r\n        this.findPdPayFrequency()\r\n        // this.findPdType()\r\n        this.insureRuleDefinitionList()\r\n        this.findCusConfigsData()\r\n        this.findProductList()\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n      showRule:function(){\r\n        if (this.showRule == false){\r\n          this.ruleConfigs=[];\r\n        }\r\n      },\r\n    ruleConfigs: function () {\r\n      if (this.ruleConfigs.length > 0) {\r\n        this.codeFilters = [];\r\n        this.ruleConfigs.forEach(val => {\r\n          this.codeFilters.push({\r\n            text: val.pdRuleCode,\r\n            value: val.pdRuleCode\r\n          });\r\n        });\r\n        this.codeFilters = this.codeFilters.reduce(function (prev, element) {\r\n          if (!prev.find(el => el.text == element.text)) {\r\n            prev.push(element);\r\n          }\r\n          return prev;\r\n        }, []);\r\n      }\r\n    },\r\n    'ageForm.pdRuleDef'() {\r\n      const val = this.ageForm.pdRuleDef;\r\n      if (val == '2') {\r\n        this.showAgeProductFlag = true\r\n      } else {\r\n        this.showAgeProductFlag = false;\r\n      }\r\n    },\r\n    'insuranceRuleForm.pdRuleGrade'() {\r\n      const val = this.insuranceRuleForm.pdRuleGrade;\r\n      if (val == '2') {\r\n        this.showRuleProductFlag = true;\r\n        this.insuranceRuleFormRule.pdGradeCode = [{required: true, message: \"请选择产品\", trigger: \"blur\"}]\r\n      } else {\r\n        this.showRuleProductFlag = false;\r\n        this.insuranceRuleFormRule.pdGradeCode = [{required: false}]\r\n      }\r\n    },\r\n    ageConfigs() {\r\n      //获取年龄角色顺序\r\n      getMaxAgeOrder(this.buildRequestData({\"pdInfoId\": this.pdPpInfo.id})).then(res => {\r\n        this.configAgeLength = res.data;\r\n        this.ageForm.pdRoleNo = res.data;\r\n      });\r\n    }\r\n  },\r\n  methods: {\r\n    changeRoleNo(val){\r\n      let maxNo = 0;\r\n      let flag = false;\r\n      this.ageConfigs.forEach(config=>{\r\n        if(config.pdRoleCode == val){\r\n          if(config.pdRuleDef == this.ageForm.pdRuleDef &&config.pdRuleDefCode == this.ageForm.pdDefCode){\r\n            if(config.pdRoleNo > maxNo){\r\n              flag = true;\r\n              maxNo = config.pdRoleNo\r\n            }\r\n          }\r\n          if(flag == true){\r\n            this.ageForm.pdRoleNo = maxNo + 1;\r\n          }\r\n        }\r\n      })\r\n    },\r\n    back() {\r\n      this.$router.push({name: '套餐校验规则订正主页'})\r\n    },\r\n    ruleModuleClosed() {\r\n      this.ruleVisible = false;\r\n      this.searchRules()\r\n    },\r\n    ruleMakeClosed() {\r\n      this.ruleView.visible = false;\r\n      this.radio2 = null\r\n    },\r\n    ruleViewClosed() {\r\n      this.radio2 = null\r\n    },\r\n    handleSearch() {\r\n      this.insureRuleDefinitionList();\r\n    },\r\n    insureRuleDefinitionList() {\r\n      insureRuleDefinitionList(this.buildRequestData({\"pdInfoId\": this.pdPpInfo.id})).then(res => {\r\n        this.ageConfigs = res.data\r\n      });\r\n    },\r\n    findProductByPackageId(val) {\r\n      if (val == null || val == \"\") {\r\n        this.appointProductOptions = [];\r\n        return\r\n      }\r\n      findProductList(this.buildRequestData({\"pdInfoId\": val})).then(res => {\r\n        let data = res.data;\r\n        this.appointProductOptions = [];\r\n        this.cusForm.product = '';\r\n        if (data.length) {\r\n          data.forEach(product => {\r\n            this.appointProductOptions.push({\r\n              value: product.pdCode,\r\n              label: product.pdCode + \":\" + product.pdName\r\n            });\r\n          });\r\n        }\r\n      });\r\n\r\n    },\r\n    findProductList() {\r\n      findProductList(this.buildRequestData({\"pdInfoId\": this.pdPpInfo.id})).then(res => {\r\n        let data = res.data;\r\n        this.productOptions = [];\r\n        if (data.length) {\r\n          data.forEach(val => {\r\n            this.productOptions.push({\r\n              value: val.pdCode,\r\n              label: val.pdCode + \":\" + val.pdName\r\n            });\r\n          });\r\n        }\r\n      });\r\n    },\r\n    findPdType() {\r\n      pdtempPdClsLabList(this.pdPpInfo.pdInfoId).then(response => {\r\n        for (let i = 0; i < response.data.length; i++) {\r\n          if (response.data[i].pdClsType == 1) {\r\n            this.pdType = response.data[i].pdCls1;\r\n            this.pdDetailType = response.data[i].pdCls2;\r\n          }\r\n        }\r\n      })\r\n\r\n    },\r\n    findPdPayFrequency() {\r\n      let data = {\r\n        pdCode: this.pdPpInfo.ppCode,\r\n        pdInfoId: this.pdPpInfo.pdInfoId\r\n      };\r\n      findPdPayFrequency(this.buildRequestData(data)).then(res => {\r\n        this.pdPayFreqOptions = [];\r\n        res.data.forEach(atrsInfo => {\r\n          this.pdPayFreqOptions.push({\r\n            value: atrsInfo.pdAtrsVal,\r\n            label: this.getCodeName(\"paymentFrequency\", atrsInfo.pdAtrsVal)\r\n          });\r\n        });\r\n      });\r\n    },\r\n    findCusConfigsData() {\r\n\r\n      findRulesList(this.buildRequestData({\"pdInfoId\": this.pdPpInfo.id, \"pdCode\": this.pdPpInfo.ppCode})).then(res => {\r\n        this.cusConfigs = res.data;\r\n      });\r\n    },\r\n    findRulesOptions() {\r\n      this.$refs[\"insuranceRuleForm\"].validate(valid => {\r\n        if (valid) {\r\n          this.showRule = true;\r\n          this.cusForm.package = this.pdPpInfo.id;\r\n          packageList().then(res => {\r\n            let data = res.data;\r\n            this.packageOptions = [];\r\n            if (data.length) {\r\n              data.forEach(val => {\r\n                this.packageOptions.push({\r\n                  value: val.id,\r\n                  label: val.ppCode + \":\" + val.ppName\r\n                });\r\n              });\r\n            }\r\n            this.findProductByPackageId(this.cusForm.package);\r\n            this.searchRules()\r\n          });\r\n\r\n        }\r\n      });\r\n      if (this.showRuleProductFlag) {\r\n        this.productCode = this.insuranceRuleForm.pdGradeCode\r\n      }\r\n    },\r\n    findRulesByParams(params) {\r\n      findRulesByParams(this.buildRequestData(params)).then(res => {\r\n        let data = res.data;\r\n        data = data.reduce(function (prev, element) {\r\n          if (!prev.find(el => el.pdRuleCode == element.pdRuleCode)) {\r\n            prev.push(element);\r\n          }\r\n          return prev;\r\n        }, []);\r\n        this.ruleConfigs = data;\r\n      });\r\n    },\r\n    refreshRuleConfigs() {\r\n      this.$refs[\"cusForm\"].resetFields();\r\n      this.searchRules()\r\n    },\r\n    addRules() {\r\n      const param = {\r\n        pdBussType: '7',\r\n        pdBussDetailType: '9'\r\n      };\r\n      let pdCode = '';\r\n      if (this.showRuleProductFlag) {\r\n        pdCode = this.productCode\r\n      } else {\r\n        pdCode = this.pdPpInfo.ppCode\r\n      }\r\n      getRuleCode(this.buildRequestData(param)).then(response => {\r\n        this.attributeObj = {\r\n          code: response.data,\r\n          ruleBussModu: '7',\r\n          ruleBussModuDeta: '9',\r\n          ruleType: '1',\r\n          ruleAttr: '3',\r\n          pdType: '2',\r\n          pdCode: pdCode,\r\n          pdEdition: '1'\r\n        };\r\n        if (this.insuranceRuleForm.pdRuleGrade == '2') {\r\n          this.attributeObj.ruleType = '1',\r\n            this.attributeObj.pdType = '1',\r\n            this.attributeObj.ruleAttr = '2',\r\n            this.attributeObj.pdCode = this.insuranceRuleForm.pdGradeCode,\r\n            this.attributeObj.riskType = this.pdType,\r\n            this.attributeObj.riskDetail = this.pdDetailType\r\n        }\r\n        this.ruleVisible = true\r\n      })\r\n    },\r\n    showRules(code) {\r\n      this.ruleView.flag = '1';\r\n      this.ruleView.ruleCode = code;\r\n      this.ruleView.ruleQuery = true;\r\n      this.ruleView.updateDynamicTable = false;\r\n      this.ruleView.visible = true\r\n    },\r\n    searchRules() {\r\n      let params ={};\r\n      if(this.insuranceRuleForm.pdRuleGrade==='2'){\r\n        if(!this.cusForm.product){\r\n          params = {\r\n            pdInfoId: this.pdPpInfo.id,\r\n            packageId: this.cusForm.package,\r\n            pdCode: this.productCode,\r\n            pdRuleCode: this.cusForm.ruleCode\r\n          };\r\n        }else{\r\n          params= {\r\n            pdInfoId: this.pdPpInfo.id,\r\n            packageId: this.cusForm.package,\r\n            pdCode: this.cusForm.product,\r\n            pdRuleCode: this.cusForm.ruleCode\r\n          };\r\n        }\r\n      }else {\r\n        params={\r\n          pdInfoId: this.pdPpInfo.id,\r\n          packageId: this.cusForm.package,\r\n          pdCode: this.cusForm.product,\r\n          pdRuleCode: this.cusForm.ruleCode\r\n        };\r\n      }\r\n      findRulesByParams(this.buildRequestData(params)).then(res => {\r\n        let data = res.data;\r\n        data = data.reduce(function (prev, element) {\r\n          if (!prev.find(el => el.pdRuleCode == element.pdRuleCode)) {\r\n            prev.push(element);\r\n          }\r\n          return prev;\r\n        }, []);\r\n        this.ruleConfigs = data;\r\n      })\r\n    },\r\n    connRules() {\r\n      if (this.chooseRules.length === 0) {\r\n        this.notifyError('请选择规则');\r\n        return\r\n      }\r\n      let pdtempPdRulesList = [];\r\n      this.chooseRules.forEach(rule => {\r\n        let pdtempPdRules = {\r\n          pdVerId: 1,\r\n          pdInfoId: this.pdPpInfo.id,\r\n          pdCode: rule.pdCode,\r\n          pdType: this.insuranceRuleForm.pdRuleGrade,\r\n          pdRuleGrade: rule.pdRuleGrade,\r\n          pdRuleCls: rule.pdRuleCls,\r\n          pdRuleDtCls: rule.pdRuleDtCls,\r\n          pdRulePropCls: rule.pdRulePropCls,\r\n          pdRulePropDtCls: rule.pdRulePropDtCls,\r\n          pdRuleCode: rule.pdRuleCode,\r\n          pdRuleDesc: rule.pdRuleDesc\r\n        };\r\n        if (this.insuranceRuleForm.pdRuleGrade == '2') {\r\n          pdtempPdRules.pdPackageCode = this.insuranceRuleForm.pdGradeCode\r\n        } else {\r\n          pdtempPdRules.pdPackageCode = this.pdPpInfo.ppCode\r\n        }\r\n        pdtempPdRulesList.push(pdtempPdRules);\r\n      });\r\n      let pdCode;\r\n      if (this.showRuleProductFlag) {\r\n        pdCode = this.productCode\r\n      } else {\r\n        pdCode = this.pdPpInfo.ppCode\r\n      }\r\n      const param = {\r\n        rules: pdtempPdRulesList,\r\n        pdtempPpInfo: this.pdPpInfo,\r\n        pdCode: pdCode,\r\n        pdBussType: '7',\r\n        pdBussDetailType: '9'\r\n      };\r\n      connRules(this.buildRequestData(param)).then(res => {\r\n        this.notifySuccess(res.message);\r\n        this.findCusConfigsData();\r\n        this.searchRules();\r\n      })\r\n    },\r\n    cleanAgeForm() {\r\n      this.$refs[\"ageForm\"].resetFields();\r\n      this.ageForm.pdMaxAppAgeUnit = \"A\";\r\n      this.ageForm.pdMinAppAgeUnit = \"A\";\r\n      this.ageForm.pdInsuPeriodUnit = \"Y\";\r\n      this.ageForm.pdPayPeriodUnit = \"Y\";\r\n      this.ageForm.pdRoleNo = this.configAgeLength;\r\n      this.radio1 = null;\r\n      this.$refs.ageTable.setCurrentRow()\r\n    },\r\n    saveAgeForm() {\r\n      let PdtempPdInsuAgeInfo = {\r\n        pdVerId: '1',\r\n        operator: this.pdPpInfo.operator,\r\n        pdType: '2',\r\n        pdInfoId: this.pdPpInfo.id,\r\n        pdCode: this.pdPpInfo.ppCode,\r\n        pdRuleDef: this.ageForm.pdRuleDef,\r\n        pdRoleCode: this.ageForm.pdRoleCode,\r\n        pdRoleNo: this.ageForm.pdRoleNo,\r\n        pdRoleSex: this.ageForm.pdRoleSex,\r\n        pdInsuPeriod: this.ageForm.pdInsuPeriod,\r\n        pdInsuPeriodUnit: this.ageForm.pdInsuPeriodUnit,\r\n        pdPayPeriod: this.ageForm.pdPayPeriod,\r\n        pdPayPeriodUnit: this.ageForm.pdPayPeriodUnit,\r\n        pdPayFreq: this.ageForm.pdPayFreq,\r\n        pdMaxAppAge: this.ageForm.pdMaxAppAge,\r\n        pdMaxAppAgeUnit: this.ageForm.pdMaxAppAgeUnit,\r\n        pdMinAppAge: this.ageForm.pdMinAppAge,\r\n        pdMinAppAgeUnit: this.ageForm.pdMinAppAgeUnit\r\n      };\r\n      //移除校验\r\n      if (this.ageForm.pdRuleDef == '3') {\r\n        this.rules.pdDefCode = [{required: false}];\r\n        PdtempPdInsuAgeInfo.pdRuleDefCode = this.pdPpInfo.ppCode\r\n      } else {\r\n        PdtempPdInsuAgeInfo.pdRuleDefCode = this.ageForm.pdDefCode\r\n      }\r\n      this.$refs[\"ageForm\"].validate(valid => {\r\n        if (valid) {\r\n          addPdtempPdInsuAgeInfo(PdtempPdInsuAgeInfo).then(res => {\r\n            if (res.code == 200) {\r\n              this.notifySuccess(res.message);\r\n              this.cleanAgeForm();\r\n              this.handleSearch();\r\n            }\r\n          });\r\n        }\r\n      });\r\n    },\r\n    updateAgeForm() {\r\n      let PdtempPdInsuAgeInfo = {\r\n        id: this.radio1,\r\n        pdVerId: '1',\r\n        operator: this.pdPpInfo.operator,\r\n        pdType: '2',\r\n        pdInfoId: this.pdPpInfo.id,\r\n        pdCode: this.pdPpInfo.ppCode,\r\n        pdRuleDef: this.ageForm.pdRuleDef,\r\n        pdRoleCode: this.ageForm.pdRoleCode,\r\n        pdRoleNo: this.ageForm.pdRoleNo,\r\n        pdRoleSex: this.ageForm.pdRoleSex,\r\n        pdInsuPeriod: this.ageForm.pdInsuPeriod,\r\n        pdInsuPeriodUnit: this.ageForm.pdInsuPeriodUnit,\r\n        pdPayPeriod: this.ageForm.pdPayPeriod,\r\n        pdPayPeriodUnit: this.ageForm.pdPayPeriodUnit,\r\n        pdPayFreq: this.ageForm.pdPayFreq,\r\n        pdMaxAppAge: this.ageForm.pdMaxAppAge,\r\n        pdMaxAppAgeUnit: this.ageForm.pdMaxAppAgeUnit,\r\n        pdMinAppAge: this.ageForm.pdMinAppAge,\r\n        pdMinAppAgeUnit: this.ageForm.pdMinAppAgeUnit\r\n      };\r\n      //移除校验\r\n      if (this.ageForm.pdRuleDef == '3') {\r\n        this.rules.pdDefCode = [{required: false}];\r\n        PdtempPdInsuAgeInfo.pdRuleDefCode = this.pdPpInfo.ppCode\r\n      } else {\r\n        PdtempPdInsuAgeInfo.pdRuleDefCode = this.ageForm.pdDefCode\r\n      }\r\n      this.$refs[\"ageForm\"].validate(valid => {\r\n        if (valid) {\r\n          updatePdtempPdInsuAgeInfo(this.buildRequestData({\"pdtempPdInsuAgeInfo\": PdtempPdInsuAgeInfo})).then(res => {\r\n            if (res.code == 200) {\r\n              this.notifySuccess(res.message);\r\n              this.cleanAgeForm();\r\n              this.handleSearch();\r\n            }\r\n          });\r\n        }\r\n      });\r\n    },\r\n    delRoleRow(row) {\r\n      this.$confirm('是否确认删除', '警告', {\r\n        distinguishCancelAndClose: true,\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消'\r\n      }).then(() => {\r\n        deletePdtempPdInsuAgeInfo(row.id).then(res => {\r\n          if (res.code == 200) {\r\n            this.notifySuccess(res.message);\r\n            this.handleSearch();\r\n          }\r\n        });\r\n      }).catch(() => {\r\n\r\n      })\r\n    },\r\n    delCusRow(row) {\r\n      deleteRules(row.id).then(res => {\r\n        if (res.code == 200) {\r\n          this.notifySuccess(res.message);\r\n          this.findCusConfigsData();\r\n        }\r\n      });\r\n    },\r\n    filterHandler(value, row, column) {\r\n      if (column) {\r\n        const property = column[\"property\"];\r\n        return row[property] === value;\r\n      }\r\n    },\r\n    chooseOne1(row, column, event) {\r\n      if (event.target.nodeName == \"INPUT\") {\r\n        if (row.id == this.radio1) {\r\n          this.radio1 = null;\r\n          this.cleanAgeForm();\r\n        } else {\r\n          this.radio1 = row.id;\r\n          //获取行数据\r\n          this.ageForm.pdRuleDef = row.pdRuleDef;\r\n          if (row.pdRuleDef == '2') {\r\n            this.ageForm.pdDefCode = row.pdRuleDefCode\r\n          } else {\r\n            this.ageForm.pdDefCode = ''\r\n          }\r\n          this.ageForm.pdRoleCode = row.pdRoleCode;\r\n          this.ageForm.pdRoleNo = row.pdRoleNo;\r\n          this.ageForm.pdRoleSex = row.pdRoleSex;\r\n          this.ageForm.pdInsuPeriod = row.pdInsuPeriod;\r\n          this.ageForm.pdInsuPeriodUnit = row.pdInsuPeriodUnit;\r\n          this.ageForm.pdPayPeriod = row.pdPayPeriod;\r\n          this.ageForm.pdPayPeriodUnit = row.pdPayPeriodUnit;\r\n          this.ageForm.pdMaxAppAge = row.pdMaxAppAge;\r\n          this.ageForm.pdMaxAppAgeUnit = row.pdMaxAppAgeUnit;\r\n          this.ageForm.pdMinAppAge = row.pdMinAppAge;\r\n          this.ageForm.pdMinAppAgeUnit = row.pdMinAppAgeUnit\r\n        }\r\n      }\r\n    },\r\n    chooseOne2(row, column, event) {\r\n      if (event.target.nodeName == \"INPUT\") {\r\n        if (row.id == this.radio2) {\r\n          this.radio2 = null\r\n          this.$refs.cusTable.setCurrentRow()\r\n        } else {\r\n          this.radio2 = row.id;\r\n          this.ruleView.flag = '2';\r\n          this.ruleView.ruleCode = row.pdRuleCode;\r\n          this.ruleView.ruleQuery = false;\r\n          this.ruleView.updateDynamicTable = true;\r\n          this.ruleView.visible = true\r\n        }\r\n      }\r\n    },\r\n    handleSelectionChange(row) {\r\n      this.chooseRules = row;\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.showDiv {\r\n  width: 100%;\r\n  height: 100%;\r\n  margin-top: -40px;\r\n  margin-left: -40px;\r\n  position: absolute;\r\n  background: #ffffff00;\r\n  z-index: 999;\r\n}\r\n\r\n.cst {\r\n  width: 15%;\r\n  margin-right: -5px;\r\n  border: 0;\r\n}\r\n\r\nhr {\r\n  margin-top: 7px;\r\n  *margin: 0;\r\n  border: 0;\r\n  color: black;\r\n  background-color: black;\r\n  height: 2px;\r\n}\r\n\r\n.divider {\r\n  color: black;\r\n  background-color: black;\r\n  width: 1px;\r\n}\r\n</style>\r\n"]}]}