{"remainingRequest":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\product-definition\\pd-framework-def\\pd-structure-def\\payment-def\\index.vue?vue&type=style&index=0&id=ea0c719c&lang=scss&scoped=true&","dependencies":[{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\product-definition\\pd-framework-def\\pd-structure-def\\payment-def\\index.vue","mtime":1618544604557},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\css-loader\\dist\\cjs.js","mtime":1706753188288},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1706753191924},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\postcss-loader\\src\\index.js","mtime":1706753189537},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1706753187424},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1706753190941}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQoNCi5pbnB1dC13aXRoLXNlbGVjdCAuZWwtaW5wdXQtZ3JvdXBfX2FwcGVuZCB7DQogIGJhY2tncm91bmQtY29sb3I6ICNmZmY7DQp9DQoNCg0KDQouaXNfZml4ZWRfc2lkZWJhckNsb3NlZCB7DQogIHBvc2l0aW9uOiBmaXhlZDsNCiAgdG9wOiAwOw0KICB6LWluZGV4OiA5ODsNCiAgYmFja2dyb3VuZDogI2ViZWJlYjsNCiAgd2lkdGg6IDgxJTsNCiAgcGFkZGluZzogMTBweDsNCn0NCg0KLmlzX2ZpeGVkX3NpZGViYXJPcGVuZWQgew0KICBwb3NpdGlvbjogZml4ZWQ7DQogIHRvcDogMDsNCiAgei1pbmRleDogOTg7DQogIGJhY2tncm91bmQ6ICNlYmViZWI7DQogIHBhZGRpbmc6IDEwcHg7DQogIHdpZHRoOiA3NCU7DQp9DQoNCi5zaG93RGl2IHsNCiAgd2lkdGg6IDkwJTsNCiAgaGVpZ2h0OiAxMDAlOw0KICBtYXJnaW4tdG9wOiAtNDBweDsNCiAgbWFyZ2luLWxlZnQ6IC00MHB4Ow0KICBwb3NpdGlvbjogYWJzb2x1dGU7DQogIGJhY2tncm91bmQ6ICNmZmZmZmYwMDsNCiAgei1pbmRleDogOTk5Ow0KfQ0KDQouZm9ybXRpdGxlMiB7DQogIHBhZGRpbmctdG9wOiAxMHB4Ow0KICBmb250LXNpemU6IDIwcHg7DQogIGZvbnQtd2VpZ2h0OiBib2xkOw0KfQ0KDQouZGl2aWRlciB7DQogIGJhY2tncm91bmQtY29sb3I6IGJsYWNrOw0KICBtYXJnaW4tbGVmdDogNHB4Ow0KfQ0KDQoucGF5Rm9ybXsNCiAgLmVsLWZvcm0taXRlbSB7DQogICAgbWFyZ2luLWJvdHRvbTogMHB4Ow0KICB9DQp9DQoNCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA61FA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/product-definition/pd-framework-def/pd-structure-def/payment-def","sourcesContent":["<template>\r\n  <cus-wraper>\r\n    <div v-show=\"!productCalcRevisionShowINfo\">\r\n      <div :class=\"{ 'showDiv': this.showPageFlag == 1 }\"></div>\r\n      <cus-page-title :label=\"$t('pay_def.payment_database')\">\r\n        <guide id=\"guide\" v-if=\"!premiumCode\" />\r\n      </cus-page-title>\r\n      <!-- 产品信息 -->\r\n      <cus-product-info></cus-product-info>\r\n      <!-- 快捷定义 -->\r\n      <div>\r\n        <cus-condition :disabled=\"!!premiumCode\" :label=\"$t('pay_def.quick_def')\" @show=\"quickshow = !quickshow\"></cus-condition>\r\n      </div>\r\n      <div v-if=\"quickshow\" >\r\n        <cus-form-title :first=\"true\" :label=\"$t('pay_def.paymentquickdef')\"></cus-form-title>\r\n        <el-form ref=\"form_quick\" :model=\"params\" :rules=\"rules_quick\" label-width=\"auto\">\r\n          <el-row :gutter=\"10\">\r\n            <el-col :span=\"6\">\r\n              <el-form-item :label=\"$t('pay_def.finelinesRegion')\" prop=\"finelinesRegion\">\r\n                <cus-select v-model=\"params.finelinesRegion\" @change=\"selectedDetailTypeChanged\"\r\n                            :codetype=\"'ProductCategory'\"></cus-select>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"6\">\r\n              <el-form-item :label=\"$t('pay_def.referenceProduct')\" prop=\"eq_pdInfoId\">\r\n                <el-select v-model=\"params.eq_pdInfoId\"\r\n                           :placeholder=\"$t('pay_def.message.typeRegion_finelinesRegion_first')\" clearable filterable>\r\n                  <el-option v-for=\"product in productList\" :label=\"product.pdCode + ':' + product.pdName\"\r\n                             :value=\"product.id\"></el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col  :span=\"6\">\r\n              <el-button  size=\"small\" v-if=\"!premiumCode\"  icon=\"el-icon-search\" style=\"margin-left: 5px\" dialog-disable=\"disable\"\r\n                         type=\"primary\"\r\n                         @click=\"handleSearchInAllPremium\">\r\n                {{ $t('table.search') }}\r\n              </el-button>\r\n            </el-col>\r\n          </el-row>\r\n          <el-row :gutter=\"10\" class=\"row-bg\" justify=\"center\" type=\"flex\">\r\n\r\n          </el-row>\r\n        </el-form>\r\n        <cus-table-title :label=\"$t('pay_def.def_list')\"></cus-table-title>\r\n        <el-table v-if=\"!isFixed || isFixed && pageFlag.tableVisible_def\" :data=\"quickTableData\" border\r\n                  element-loading-text=\"Loading\" fit\r\n                  highlight-current-row size=\"mini\" @row-click=\"rowClick_quick\">\r\n\r\n          <el-table-column :label=\"$t('table.id')\" align=\"center\" type=\"index\"></el-table-column>\r\n          <el-table-column :label=\"$t('table.detail')\" type=\"expand\">\r\n            <template slot-scope=\"props\">\r\n              <el-form class=\"demo-table-expand\" inline label-position=\"left\">\r\n                <el-form-item :label=\"$t('pay_def.pay_calc_method')\">\r\n                  <span>{{ props.row.pdPremCalMode | filter_calcMethod }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_zero')\">\r\n                  <span>{{ props.row.pdPremZeroFlag | filter_payZero }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('i18nView.pay_start_interval')\">\r\n                  <!-- <span>{{ props.row.pdPayStartPeriod }}{{ props.row.pdPayStartPerUnit | filter_dateSuffix }}</span> -->\r\n                  <span>{{ props.row.pdtempPdPremPeriodList|filter_pdPayStartPeriod}}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_start_calc_basis')\">\r\n                  <span>{{ props.row.pdPayStartCalRule | filter_startCalcRule }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_start_calc_valuetypes')\">\r\n                  <span>{{ props.row.pdPayStartCalMode | filter_startCalcMethod }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('i18nView.payTerm')\">\r\n                  <!-- <span>{{ props.row.pdPayEndPeriod }}{{ props.row.pdPayEndUnit | filter_dateSuffix }}</span> -->\r\n                  <span>{{ props.row.pdtempPdPremPeriodList|filter_pdPayEndPeriod}}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_end_calc_basis')\">\r\n                  <span>{{ props.row.pdPayEndCalRule | filter_endCalcRule }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_end_calc_method')\">\r\n                  <span>{{ props.row.pdPayEndCalMode | filter_endCalcMethod }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_calc_formula_code')\">\r\n                  <span>{{ props.row.pdPremCalcCode }}</span>\r\n                </el-form-item>\r\n              </el-form>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('i18nView.pdCode')\" align=\"center\" prop=\"pdCode\"></el-table-column>\r\n          <el-table-column :label=\"$t('i18nView.pdName')\" align=\"center\" prop=\"pdName\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_code')\" align=\"center\" prop=\"pdPremCode\" sortable :filters=\"quickfilterHandlerList0\"\r\n                           :filter-method=\"filterHandler\" ></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_name')\" align=\"center\" prop=\"pdPayName\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_calc_method')\" align=\"center\" prop=\"pdPremCalMode\">\r\n            <template v-slot=\"scope\">{{ scope.row.pdPremCalMode | filter_calcMethod }}</template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_prem_changeFlag')\" align=\"center\"  :filters=\"quickfilterHandlerList1\"\r\n                           :filter-method=\"filterHandler\"\r\n                           prop=\"pdRateChangeFlag\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pd_prem_acc_relaFlag')\" align=\"center\"  :filters=\"quickfilterHandlerList2\"\r\n                           :filter-method=\"filterHandler\"\r\n                           prop=\"pdPremAccRela\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.extra_payFlag')\" align=\"center\" prop=\"pdPremAddFlag\"  :filters=\"quickfilterHandlerList3\"\r\n                           :filter-method=\"filterHandler\" ></el-table-column>\r\n\r\n          <el-table-column v-if=\"!premiumCode\" :label=\"$t('pdtempPdInsuAgeInfo.operation')\" align=\"center\" width=\"150px\">\r\n            <template slot-scope=\"scope\">\r\n              <el-button  size=\"small\" v-auth=\"'pdtemp-pd-prem:copyPremium'\" type=\"primary\"\r\n                         @click=\"copyPremiumToCurrentProduct(scope.row)\"><i\r\n                class=\"el-icon-document-copy\"></i>{{ $t('pay_def.copyPremium') }}\r\n              </el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n        <!-- 分页 -->\r\n        <cus-pagination ref=\"page_quick\" v-model=\"quickTableData\"  :pageSize=\"5\"\r\n                        :params=\"params\" url=\"/pdtemp-pd-prem/base/quickQuery\"/>\r\n      </div>\r\n      <!-- 缴费定义表格 -->\r\n      <cus-table-title :label=\"$t('pay_def.pay_premium')\"></cus-table-title>\r\n      <div id=\"table_def\" :class=\"fixedClassName\">\r\n        <div style=\"text-align: center\">\r\n          <div>\r\n            <cus-form-title v-if=\"isFixed\" style=\"float: left\" :label=\"$t('pay_def.pay_premium')\" :showArrow=\"true\" :display=\"true\" @show=\"pageFlag.tableVisible_def =! pageFlag.tableVisible_def\" >\r\n\r\n            </cus-form-title>\r\n<!--            <el-button   v-if=\"isFixed\" size=\"mini\" style=\"float: right\" @click=\"pageFlag.tableVisible_def =! pageFlag.tableVisible_def\">-->\r\n<!--              {{ $t('pay_def.display_or_not') }}-->\r\n<!--            </el-button>-->\r\n          </div>\r\n        </div>\r\n        <el-table v-show=\"!isFixed || isFixed && pageFlag.tableVisible_def\" ref=\"defTableData\" :data=\"defTableData\" border\r\n                  element-loading-text=\"Loading\"\r\n                  fit highlight-current-row size=\"mini\"\r\n                  @row-click=\"rowClick_def\">\r\n          <el-table-column :label=\"$t('table.select')\" align=\"center\" width=\"60px\">\r\n            <template slot-scope=\"scope\">\r\n              <el-radio-group v-model=\"selectedDef\" @change=\"selectedDefChanged\">\r\n                <el-radio :label=\"scope.row\">{{ '' }}</el-radio>\r\n              </el-radio-group>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('table.detail')\" type=\"expand\">\r\n            <template slot-scope=\"props\">\r\n              <el-form class=\"demo-table-expand\" inline label-position=\"left\">\r\n                <el-form-item :label=\"$t('pay_def.pay_calc_method')\">\r\n                  <span>{{ props.row.pdPremCalMode | filter_calcMethod }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_zero')\">\r\n                  <span>{{ props.row.pdPremZeroFlag | filter_payZero }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('i18nView.pay_start_interval')\">\r\n                  <!-- <span>{{ props.row.pdPayStartPeriod }}{{ props.row.pdPayStartPerUnit | filter_dateSuffix }}</span> -->\r\n                  <span>{{ props.row.pdtempPdPremPeriodList|filter_pdPayStartPeriod}}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_start_calc_basis')\">\r\n                  <span>{{ props.row.pdPayStartCalRule | filter_startCalcRule }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_start_calc_valuetypes')\">\r\n                  <span>{{ props.row.pdPayStartCalMode | filter_startCalcMethod }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('i18nView.payTerm')\">\r\n                  <!-- <span>{{ props.row.pdPayEndPeriod }}{{ props.row.pdPayEndUnit | filter_dateSuffix }}</span> -->\r\n                  <span>{{ props.row.pdtempPdPremPeriodList|filter_pdPayEndPeriod}}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_end_calc_basis')\">\r\n                  <span>{{ props.row.pdPayEndCalRule | filter_endCalcRule }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_end_calc_method')\">\r\n                  <span>{{ props.row.pdPayEndCalMode | filter_endCalcMethod }}</span>\r\n                </el-form-item>\r\n                <el-form-item :label=\"$t('pay_def.pay_calc_formula_code')\">\r\n                  <span>{{ props.row.pdPremCalcCode }}</span>\r\n                </el-form-item>\r\n              </el-form>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('table.id')\" align=\"center\" width=\"50\">\r\n            <template v-slot=\"scope\">\r\n              {{ initTableIndex('page_def', scope.$index) }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_code')\" align=\"center\" prop=\"pdPremCode\" sortable :filters=\"filterHandlerList0\"\r\n                           :filter-method=\"filterHandler\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_name')\" align=\"center\" prop=\"pdPayName\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_prem_changeFlag')\" align=\"center\" :filters=\"filterHandlerList1\"\r\n                           :filter-method=\"filterHandler\"\r\n                           prop=\"pdRateChangeFlag\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pd_prem_acc_relaFlag')\" align=\"center\"  :filters=\"filterHandlerList2\"\r\n                           :filter-method=\"filterHandler\"\r\n                           prop=\"pdPremAccRela\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.operation')\" v-if=\"!premiumCode\" align=\"center\" width=\"100px\">\r\n            <template slot-scope=\"scope\">\r\n              <cus-del-btn v-auth=\"'pdtemp-pd-prem:delete'\" :disabled=\"!!premiumCode\"\r\n                           @ok=\"handleDeleteDef(scope.row)\"></cus-del-btn>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </div>\r\n      <!-- 分页 -->\r\n      <cus-pagination ref=\"page_def\" v-model=\"defTableData\" :autoBuild=\"false\" :pageSize=\"10\"\r\n                      :params=\"params_currentProduct\" url=\"/pdtemp-pd-prem/base/list\"/>\r\n      <!-- 缴费定义表单 -->\r\n      <cus-form-title :first=\"true\" :label=\"$t('pay_def.pay_def')\"></cus-form-title>\r\n      <div>\r\n        <el-form id=\"paymentBase\" ref=\"form_def\" :disabled=\"!!premiumCode\"  :model=\"form_def\" :rules=\"rules\"\r\n                  label-width=\"auto\">\r\n          <cus-row>\r\n            <cus-col :span=\"12\">\r\n              <el-form-item :label=\"$t('pay_def.pay_name')\" prop=\"pdPayName\">\r\n                <el-input v-model=\"form_def.pdPayName\" maxlength=\"60\" show-word-limit ></el-input>\r\n              </el-form-item>\r\n            </cus-col>\r\n            <cus-col >\r\n              <el-form-item :label=\"$t('pay_def.pay_calc_method')\" prop=\"pdPremCalMode\">\r\n                <cus-select v-model=\"form_def.pdPremCalMode\" :codetype=\"'pd_prem_cal_method'\"></cus-select>\r\n              </el-form-item>\r\n            </cus-col>\r\n          </cus-row>\r\n          <cus-row >\r\n            <cus-col>\r\n              <el-form-item :label=\"$t('pay_def.pd_prem_acc_rela')\">\r\n                <el-switch v-model=\"form_def.pdPremAccRela\" active-value=\"Y\" inactive-value=\"N\"></el-switch>\r\n              </el-form-item>\r\n            </cus-col>\r\n            <cus-col >\r\n              <el-form-item :label=\"$t('pay_def.pay_zero')\">\r\n                <el-switch v-model=\"form_def.pdPremZeroFlag\" active-value=\"Y\" inactive-value=\"N\"></el-switch>\r\n              </el-form-item>\r\n            </cus-col>\r\n            <cus-col >\r\n              <el-form-item :label=\"$t('pay_def.pay_prem_change')\">\r\n                <el-switch v-model=\"form_def.pdRateChangeFlag\" active-value=\"Y\" inactive-value=\"N\"></el-switch>\r\n              </el-form-item>\r\n            </cus-col>\r\n\r\n\r\n            <div v-if=\"false\">\r\n            <cus-col >\r\n              <el-form-item :label=\"$t('pay_def.extra_pay')\">\r\n                <el-switch v-model=\"form_def.pdPremAddFlag\" active-value=\"Y\" inactive-value=\"N\"></el-switch>\r\n              </el-form-item>\r\n            </cus-col>\r\n            </div>\r\n          </cus-row>\r\n          <el-form id=\"paymentBase1\" ref=\"product_extra\" :model=\"product_extra\" :rules=\"rules1\"\r\n                   label-width=\"auto\">\r\n            <cus-row>\r\n              <cus-col :span=\"24\">\r\n                <el-form-item :label=\"$t('pay_def.pay_frequency')\" prop=\"pdPayFreq\">\r\n                  <cus-checkbox v-model=\"product_extra.pdPayFreq\" :codetype=\"'paymentFrequency'\"\r\n                  ></cus-checkbox>\r\n                </el-form-item>\r\n              </cus-col>\r\n              <!--            缴费期间取值类型-->\r\n            </cus-row>\r\n          </el-form>\r\n          <cus-form-title :first=\"true\" :label=\"$t('pay_def.pay_def_time')\"></cus-form-title>\r\n          <cus-table-title :label=\"$t('i18nView.payTerm')\"></cus-table-title>\r\n          <el-form ref=\"ruleForm1\" :model=\"payDateForm\" :rules=\"rules\" class=\"payForm\">\r\n          <el-table ref=\"payDateTable\" :data=\"payDateForm.payDateTable\" align=\"center\" border class=\"wraper-table\" fit highlight-current-row>\r\n            <el-table-column :label=\"$t('table.id')\" align=\"center\" type=\"index\" width=\"80px\"></el-table-column>\r\n            <el-table-column :label=\"$t('i18nView.payTerm')\" align=\"center\" prop=\"pdPayEndPeriod\" >\r\n              <template slot-scope=\"scope\">\r\n                <el-form-item :prop=\"'payDateTable.' + scope.$index + '.pdPayEndPeriod'\" :rules='rules.pdPayEndPeriod'>\r\n                  <el-input v-model.number=\"scope.row.pdPayEndPeriod\" :placeholder=\"$t('i18nView.placeholderNum')\"  type=\"number\"></el-input>\r\n                </el-form-item>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column :label=\"$t('i18nView.pay_date_unit')\" align=\"center\" prop=\"pdPayEndUnit\" >\r\n              <template slot-scope=\"scope\">\r\n                <cus-select v-model=\"scope.row.pdPayEndUnit\" :codetype=\"'pdsbnftdy'\"></cus-select>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column :label=\"$t('i18nView.pay_start_interval')\" align=\"center\"prop=\"pdPayStartPeriod\" >\r\n              <template slot-scope=\"scope\">\r\n                <el-form-item :prop=\"'payDateTable.' + scope.$index + '.pdPayStartPeriod'\" :rules='rules.pdPayEndPeriod'>\r\n                  <el-input v-model.number=\"scope.row.pdPayStartPeriod\" :placeholder=\"$t('i18nView.placeholderNum')\"  type=\"number\"></el-input>\r\n                </el-form-item>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column :label=\"$t('i18nView.pay_start_interval_unit')\" align=\"center\" prop=\"pdPayStartPerUnit\" >\r\n              <template slot-scope=\"scope\">\r\n                <cus-select v-model=\"scope.row.pdPayStartPerUnit\" :codetype=\"'pdsbnftdy'\"></cus-select>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column :label=\"$t('pay_def.operation')\" v-if=\"!premiumCode\" align=\"center\" width=\"100px\">\r\n              <template slot-scope=\"scope\">\r\n                <cus-popover @confirm=\"delPayRow(scope.$index, scope.row)\"  icon=\"el-icon-minus\" style=\"margin-right: 5px;margin-left: 5px\" type=\"danger\"  :content=\"$t('confirmMessage.delete')\">\r\n                </cus-popover>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n          </el-form>\r\n          <el-row>\r\n            <el-button v-if=\"!premiumCode\" size=\"mini\" type=\"primary\" icon=\"el-icon-plus\" @click=\"addPayRow\" dialog-disable=\"disable\"></el-button>\r\n          </el-row>\r\n          <!-- <el-row>\r\n            <el-col :span=\"7\">\r\n              <el-form-item :label=\"$t('pay_def.pay_calc_method')\" prop=\"pdPremCalMode\">\r\n                <cus-select v-model=\"form_def.pdPremCalMode\" :codetype=\"'pd_prem_cal_method'\"></cus-select>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"8\">\r\n              <el-form-item :label=\"$t('pay_def.pay_date')\" prop=\"pdPayEndPeriod\">\r\n                <el-input v-model=\"form_def.pdPayEndPeriod\" placeholder=\"请输入数字\"  type=\"number\">\r\n                  <cus-select slot=\"append\" v-model=\"form_def.pdPayEndUnit\" :codetype=\"'pdsbnftdy'\"\r\n                              class=\"cst\"></cus-select>\r\n                </el-input>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"8\">\r\n              <el-form-item :label=\"$t('pay_def.pay_start_interval')\" prop=\"pdPayStartPeriod\">\r\n                <el-input v-model=\"form_def.pdPayStartPeriod\" placeholder=\"请输入数字\"  type=\"number\">\r\n                  <cus-select slot=\"append\" v-model=\"form_def.pdPayStartPerUnit\" :codetype=\"'pdsbnftdy'\"\r\n                              class=\"cst\"></cus-select>\r\n                </el-input>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row> -->\r\n\r\n\r\n          <el-row>\r\n            <el-col :span=\"8\" style=\"white-space: nowrap;\" >\r\n              <el-form-item :label=\"$t('pay_def.pay_start_calc_basis')\">\r\n                <cus-radio v-model=\"form_def.pdPayStartCalRule\" :codetype=\"'pd_prem_start_calc_rule'\"></cus-radio>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n          <cus-col :span=\"24\">\r\n            <el-form-item :label=\"$t('pay_def.pay_date_value')\" >\r\n                <cus-radio v-model=\"form_def.pdPayDateValue\" :codetype=\"'pdPayEndCalMode'\"></cus-radio>\r\n            </el-form-item>\r\n          </cus-col>\r\n          <cus-row>\r\n\r\n          </cus-row>\r\n          <div v-if=\"false\">\r\n            <el-row>\r\n              <cus-col >\r\n                <el-form-item :label=\"$t('pay_def.pay_start_menu')\">\r\n                  <el-switch v-model=\"form_def.pdPremStartFlag\" active-value=\"Y\" inactive-value=\"N\"></el-switch>\r\n                </el-form-item>\r\n              </cus-col>\r\n            </el-row>\r\n          </div>\r\n              <el-row>\r\n                <el-col :span=\"8\" style=\"white-space: nowrap;\" >\r\n                  <el-form-item :label=\"$t('pay_def.pay_start_calc_valuetypes')\">\r\n                    <cus-radio v-model=\"form_def.pdPayStartCalMode\" :codetype=\"'pd_prem_start_calc_method'\"></cus-radio>\r\n                  </el-form-item>\r\n                </el-col>\r\n              </el-row>\r\n            <cus-row>\r\n              <el-col :span=\"8\" style=\"white-space: nowrap;\" >\r\n                <el-form-item :label=\"$t('pay_def.pay_end_calc_basis')\">\r\n                  <cus-radio v-model=\"form_def.pdPayEndCalRule\" :codetype=\"'pd_prem_end_calc_rule'\"></cus-radio>\r\n                </el-form-item>\r\n              </el-col>\r\n            </cus-row>\r\n            <cus-row>\r\n              <el-col :span=\"8\" style=\"white-space: nowrap;\" >\r\n                <el-form-item :label=\"$t('pay_def.pay_end_calc_method')\">\r\n                  <cus-radio v-model=\"form_def.pdPayEndCalMode\" :codetype=\"'pd_prem_end_calc_method'\"></cus-radio>\r\n                </el-form-item>\r\n              </el-col>\r\n            </cus-row>\r\n          <el-row>\r\n            <el-form-item style=\"float: right\">\r\n              <el-button  size=\"small\"  v-if=\"!selectedDef.id&&!premiumCode\" v-auth=\"'pdtemp-pd-prem:add'\" icon=\"el-icon-success\" dialog-disable=\"disable\"\r\n                         type=\"primary\" @click=\"handleAddDef\">{{ $t('pay_def.save') }}\r\n              </el-button>\r\n              <el-button  size=\"small\"  v-if=\"selectedDef.id&&!premiumCode\" v-auth=\"'pdtemp-pd-prem:update'\" icon=\"el-icon-success\" dialog-disable=\"disable\"\r\n                         type=\"primary\" @click=\"handleUpdateDef\">{{ $t('pay_def.update') }}\r\n              </el-button>\r\n              <el-button  size=\"small\" v-if=\"!premiumCode\"  icon=\"el-icon-refresh\" type=\"primary\" @click=\"clearFormDef\" dialog-disable=\"disable\">\r\n                {{ $t('pay_def.refresh') }}\r\n              </el-button>\r\n            </el-form-item>\r\n          </el-row>\r\n          <cus-form-title :label=\"$t('pay_def.pay_calc_formula')\"></cus-form-title>\r\n          <el-row id=\"payCalcFormula\">\r\n            <el-col :span=\"8\">\r\n              <el-form-item :label=\"$t('pay_def.pay_code')\">\r\n                <el-tag type=\"info\" style=\"width: 220px\">{{ form_def.pdPremCode || form_defAdd.pdPremCode }}</el-tag>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"8\">\r\n              <el-form-item :label=\"$t('pay_def.pay_calc_formula1')\">\r\n                <el-input v-model=\"form_def.pdPremCalcCode\" readonly style=\"width: 220px\">\r\n                  <el-tooltip\r\n                    slot=\"suffix\"\r\n                    :content=\"premiumCode?$t('pay_def.message.readonly'):(Object.keys(selectedDef).length===0&&Object.keys(form_defAdd).length===0?$t('pay_def.message.pleaseSelectPremium'):'')\"\r\n                    :disabled=\"!premiumCode && (Object.keys(selectedDef).length>0||Object.keys(form_defAdd).length>0)\"\r\n                    effect=\"dark\" placement=\"top\">\r\n                    <svg-icon\r\n                      :style=\"{cursor:!premiumCode && (Object.keys(selectedDef).length>0||Object.keys(form_defAdd).length>0)?'pointer':'not-allowed'}\"\r\n                      icon-class=\"calc\"\r\n                      style=\"color: #606266;font-size: 18px\"\r\n                      @click=\"!premiumCode && (Object.keys(selectedDef).length>0||Object.keys(form_defAdd).length>0) && goClicks('1','17')\"/>\r\n                  </el-tooltip>\r\n                </el-input>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n        </el-form>\r\n      </div>\r\n      <!-- 加费部分 -->\r\n\r\n      <cus-form-title v-show=\"false\" :label=\"$t('pay_def.pay_extra_def')\" :realFirst=\"true\" @show=\"showAddFee\" :showArrow=\"true\"></cus-form-title>\r\n      <div  v-show=\"addFeeFlag\">\r\n        <!-- 加费定义表格（显示数据库中现有的加费记录） -->\r\n        <cus-table-title :label=\"$t('pay_def.addition_list') \"></cus-table-title>\r\n        <el-table :data=\"additionTableData\" :span-method=\"objectSpanMethod_addition\" border element-loading-text=\"Loading\"\r\n                  fit size=\"mini\" @row-click=\"rowClick_addition\">\r\n          <el-table-column :label=\"$t('table.select')\" align=\"center\" width=\"60px\">\r\n            <template slot-scope=\"scope\">\r\n              <el-radio-group v-model=\"selectedAddition\" @change=\"selectedAdditionChanged\">\r\n                <el-radio :label=\"scope.row\">{{ '' }}</el-radio>\r\n              </el-radio-group>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('table.id')\" align=\"center\" width=\"50\">\r\n            <template v-slot=\"scope\">\r\n              {{ initTableIndex('page_addition', scope.$index) }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_code')\" align=\"center\" prop=\"pdPremCode\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_name')\" align=\"center\" prop=\"pdPremName\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.addition_pay_code')\" align=\"center\" prop=\"pdExtPremCode\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.addition_pay_name')\" sortable :filters=\"filterpdExtPremNameList1\"\r\n                           :filter-method=\"filterHandler\" align=\"center\" prop=\"pdExtPremName\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.addition_pay_person')\" align=\"center\" prop=\"pdExtPremObj\">\r\n            <template v-slot=\"scope\">{{ scope.row.pdExtPremObj | filter_additionPayPerson }}</template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.addition_type')\" align=\"center\" prop=\"pdExtPremType\" sortable  :filters=\"filterpdExtPremNameList2\"\r\n                           :filter-method=\"filterHandler\" >\r\n            <template v-slot=\"scope\">{{ scope.row.pdExtPremType | filter_additionType }}</template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.addition_mode')\" align=\"center\" prop=\"pdExtPremMode\">\r\n            <template v-slot=\"scope\">{{ scope.row.pdExtPremMode | filter_additionAdditionMode }}</template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.operation')\" v-if=\"!premiumCode\" align=\"center\" width=\"100px\">\r\n            <template slot-scope=\"scope\">\r\n              <cus-del-btn v-auth=\"'pdtemp-pd-ext-prem:delete'\" :disabled=\"!!premiumCode\"\r\n                           @ok=\"handleDeleteAddition(scope.row)\"></cus-del-btn>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n        <!-- 分页 -->\r\n        <cus-pagination ref=\"page_addition\" v-model=\"additionTableData\" :mergedAttrName=\"'pdPremId'\"\r\n                        :needMerging=\"true\" :orderIndexArrName=\"'orderIndexArr_addition'\" :pageSize=\"10\"\r\n                        :params=\"params_addition\" :tableData=\"additionTableData\" url=\"/pdtemp-pd-ext-prem/base/list\"\r\n                        @updateOrderIndexArr=\"updateOrderIndexArr\"/>\r\n      </div>\r\n      <!-- 加费定义表单（新增） -->\r\n      <div v-if=\"!selectedAddition.id && addFeeFlag\">\r\n        <br>\r\n        <cus-form-title :first=\"true\" :label=\"$t('pay_def.addition_info')\"></cus-form-title>\r\n        <el-form ref=\"form_addition_add\" :disabled=\"!!premiumCode\" :model=\"form_addition_add\" :rules=\"rules\" label-width=\"auto\" >\r\n          <cus-row>\r\n            <cus-col :span=\"11\">\r\n              <el-form-item :label=\"$t('pay_def.pay_name')\" prop=\"pdPremId\">\r\n                <el-select v-model=\"form_addition_add.pdPremId\" :placeholder=\"$t('pay_def.please_select')\" clearable\r\n                           filterable multiple>\r\n                  <el-option v-for=\"def in defTableData\" :label=\"def.pdPayName\" :value=\"def.id\"></el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n            </cus-col>\r\n          </cus-row>\r\n          <cus-row>\r\n            <cus-col :span=\"11\">\r\n              <el-form-item :label=\"$t('pay_def.addition_pay_person')\" prop=\"pdExtPremObj\">\r\n                <cus-checkbox v-model=\"form_addition_add.pdExtPremObj\"\r\n                              :codetype=\"'pdAddPremObj'\"></cus-checkbox>\r\n              </el-form-item>\r\n            </cus-col>\r\n            </cus-row>\r\n            <cus-row>\r\n            <cus-col :span=\"11\">\r\n              <el-form-item :label=\"$t('pay_def.addition_mode')\" prop=\"pdExtPremMode\">\r\n                <cus-checkbox v-model=\"form_addition_add.pdExtPremMode\"\r\n                              :codetype=\"'pd_prem_addition_addition_mode'\"></cus-checkbox>\r\n              </el-form-item>\r\n            </cus-col>\r\n          </cus-row>\r\n          <el-row>\r\n            <el-col :span=\"11\">\r\n              <el-form-item :label=\"$t('pay_def.addition_type')\" prop=\"pdExtPremType\">\r\n                <el-input v-model=\"displayName_additionType\" :placeholder=\"$t('pay_def.unselected')\" readonly></el-input>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-button v-if=\"!premiumCode\"  size=\"small\" style=\"margin-left: 5px\" @click=\"pageFlag.dialogVisible_additionType = true\">\r\n              {{ $t('pay_def.please_select') }}\r\n            </el-button>\r\n          </el-row>\r\n          <el-dialog ref=\"additionType\" v-dialog-drag :visible.sync=\"pageFlag.dialogVisible_additionType\"\r\n                     width=\"45%\">\r\n            <cus-page-title :label=\"$t('pay_def.addition_type')\"></cus-page-title>\r\n            <el-form-item>\r\n              <cus-checkbox v-model=\"form_addition_add.pdExtPremType\"\r\n                            :codetype=\"'pd_prem_addition_type'\"></cus-checkbox>\r\n            </el-form-item>\r\n            <el-button-group>\r\n              <el-button v-if=\"!premiumCode\"  size=\"small\" type=\"primary\" icon=\"el-icon-success\" @click=\"selectAllAdditionType\" dialog-disable=\"disable\">{{ $t('pay_def.select_all') }}</el-button>\r\n              <el-button v-if=\"!premiumCode\"  size=\"small\" type=\"primary\" icon=\"el-icon-refresh\" @click=\"form_addition_add.pdExtPremType = []\" dialog-disable=\"disable\">{{ $t('pay_def.refresh') }}</el-button>\r\n            </el-button-group>\r\n            <div style=\"float: right\">\r\n              <el-button-group>\r\n                <el-button v-if=\"!premiumCode\"  size=\"small\" type=\"primary\" icon=\"el-icon-success\" @click=\"pageFlag.dialogVisible_additionType = false\" dialog-disable=\"disable\">\r\n                  {{ $t('pay_def.add') }}\r\n                </el-button>\r\n              </el-button-group>\r\n            </div>\r\n          </el-dialog>\r\n          <el-row>\r\n            <el-form-item style=\"float: right\">\r\n              <el-button v-if=\"!premiumCode\"  size=\"small\" icon=\"el-icon-success\" type=\"primary\" @click=\"handleAddAddition\" dialog-disable=\"disable\">\r\n                {{ $t('pay_def.add') }}\r\n              </el-button>\r\n              <el-button v-if=\"!premiumCode\" size=\"small\" icon=\"el-icon-refresh\" type=\"primary\" @click=\"resetFormAdditionAdd\" dialog-disable=\"disable\">\r\n                {{ $t('pay_def.refresh') }}\r\n              </el-button>\r\n            </el-form-item>\r\n          </el-row>\r\n\r\n          <!-- 新增加费表格（动态显示） -->\r\n          <div v-if=\"additionAddTableData.length > 0\">\r\n            <cus-form-title :label=\"$t('pay_def.to_add_additionitem')\"></cus-form-title>\r\n            <cus-table-title :label=\"$t('pay_def.addition_add_list')\"></cus-table-title>\r\n            <el-table :data=\"additionAddTableData\" :span-method=\"objectSpanMethod_addition_add\"\r\n                      border element-loading-text=\"Loading\" fit max-height=\"500\" size=\"mini\"\r\n                      @selection-change=\"handleSelectionChange\">\r\n              <el-table-column align=\"center\" type=\"selection\" width=\"50\"></el-table-column>\r\n              <el-table-column :label=\"$t('table.id')\" align=\"center\" type=\"index\" width=\"50\"></el-table-column>\r\n              <el-table-column :label=\"$t('pay_def.pay_code')\" align=\"center\" prop=\"pdPremCode\"></el-table-column>\r\n              <el-table-column :label=\"$t('pay_def.pay_name')\" align=\"center\" prop=\"pdPremName\"></el-table-column>\r\n              <el-table-column :label=\"$t('pay_def.addition_pay_name')\" align=\"center\" width=\"300px\">\r\n                <template v-slot=\"scope\">\r\n                  <el-input v-model=\"scope.row.pdExtPremName\" :placeholder=\"$t('form.please_enter')\" maxlength=\"60\"\r\n                            show-word-limit></el-input>\r\n                </template>\r\n              </el-table-column>\r\n              <el-table-column :label=\"$t('pay_def.addition_pay_person')\" align=\"center\" prop=\"additionPayPersonType\">\r\n                <template v-slot=\"scope\">{{ scope.row.pdExtPremObj | filter_additionPayPerson }}</template>\r\n              </el-table-column>\r\n              <el-table-column :label=\"$t('pay_def.addition_mode')\" align=\"center\" prop=\"additionMode\">\r\n                <template v-slot=\"scope\">{{ scope.row.pdExtPremMode | filter_additionAdditionMode }}</template>\r\n              </el-table-column>\r\n              <el-table-column :label=\"$t('pay_def.addition_type')\" align=\"center\" prop=\"additionType\">\r\n                <template v-slot=\"scope\">{{ scope.row.pdExtPremType | filter_additionType }}</template>\r\n              </el-table-column>\r\n              <el-table-column :label=\"$t('pay_def.addition_maximum')\" align=\"center\" width=\"140px\">\r\n                <template slot-scope=\"scope\">\r\n                  <el-input-number v-model=\"scope.row.pdMaxVal\" style=\"width: 120px;\"\r\n                                   :disabled=\"scope.row.pdExtPremMode!=='01'\" :placeholder=\"$('i18nView.placeholderNum')\"></el-input-number>\r\n                </template>\r\n              </el-table-column>\r\n              <el-table-column :label=\"$t('table.actions')\" v-if=\"!premiumCode\" align=\"center\" width=\"100px\">\r\n                <template slot-scope=\"scope\">\r\n                  <el-button  slot=\"reference\" size=\"mini\"\r\n                              type=\"danger\" @click=\"handleDeleteAdditionAdd(scope.row)\"><i class=\"el-icon-minus\" dialog-disable=\"disable\"></i>\r\n                  </el-button>\r\n                </template>\r\n              </el-table-column>\r\n            </el-table>\r\n            <el-form>\r\n              <el-row v-if=\"selectedAdditionAdds.length > 0\" style=\"margin: 20px auto 50px auto;\">\r\n                <el-form-item align=\"right\" style=\"float: right\">\r\n                  <el-button v-if=\"!premiumCode\"  size=\"small\" v-auth=\"'pdtemp-pd-ext-prem:add'\" icon=\"el-icon-success\" type=\"primary\" dialog-disable=\"disable\"\r\n                              @click=\"handleSaveAdditionAdd\">{{ $t('pay_def.save') }}\r\n                  </el-button>\r\n                </el-form-item>\r\n              </el-row>\r\n            </el-form>\r\n            <br/>\r\n          </div>\r\n\r\n\r\n          <cus-form-title :label=\"$t('pay_def.addition_calc_formula_code')\"></cus-form-title>\r\n          <cus-row>\r\n            <cus-col>\r\n              <el-form-item :label=\"$t('pay_def.addition_calc_formula_code1')\">\r\n                <el-input v-model=\"form_addition.pdExtPremCalcCode\" readonly >\r\n                  <el-tooltip\r\n                    slot=\"suffix\"\r\n                    :content=\"premiumCode?$t('pay_def.message.readonly'):(Object.keys(selectedAddition).length===0?$t('pay_def.message.pleaseSelectAddPremium'):'')\"\r\n                    :disabled=\"!premiumCode && Object.keys(selectedAddition).length>0\" effect=\"dark\"\r\n                    placement=\"top\">\r\n                    <svg-icon\r\n                      :style=\"{cursor:!premiumCode && Object.keys(selectedAddition).length>0?'pointer':'not-allowed'}\"\r\n                      icon-class=\"calc\"\r\n                      style=\"color: #606266;font-size: 18px\"\r\n                      @click=\"!premiumCode && Object.keys(selectedAddition).length>0 && goClicks('1','19')\"/>\r\n                  </el-tooltip>\r\n                </el-input>\r\n              </el-form-item>\r\n            </cus-col>\r\n          </cus-row>\r\n          <el-row v-if=\"false\">\r\n            <el-button  size=\"small\" icon=\"el-icon-monitor\" type=\"primary\" @click=\"goRules('1','1')\">\r\n              {{ $t('pay_def.premium_rule_def') }}\r\n            </el-button>\r\n          </el-row>\r\n\r\n        </el-form>\r\n      </div>\r\n      <!-- 加费定义表单（编辑） -->\r\n      <div v-if=\"selectedAddition.id && addFeeFlag\">\r\n        <cus-form-title :first=\"true\" :label=\"$t('pay_def.addition_info')\"></cus-form-title>\r\n        <el-form ref=\"form_addition\" :disabled=\"!!premiumCode\"  :model=\"form_addition\"\r\n                 :rules=\"rules\" label-position=\"right\" label-width=\"auto\">\r\n          <el-row>\r\n            <el-col :span=\"10\">\r\n              <el-form-item :label=\"$t('pay_def.pay_code')\">\r\n                <div>{{ form_addition.pdPremCode }}</div>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"10\">\r\n              <el-form-item :label=\"$t('pay_def.pay_name')\">\r\n                <div>{{ form_addition.pdPremId | filter_paymentId }}</div>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n          <el-row>\r\n            <el-col :span=\"10\">\r\n              <el-form-item :label=\"$t('pay_def.addition_pay_code')\">\r\n                <div>{{ form_addition.pdExtPremCode }}</div>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"10\">\r\n              <el-form-item :label=\"$t('pay_def.addition_pay_name')\" prop=\"pdExtPremName\">\r\n                <el-input v-model=\"form_addition.pdExtPremName\" maxlength=\"60\" show-word-limit></el-input>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n          <el-row>\r\n            <el-col :span=\"10\">\r\n              <el-form-item :label=\"$t('pay_def.addition_pay_person')\" prop=\"pdExtPremObj\">\r\n                <cus-radio v-model=\"form_addition.pdExtPremObj\" :codetype=\"'pdAddPremObj'\"></cus-radio>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"10\">\r\n              <el-form-item :label=\"$t('pay_def.addition_mode')\" prop=\"pdExtPremMode\">\r\n                <cus-radio v-model=\"form_addition.pdExtPremMode\"\r\n                           :codetype=\"'pd_prem_addition_addition_mode'\"></cus-radio>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n          <el-row>\r\n            <el-col :span=\"10\">\r\n              <el-form-item :label=\"$t('pay_def.addition_type')\" prop=\"pdExtPremType\">\r\n                <cus-select v-model=\"form_addition.pdExtPremType\" :codetype=\"'pd_prem_addition_type'\"></cus-select>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col  :span=\"10\" v-if=\"form_addition.pdExtPremMode === '01'\">\r\n              <el-form-item :label=\"$t('pay_def.addition_maximum')\" prop=\"pdMaxVal\">\r\n                <el-input-number v-model=\"form_addition.pdMaxVal\" :placeholder=\"$t('i18nView.placeholderNum')\"></el-input-number>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n\r\n          <cus-form-title :label=\"$t('pay_def.addition_calc_formula_code')\"></cus-form-title>\r\n          <el-row>\r\n            <el-col :span=\"6\">\r\n              <el-form-item :label=\"$t('pay_def.addition_calc_formula_code1')\">\r\n                <el-input v-model=\"form_addition.pdExtPremCalcCode\">\r\n                  <el-tooltip\r\n                    slot=\"suffix\"\r\n                    :content=\"premiumCode?$t('pay_def.message.readonly'):(Object.keys(selectedAddition).length===0?$t('pay_def.message.pleaseSelectAddPremium'):'')\"\r\n                    :disabled=\"!premiumCode && Object.keys(selectedAddition).length>0\" effect=\"dark\"\r\n                    placement=\"top\">\r\n                    <svg-icon\r\n                      :style=\"{cursor:!premiumCode && Object.keys(selectedAddition).length>0?'pointer':'not-allowed'}\"\r\n                      icon-class=\"calc\"\r\n                      style=\"color: #606266;font-size: 18px\"\r\n                      @click=\"!premiumCode && Object.keys(selectedAddition).length>0 && goClicks('1','19')\"/>\r\n                  </el-tooltip>\r\n                </el-input>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n          <el-row>\r\n            <el-form-item style=\"float: right\">\r\n              <el-button  size=\"small\" v-if=\"!premiumCode\" v-auth=\"'pdtemp-pd-ext-prem:update'\" icon=\"el-icon-success\" dialog-disable=\"disable\"\r\n                          type=\"primary\" @click=\"handleUpdateAddition\">{{ $t('pay_def.update') }}\r\n              </el-button>\r\n              <!-- <el-button  size=\"small\" @click=\"handleDeleteAddition\" style=\"margin: 0 10px 0 0\"\r\n                          type=\"danger\" v-auth=\"'pdtemp-pd-ext-prem:delete'\">{{ $t('table.delete') }}\r\n               </el-button>-->\r\n              <el-button  size=\"small\" v-if=\"!premiumCode\" icon=\"el-icon-refresh\" type=\"primary\" @click=\"clearFormAddition\" dialog-disable=\"disable\">\r\n                {{ $t('pay_def.refresh') }}\r\n              </el-button>\r\n            </el-form-item>\r\n          </el-row>\r\n        </el-form>\r\n      </div>\r\n      <!--产品优惠部分-->\r\n      <br/>\r\n    </div>\r\n\r\n    <div v-show=\"productCalcRevisionShowINfo\">\r\n      <cus-page-title-back :label=\"$t('i18nView.pdFormulaQuery')\" @backTo=\"back2\"></cus-page-title-back>\r\n      <cus-product-info></cus-product-info>\r\n    </div>\r\n\r\n    <el-form ref=\"form_count\"  :model=\"form_count\" :rules=\"rules_count\" label-position=\"right\" label-width=\"auto\">\r\n      <cus-form-title @show=\"discountClick\" :showArrow=\"true\" :realFirst=\"true\" :label=\"$t('pay_def.pay_discount')\"></cus-form-title>\r\n\r\n      <div v-if=\"discountFlag==='Y'\">\r\n        <cus-table-title :label=\"$t('pay_def.pd_pay_discount')\"></cus-table-title>\r\n        <el-table ref=\"discountTableData\" :data=\"discountTableData\" :span-method=\"objectSpanMethod_discount\"\r\n                  border element-loading-text=\"Loading\" fit size=\"mini\" @row-click=\"rowClick_discount\">\r\n          <el-table-column :label=\"$t('table.select')\" align=\"center\" width=\"60px\">\r\n            <template slot-scope=\"scope\">\r\n              <el-radio-group v-model=\"selectedDiscount\" @change=\"selectedDiscountChanged\">\r\n                <el-radio :label=\"scope.row\">{{ '' }}</el-radio>\r\n              </el-radio-group>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('table.id')\" align=\"center\" width=\"50\" type=\"index\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_code')\" align=\"center\"\r\n                           sortable :filters=\"filterDiscountCode\"\r\n                           :filter-method=\"filterHandlerDiscount\" prop=\"pdPremCode\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_name')\" align=\"center\"\r\n                           prop=\"pdPayName\"></el-table-column>\r\n          <el-table-column :filter-method=\"filterHandler\" :filters=\"pdCmpnRangeFilters\"\r\n                           :label=\"$t('pay_def.pay_discount_range')\"\r\n                           align=\"center\"\r\n                           prop=\"pdCmpnRange\">\r\n            <template v-slot=\"scope\">{{ scope.row.pdCmpnRange | filter_pdCmpnRange }}</template>\r\n          </el-table-column>\r\n          <el-table-column :filter-method=\"filterHandler\" :filters=\"pdCmpnTypeFilters\"\r\n                           :label=\"$t('pay_def.pay_discount_type')\"\r\n                           align=\"center\"\r\n                           prop=\"pdCmpnType\">\r\n            <template v-slot=\"scope\">{{ scope.row.pdCmpnType | filter_pdCmpnType }}</template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_discount_calc')\" align=\"center\" prop=\"pdCmpnCalcMode\">\r\n            <template v-slot=\"scope\">{{ scope.row.pdCmpnCalcMode | filter_pdCmpnCalcMode }}</template>\r\n          </el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_discount_val')\" align=\"center\" prop=\"pdCmpnVal\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.pay_discount_calc_code')\" align=\"center\"\r\n                           prop=\"pdCmpnCalcCode\"></el-table-column>\r\n          <el-table-column :label=\"$t('pay_def.operation')\" v-if=\"!premiumCode\" align=\"center\" width=\"100px\">\r\n            <template slot-scope=\"scope\">\r\n              <cus-del-btn :disabled=\"!!premiumCode\" @ok=\"deleteDisCount(scope.row)\"></cus-del-btn>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n        <div v-show=\"!productCalcRevisionShowINfo\">\r\n          <cus-form-title :label=\"$t('pay_def.pay_discount_menu')\" ></cus-form-title>\r\n          <cus-row>\r\n            <cus-col >\r\n              <el-form-item :label=\"$t('pay_def.pay_name')\" prop=\"pdPremIds\">\r\n                <el-select v-model=\"form_count.pdPremIds\" :disabled=\"!!selectedDiscount.id\" clearable multiple\r\n                           filterable @change=\"getPdDiscountRange\">\r\n                  <el-option v-for=\"def in defTableData\" :label=\"def.pdPayName\" :value=\"def.id\"></el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n            </cus-col>\r\n            <cus-col >\r\n              <el-form-item :label=\"$t('pay_def.pay_discount_order')\" prop=\"pdCmpnOrder\">\r\n                <el-input v-model=\"form_count.pdCmpnOrder\" :placeholder=\"$t('i18nView.placeholderNum')\" type=\"number\"></el-input>\r\n              </el-form-item>\r\n            </cus-col>\r\n            <cus-col >\r\n              <el-form-item :label=\"$t('pay_def.pay_discount_type')\" prop=\"pdCmpnType\" >\r\n                <cus-select v-model=\"form_count.pdCmpnType\" :codetype=\"'preferentialType'\"\r\n                            :disabled=\"!!selectedDiscount.id\" :filter=\"filterCmpnType\"></cus-select>\r\n              </el-form-item>\r\n            </cus-col>\r\n          </cus-row>\r\n          <cus-row>\r\n            <cus-col :span=\"24\">\r\n              <el-form-item :label=\"$t('pay_def.pay_discount_range')\" prop=\"pdCmpnRange\">\r\n                <el-checkbox-group v-model=\"form_count.pdCmpnRange\" :disabled=\"!!selectedDiscount.id\">\r\n                  <el-checkbox v-for=\"item in pdDiscountRangeOptions\" :key=\"item.value\" :disabled=\"item.disabled\"\r\n                               :label=\"item.value\">{{ item.label }}\r\n                  </el-checkbox>\r\n                </el-checkbox-group>\r\n              </el-form-item>\r\n            </cus-col>\r\n          </cus-row>\r\n          <cus-row>\r\n            <cus-col >\r\n              <el-form-item :label=\"$t('pay_def.pay_discount_calc')\" prop=\"pdCmpnCalcMode\" @change=\"changePdCmpnCalcMode\">\r\n                <cus-radio v-model=\"form_count.pdCmpnCalcMode\" :codetype=\"'preferentialClculationType'\"\r\n                ></cus-radio>\r\n              </el-form-item>\r\n            </cus-col>\r\n            <cus-col >\r\n              <el-form-item :label=\"$t('pay_def.pay_discount_val')\">\r\n                <el-input v-model=\"form_count.pdCmpnVal\" :disabled=\"form_count.pdCmpnCalcMode!=='1'\" :placeholder=\"$t('i18nView.placeholderNum')\"\r\n                          type=\"number\"></el-input>\r\n              </el-form-item>\r\n            </cus-col>\r\n            <cus-col >\r\n            </cus-col >\r\n          </cus-row>\r\n          <el-row>\r\n            <el-form-item style=\"float: right\">\r\n              <el-button  size=\"small\" v-if=\"!selectedDiscount.id&&!premiumCode\" :disabled=\"!!premiumCode\" icon=\"el-icon-success\" type=\"primary\" dialog-disable=\"disable\"\r\n                         @click=\"saveDisCount\">\r\n                {{ $t('pay_def.save') }}\r\n              </el-button>\r\n              <el-button  size=\"small\" v-if=\"selectedDiscount.id&&!premiumCode\" :disabled=\"!!premiumCode\" icon=\"el-icon-success\" type=\"primary\" dialog-disable=\"disable\"\r\n                         @click=\"updateDisCount\">\r\n                {{ $t('pay_def.update') }}\r\n              </el-button>\r\n              <el-button  size=\"small\" v-if=\"!premiumCode\" :disabled=\"!!premiumCode\" icon=\"el-icon-refresh\" type=\"primary\" @click=\"clearFormDiscount\" dialog-disable=\"disable\">\r\n                {{ $t('pay_def.refresh') }}\r\n              </el-button>\r\n            </el-form-item>\r\n          </el-row>\r\n        </div>\r\n\r\n        <cus-form-title :label=\"$t('pay_def.pay_discount_calc_code')\"></cus-form-title>\r\n        <cus-row>\r\n          <cus-col >\r\n            <el-form-item :label=\"$t('pay_def.pay_discount_calc_code1')\" >\r\n              <el-input v-model=\"form_count.pdCmpnCalcCode\" :disabled=\"form_count.pdCmpnCalcMode!=='2'\" readonly>\r\n                <el-tooltip\r\n                  slot=\"suffix\"\r\n                  :content=\"premiumCode?$t('pay_def.message.readonly'):(Object.keys(selectedDiscount).length===0?$t('pay_def.message.pleaseSelectRange'):'')\"\r\n                  :disabled=\"!premiumCode && Object.keys(selectedDiscount).length>0\" effect=\"dark\"\r\n                  placement=\"top\">\r\n                  <svg-icon\r\n                    :style=\"{cursor:form_count.pdCmpnCalcMode==='2' && !premiumCode && Object.keys(selectedDiscount).length>0?'pointer':'not-allowed'}\"\r\n                    icon-class=\"calc\"\r\n                    style=\"color: #606266;font-size: 18px\"\r\n                    @click=\"form_count.pdCmpnCalcMode==='2' && !premiumCode && Object.keys(selectedDiscount).length>0 && goPdDiscountSelect('1','40')\"/>\r\n                </el-tooltip>\r\n              </el-input>\r\n            </el-form-item>\r\n          </cus-col>\r\n        </cus-row>\r\n\r\n      </div>\r\n    </el-form>\r\n\r\n    <!-- 弹窗（公式定义） -->\r\n    <el-dialog v-if=\"dialogShow.premAmountFormula\" v-dialog-drag :close-on-click-modal=\"false\"\r\n               :visible.sync=\"dialogShow.premAmountFormula\" center width=\"80%\"\r\n               @close=\"changeDialogVisible_formula(false)\">\r\n      <premAmountFormula :calculationFormulaType=\"calculationFormulaType\" :guaranteeDetails=\"guaranteeDetails\"\r\n                         :pdUwSiTypeDtOptions=\"pdUwSiTypeDtOptions\" :pdUwSiTypeOptions=\"pdUwSiTypeOptions\"\r\n                         @bringInCalcCode=\"bringInCalcCode\"\r\n                         @changeDialogVisible_formula=\"changeDialogVisible_formula\"\r\n                         @changeDialogVisible_formulaSelect=\"changeDialogVisible_formulaSelect\"></premAmountFormula>\r\n      <!-- 弹窗（公式选择） -->\r\n      <el-dialog v-if=\"dialogShow.premAmountFormulaSelect\" v-dialog-drag :close-on-click-modal=\"false\"\r\n                 :visible.sync=\"dialogShow.premAmountFormulaSelect\" append-to-body center\r\n                 width=\"70%\" @close=\"changeDialogVisible_formulaSelect(false)\">\r\n        <premAmountFormulaSelect :calculationFormulaType=\"calculationFormulaType\" :guaranteeDetails=\"guaranteeDetails\"\r\n                                 :pdUwSiTypeDtOptions=\"pdUwSiTypeDtOptions\" :pdUwSiTypeOptions=\"pdUwSiTypeOptions\"\r\n                                 @bringInCalcCode=\"bringInCalcCode\"\r\n                                 @changeDialogVisible_formulaSelect=\"changeDialogVisible_formulaSelect\"></premAmountFormulaSelect>\r\n      </el-dialog>\r\n    </el-dialog>\r\n\r\n    <!-- 弹窗（规则定义） -->\r\n    <el-dialog v-if=\"dialogRulesShow.premRules\" v-dialog-drag :close-on-click-modal=\"false\"\r\n               :visible.sync=\"dialogRulesShow.premRules\"\r\n               center width=\"80%\" @close=\"changeDialogVisible_rules(false)\">\r\n      <premRules :calculationFormulaType=\"calculationFormulaType\"\r\n                 :guaranteeDetails=\"guaranteeDetails\"\r\n                 :pdUwSiTypeDtOptions=\"pdUwSiTypeDtOptions\"\r\n                 :pdUwSiTypeOptions=\"pdUwSiTypeOptions\"\r\n                 @changeDialogVisible_formula=\"changeDialogVisible_rules\"\r\n                 @changeDialogVisible_formulaSelect=\"changeDialogVisible_rulesSelect\"></premRules>\r\n      <!-- 弹窗（规则选择） -->\r\n      <el-dialog v-if=\"dialogRulesShow.premRulesSelect\" v-dialog-drag :close-on-click-modal=\"false\"\r\n                 :visible.sync=\"dialogRulesShow.premRulesSelect\" append-to-body\r\n                 center width=\"70%\" @close=\"changeDialogVisible_rulesSelect(false)\">\r\n        <premRulesSelect :calculationFormulaType=\"calculationFormulaType\" :guaranteeDetails=\"guaranteeDetails\"\r\n                         :pdUwSiTypeDtOptions=\"pdUwSiTypeDtOptions\"\r\n                         :pdUwSiTypeOptions=\"pdUwSiTypeOptions\"\r\n                         @changeDialogVisible_formulaSelect=\"changeDialogVisible_rulesSelect\"></premRulesSelect>\r\n      </el-dialog>\r\n    </el-dialog>\r\n\r\n    <!--优惠计算公式定义-->\r\n    <el-dialog v-if=\"dialogShow.pdDiscountFormula\" v-dialog-drag :close-on-click-modal=\"false\"\r\n               :visible.sync=\"dialogShow.pdDiscountFormula\" center width=\"80%\"\r\n               @close=\"changeDialogVisible_pdDiscount(false)\">\r\n      <pdDiscountFormula :calculationFormulaType=\"calculationFormulaType\" :guaranteeDetails=\"guaranteeDetails\"\r\n                         :pdDisCount=\"pdDisCount\" :pdDiscountRangeOptions=\"pdDiscountRangeOptions\"\r\n                         @bringInCalcCode=\"bringInCalcCode\"\r\n                         @changeDialogVisible_pdDiscount=\"changeDialogVisible_pdDiscount\"\r\n                         @changeDialogVisible_pdDiscountSelect=\"changeDialogVisible_pdDiscountSelect\"></pdDiscountFormula>\r\n      <!-- 弹窗（公式选择） -->\r\n      <el-dialog v-if=\"dialogShow.pdDiscountFormulaSelect\" v-dialog-drag :close-on-click-modal=\"false\"\r\n                 :visible.sync=\"dialogShow.pdDiscountFormulaSelect\" append-to-body center\r\n                 width=\"70%\" @close=\"changeDialogVisible_pdDiscountSelect(false)\">\r\n        <pdDiscountFormulaSelect :calculationFormulaType=\"calculationFormulaType\" :guaranteeDetails=\"guaranteeDetails\"\r\n                                 :pdDisCount=\"pdDisCount\" @bringInCalcCode=\"bringInCalcCode\"\r\n                                 @changeDialogVisible_pdDiscountSelect=\"changeDialogVisible_pdDiscountSelect\"></pdDiscountFormulaSelect>\r\n      </el-dialog>\r\n    </el-dialog>\r\n\r\n  </cus-wraper>\r\n</template>\r\n<script>\r\n\r\nimport {mapGetters} from \"vuex\"\r\nimport {\r\n  addPdtempPdPrem,\r\n  deletePdtempPdPrem,\r\n  getPayDate,\r\n  getPdAttrInfo,\r\n  getPdClsLabInfo,\r\n  updatePdtempPdPrem\r\n} from \"@/api/basicinfo/pdtemppdprem\"\r\nimport {addPdtempPdExtPrem, deletePdtempPdExtPrem, updatePdtempPdExtPrem} from \"@/api/basicinfo/pdtemppdextprem\"\r\nimport {\r\n  addPdtempPdCmpnInfo,\r\n  deletePdtempPdCmpnInfo,\r\n  findCmpnCaleCode,\r\n  getMaxRangeOrder,\r\n  selectDiscountRangeByPdInfoId,\r\n  updatePdtempPdCmpnInfo\r\n} from \"@/api/basicinfo/pdtemppdcmpninfo\";\r\nimport pdDiscountFormula\r\n  from \"@/views/product-definition/pd-framework-def/pd-structure-def/payment-def/discount-formula\";\r\nimport pdDiscountFormulaSelect\r\n  from \"@/views/product-definition/pd-framework-def/pd-structure-def/payment-def/discount-formula-select\";\r\nimport premAmountFormula from \"@/views/product-definition/pd-framework-def/pd-structure-def/payment-def/prem-formula\";\r\nimport premAmountFormulaSelect\r\n  from \"@/views/product-definition/pd-framework-def/pd-structure-def/payment-def/prem-formula-select\";\r\nimport premRules from \"@/views/product-definition/pd-framework-def/pd-structure-def/payment-def/prem-rule\";\r\nimport premRulesSelect from \"@/views/product-definition/pd-framework-def/pd-structure-def/payment-def/prem-rule-select\";\r\n\r\nimport guide from '@/views/product-definition/pd-framework-def/pd-structure-def/payment-def/guide'\r\n\r\nlet _this\r\n\r\nexport default {\r\n  name: \"PaymentDefinition\",\r\n  filters: {\r\n    filter_calcMethod(code) {\r\n      return _this.getCodeName('pd_prem_cal_method', code)\r\n    },\r\n    filter_dateSuffix(code) {\r\n      return _this.getCodeName('pd_prem_date_suffix', code, true)\r\n    },\r\n    filter_freq(code) {\r\n      return _this.getCodeName('pd_prem_freq', code)\r\n    },\r\n    filter_startCalcRule(code) {\r\n      return _this.getCodeName('pd_prem_start_calc_rule', code)\r\n    },\r\n    filter_endCalcRule(code) {\r\n      return _this.getCodeName('pd_prem_end_calc_rule', code)\r\n    },\r\n    filter_startCalcMethod(code) {\r\n      return _this.getCodeName('pd_prem_start_calc_method', code)\r\n    },\r\n    filter_endCalcMethod(code) {\r\n      return _this.getCodeName('pd_prem_end_calc_method', code)\r\n    },\r\n    filter_additionType(code) {\r\n      return _this.getCodeName('pd_prem_addition_type', code)\r\n    },\r\n    filter_additionMode(code) {\r\n      return _this.getCodeName('pd_prem_addition_mode', code)\r\n    },\r\n    filter_accountType(code) {\r\n      return _this.getCodeName('pd_prem_account_type', code)\r\n    },\r\n    filter_additionPayPerson(code) {\r\n      return _this.getCodeName('pdAddPremObj', code)\r\n    },\r\n    filter_additionAdditionMode(code) {\r\n      return _this.getCodeName('pd_prem_addition_addition_mode', code)\r\n    },\r\n    filter_payZero(code) {\r\n      return _this.getCodeName('pd_prem_zero', code)\r\n    },\r\n    filter_serviceChargeOffset(code) {\r\n      return _this.getCodeName('pd_prem_service_charge_offset', code)\r\n    },\r\n    filter_pdCmpnType(code) {\r\n      return _this.getCodeName('preferentialType', code)\r\n    },\r\n    filter_pdCmpnCalcMode(code) {\r\n      return _this.getCodeName('preferentialClculationType', code)\r\n    },\r\n    filter_pdCmpnRange(code) {\r\n      for (const def of _this.defTableData) {\r\n        if (def.pdPremCode === code) {\r\n          return def.pdPremCode + \":\" + def.pdPayName\r\n        }\r\n      }\r\n      for (const def of _this.additionTableData) {\r\n        if (def.pdExtPremCode === code) {\r\n          return def.pdExtPremCode + \":\" + def.pdExtPremName\r\n        }\r\n      }\r\n      return code\r\n    },\r\n    filter_payUrging(code) {\r\n      return _this.getCodeName('pd_prem_urging', code)\r\n    },\r\n    filter_payFrequency(code) {\r\n      return _this.getCodeName('paymentFrequency', code)\r\n    },\r\n    filter_paydatevalue(code){\r\n      return _this.getCodeName('pdPayEndCalMode', code)\r\n    },\r\n    filter_paymentId(pdPremId) {\r\n      for (const def of _this.defTableData) {\r\n        if (def.id === pdPremId) {\r\n          return def.pdPayName\r\n        }\r\n      }\r\n      return ''\r\n    },\r\n    filter_pdPayStartPeriod(list){\r\n      let returnData = ''\r\n      if(list.length){\r\n        list.forEach(data=>{\r\n          if(returnData.length){\r\n            returnData+=','\r\n          }\r\n        returnData+=data.pdPayStartPeriod;\r\n        returnData+=_this.getCodeName('pd_prem_date_suffix',data.pdPayStartPerUnit,true);\r\n      })\r\n      }\r\n      return returnData\r\n    },\r\n    filter_pdPayEndPeriod(list){\r\n      let returnData = ''\r\n      if(list.length){\r\n        list.forEach(data=>{\r\n          if(returnData.length){\r\n            returnData+=','\r\n          }\r\n        returnData+=data.pdPayEndPeriod;\r\n        returnData+=_this.getCodeName('pd_prem_date_suffix',data.pdPayEndUnit,true);\r\n      })\r\n      }\r\n      return returnData\r\n    }\r\n  },\r\n  props: {\r\n    premiumCode: {\r\n      required: false,\r\n      type: String,\r\n      default: ''\r\n    }\r\n  },\r\n  data() {\r\n\r\n    _this = this\r\n    return {\r\n      productCalcRevisionShowINfo:false,\r\n      pdPayFreqCopy:[],\r\n      quickfilterHandlerList0:[],\r\n      quickfilterHandlerList1:[],\r\n      quickfilterHandlerList2:[],\r\n      quickfilterHandlerList3:[],\r\n      filterHandlerList0:[],\r\n      filterHandlerList1:[],\r\n      filterHandlerList2:[],\r\n      filterHandlerList3:[],\r\n      filterHandlerList4:[],\r\n      filterpdExtPremNameList1:[],\r\n      filterpdExtPremNameList2:[],\r\n      detailTypeOptionList:[],\r\n      payDateForm:{\r\n        payDateTable:[],\r\n      },\r\n      tableCount: 0,\r\n      tableCountDiscount: 0,\r\n      pdCmpnCalcCode1: '',\r\n      flag1:0,\r\n      //公式\r\n      dialogShow: {\r\n        premAmountFormula: false,\r\n        premAmountFormulaSelect: false,\r\n        pdDiscountFormula: false,\r\n        pdDiscountFormulaSelect: false\r\n      },\r\n      guaranteeDetails: '',\r\n      calculationFormulaType: '',\r\n      pdUwSiTypeOptions: '',\r\n      pdUwSiTypeDtOptions: '',\r\n      pdDisCount: '',\r\n      //规则\r\n      dialogRulesShow: {\r\n        premRules: false,\r\n        premRulesSelect: false\r\n      },\r\n      showPageFlag: 0,\r\n      quickTableData: [],\r\n      defTableData: [],\r\n      additionTableData: [],\r\n      additionAddTableData: [],\r\n      pdCmpnTypeFilters: [],\r\n      rowIndex: '-1',\r\n      orderIndexArr_addition: [],\r\n      orderIndexArr_addition_add: [],\r\n      orderIndexArr_addition_discount:[],\r\n      hoverOrderArr: [],\r\n      quickicon_discount: \"el-icon-arrow-right\",\r\n      quickshow: false,\r\n      filterDiscountCode:[],\r\n      pdCmpnRangeFilters: [],\r\n      productOriginalList:[],\r\n      productList:[],\r\n      selectedReferenceProductId: undefined,\r\n      form_quick: {\r\n        typeRegion: '',\r\n      },\r\n      params: {\r\n        eq_pdInfoId: undefined,\r\n        eq_pdPremCalMode: '',\r\n        accountRelated: '',\r\n        extraPremiumFlag: '',\r\n        eq_id: '',\r\n        byPage: 'Y',\r\n        finelinesRegion: '',\r\n        firstOpenPageFlag: 'Y',\r\n      },\r\n      params_currentProduct: {\r\n        eq_pdInfoId: undefined,\r\n        like_payName: '',\r\n        eq_payCode: ''\r\n      },\r\n      params_addition: {\r\n        premiumList: []\r\n      },\r\n      discountTableData: [],\r\n      configRangeLength: '',\r\n      pdDiscountRangeOptions: [{\r\n        key: '000000',\r\n        value: '000000',\r\n        label: '全部',\r\n        disabled: true\r\n      }],\r\n      filterCmpnType: '1$D$I',\r\n      addFeeFlag: false,\r\n      discountFlag: 'N',\r\n      selectedDiscount: {},\r\n      selectedDef: {},\r\n      selectedDefInQueryResult: {},\r\n      selectedAddition: {},\r\n      selectedAdditionAdds: [],\r\n      // 产品信息\r\n      product: {\r\n        id: undefined,\r\n        pdCode: '',\r\n        pdEdition: '',\r\n        pdVerId: undefined,\r\n        pdSalechnl: '',\r\n        pdName: '',\r\n        pdShortname: '',\r\n        pdEnName: '',\r\n        pdShortEnName: '',\r\n        operator: '',\r\n        pdStartDateRule: '',\r\n        pdStartDateMode: '',\r\n        pdStartPeriod: undefined,\r\n        pdStartPeriodUnit: '',\r\n        pdEndDateRule: '',\r\n        pdEndDateMode: '',\r\n        pdEndPeriod: undefined,\r\n        pdEndPeriodUnit: '',\r\n        pdGracePeriod: undefined,\r\n        pdObservationDay: undefined,\r\n        pdApplDate: undefined,\r\n        pdProcessId: undefined,\r\n        pdStartDate: undefined,\r\n        pdStopDate: undefined,\r\n        createTime: undefined,\r\n        updateTime: undefined\r\n      },\r\n      product_extra: {\r\n        typeRegion: '',\r\n        pdPayFreq: []\r\n      },\r\n      form_count: {\r\n        pdVerId: '',\r\n        operator: '',\r\n        pdType: '',\r\n        pdDefType: '',\r\n        pdInfoId: '',\r\n        pdCode: '',\r\n        pdName: '',\r\n        pdPremIds: [],\r\n        pdPremId:'',\r\n        pdPremCode: '',\r\n        pdPremCodes:[],\r\n        pdCmpnRange: [],\r\n        pdCmpnType: '',\r\n        cmpnInfoId: '',\r\n        pdCmpnCode: '',\r\n        pdCmpnOrder: '',\r\n        pdCmpnCalcMode: '',\r\n        pdCmpnVal: '',\r\n        pdCmpnCalcCode: '',\r\n        pdCmpnDesc: ''\r\n      },\r\n      form_defAdd: {},\r\n      form_def: {\r\n        id: undefined,\r\n        pdInfoId: undefined,\r\n        pdVerId: undefined,\r\n        pdCode: '',\r\n        pdName: '',\r\n        operator: '',\r\n        pdPayName: '',\r\n        pdPremCode: '',\r\n        pdPremCalMode: 'G',\r\n        pdPremZeroFlag: 'Y',\r\n        pdPremReclFlag: 'N',\r\n        pdUrgePayFlag: 'Y',\r\n        pdPayStartPeriod: undefined,\r\n        pdPayStartPerUnit: 'Y',\r\n        pdPayStartCalRule: '',\r\n        pdPayStartCalMode: '',\r\n        pdPayEndPeriod: undefined,\r\n        pdPayEndUnit: 'Y',\r\n        pdPayEndCalRule: '',\r\n        pdPayEndCalMode: '',\r\n        pdAddPremMode: '',\r\n        pdPayAccKind: '',\r\n        pdRateChangeFlag: 'N',\r\n        pdPremAddFlag: 'N',\r\n        pdPremStartFlag: 'N',\r\n        pdCharPremRel: 'N',\r\n        pdPremAccRela: 'N',\r\n        pdPremCalcCode: '',\r\n        pdPayFrequency:'',\r\n        pdPayDateValue:''\r\n      },\r\n      form_addition: {\r\n        id: undefined,\r\n        pdPremId: undefined,\r\n        pdVerId: undefined,\r\n        operator: '',\r\n        pdExtPremCode: '',\r\n        pdExtPremName: '',\r\n        pdPremName: '',\r\n        pdPremCode: '',\r\n        pdExtPremObj: '',\r\n        pdExtPremMode: '',\r\n        pdExtPremType: '',\r\n        pdMaxVal: undefined,\r\n        pdExtPremCalcCode: '',\r\n        createTime: undefined,\r\n        updateTime: undefined\r\n      },\r\n      form_addition_add: {\r\n        id: undefined,\r\n        pdPremId: [],\r\n        pdExtPremObj: [],\r\n        pdExtPremMode: [],\r\n        pdExtPremType: [],\r\n        pdExtPremCalcCode: ''\r\n      },\r\n      pageFlag: {\r\n        tableVisible_def: true,\r\n        dialogVisible_additionType: false,\r\n        dialogVisible_queryResult: false,\r\n        additionFlag: false\r\n      },\r\n      displayName_additionType: '',\r\n      isFixed: false,\r\n      fixedClassName: '',\r\n      offsetTop: undefined,\r\n      filters: {\r\n        pdAddPremMode: [],\r\n        pdPremCalMode: [],\r\n        pdPayAccKind: []\r\n      },\r\n      rules: {\r\n        pdPayEndPeriod: [{\r\n          required: true,\r\n          message: this.$t('pay_def.message.please_enter') + this.$t('i18nView.payTerm'),\r\n          trigger: 'blur'\r\n        }],\r\n        pdPayName: [{\r\n          required: true,\r\n          message: this.$t('pay_def.message.please_enter') + this.$t('pay_def.pay_name'),\r\n          trigger: 'blur'\r\n        }],\r\n\r\n        pdPremCalMode: [{\r\n          required: true,\r\n          message: this.$t('pay_def.message.please_enter') + this.$t('pay_def.pay_calc_method'),\r\n          trigger: 'change'\r\n        }],\r\n        pdExtPremName:[{required: true, message: \"请输入加费名称\", trigger: 'blur'}],\r\n        pdPremId: [{required: true, message: \"请选择加费对象\", trigger: 'blur'}],\r\n        pdPremIds: [{required: true, message: \"请选择加费对象\", trigger: 'blur'}],\r\n        pdExtPremObj: [{required: true, message: \"请选择加费对象\", trigger: 'blur'}],\r\n        pdExtPremMode: [{required: true, message: \"请选择加费方式\", trigger: 'blur'}],\r\n        pdExtPremType: [{required: true, message: \"请选择加费类型\", trigger: 'blur'}],\r\n      },\r\n      rules1:{\r\n        pdPayFreq: [{\r\n          required: true,\r\n          message: this.$t('pay_def.message.please_enter') + this.$t('pay_def.pay_frequency'),\r\n          trigger: 'blur'\r\n        }],\r\n      },\r\n      rules_count: {\r\n        pdPremId: [{\r\n          required: true,\r\n          message: this.$t('pay_def.message.please_enter') + this.$t('pay_def.pay_name'),\r\n          trigger: 'blur'\r\n        }],\r\n        pdCmpnRange: [{\r\n          type: 'array',\r\n          required: true,\r\n          message: this.$t('pay_def.message.please_enter') + this.$t('pay_def.pay_discount_range'),\r\n          trigger: 'change'\r\n        }],\r\n        pdCmpnType: [{\r\n          required: true,\r\n          message: this.$t('pay_def.message.please_enter') + this.$t('pay_def.pay_discount_type'),\r\n          trigger: 'blur'\r\n        }],\r\n        pdCmpnOrder: [{\r\n          required: true,\r\n          message: this.$t('pay_def.message.please_enter') + this.$t('pay_def.pay_discount_order'),\r\n          trigger: 'blur'\r\n        }],\r\n        pdCmpnCalcMode: [{\r\n          required: true,\r\n          message: this.$t('pay_def.message.please_enter') + this.$t('pay_def.pay_calc_method'),\r\n          trigger: 'change'\r\n        }]\r\n      },\r\n      rules_quick: {\r\n        finelinesRegion: [{\r\n          required: true,\r\n          message: this.$t('form.please_select') + this.$t('pay_def.finelinesRegion'),\r\n          trigger: 'change'\r\n        }],\r\n      }\r\n    }\r\n  },\r\n  components: {\r\n    premAmountFormula,\r\n    premAmountFormulaSelect,\r\n    premRules,\r\n    premRulesSelect,\r\n    pdDiscountFormula,\r\n    pdDiscountFormulaSelect,\r\n    guide\r\n  },\r\n  async created() {\r\n\r\n    this.initProductQueryData()\r\n\r\n    this.showPageFlag = this.$route.query.showPageFlag\r\n    await this.init();\r\n    this.productCalcRevisionShowINfo = this.$route.query.productCalcRevisionShowINfo === 'true'\r\n    if (!this.productCalcRevisionShowINfo){\r\n      this.form_def.pdPremAddFlag = 'Y'\r\n      this.form_def.pdPayStartCalMode = '0'\r\n      this.form_def.pdPayStartCalRule = 'S'\r\n      this.form_def.pdPayEndCalMode = '0'\r\n      this.form_def.pdPayEndCalRule = 'S'\r\n      this.form_def.pdPayDateValue = '1'\r\n      this.$refs.page_def.buildData().then(() => {\r\n        this.$refs.page_addition.buildData().then(() =>{\r\n          // 带入需要查看的信息\r\n          if (this.premiumCode) {\r\n            let flag = false\r\n            for (const premium of this.defTableData) {\r\n              if (premium.pdPremCode === this.premiumCode) {\r\n                flag = true\r\n                this.selectedDef = premium\r\n                this.selectedDefChanged()\r\n                this.form_def.pdPremAddFlag = 'Y'\r\n                break\r\n              }\r\n            }\r\n          }\r\n        })\r\n      })\r\n    }else {\r\n        this.discountClick();\r\n        this.selectDiscountRangeTable()\r\n        this.form_def.pdPremAddFlag = 'Y'\r\n        this.$refs.page_def.buildData().then(() => {\r\n            this.$refs.page_addition.buildData().then(() =>{\r\n                // 带入需要查看的信息\r\n                if (this.premiumCode) {\r\n                    let flag = false\r\n                    for (const premium of this.defTableData) {\r\n                        if (premium.pdPremCode === this.premiumCode) {\r\n                            flag = true\r\n                            this.selectedDef = premium\r\n                            this.selectedDefChanged()\r\n                            this.form_def.pdPremAddFlag = 'Y'\r\n                            break\r\n                        }\r\n                    }\r\n                }\r\n            })\r\n        })\r\n    }\r\n  },\r\n  mounted() {\r\n    // 吸顶效果\r\n    window.addEventListener('scroll', this.initHeight);\r\n    this.$nextTick(() => {\r\n      this.offsetTop = document.querySelector('#table_def').offsetTop;\r\n    })\r\n\r\n  },\r\n  destroyed() {\r\n    window.removeEventListener('scroll', this.handleScroll)\r\n  },\r\n  computed: {\r\n    ...mapGetters([\r\n      'ldcodes',\r\n      'sidebar'\r\n    ])\r\n  },\r\n  watch: {\r\n    'form_def.pdPayEndPeriod'() {\r\n      const valTime = this.form_def.pdPayEndPeriod;\r\n      if (valTime) {\r\n        if (!this.form_def.pdPayEndUnit) {\r\n          this.form_def.pdPayEndUnit = 'Y'\r\n        }\r\n      }\r\n    },\r\n    'form_def.pdPayStartPeriod'() {\r\n      const valTime = this.form_def.pdPayStartPeriod;\r\n      if (valTime) {\r\n        if (!this.form_def.pdPayStartPerUnit) {\r\n          this.form_def.pdPayStartPerUnit = 'Y'\r\n        }\r\n      }\r\n    },\r\n    'form_addition_add.pdExtPremType'() {\r\n      this.displayName_additionType = ''\r\n      const additionTypeList_selected = this._.filter(this.ldcodes['pd_prem_addition_type'], function (additionType) {\r\n        return _this.isInArray(additionType.code, _this.form_addition_add.pdExtPremType);\r\n      })\r\n      if (additionTypeList_selected && additionTypeList_selected.length > 0) {\r\n        additionTypeList_selected.forEach((additionType, index) => {\r\n          if (index === 0) {\r\n            this.displayName_additionType += additionType.codename\r\n          } else {\r\n            this.displayName_additionType += ', ' + additionType.codename\r\n          }\r\n        })\r\n      } else {\r\n        this.displayName_additionType = ''\r\n      }\r\n    },\r\n    'quickTableData'(){\r\n      if (this.quickTableData.length > 0) {\r\n        this.quickfilterHandlerList0 = [];\r\n        this.quickfilterHandlerList1 = [];\r\n        this.quickfilterHandlerList2 = [];\r\n        this.quickfilterHandlerList3 = [];\r\n        this.quickTableData.forEach(val => {\r\n          this.quickfilterHandlerList0.push({\r\n            text: val.pdPremCode,\r\n            value: val.pdPremCode\r\n          });\r\n          this.quickfilterHandlerList1.push({\r\n            text: val.pdRateChangeFlag,\r\n            value: val.pdRateChangeFlag\r\n          });\r\n          this.quickfilterHandlerList2.push({\r\n            text: val.pdPremAccRela,\r\n            value: val.pdPremAccRela\r\n          });\r\n          this.quickfilterHandlerList3.push({\r\n            text: val.pdPremAddFlag,\r\n            value: val.pdPremAddFlag\r\n          });\r\n        });\r\n      }\r\n      this.quickfilterHandlerList0 = this.quickfilterHandlerList0.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n      this.quickfilterHandlerList1 = this.quickfilterHandlerList1.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n      this.quickfilterHandlerList2 = this.quickfilterHandlerList2.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n      this.quickfilterHandlerList3 = this.quickfilterHandlerList3.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n    },\r\n    defTableData() {\r\n      if (this.defTableData.length > 0) {\r\n        this.filterHandlerList0 = [];\r\n        this.filterHandlerList1 = [];\r\n        this.filterHandlerList2 = [];\r\n        this.filterHandlerList3 = [];\r\n        this.filterHandlerList4 = [];\r\n        this.defTableData.forEach(val => {\r\n          this.filterHandlerList0.push({\r\n            text: val.pdPremCode,\r\n            value: val.pdPremCode\r\n          });\r\n          this.filterHandlerList1.push({\r\n            text: val.pdRateChangeFlag,\r\n            value: val.pdRateChangeFlag\r\n          });\r\n          this.filterHandlerList2.push({\r\n            text: val.pdPremAccRela,\r\n            value: val.pdPremAccRela\r\n          });\r\n          this.filterHandlerList3.push({\r\n            text: val.pdPremAddFlag,\r\n            value: val.pdPremAddFlag\r\n          });\r\n          this.filterHandlerList4.push({\r\n            text: val.pdPayEndPeriod,\r\n            value: val.pdPayEndPeriod\r\n          });\r\n        });\r\n      }\r\n      this.filterHandlerList0 = this.filterHandlerList0.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n      this.filterHandlerList1 = this.filterHandlerList1.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n      this.filterHandlerList2 = this.filterHandlerList2.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n      this.filterHandlerList3 = this.filterHandlerList3.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n      this.filterHandlerList4 = this.filterHandlerList4.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n      if (this.tableCount == 0) {\r\n        if (this.defTableData.length === 1) {\r\n          this.$refs.defTableData.setCurrentRow(this.defTableData[0]);\r\n          this.selectedDef = this.defTableData[0]\r\n          this.selectedDefChanged();\r\n        }\r\n      } else {\r\n        this.$refs.defTableData.setCurrentRow(this.defTableData[0]);\r\n        this.selectedDef = this.defTableData[0]\r\n        this.selectedDefChanged();\r\n      }\r\n\r\n      this.params_addition.premiumList = this.defTableData\r\n      if (this.form_def.pdPremAddFlag === 'Y') {\r\n        this.$refs.page_addition.reload()\r\n      }\r\n    },\r\n    'discountTableData'() {\r\n      if (this.discountTableData.length == 1) {\r\n        this.selectedDiscount = this.discountTableData[0]\r\n        this.selectedDiscountChanged();\r\n      }\r\n      //获取优惠顺序\r\n      getMaxRangeOrder(this.buildRequestData({\"pdInfoId\": this.product.id})).then(res => {\r\n        this.configRangeLength = res.data;\r\n        this.form_count.pdCmpnOrder = res.data;\r\n      });\r\n      if (this.discountTableData.length > 0) {\r\n        this.filterDiscountCode=[];\r\n        this.pdCmpnRangeFilters = [];\r\n        this.pdCmpnTypeFilters = [];\r\n        this.discountTableData.forEach(val => {\r\n          this.filterDiscountCode.push({\r\n            text: val.pdPremCode,\r\n            value: val.pdPremCode\r\n          });\r\n          this.pdCmpnRangeFilters.push({\r\n            text: this.filter_pdCmpnRanges(val.pdCmpnRange),\r\n            value: val.pdCmpnRange\r\n          });\r\n          this.pdCmpnTypeFilters.push({\r\n            text: this.getCodeName('preferentialType', val.pdCmpnType),\r\n            value: val.pdCmpnType\r\n          });\r\n        });\r\n        //缴费编码\r\n        this.filterDiscountCode = this.filterDiscountCode.reduce(function (prev, element) {\r\n          if (!prev.find(el => el.text == element.text)) {\r\n            prev.push(element);\r\n          }\r\n          return prev;\r\n        }, []);\r\n        //优惠范围\r\n        this.pdCmpnRangeFilters = this.pdCmpnRangeFilters.reduce(function (prev, element) {\r\n          if (!prev.find(el => el.text == element.text)) {\r\n            prev.push(element);\r\n          }\r\n          return prev;\r\n        }, []);\r\n        //优惠类型\r\n        this.pdCmpnTypeFilters = this.pdCmpnTypeFilters.reduce(function (prev, element) {\r\n          if (!prev.find(el => el.text == element.text)) {\r\n            prev.push(element);\r\n          }\r\n          return prev;\r\n        }, []);\r\n      }\r\n    },\r\n    'sidebar.opened'() {\r\n      this.initHeight()\r\n    },\r\n    'additionTableData'() {\r\n      if (this.additionTableData.length > 0) {\r\n        this.filterpdExtPremNameList1 = [];\r\n        this.filterpdExtPremNameList2 = [];\r\n        this.additionTableData.forEach(val => {\r\n          this.filterpdExtPremNameList1.push({\r\n            text: val.pdExtPremName,\r\n            value: val.pdExtPremName\r\n          });\r\n          this.filterpdExtPremNameList2.push({\r\n            text: this.getCodeName('pd_prem_addition_type', val.pdExtPremType),\r\n            value: val.pdExtPremType\r\n          });\r\n        });\r\n      }\r\n      this.filterpdExtPremNameList1 = this.filterpdExtPremNameList1.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n      this.filterpdExtPremNameList2 = this.filterpdExtPremNameList2.reduce(function(prev, element) {\r\n        if (!prev.find(el => el.text == element.text)) {\r\n          prev.push(element);\r\n        }\r\n        return prev;\r\n      }, []);\r\n      this.selectedAddition = {}\r\n      this.resetFormAddition()\r\n      if (this.additionTableData.length ==1) {\r\n        this.selectedAddition = this.additionTableData[0]\r\n        this.selectedAdditionChanged();\r\n      }\r\n    },\r\n    'form_count.pdCmpnCalcMode'() {\r\n      const val = this.form_count.pdCmpnCalcMode\r\n      if (val === '1') {\r\n        this.form_count.pdCmpnCalcCode = ''\r\n      } else if (val === '2') {\r\n        this.form_count.pdCmpnVal = ''\r\n      }\r\n    },\r\n    'form_count.pdCmpnRange'(selectedCodes) {\r\n      if (selectedCodes.length === 0) {\r\n        for (const pdDiscount of this.pdDiscountRangeOptions) {\r\n          pdDiscount.disabled = false\r\n        }\r\n      } else {\r\n        if (this._.includes(selectedCodes, '000000')) {\r\n          for (const pdDiscount of this.pdDiscountRangeOptions) {\r\n            pdDiscount.disabled = pdDiscount.value !== '000000'\r\n          }\r\n        } else {\r\n          for (const pdDiscount of this.pdDiscountRangeOptions) {\r\n            pdDiscount.disabled = pdDiscount.value === '000000'\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    back2(){\r\n      this.$router.push({name: '产品公式订正主页', params: {}})\r\n    },\r\n    changePdCmpnCalcMode(){\r\n      //console.log(this.form_count.pdCmpnCalcMode)\r\n    },\r\n\r\n    bringInCalcCode(pdBussDetailType, pdBussId, calcCode) {\r\n      switch (pdBussDetailType) {\r\n        case '17':\r\n          for (const prem of this.defTableData) {\r\n            if (prem.id === Number(pdBussId)) {\r\n              this.$set(prem, 'pdPremCalcCode', calcCode)\r\n              break\r\n            }\r\n          }\r\n          if (this.form_def.id === Number(pdBussId)) {\r\n            this.form_def.pdPremCalcCode = calcCode\r\n          }\r\n          break\r\n        case '19':\r\n          for (const extPrem of this.additionTableData) {\r\n            if (extPrem.id === Number(pdBussId)) {\r\n              this.$set(extPrem, 'pdExtPremCalcCode', calcCode)\r\n              break\r\n            }\r\n          }\r\n          if (this.form_addition.id === Number(pdBussId)) {\r\n            this.form_addition.pdExtPremCalcCode = calcCode\r\n          }\r\n          break\r\n        case '40':\r\n          for (const discount of this.discountTableData) {\r\n            if (discount.id === Number(pdBussId)) {\r\n              this.$set(discount, 'pdCmpnCalcCode', calcCode)\r\n              break\r\n            }\r\n          }\r\n          if (this.form_count.id === Number(pdBussId)) {\r\n            this.form_count.pdCmpnCalcCode = calcCode\r\n          }\r\n          break\r\n        default:\r\n          break\r\n      }\r\n    },\r\n    discountClick() {\r\n      if (this.discountFlag === 'N') {\r\n        this.quickicon_discount = \"el-icon-arrow-down\"\r\n        this.discountFlag = 'Y'\r\n      } else {\r\n        this.quickicon_discount = \"el-icon-arrow-right\"\r\n        this.discountFlag = 'N'\r\n      }\r\n    },\r\n    //公式\r\n    goClicks(num1, num2) {\r\n      this.guaranteeDetails = num1;//业务大类\r\n      this.calculationFormulaType = num2;//业务细类\r\n      if (num2 === '19') {//加费\r\n        this.pdUwSiTypeOptions = this.selectedAddition.pdPremId + \":\" + this.selectedAddition.pdPremCode;\r\n        this.pdUwSiTypeDtOptions = this.selectedAddition.id + \":\" + this.selectedAddition.pdExtPremCode;\r\n      } else {//缴费\r\n        this.pdUwSiTypeOptions = this.selectedDef.id ? this.selectedDef.id + \":\" + this.selectedDef.pdPremCode : this.form_defAdd.id + \":\" + this.form_defAdd.pdPremCode\r\n        this.pdUwSiTypeDtOptions = ''\r\n      }\r\n      this.dialogShow.premAmountFormula = true;\r\n    },\r\n    getPdDiscountRange(val) {\r\n      this.pdDiscountRangeOptions = []\r\n      //添加全部选项\r\n      this.pdDiscountRangeOptions.push({\r\n        value: '000000',\r\n        label: '全部'\r\n      })\r\n      //添加缴费选项\r\n      for (const pdDisCount of this.defTableData) {\r\n        if (val.includes(pdDisCount.id)) {\r\n          this.pdDiscountRangeOptions.push({\r\n            value: pdDisCount.pdPremCode,\r\n            label: pdDisCount.pdPremCode + \":\" + pdDisCount.pdPayName\r\n          })\r\n        }\r\n      }\r\n      //添加加费选项\r\n      for (const pdDisCount of this.additionTableData) {\r\n        if (val.includes(pdDisCount.pdPremId)) {\r\n          this.pdDiscountRangeOptions.push({\r\n            value: pdDisCount.pdExtPremCode,\r\n            label: pdDisCount.pdExtPremCode + \"-\" + pdDisCount.pdExtPremName\r\n          })\r\n        }\r\n      }\r\n      //设置置灰属性\r\n      for (const pdDiscount of this.pdDiscountRangeOptions) {\r\n        this.$set(pdDiscount, 'disabled', false)\r\n      }\r\n    },\r\n    changeDialogVisible_formula(flag) {\r\n      if (flag === true) {\r\n        this.pdUwSiTypeOptions = this.pdtempPdBnft\r\n      }\r\n      this.dialogShow.premAmountFormula = flag\r\n    },\r\n    changeDialogVisible_formulaSelect(flag, guaranteeDetails, calculationFormulaType, prem, extPrem) {\r\n      if (flag === true) {\r\n        this.pdUwSiTypeOptions = prem\r\n        this.pdUwSiTypeDtOptions = extPrem\r\n        this.guaranteeDetails = guaranteeDetails\r\n        this.calculationFormulaType = calculationFormulaType\r\n      } else {\r\n        this.dialogShow.premAmountFormula = false\r\n        this.$nextTick(() => {\r\n          this.dialogShow.premAmountFormula = true\r\n        })\r\n      }\r\n      this.dialogShow.premAmountFormulaSelect = flag\r\n    },\r\n    changeDialogVisible_pdDiscountSelect(flag) {\r\n      this.dialogShow.pdDiscountFormulaSelect = flag\r\n      if (flag === false) {\r\n        this.dialogShow.pdDiscountFormula = false\r\n        this.$nextTick(() => {\r\n          this.dialogShow.pdDiscountFormula = true\r\n        })\r\n      }\r\n    },\r\n    filterHandler(value, row, column) {\r\n      if (column) {\r\n        const property = column[\"property\"];\r\n        return row[property] === value;\r\n      }\r\n    },\r\n    filterHandlerDiscount(value, row, column) {\r\n      if (column) {\r\n        const property = column[\"property\"];\r\n        return row[property] === value;\r\n      }\r\n    },\r\n    //规则\r\n    goRules(num1, num2) {\r\n      this.guaranteeDetails = num1;//业务大类\r\n      this.calculationFormulaType = num2;//业务细类\r\n      this.dialogRulesShow.premRules = true;\r\n      this.pdUwSiTypeOptions = this.form_def.id + \":\" + this.form_def.pdPremCode;\r\n    },\r\n    goPdDiscountSelect(num1, num2) {\r\n      this.guaranteeDetails = num1;//业务大类\r\n      this.calculationFormulaType = num2;//业务细类\r\n      this.dialogShow.pdDiscountFormula = true;\r\n      this.pdUwSiTypeOptions = this.form_def;\r\n      this.pdDisCount = this.form_count\r\n    },\r\n    filter_pdCmpnRanges(code) {\r\n      for (const def of _this.defTableData) {\r\n        if (def.pdPremCode === code) {\r\n          return def.pdPremCode + \":\" + def.pdPayName\r\n        }\r\n      }\r\n      for (const def of _this.additionTableData) {\r\n        if (def.pdExtPremCode === code) {\r\n          return def.pdExtPremCode + \":\" + def.pdExtPremName\r\n        }\r\n      }\r\n      return code\r\n    },\r\n    changeDialogVisible_rules(flag) {\r\n      if (flag === true) {\r\n        this.pdUwSiTypeOptions = this.pdtempPdBnft\r\n      }\r\n      this.dialogRulesShow.premRules = flag\r\n    },\r\n    changeDialogVisible_pdDiscount(flag) {\r\n      if (flag === true) {\r\n        this.pdUwSiTypeOptions = this.pdtempPdBnft\r\n      }\r\n      this.dialogShow.pdDiscountFormula = flag\r\n    },\r\n    changeDialogVisible_rulesSelect(flag, guaranteeDetails, calculationFormulaType, prem, extPrem) {\r\n      if (flag === true) {\r\n        this.pdUwSiTypeOptions = prem\r\n        this.pdUwSiTypeDtOptions = extPrem\r\n        this.guaranteeDetails = guaranteeDetails\r\n        this.calculationFormulaType = calculationFormulaType\r\n      }\r\n      this.dialogRulesShow.premRulesSelect = flag\r\n    },\r\n    // 页面初始化\r\n    init() {\r\n      this.getProductInfo();\r\n      this.init_filters();\r\n      this.init_pay_frequency();\r\n      this.selectDiscountRangeTable();\r\n      this.init_pay_date();\r\n      this.init_typeRegion();\r\n    },\r\n    getProductInfo() {\r\n      // 带入产品信息\r\n      this.product = this.getPdData()\r\n      this.params_currentProduct.eq_pdInfoId = this.product.id\r\n      this.form_def.pdInfoId = this.product.id\r\n      this.form_def.pdVerId = this.product.pdVerId\r\n      this.form_def.pdCode = this.product.pdCode\r\n      this.form_def.pdName = this.product.pdName;\r\n      this.params.finelinesRegion = this.getPdData().cType;\r\n    },\r\n    // 获取缴费频率\r\n    init_pay_frequency() {\r\n      const paramsMap = {\r\n        pd_info_id: this.params_currentProduct.eq_pdInfoId,\r\n        pd_atrs_code: 'payintv'\r\n      }\r\n      getPdAttrInfo(this.buildRequestData(paramsMap)).then(response => {\r\n        const pdTempAtrsList = response.data\r\n        this.product_extra.pdPayFreq = this._.map(pdTempAtrsList, 'pdAtrsVal');\r\n        this.pdPayFreqCopy = this._.map(pdTempAtrsList, 'pdAtrsVal');\r\n        console.log(\"AAAAAAAAAAAAAAAAAAAA\", this.pdPayFreqCopy);\r\n      })\r\n    },\r\n    //获取产品分类标记表信息催缴标记\r\n    init_typeRegion() {\r\n      const paramsMap = {\r\n        pd_info_id: this.params_currentProduct.eq_pdInfoId,\r\n        pd_cls_type: '2'\r\n      }\r\n      getPdClsLabInfo(this.buildRequestData(paramsMap)).then(response => {\r\n        const pdTempClsLabList = response.data\r\n        const pdCls6Array = this._.map(pdTempClsLabList, 'pdCls6')\r\n        if (pdCls6Array.length > 0) {\r\n          this.form_def.pdUrgePayFlag = pdCls6Array[0]\r\n        }\r\n      })\r\n    },\r\n    //获取缴费期间\r\n    init_pay_date(){\r\n      const payMap = {\r\n        pd_info_id: this.params_currentProduct.eq_pdInfoId\r\n      }\r\n      getPayDate(this.buildRequestData(payMap)).then(response => {\r\n        this.form_def.pdPayEndPeriod = response.data.pdPayPeriod\r\n      })\r\n    },\r\n    // 初始化筛选器\r\n    init_filters() {\r\n      let ldcode_pdPremCalMode = this.ldcodes['pd_prem_cal_method']\r\n      let ldcode_pdAddPremMode = this.ldcodes['pd_prem_addition_mode']\r\n      let ldcode_pdPayAccKind = this.ldcodes['pd_prem_account_type']\r\n      if (ldcode_pdPremCalMode instanceof Array) {\r\n        for (const item of ldcode_pdPremCalMode) {\r\n          this.filters.pdPremCalMode.push({text: item.codename, value: item.code})\r\n        }\r\n      }\r\n      if (ldcode_pdAddPremMode instanceof Array) {\r\n        for (const item of ldcode_pdAddPremMode) {\r\n          this.filters.pdAddPremMode.push({text: item.codename, value: item.code})\r\n        }\r\n      }\r\n      if (ldcode_pdPayAccKind instanceof Array) {\r\n        for (const item of ldcode_pdPayAccKind) {\r\n          this.filters.pdPayAccKind.push({text: item.codename, value: item.code})\r\n        }\r\n      }\r\n    },\r\n    filter_pdPremCalMode(value, row) {\r\n      return row.pdPremCalMode === value;\r\n    },\r\n    filter_pdAddPremMode(value, row) {\r\n      return row.pdAddPremMode === value;\r\n    },\r\n    filter_pdPayAccKind(value, row) {\r\n      return row.pdPayAccKind === value;\r\n    },\r\n    initHeight() {\r\n      let scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop\r\n      this.isFixed = this.form_def.pdPremAddFlag === 'Y' && scrollTop > this.offsetTop + 130\r\n      this.fixedClassName = this.getFixedClassName()\r\n    },\r\n    getFixedClassName() {\r\n      const opened = this.sidebar.opened\r\n      if (this.isFixed === true) {\r\n        if (opened === true) {\r\n          return 'is_fixed_sidebarOpened'\r\n        } else {\r\n          return 'is_fixed_sidebarClosed'\r\n        }\r\n      } else {\r\n        return ''\r\n      }\r\n    },\r\n    initProductQueryData(){\r\n      this.filterProductByNode(this,'1')\r\n    },\r\n    selectedDetailTypeChanged(val) {\r\n      this.params.eq_pdInfoId = ''\r\n      val === ''?  this.initProductQueryData() : this.filterProductByCategory(this,val)\r\n    },\r\n    handleSearchInAllPremium() {\r\n      this.$refs.form_quick.validate(pass => {\r\n        if (pass) {\r\n          this.params.firstOpenPageFlag = 'N'\r\n          this.params.byPage = 'Y'\r\n          this.$refs.page_quick.reload()\r\n        }\r\n      })\r\n    },\r\n    copyPremiumToCurrentProduct(row) {\r\n      let add = {}\r\n      Object.assign(add, row)\r\n      // 清除带入的主键，使后台执行新增而不是更新\r\n      add.id = undefined\r\n      // 使用当前产品信息覆盖原有产品信息\r\n      add.pdInfoId = this.product.id\r\n      add.pdCode = this.product.pdCode\r\n      add.pdName = this.product.pdName\r\n      add.pdVerId = this.product.pdVerId\r\n      const data = {\r\n        premium: add\r\n      }\r\n      addPdtempPdPrem(data).then(() => {\r\n        this.$refs.page_def.buildData().then(() => {\r\n          this.$emit('childFn', true);\r\n          this.notifySuccess(this.$t('successMessage.add'))\r\n          this.selectedDefInQueryResult = {}\r\n        })\r\n      })\r\n    },\r\n    bringIntoFormDef() {\r\n      this.resetFormDef()\r\n      Object.assign(this.form_def, this.selectedDefInQueryResult)\r\n      // 清除带入的主键，表示这是新增而不是更新\r\n      this.form_def.id = undefined\r\n      // 使用当前产品信息覆盖原有产品信息\r\n      this.form_def.pdInfoId = this.product.id\r\n      this.form_def.pdVerId = this.product.pdVerId\r\n      this.form_def.pdCode = this.product.pdCode\r\n      this.form_def.pdName = this.product.pdName\r\n      if (!this.selectedDef.pdPremZeroFlag) {\r\n        this.form_def.pdPremZeroFlag = 'N'\r\n      }\r\n      if (!this.selectedDef.pdUrgePayFlag) {\r\n        this.form_def.pdUrgePayFlag = 'Y'\r\n      }\r\n      if (!this.selectedDef.pdCharPremRel) {\r\n        this.form_def.pdCharPremRel = 'N'\r\n      }\r\n      this.params_addition.premiumList = [this.selectedDef]\r\n      if (this.$refs.page_addition) {\r\n        this.$refs.page_addition.reload()\r\n      }\r\n      this.selectedDefInQueryResult = {}\r\n    },\r\n    handleSearchInCurrentProduct() {\r\n      this.$refs.page_def.reload()\r\n    },\r\n    //初始化缴费优惠表格\r\n    selectDiscountRangeTable() {\r\n      this.discountTableData = []\r\n      selectDiscountRangeByPdInfoId(this.buildRequestData({\"pdInfoId\": this.product.id})).then(res => {\r\n        this.discountTableData = res.data\r\n        this.getOrderNumber('addition_discount')\r\n        if (this.flag1 == 1){\r\n          for (let i = 0; i< this.discountTableData.length; i ++){\r\n            if (i = this.discountTableData.length - 1){\r\n              this.form_count.pdCmpnCalcCode = this.discountTableData[i].pdCmpnCalcCode\r\n            }\r\n          }\r\n        }\r\n      })\r\n    },\r\n    rowClick_quick(row, column, event) {\r\n      if (event.target.nodeName === \"INPUT\") {\r\n        if (row.id === this.selectedDefInQueryResult.id) {\r\n          this.selectedDefInQueryResult = {}\r\n          this.resetFormDef()\r\n        }\r\n      }\r\n    },\r\n    rowClick_def(row, column, event) {\r\n      if (event.target.nodeName === \"INPUT\") {\r\n        if (row.id === this.selectedDef.id) {\r\n          this.cancelUpdateDef();\r\n          this.init_pay_date();\r\n          this.form_def.pdPayStartCalMode = '0'\r\n          this.form_def.pdPayStartCalRule = 'S'\r\n          this.form_def.pdPayEndCalMode = '0'\r\n          this.form_def.pdPayEndCalRule = 'S'\r\n          this.form_def.pdPayDateValue = '1'\r\n        }\r\n      }\r\n    },\r\n    selectedDefChanged() {\r\n      this.resetFormDef()\r\n      Object.assign(this.form_def, this.selectedDef)\r\n      this.payDateForm.payDateTable = JSON.parse(JSON.stringify(this.form_def.pdtempPdPremPeriodList))\r\n      if (!this.selectedDef.pdPremZeroFlag) {\r\n        this.form_def.pdPremZeroFlag = 'N'\r\n      }\r\n      if (!this.selectedDef.pdUrgePayFlag) {\r\n        this.form_def.pdUrgePayFlag = 'Y'\r\n      }\r\n      if (!this.selectedDef.pdCharPremRel) {\r\n        this.form_def.pdCharPremRel = 'N'\r\n      }\r\n\r\n      if (this.selectedDef.pdPayStartCalRule || this.selectedDef.pdPayStartCalMode || this.selectedDef.pdPayStartPeriod){\r\n        this.form_def.pdPremStartFlag='Y'\r\n      }\r\n\r\n      this.params_addition.premiumList = [this.selectedDef]\r\n\r\n      var arr = this.form_def.pdPayFrequency;\r\n      if (arr){\r\n        this.product_extra.pdPayFreq = eval('(' + arr + ')');\r\n      }else {\r\n        this.product_extra.pdPayFreq=[]\r\n      }\r\n      if (this.$refs.page_addition) {\r\n        this.$refs.page_addition.reload()\r\n      }\r\n\r\n    },\r\n    cancelUpdateDef() {\r\n      this.resetFormDef()\r\n      this.selectedDef = {}\r\n      this.params_addition.premiumList = this.defTableData\r\n      if (this.$refs.page_addition) {\r\n        this.$refs.page_addition.reload()\r\n      }\r\n    },\r\n    handleAddDef() {\r\n      this.$refs.form_def.validate(pass => {\r\n        this.$refs.product_extra.validate(pass2 => {\r\n          if (pass && pass2) {\r\n            this.$refs.ruleForm1.validate(val => {\r\n              if (val) {\r\n                if (!this.product_extra.pdPayFreq.every(val => this.pdPayFreqCopy.includes(val))) {\r\n                  this.notifyError(\"缴费频率不可超过产品缴费范围\")\r\n                  return;\r\n                }\r\n                if (!this.payDateForm.payDateTable.length) {\r\n                  this.notifyError(\"请录入至少一条缴费期间\")\r\n                  return;\r\n                }\r\n                if (this.additionTableData.length != 0) {\r\n                  this.form_def.pdPremAddFlag = 'Y'\r\n                } else {\r\n                  this.form_def.pdPremAddFlag = 'N'\r\n                }\r\n                if (this.form_def.pdPayStartPeriod == undefined) {\r\n                  this.form_def.pdPayStartPerUnit = undefined\r\n                }\r\n                if (this.form_def.pdPayEndPeriod == undefined) {\r\n                  this.form_def.pdPayEndUnit = undefined\r\n                }\r\n                this.form_def.pdPayFrequency = this.product_extra.pdPayFreq;\r\n                // 清除带入的主键，使后台执行新增而不是更新\r\n                this.form_def.id = undefined\r\n                this.form_def.pdPremStartFlag = '';\r\n                const data = {\r\n                  premium: this.form_def,\r\n                  payDateTable: this.payDateForm.payDateTable\r\n                }\r\n                addPdtempPdPrem(data).then(response => {\r\n                  // this.form_defAdd = response.data\r\n                  this.form_defAdd = {};\r\n                  this.$refs.page_def.buildData().then(() => {\r\n                    this.resetFormDef()\r\n                    this.$emit('childFn', true);\r\n                    this.notifySuccess(this.$t('successMessage.add'))\r\n                  })\r\n                  this.tableCount++;\r\n                  this.$nextTick(() => {\r\n                    this.selectedRow();\r\n                  })\r\n                })\r\n              }\r\n            })\r\n\r\n          } else {\r\n            this.notifyError(this.$t('pay_def.message.form_validation_failed'))\r\n          }\r\n        })\r\n      })\r\n    },\r\n    handleUpdateDef() {\r\n      this.$refs.form_def.validate(pass => {\r\n        if (pass) {\r\n          this.$refs.ruleForm1.validate(val=>{\r\n            if(val){\r\n            if(!this.product_extra.pdPayFreq.every(val => this.pdPayFreqCopy.includes(val))){\r\n            this.notifyError(\"缴费频率不可超过产品缴费范围\")\r\n            return;\r\n          }\r\n          var idRow = this.form_def.id;\r\n          this.form_def.pdPayFrequency = this.product_extra.pdPayFreq;\r\n          this.form_def.pdPremStartFlag ='';\r\n          let pdtempPdPrem = this.form_def;\r\n          let pdtempPdPremPeriods = [];\r\n          if(this.payDateForm.payDateTable.length){\r\n            this.payDateForm.payDateTable.forEach(val=>{\r\n            pdtempPdPremPeriods.push({\r\n            pdPayStartPeriod:val.pdPayStartPeriod,\r\n            pdPayStartPerUnit:val.pdPayStartPerUnit,\r\n            pdPayEndPeriod:val.pdPayEndPeriod,\r\n            pdPayEndUnit:val.pdPayEndUnit\r\n          })\r\n          })\r\n          }\r\n          let data = {\r\n            pdtempPdPrem,\r\n            pdtempPdPremPeriods\r\n          }\r\n          updatePdtempPdPrem(this.buildRequestData(data)).then(res => {\r\n            this.$refs.page_def.buildData().then(() => {\r\n              this.resetFormDef()\r\n              this.selectedDef = {}\r\n              this.$emit('childFn', true);\r\n              this.notifySuccess(res.message)\r\n              this.$nextTick(() => {\r\n                this.selectedRow(idRow);\r\n              })\r\n            })\r\n          })\r\n\r\n            }\r\n          })\r\n\r\n\r\n        }\r\n      })\r\n    },\r\n\r\n    //选中缴费修改项\r\n    selectedRow(id) {\r\n      this.$refs.page_def.buildData().then(() => {\r\n        if (id) {\r\n          var idRow = id;\r\n          let num = 0;\r\n          for (num = 0; num < this.defTableData.length; num++) {\r\n            if (this.defTableData[num].id === idRow) {\r\n              this.$refs.defTableData.setCurrentRow(this.defTableData[num]);\r\n              this.selectedDef = this.defTableData[num]\r\n              this.selectedDefChanged();\r\n              break;\r\n            }\r\n          }\r\n        } else {\r\n          this.$refs.defTableData.setCurrentRow(this.defTableData[0]);\r\n          this.selectedDef = this.defTableData[0]\r\n          this.selectedDefChanged();\r\n        }\r\n      })\r\n    },\r\n    handleDeleteDef(row) {\r\n      deletePdtempPdPrem(row.id).then(() => {\r\n        if (row.pdPremCode === this.form_defAdd.pdPremCode) {\r\n          this.form_defAdd = {}\r\n        }\r\n        // 删除加费动态表格中属于该条缴费的加费\r\n        for (let i = 0; i < this.additionAddTableData.length; i++) {\r\n          let additionAdd = this.additionAddTableData[i]\r\n          if (additionAdd.pdPremId === this.selectedDef.id) {\r\n            this.additionAddTableData.splice(i, 1)\r\n            i--\r\n          }\r\n        }\r\n        let operationFlag\r\n        if (this._.includes(this.defTableData, this.selectedDef)) {\r\n          if (this.defTableData.length === 1 && this.$refs.page_def.page > 1) {\r\n            this.$refs.page_def.page -= 1\r\n          }\r\n          operationFlag = 'buildData'\r\n        } else {\r\n          operationFlag = 'reload'\r\n        }\r\n        switch (operationFlag) {\r\n          case 'buildData':\r\n            this.$refs.page_def.buildData().then(() => {\r\n              this.resetFormDef()\r\n              this.selectedDef = {}\r\n              this.notifySuccess(this.$t('successMessage.delete'))\r\n            })\r\n            break\r\n          case 'reload':\r\n            this.$refs.page_def.reload().then(() => {\r\n              this.resetFormDef()\r\n              this.selectedDef = {}\r\n              this.notifySuccess(this.$t('successMessage.delete'))\r\n            })\r\n            break\r\n        }\r\n      })\r\n    },\r\n    rowClick_addition(row, column, event) {\r\n      if (event.target.nodeName === \"INPUT\") {\r\n        if (row.id === this.selectedAddition.id) {\r\n          this.cancelUpdateAddition()\r\n        }\r\n      }\r\n    },\r\n    rowClick_discount(row, column, event) {\r\n      if (event.target.nodeName === \"INPUT\") {\r\n        if (row.id === this.selectedDiscount.id) {\r\n          this.selectedDiscount = {}\r\n          this.resetDiscountForm()\r\n        }\r\n      }\r\n    },\r\n    selectedAdditionChanged() {\r\n      this.resetFormAddition()\r\n      Object.assign(this.form_addition, this.selectedAddition)\r\n    },\r\n    selectedDiscountChanged() {\r\n      this.resetDiscountForm()\r\n      Object.assign(this.form_count, this.selectedDiscount)\r\n      this.form_count.pdPremIds = [this.selectedDiscount.pdPremId]\r\n      this.getPdDiscountRange([this.selectedDiscount.pdPremId])\r\n      //获取优惠范围\r\n      this.form_count.pdCmpnRange = [this.selectedDiscount.pdCmpnRange]\r\n    },\r\n    selectAllAdditionType() {\r\n      for (const additionType of this.ldcodes['pd_prem_addition_type']) {\r\n        this.form_addition_add.pdExtPremType.push(additionType.code)\r\n      }\r\n    },\r\n    handleAddAddition() {\r\n      this.$refs.form_addition_add.validate(pass => {\r\n        if (pass) {\r\n          if (this.form_addition_add.pdPremId.length === 0 || this.form_addition_add.pdExtPremObj.length === 0 || this.form_addition_add.pdExtPremMode.length === 0 || this.form_addition_add.pdExtPremType.length === 0) {\r\n            this.notifyError(this.$t('pay_def.message.error_incomplete_information'))\r\n            return\r\n          }\r\n          if (this.defTableData && this.defTableData.length > 0) {\r\n            // 验证选择的缴费信息是否全部有效\r\n            let paymentIds = this.form_addition_add.pdPremId\r\n            let paymentIds_available = this._.map(this.defTableData, 'id')\r\n            for (const paymentId of paymentIds) {\r\n              if (!this.isInArray(paymentId, paymentIds_available)) {\r\n                this.notifyError(this.$t('pay_def.message.error_unavailable_def'))\r\n                return\r\n              }\r\n            }\r\n            // 通过验证，开始创建\r\n            let array = this.buildArray(paymentIds, this.form_addition_add.pdExtPremObj, this.form_addition_add.pdExtPremMode, this.form_addition_add.pdExtPremType)\r\n            for (const arrayItem of array) {\r\n              this.form_addition = Object.assign({}, this.form_addition_add)\r\n              arrayItem.forEach((value, index) => {\r\n                if (index === 0) {\r\n                  this.form_addition.pdPremId = value\r\n                } else if (index === 1) {\r\n                  this.form_addition.pdExtPremObj = value\r\n                } else if (index === 2) {\r\n                  this.form_addition.pdExtPremMode = value\r\n                } else if (index === 3) {\r\n                  this.form_addition.pdExtPremType = value\r\n                }\r\n              })\r\n              // 为 payName 和 payCode 赋值\r\n              for (const def of this.defTableData) {\r\n                if (def.id === this.form_addition.pdPremId) {\r\n                  this.form_addition.pdPremName = def.pdPayName\r\n                  this.form_addition.pdPremCode = def.pdPremCode\r\n                  break\r\n                }\r\n              }\r\n              // 为 pdInfoId 赋值\r\n              this.form_addition.pdInfoId = this.product.id\r\n              // 为 pdCode 赋值\r\n              this.form_addition.pdCode = this.product.pdCode\r\n              // 为 pdVerId 赋值\r\n              this.form_addition.pdVerId = this.product.pdVerId\r\n              // 为 pdPremCalcCode 赋值\r\n              this.form_addition.pdExtPremCalcCode = this.form_addition_add.pdExtPremCalcCode\r\n              //为加费名称赋初始值\r\n              let pdAddPremObj = this.getCodeName('pdAddPremObj', this.form_addition.pdExtPremObj,true);\r\n              let pd_prem_addition_addition_mode = this.getCodeName('pd_prem_addition_addition_mode', this.form_addition.pdExtPremMode,true);\r\n              let pd_prem_addition_type = this.getCodeName('pd_prem_addition_type', this.form_addition.pdExtPremType,true);\r\n              this.$set(this.form_addition, 'pdExtPremName', pdAddPremObj+pd_prem_addition_addition_mode+pd_prem_addition_type)\r\n              this.additionAddTableData.push(this.form_addition)\r\n            }\r\n            this.getOrderNumber('addition_add')\r\n            this.resetFormAddition()\r\n            this.resetFormAdditionAdd()\r\n            this.notifySuccess(this.$t('successMessage.add'))\r\n          } else {\r\n            this.notifyError(this.$t('pay_def.message.error_def_no_define'))\r\n          }\r\n        }\r\n      })\r\n\r\n    },\r\n    buildArray(paymentIds, additionPayPersonTypes, additionModes, additionTypes) {\r\n      let array = []\r\n      let array_item = []\r\n      let array_paymentId = ''\r\n      let array_additionPayPersonType = ''\r\n      let array_additionMode = ''\r\n      let array_additionType = ''\r\n      for (const paymentId of paymentIds) {\r\n        array_paymentId = paymentId\r\n        for (const additionPayPersonType of additionPayPersonTypes) {\r\n          array_additionPayPersonType = additionPayPersonType\r\n          for (const additionMode of additionModes) {\r\n            array_additionMode = additionMode\r\n            for (const additionType of additionTypes) {\r\n              array_additionType = additionType\r\n              array_item.push(array_paymentId, array_additionPayPersonType, array_additionMode, array_additionType)\r\n              array.push(array_item)\r\n              array_item = []\r\n            }\r\n          }\r\n        }\r\n      }\r\n      return array\r\n    },\r\n    handleUpdateAddition() {\r\n      this.$refs.form_addition.validate(pass => {\r\n        if (pass) {\r\n          updatePdtempPdExtPrem(this.form_addition).then(() => {\r\n            this.$refs.page_addition.buildData().then(() => {\r\n              this.resetFormAddition()\r\n              this.selectedAddition = {}\r\n              this.notifySuccess(this.$t('successMessage.update'))\r\n            })\r\n          })\r\n        }\r\n      })\r\n    },\r\n    cancelUpdateAddition() {\r\n      this.resetFormAddition()\r\n      this.selectedAddition = {}\r\n    },\r\n    handleDeleteAddition(row) {\r\n      deletePdtempPdExtPrem(row.id).then(() => {\r\n        let operationFlag\r\n        if (this._.includes(this.additionTableData, this.selectedAddition)) {\r\n          if (this.additionTableData.length === 1 && this.$refs.page_addition.page > 1) {\r\n            this.$refs.page_addition.page -= 1\r\n          }\r\n          operationFlag = 'buildData'\r\n        } else {\r\n          operationFlag = 'reload'\r\n        }\r\n        switch (operationFlag) {\r\n          case 'buildData':\r\n            this.$refs.page_addition.buildData().then(() => {\r\n              this.resetFormAddition()\r\n              this.selectedAddition = {}\r\n              this.notifySuccess(this.$t('successMessage.delete'))\r\n            })\r\n            break\r\n          case 'reload':\r\n            this.$refs.page_addition.reload().then(() => {\r\n              this.resetFormAddition()\r\n              this.selectedAddition = {}\r\n              this.notifySuccess(this.$t('successMessage.delete'))\r\n            })\r\n            break\r\n        }\r\n      })\r\n    },\r\n    // 动态表格多选框\r\n    handleSelectionChange(val) {\r\n      this.selectedAdditionAdds = val\r\n    },\r\n    handleDeleteAdditionAdd(form_addition) {\r\n      this.additionAddTableData.splice(this.additionAddTableData.indexOf(form_addition), 1)\r\n      this.selectedAdditionAdds.splice(this.additionAddTableData.indexOf(form_addition), 1)\r\n      this.getOrderNumber('addition_add')\r\n      this.notifySuccess(this.$t('successMessage.delete'))\r\n    },\r\n    handleSaveAdditionAdd() {\r\n      let num = 0;\r\n      for (num = 0; num < this.selectedAdditionAdds.length; num++) {\r\n        if (!this.selectedAdditionAdds[num].pdExtPremName) {\r\n          this.notifyError(\"请输入加费名称\")\r\n          return\r\n        }\r\n        if (this.selectedAdditionAdds[num].pdExtPremMode == '01' && !this.selectedAdditionAdds[num].pdMaxVal) {\r\n          this.notifyError(\"请输入加费上限值\")\r\n          return\r\n        }\r\n      }\r\n      const params = {\r\n        extPremList: this.selectedAdditionAdds\r\n      }\r\n      addPdtempPdExtPrem(this.buildRequestData(params)).then(() => {\r\n        this.$refs.page_addition.buildData().then(() => {\r\n          for (const selectedAdditionAdd of this.selectedAdditionAdds) {\r\n            this.additionAddTableData.splice(this.additionAddTableData.indexOf(selectedAdditionAdd), 1)\r\n          }\r\n          this.selectedAdditionAdds = []\r\n          this.getOrderNumber('addition_add')\r\n          this.notifySuccess(this.$t('successMessage.save'))\r\n        })\r\n      })\r\n    },\r\n    async saveDisCount() {\r\n      this.$refs[\"form_count\"].validate(async valid1 => {\r\n        if (valid1) {\r\n          let param = {\r\n            pdCmpnType: this.form_count.pdCmpnType\r\n          };\r\n          await findCmpnCaleCode(this.buildRequestData(param)).then(response => {\r\n            this.$nextTick(() => {\r\n              if (response.data.length < 2 && response.data.length > 0 && this.form_count.pdCmpnCalcMode == 2) {\r\n                this.detailTypeOptionList = response.data;\r\n                for (const product of this.detailTypeOptionList) {\r\n                  if (product.cmpnCalcCode == null){\r\n                    this.form_count.pdCmpnCalcCode = '';\r\n                  }else {\r\n                    this.form_count.pdCmpnCalcCode = product.cmpnCalcCode;\r\n                  }\r\n                }\r\n              }else {\r\n                this.form_count.pdCmpnCalcCode = '';\r\n              }\r\n            })\r\n          });\r\n\r\n          let PdtempPdCmpnInfos = []\r\n          let pdCmpnRange = this.form_count.pdCmpnRange\r\n          if (this._.includes(pdCmpnRange, '000000')) {\r\n            pdCmpnRange = []\r\n            for (const pdDiscount of this.pdDiscountRangeOptions) {\r\n              if (pdDiscount.value !== '000000') {\r\n                pdCmpnRange.push(pdDiscount.value)\r\n              }\r\n            }\r\n          }\r\n          this.form_count.pdVerId = this.product.pdVerId\r\n          this.form_count.operator = this.product.operator\r\n          this.form_count.pdInfoId = this.product.id\r\n          this.form_count.pdCode = this.product.pdCode\r\n          this.form_count.pdName = this.product.pdName\r\n          //获取缴费编码\r\n          for (const def of _this.defTableData) {\r\n            if (this.form_count.pdPremIds.includes(def.id)) {\r\n              this.form_count.pdPremCodes.push(def.pdPremCode)\r\n            }\r\n          }\r\n          for (let i = 0; i < pdCmpnRange.length; i++) {\r\n            for(let j = 0; j < this.form_count.pdPremIds.length; j++){\r\n              let PdtempPdCmpnInfo = JSON.parse(JSON.stringify(this.form_count))\r\n              PdtempPdCmpnInfo.pdPremId = this.form_count.pdPremIds[j]\r\n              PdtempPdCmpnInfo.pdPremCode = this.form_count.pdPremCodes[j]\r\n              PdtempPdCmpnInfo.pdCmpnRange = pdCmpnRange[i]\r\n              PdtempPdCmpnInfos.push(PdtempPdCmpnInfo)\r\n            }\r\n\r\n          }\r\n          const data = {\r\n            PdtempPdCmpnInfos: PdtempPdCmpnInfos\r\n          }\r\n          this.flag1 = 1;\r\n          addPdtempPdCmpnInfo(this.buildRequestData(data)).then(res => {\r\n            this.$emit(\"childFn\", \"reload\");\r\n            if (res.code == 200) {\r\n              this.notifySuccess(res.message);\r\n              this.clearFormDiscount()\r\n              this.selectDiscountRangeTable();\r\n            }\r\n          });\r\n        } else {\r\n          this.focusItem()\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    updateDisCount() {\r\n      this.$refs[\"form_count\"].validate(valid1 => {\r\n        if (valid1) {\r\n          const PdtempPdCmpnInfo = JSON.parse(JSON.stringify(this.form_count))\r\n          PdtempPdCmpnInfo.pdCmpnRange = PdtempPdCmpnInfo.pdCmpnRange[0]\r\n          updatePdtempPdCmpnInfo(this.buildRequestData({\"PdtempPdCmpnInfo\": PdtempPdCmpnInfo})).then(() => {\r\n            this.$emit(\"childFn\", \"reload\")\r\n            this.notifySuccess(this.$t('successMessage.update'))\r\n            this.selectDiscountRangeTable();\r\n            this.selectedDiscount = {};\r\n            this.clearFormDiscount()\r\n          });\r\n        } else {\r\n          this.focusItem()\r\n        }\r\n      })\r\n    },\r\n    //选中折扣数据\r\n    selectedRowDiscount(eeid) {\r\n      var lid = eeid;\r\n      if (lid) {\r\n        let num = 0;\r\n        for (num = 0; num < this.discountTableData.length; num++) {\r\n          if (this.discountTableData[num].cmpnInfoId == lid) {\r\n            this.selectedDiscount = this.discountTableData[num]\r\n            this.selectedDiscountChanged();\r\n            break;\r\n          }\r\n        }\r\n      } else if (lid == undefined) {\r\n        this.selectedDiscount = this.discountTableData[this.discountTableData.length - 1]\r\n        this.selectedDiscountChanged();\r\n      }\r\n    },\r\n    deleteDisCount(row) {\r\n      deletePdtempPdCmpnInfo(row.id).then(res => {\r\n        this.$emit(\"childFn\", \"reload\");\r\n        if (res.code == 200) {\r\n          this.notifySuccess(res.message);\r\n          this.selectedDiscount = {};\r\n          this.resetDiscountForm();\r\n          this.selectDiscountRangeTable();\r\n        }\r\n      })\r\n    },\r\n    // 获取相同编号的数组\r\n    getOrderNumber(arrayName) {\r\n      let tableData\r\n      let orderIndexArr\r\n      if (arrayName === 'addition') {\r\n        tableData = this.additionTableData\r\n      } else if (arrayName === 'addition_add') {\r\n        tableData = this.additionAddTableData\r\n      } else if (arrayName === 'addition_discount') {\r\n        tableData = this.discountTableData\r\n      }\r\n      else {\r\n        return\r\n      }\r\n      orderIndexArr = []\r\n      // 按照 paymentId 排序，将 paymentId 相同的数据连在一起\r\n      tableData = this._.orderBy(tableData, 'pdPremId', 'asc')\r\n      if (arrayName === 'addition') {\r\n        this.additionTableData = tableData\r\n      } else if (arrayName === 'addition_add') {\r\n        this.additionAddTableData = tableData\r\n      }else if (arrayName === 'addition_discount') {\r\n        this.discountTableData=tableData\r\n      }\r\n      let orderObj = {}\r\n      tableData.forEach((element, index) => {\r\n        element.rowIndex = index\r\n        if (orderObj[element.pdPremId]) {\r\n          orderObj[element.pdPremId].push(index)\r\n        } else {\r\n          orderObj[element.pdPremId] = []\r\n          orderObj[element.pdPremId].push(index)\r\n        }\r\n      })\r\n      // 需要合并的行的index已经存在了同一个数组里，把这些数组存储到 this.orderIndexArr\r\n      for (let k in orderObj) {\r\n        orderIndexArr.push(orderObj[k])\r\n      }\r\n      if (arrayName === 'addition') {\r\n        this.orderIndexArr_addition = orderIndexArr\r\n      } else if (arrayName === 'addition_add') {\r\n        this.orderIndexArr_addition_add = orderIndexArr\r\n      }\r\n      else if (arrayName === 'addition_discount') {\r\n        this.orderIndexArr_addition_discount = orderIndexArr\r\n      }\r\n    },\r\n    // 合并单元格\r\n    objectSpanMethod_addition({row, column, rowIndex, columnIndex}) {\r\n      if (columnIndex === 2 || columnIndex === 3) {\r\n        for (let i = 0; i < this.orderIndexArr_addition.length; i++) {\r\n          let element = this.orderIndexArr_addition[i]\r\n          for (let j = 0; j < element.length; j++) {\r\n            let item = element[j]\r\n            if (rowIndex === item) {\r\n              if (j === 0) {\r\n                return {\r\n                  rowspan: element.length,\r\n                  colspan: 1\r\n                }\r\n              } else {\r\n                return {\r\n                  rowspan: 0,\r\n                  colspan: 0\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    },\r\n    objectSpanMethod_addition_add({row, column, rowIndex, columnIndex}) {\r\n      if (columnIndex === 2 || columnIndex === 3) {\r\n        for (let i = 0; i < this.orderIndexArr_addition_add.length; i++) {\r\n          let element = this.orderIndexArr_addition_add[i]\r\n          for (let j = 0; j < element.length; j++) {\r\n            let item = element[j]\r\n            if (rowIndex === item) {\r\n              if (j === 0) {\r\n                return {\r\n                  rowspan: element.length,\r\n                  colspan: 1\r\n                }\r\n              } else {\r\n                return {\r\n                  rowspan: 0,\r\n                  colspan: 0\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    },\r\n    //优惠表格合并\r\n    objectSpanMethod_discount({row, column, rowIndex, columnIndex}) {\r\n      if (columnIndex === 2 || columnIndex === 3) {\r\n        for (let i = 0; i < this.orderIndexArr_addition_discount.length; i++) {\r\n          let element = this.orderIndexArr_addition_discount[i]\r\n          for (let j = 0; j < element.length; j++) {\r\n            let item = element[j]\r\n            if (rowIndex === item) {\r\n              if (j === 0) {\r\n                return {\r\n                  rowspan: element.length,\r\n                  colspan: 1\r\n                }\r\n              } else {\r\n                return {\r\n                  rowspan: 0,\r\n                  colspan: 0\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    },\r\n    // 清空缴费定义表单\r\n    clearFormDef() {\r\n      const id = this.form_def.id;\r\n      const frequency = this.form_def.frequency\r\n      if (id) {\r\n        this.form_def.frequency = frequency\r\n        this.form_def = this.selectedDef\r\n        var arr = this.form_def.pdPayFrequency;\r\n        if (arr){\r\n          this.product_extra.pdPayFreq = eval('(' + arr + ')');\r\n        }else {\r\n          this.product_extra.pdPayFreq=[]\r\n        }\r\n      } else {\r\n        this.init_pay_frequency();\r\n        this.resetFormDef();\r\n        this.form_def.id = id\r\n        this.form_def.frequency = frequency\r\n        this.selectedDef = {}\r\n        this.form_def.pdPremAddFlag = 'Y'\r\n        this.form_def.pdPayStartCalMode = '0'\r\n        this.form_def.pdPayStartCalRule = 'S'\r\n        this.form_def.pdPayEndCalMode = '0'\r\n        this.form_def.pdPayEndCalRule = 'S'\r\n        this.form_def.pdPayDateValue = '1'\r\n        this.init_pay_date();\r\n      }\r\n    },\r\n    // 清空加费定义表单\r\n    clearFormAddition() {\r\n      this.selectedAdditionChanged();\r\n      /*      this.form_addition.pdExtPremName = ''\r\n            this.form_addition.pdExtPremObj = ''\r\n            this.form_addition.pdExtPremMode = ''\r\n            this.form_addition.pdExtPremType = ''\r\n            this.form_addition.pdMaxVal = undefined\r\n            this.form_addition.pdExtPremCalcCode = ''*/\r\n    },\r\n    clearFormDiscount() {\r\n     /* if (this.selectedDiscount.id) {\r\n        this.selectedDiscountChanged();\r\n      } else {}*/\r\n        this.selectedDiscount = {}\r\n        this.resetDiscountForm()\r\n    },\r\n    //重置优惠对象\r\n    resetDiscountForm() {\r\n      this.pdDiscountRangeOptions = [{\r\n        key: '000000',\r\n        value: '000000',\r\n        label: '全部',\r\n        disabled: true\r\n      }]\r\n      this.form_count = {\r\n        pdVerId: '',\r\n        operator: '',\r\n        pdType: '',\r\n        pdDefType: '',\r\n        pdInfoId: '',\r\n        pdCode: '',\r\n        pdName: '',\r\n        pdPremId: '',\r\n        pdPremCode: '',\r\n        pdPremCodes: [],\r\n        pdCmpnRange: [],\r\n        pdCmpnType: '',\r\n        cmpnInfoId: '',\r\n        pdCmpnCode: '',\r\n        pdCmpnOrder: this.configRangeLength,\r\n        pdCmpnCalcMode: '',\r\n        pdCmpnVal: '',\r\n        pdCmpnCalcCode: '',\r\n        pdCmpnDesc: ''\r\n      }\r\n      this.$nextTick(() => {\r\n        this.$refs.form_count.clearValidate()\r\n      })\r\n    },\r\n    // 重置缴费对象（相当于 new 了一个对象，具有解除双向绑定的效果）\r\n    resetFormDef() {\r\n      this.form_def = {\r\n        id: undefined,\r\n        pdInfoId: undefined,\r\n        pdVerId: undefined,\r\n        pdCode: '',\r\n        pdName: '',\r\n        operator: '',\r\n        pdPayName: '',\r\n        pdPremCode: '',\r\n        pdPremCalMode: 'G',\r\n        pdPremZeroFlag: 'Y',\r\n        pdPremReclFlag: 'N',\r\n        pdUrgePayFlag: 'Y',\r\n        pdPayStartPeriod: undefined,\r\n        pdPayStartPerUnit: 'Y',\r\n        pdPayStartCalRule: 'S',\r\n        pdPayStartCalMode: '0',\r\n        pdPayEndPeriod: undefined,\r\n        pdPayEndUnit: 'Y',\r\n        pdPayEndCalRule: 'S',\r\n        pdPayEndCalMode: '0',\r\n        pdAddPremMode: '',\r\n        pdPayAccKind: '',\r\n        pdCharPremRel: 'N',\r\n        pdRateChangeFlag: 'N',\r\n        pdPremAddFlag: 'N',\r\n        pdPremStartFlag: 'N',\r\n        pdPremAccRela: 'N',\r\n        pdPremCalcCode: '',\r\n        pdPayDateValue:'1'\r\n      }\r\n      this.form_def.pdInfoId = this.product.id\r\n      this.form_def.pdVerId = this.product.pdVerId\r\n      this.form_def.pdCode = this.product.pdCode\r\n      this.form_def.pdName = this.product.pdName\r\n      this.payDateForm = {\r\n        payDateTable:[],\r\n      },\r\n      this.$nextTick(() => {\r\n        this.$refs.form_def.clearValidate()\r\n      })\r\n    },\r\n    // 重置加费对象（相当于 new 了一个对象，具有解除双向绑定的效果）\r\n    resetFormAddition() {\r\n      this.form_addition = {\r\n        id: undefined,\r\n        pdPremId: undefined,\r\n        pdVerId: undefined,\r\n        operator: '',\r\n        pdExtPremCode: '',\r\n        pdExtPremName: '',\r\n        pdPremName: '',\r\n        pdPremCode: '',\r\n        pdExtPremObj: '',\r\n        pdExtPremMode: '',\r\n        pdExtPremType: '',\r\n        pdMaxVal: undefined,\r\n        pdExtPremCalcCode: '',\r\n        createTime: undefined,\r\n        updateTime: undefined\r\n      }\r\n      if (this.$refs.form_addition) {\r\n        this.$refs.form_addition.clearValidate()\r\n      }\r\n    },\r\n    // 重置临时加费对象（相当于 new 了一个对象，具有解除双向绑定的效果）\r\n    resetFormAdditionAdd() {\r\n      this.form_addition_add = {\r\n        id: undefined,\r\n        pdPremId: [],\r\n        pdExtPremObj: [],\r\n        pdExtPremMode: [],\r\n        pdExtPremType: [],\r\n        pdExtPremCalcCode: ''\r\n      }\r\n      if (this.$refs.form_addition_add) {\r\n        this.$refs.form_addition_add.clearValidate()\r\n      }\r\n    },\r\n    showAddFee(){\r\n      this.addFeeFlag =  !this.addFeeFlag\r\n    },\r\n    addPayRow(){\r\n      this.payDateForm.payDateTable.push({\r\n        pdPayEndPeriod:this.product.pdPayPeriod,\r\n        pdPayEndUnit:'Y',\r\n        pdPayStartPeriod:'0',\r\n        pdPayStartPerUnit:'Y'\r\n      })\r\n    },\r\n    delPayRow(index, row){\r\n      this.payDateForm.payDateTable.splice(index,1);\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n.input-with-select .el-input-group__append {\r\n  background-color: #fff;\r\n}\r\n\r\n\r\n\r\n.is_fixed_sidebarClosed {\r\n  position: fixed;\r\n  top: 0;\r\n  z-index: 98;\r\n  background: #ebebeb;\r\n  width: 81%;\r\n  padding: 10px;\r\n}\r\n\r\n.is_fixed_sidebarOpened {\r\n  position: fixed;\r\n  top: 0;\r\n  z-index: 98;\r\n  background: #ebebeb;\r\n  padding: 10px;\r\n  width: 74%;\r\n}\r\n\r\n.showDiv {\r\n  width: 90%;\r\n  height: 100%;\r\n  margin-top: -40px;\r\n  margin-left: -40px;\r\n  position: absolute;\r\n  background: #ffffff00;\r\n  z-index: 999;\r\n}\r\n\r\n.formtitle2 {\r\n  padding-top: 10px;\r\n  font-size: 20px;\r\n  font-weight: bold;\r\n}\r\n\r\n.divider {\r\n  background-color: black;\r\n  margin-left: 4px;\r\n}\r\n\r\n.payForm{\r\n  .el-form-item {\r\n    margin-bottom: 0px;\r\n  }\r\n}\r\n\r\n</style>\r\n"]}]}