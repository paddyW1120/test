{"remainingRequest":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\babel-loader\\lib\\index.js!D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\workflow\\deploy\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\workflow\\deploy\\index.vue","mtime":1609847107226},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\babel-loader\\lib\\index.js","mtime":1706753193796},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1706753190941}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyIpOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7Cgp2YXIgX3dvcmtmbG93ID0gcmVxdWlyZSgiQC9hcGkvd29ya2Zsb3cvd29ya2Zsb3ciKTsKCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCnZhciBfZGVmYXVsdCA9IHsKICBuYW1lOiAnd29ya2Zsb3cnLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBmaWxlTGlzdDogW10sCiAgICAgIHJ1bGVzOiB7CiAgICAgICAgdGVuYW50SWQ6IFt7CiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuJHQoJ3dvcmtmbG93LnNlbGVjdFRlbmFudCcpLAogICAgICAgICAgdHJpZ2dlcjogJ2NoYW5nZScKICAgICAgICB9XQogICAgICB9LAogICAgICBmb3JtOiB7CiAgICAgICAgdGVuYW50SWQ6ICcnCiAgICAgIH0sCiAgICAgIHRlbmFudE9wdGlvbnM6IFtdCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMuaW5pdFRlbmFudExpc3RzKCk7CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkge30sCiAgbWV0aG9kczogewogICAgaGFuZGxlQ2hhbmdlOiBmdW5jdGlvbiBoYW5kbGVDaGFuZ2UoZmlsZSwgZmlsZUxpc3QpIHsKICAgICAgLy/liKTmlq3mlofku7blpKflsI8KICAgICAgaWYgKHRoaXMuaGFuZGxlQmVmb3JlKGZpbGUsIGZpbGVMaXN0KSkgewogICAgICAgIHRoaXMuZmlsZUxpc3QgPSBmaWxlTGlzdDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmZpbGVMaXN0ID0gW107CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9LAogICAgaGFuZGxlQmVmb3JlOiBmdW5jdGlvbiBoYW5kbGVCZWZvcmUoZmlsZSwgZmlsZUxpc3QpIHsKICAgICAgdmFyIGlzQnBtbiA9IGZpbGUubmFtZS5pbmRleE9mKCcuYnBtbicpID4gMDsKICAgICAgdmFyIGlzTHQ1TSA9IGZpbGUuc2l6ZSAvIDEwMjQgLyAxMDI0IDw9IDU7CgogICAgICBpZiAoIWlzQnBtbikgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+WPquiDveaYryBicG1uIOagvOW8jyEnKTsKICAgICAgfQoKICAgICAgaWYgKCFpc0x0NU0pIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfkuIrkvKDmlofku7bkuI3og73otoXov4cgMTBNQiEnKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGlzQnBtbiAmJiBpc0x0NU07CiAgICB9LAogICAgaGFuZGxlUmVtb3ZlOiBmdW5jdGlvbiBoYW5kbGVSZW1vdmUoZmlsZSwgZmlsZUxpc3QpIHsKICAgICAgdGhpcy5maWxlTGlzdCA9IGZpbGVMaXN0OwogICAgfSwKICAgIGluaXRUZW5hbnRMaXN0czogZnVuY3Rpb24gaW5pdFRlbmFudExpc3RzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgKDAsIF93b3JrZmxvdy5nZXRBbGxUZW5hbnQpKCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgX3RoaXMudGVuYW50T3B0aW9ucyA9IFtdOwogICAgICAgIHZhciB0ZW5hbnRMaXN0ID0gcmVzLmRhdGE7CiAgICAgICAgdGVuYW50TGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICBfdGhpcy50ZW5hbnRPcHRpb25zLnB1c2goewogICAgICAgICAgICAndmFsdWUnOiBkYXRhLmlkLAogICAgICAgICAgICAnbGFiZWwnOiBkYXRhLm5hbWUKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBkb0RlcGxveTogZnVuY3Rpb24gZG9EZXBsb3koKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMuZmlsZUxpc3QubGVuZ3RoID09PSAwKSB7CiAgICAgICAgdGhpcy5ub3RpZnlFcnJvcih0aGlzLiR0KCdwZHRlbXBQZEN2LnBsZWFzZVNlbGVjdEZpbGUnKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kcmVmc1snZGF0YUZvcm0nXS52YWxpZGF0ZShmdW5jdGlvbiAodmFsaWQpIHsKICAgICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgICB2YXIgZmlsZURhdGEgPSBfdGhpczIudXBsb2FkVXRpbChfdGhpczIuZmlsZUxpc3QpOwoKICAgICAgICAgICAgKDAsIF93b3JrZmxvdy5kZXBsb3kpKF90aGlzMi5mb3JtLnRlbmFudElkLCBmaWxlRGF0YSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgX3RoaXMyLiRyZWZzLnVwbG9hZC5jbGVhckZpbGVzKCk7CgogICAgICAgICAgICAgIF90aGlzMi5maWxlTGlzdCA9IFtdOwoKICAgICAgICAgICAgICBfdGhpczIubm90aWZ5U3VjY2Vzcygn5Y+R5biD5oiQ5YqfJyk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfQp9OwpleHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDs="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;AAiCA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAIA;AACA,EAAA,IAAA,EAAA,UADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,QAAA,EAAA,EADA;AAEA,MAAA,KAAA,EAAA;AACA,QAAA,QAAA,EAAA,CACA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,KAAA,EAAA,CAAA,uBAAA,CAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SADA;AADA,OAFA;AAOA,MAAA,IAAA,EAAA;AACA,QAAA,QAAA,EAAA;AADA,OAPA;AAUA,MAAA,aAAA,EAAA;AAVA,KAAA;AAYA,GAfA;AAgBA,EAAA,OAhBA,qBAgBA;AACA,SAAA,eAAA;AACA,GAlBA;AAmBA,EAAA,OAnBA,qBAmBA,CACA,CApBA;AAqBA,EAAA,OAAA,EAAA;AACA,IAAA,YADA,wBACA,IADA,EACA,QADA,EACA;AACA;AACA,UAAA,KAAA,YAAA,CAAA,IAAA,EAAA,QAAA,CAAA,EAAA;AACA,aAAA,QAAA,GAAA,QAAA;AACA,OAFA,MAEA;AACA,aAAA,QAAA,GAAA,EAAA;AACA,eAAA,KAAA;AACA;AACA,KATA;AAUA,IAAA,YAVA,wBAUA,IAVA,EAUA,QAVA,EAUA;AACA,UAAA,MAAA,GAAA,IAAA,CAAA,IAAA,CAAA,OAAA,CAAA,OAAA,IAAA,CAAA;AACA,UAAA,MAAA,GAAA,IAAA,CAAA,IAAA,GAAA,IAAA,GAAA,IAAA,IAAA,CAAA;;AACA,UAAA,CAAA,MAAA,EAAA;AACA,aAAA,QAAA,CAAA,KAAA,CAAA,cAAA;AACA;;AACA,UAAA,CAAA,MAAA,EAAA;AACA,aAAA,QAAA,CAAA,KAAA,CAAA,gBAAA;AACA;;AACA,aAAA,MAAA,IAAA,MAAA;AACA,KApBA;AAoBA,IAAA,YApBA,wBAoBA,IApBA,EAoBA,QApBA,EAoBA;AACA,WAAA,QAAA,GAAA,QAAA;AACA,KAtBA;AAuBA,IAAA,eAvBA,6BAuBA;AAAA;;AACA,oCAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,QAAA,KAAA,CAAA,aAAA,GAAA,EAAA;AACA,YAAA,UAAA,GAAA,GAAA,CAAA,IAAA;AACA,QAAA,UAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA;AACA,UAAA,KAAA,CAAA,aAAA,CAAA,IAAA,CAAA;AAAA,qBAAA,IAAA,CAAA,EAAA;AAAA,qBAAA,IAAA,CAAA;AAAA,WAAA;AACA,SAFA;AAGA,OANA;AAOA,KA/BA;AAgCA,IAAA,QAhCA,sBAgCA;AAAA;;AACA,UAAA,KAAA,QAAA,CAAA,MAAA,KAAA,CAAA,EAAA;AACA,aAAA,WAAA,CAAA,KAAA,EAAA,CAAA,6BAAA,CAAA;AACA,OAFA,MAEA;AAEA,aAAA,KAAA,CAAA,UAAA,EAAA,QAAA,CAAA,UAAA,KAAA,EAAA;AACA,cAAA,KAAA,EAAA;AACA,gBAAA,QAAA,GAAA,MAAA,CAAA,UAAA,CAAA,MAAA,CAAA,QAAA,CAAA;;AACA,kCAAA,MAAA,CAAA,IAAA,CAAA,QAAA,EAAA,QAAA,EAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,cAAA,MAAA,CAAA,KAAA,CAAA,MAAA,CAAA,UAAA;;AACA,cAAA,MAAA,CAAA,QAAA,GAAA,EAAA;;AACA,cAAA,MAAA,CAAA,aAAA,CAAA,MAAA;AACA,aAJA;AAKA;AACA,SATA;AAUA;AAEA;AAjDA;AArBA,C","sourcesContent":["<template>\r\n  <div class=\"box\">\r\n    <el-divider content-position=\"left\">{{$t('workflow.pageTitle')}}</el-divider>\r\n    <div style=\"margin-left:30px\">\r\n      <el-form ref=\"dataForm\" :model=\"form\" style=\"margin-top: 20px\" label-width=\"auto\" :rules=\"rules\">\r\n        <el-form-item :label=\"$t('workflow.fileUpload')\" required >\r\n          <el-upload v-model=\"form.fileName\" ref=\"upload\" action=\"#\" style=\"width: 400px\" :on-change=\"handleChange\" :limit=\"1\" :auto-upload=\"false\" drag :on-remove=\"handleRemove\"\r\n                     :file-list=\"fileList\">\r\n            <i class=\"el-icon-upload\"></i>\r\n            <div class=\"el-upload__text\">{{$t('workflow.fileTip')}}<em>{{$t('workflow.clickTip')}}</em></div>\r\n            <div class=\"el-upload__tip\" slot=\"tip\">{{$t('workflow.fileOnly')}}</div>\r\n          </el-upload>\r\n        </el-form-item>\r\n        <cus-row>\r\n            <cus-col :span=\"6\">\r\n              <el-form-item :label=\"$t('workflow.tenant')\" prop=\"tenantId\">\r\n                <el-select v-model=\"form.tenantId\" class=\"filter-item\" clearable filterable\r\n                           :placeholder=\"$t('i18nView.selectPlaceholder')\">\r\n                  <el-option v-for=\"item in tenantOptions\" :key=\"item.value\" :label=\"item.label\"\r\n                             :value=\"item.value\"></el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n            </cus-col>\r\n        </cus-row>\r\n        <el-button  size=\"small\" v-auth=\"'workflow:deploy'\" type=\"primary\" @click=\"doDeploy\">{{ $t('workflow.deploy') }}</el-button>\r\n      </el-form>\r\n\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\n  import {\r\n    deploy,getAllTenant\r\n  } from '@/api/workflow/workflow'\r\n\r\n  export default {\r\n    name: 'workflow',\r\n    data() {\r\n      return {\r\n        fileList: [],\r\n        rules: {\r\n          tenantId: [\r\n            { required: true, message: this.$t('workflow.selectTenant'), trigger: 'change' }\r\n          ]\r\n        },\r\n        form: {\r\n          tenantId: ''\r\n        },\r\n        tenantOptions: []\r\n      }\r\n    },\r\n    created() {\r\n      this.initTenantLists()\r\n    },\r\n    mounted() {\r\n    },\r\n    methods: {\r\n      handleChange(file, fileList) {\r\n        //判断文件大小\r\n        if (this.handleBefore(file,fileList)){\r\n          this.fileList = fileList\r\n        }else {\r\n          this.fileList = []\r\n          return false;\r\n        }\r\n      },\r\n      handleBefore(file, fileList) {\r\n        const isBpmn = file.name.indexOf('.bpmn') > 0\r\n        const isLt5M = file.size / 1024 / 1024 <= 5\r\n        if (!isBpmn) {\r\n          this.$message.error('只能是 bpmn 格式!')\r\n        }\r\n        if (!isLt5M) {\r\n          this.$message.error('上传文件不能超过 10MB!')\r\n        }\r\n        return isBpmn && isLt5M\r\n      }, handleRemove(file, fileList) {\r\n        this.fileList = fileList\r\n      },\r\n      initTenantLists() {\r\n        getAllTenant().then(res => {\r\n          this.tenantOptions = []\r\n          let tenantList = res.data\r\n          tenantList.forEach(data => {\r\n            this.tenantOptions.push({ 'value': data.id, 'label': data.name })\r\n          })\r\n        })\r\n      },\r\n      doDeploy() {\r\n        if (this.fileList.length === 0) {\r\n          this.notifyError(this.$t('pdtempPdCv.pleaseSelectFile'))\r\n        } else {\r\n\r\n          this.$refs['dataForm'].validate(valid => {\r\n            if (valid) {\r\n              let fileData = this.uploadUtil(this.fileList)\r\n              deploy(this.form.tenantId, fileData).then(res => {\r\n                this.$refs.upload.clearFiles()\r\n                this.fileList = []\r\n                this.notifySuccess('发布成功')\r\n              })\r\n            }\r\n          })\r\n        }\r\n\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n"],"sourceRoot":"src/views/workflow/deploy"}]}