{"remainingRequest":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\babel-loader\\lib\\index.js!D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\wecom-login\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\wecom-login\\index.vue","mtime":1609847107212},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\babel-loader\\lib\\index.js","mtime":1706753193796},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1706753190941}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJEOi84NjE4MS9EZXNrdG9wL3Byb2R1Y3QvcGNzLXByb2R1Y3Qtdmlldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHQiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5tYXRjaC5qcyIpOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7Cgp2YXIgX3VzZXJhdXRoID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJAL2FwaS93ZWNvbS1sb2dpbi91c2VyYXV0aCIpKTsKCnZhciBfYXV0aCA9IHJlcXVpcmUoIkAvdXRpbHMvYXV0aCIpOwoKdmFyIF91c2VyID0gcmVxdWlyZSgiQC9hcGkvc3lzdGVtL3VzZXIiKTsKCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCnZhciBfZGVmYXVsdCA9IHsKICBuYW1lOiAnYXV0aCcsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGRpYWxvZ1Zpc2libGU6IGZhbHNlLAogICAgICByYWRpbzogJycsCiAgICAgIHRlbmFudExpc3Q6IFtdLAogICAgICBsb2dpbkZvcm06IHsKICAgICAgICB1c2VybmFtZTogJycsCiAgICAgICAgdGVuYW50Q29kZTogJycsCiAgICAgICAgdGVuYW50SWQ6ICcnCiAgICAgIH0KICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBkb1JlYWxMb2dpbjogZnVuY3Rpb24gZG9SZWFsTG9naW4oKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgndXNlci9sb2dpbicsIHRoaXMubG9naW5Gb3JtKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2xkY29kZS9zdG9yYWdlU2VsZWN0Jyk7CgogICAgICAgIHZhciBmbGFnID0gbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvKHBob25lfHBhZHxwb2R8aVBob25lfGlQb2R8aW9zfGlQYWR8QW5kcm9pZHxNb2JpbGV8QmxhY2tCZXJyeXxJRU1vYmlsZXxNUVFCcm93c2VyfEpVQ3xGZW5uZWN8d09TQnJvd3NlcnxCcm93c2VyTkd8V2ViT1N8U3ltYmlhbnxXaW5kb3dzIFBob25lKS9pKTsKCiAgICAgICAgaWYgKGZsYWcgPT0gbnVsbCkgewogICAgICAgICAgX3RoaXMuJHN0b3JlLmRpc3BhdGNoKCdydWxlTWVzc2FnZS9zdG9yYWdlUnVsZU1lc3NhZ2UnKTsKCiAgICAgICAgICBfdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3J1bGVDYWNoZS9zdG9yYWdlUnVsZUNhY2hlJyk7CgogICAgICAgICAgX3RoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgcGF0aDogJ2Rhc2hib2FyZCcKICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHt9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3RoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgcGF0aDogJ3dlQ29tRGFzaGJvYXJkJwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICBhbGVydChlcnJvcik7CiAgICAgIH0pOwogICAgfSwKICAgIHNlbGVjdFRlbmFudDogZnVuY3Rpb24gc2VsZWN0VGVuYW50KHJvdykgewogICAgICB0aGlzLmxvZ2luRm9ybS50ZW5hbnRJZCA9IHJvdy50ZW5hbnRJZDsKICAgICAgdGhpcy5sb2dpbkZvcm0ucGFzc3dvcmQgPSByb3cudGVuYW50Q29kZTsKICAgIH0sCiAgICBzdWJtaXRGb3JtOiBmdW5jdGlvbiBzdWJtaXRGb3JtKCkgewogICAgICB0aGlzLmRvUmVhbExvZ2luKCk7CiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgKDAsIF9hdXRoLnNldERlYnVnKSgndHJ1ZScpOyAvL+S8geS4muW+ruS/oeeZu+W9lQoKICAgIF91c2VyYXV0aC5kZWZhdWx0LmdldENvZGUoKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgdmFyIHdlQ29tSWQgPSByZXMuZGF0YS51c2VySWQ7CiAgICAgIHZhciBwYXJhbSA9IHsKICAgICAgICB3ZUNvbUlkOiB3ZUNvbUlkCiAgICAgIH07CiAgICAgICgwLCBfdXNlci53ZUNvbUxvZ2luKSh7CiAgICAgICAgJ3BhcmFtcyc6IHBhcmFtCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhOwogICAgICAgICgwLCBfYXV0aC5zZXRBZXNLZXkpKGRhdGEuYWVzS2V5KTsKICAgICAgICAoMCwgX2F1dGguc2V0RGVidWcpKGRhdGEuZGVidWcpOwogICAgICAgIHZhciB0ZW5hbnRMaXN0ID0gZGF0YS50ZW5hbnRzOwogICAgICAgIF90aGlzMi5sb2dpbkZvcm0udXNlcm5hbWUgPSBkYXRhLndlQ29tSWQ7CiAgICAgICAgX3RoaXMyLmxvZ2luRm9ybS53ZUNvbUZsYWcgPSAnMSc7CgogICAgICAgIGlmICh0ZW5hbnRMaXN0Lmxlbmd0aCA9PT0gMSkgewogICAgICAgICAgX3RoaXMyLmxvZ2luRm9ybS50ZW5hbnRJZCA9IHRlbmFudExpc3RbMF0udGVuYW50SWQ7CiAgICAgICAgICBfdGhpczIubG9naW5Gb3JtLnBhc3N3b3JkID0gdGVuYW50TGlzdFswXS50ZW5hbnRDb2RlOwoKICAgICAgICAgIF90aGlzMi5kb1JlYWxMb2dpbigpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfdGhpczIudGVuYW50TGlzdCA9IHRlbmFudExpc3Q7CiAgICAgICAgICBfdGhpczIuZGlhbG9nVmlzaWJsZSA9IHRydWU7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICBhbGVydChlcnJvcik7CiAgICB9KTsKICB9Cn07CmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0Ow=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <el-dialog :close-on-click-modal=\"false\" center  :visible.sync=\"dialogVisible\" width=\"40%\">\r\n    <cus-page-title :label=\"$t('i18nView.comSelect')\"></cus-page-title>\r\n    <el-table :data=\"tenantList\" align=\"center\" border class=\"wraper-table\" element-loading-text=\"Loading\" fit\r\n              highlight-current-row\r\n              size=\"mini\">>\r\n      <el-table-column :label=\"$t('table.select')\" align=\"center\" width=\"50px\">\r\n        <template slot-scope=\"scope\">\r\n          <el-radio :label=\"scope.row.tenantId\" @change=\"selectTenant(scope.row)\" v-model=\"radio\">\r\n            {{ '' }}\r\n          </el-radio>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('table.id')\" align=\"center\" type=\"index\"  width=\"50px\">\r\n      </el-table-column>\r\n      <el-table-column align=\"center\" :label=\"$t('i18nView.lesseeNme')\" prop=\"tenantName\"></el-table-column>\r\n      <el-table-column align=\"center\" :label=\"$t('i18nView.comCode')\" prop=\"tenantCode\"></el-table-column>\r\n    </el-table>\r\n    <span slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button size=\"small\" :disabled=\"radio===''\"  type=\"primary\" @click=\"submitForm\"><i class=\"el-icon-success el-icon--left\"></i>\r\n            {{\r\n              $t('table.confirm')\r\n            }} </el-button>\r\n        </span>\r\n  </el-dialog>\r\n\r\n</template>\r\n<script>\r\n\r\nimport auth from '@/api/wecom-login/userauth'\r\nimport { setAesKey, setDebug } from '@/utils/auth'\r\nimport { weComLogin } from '@/api/system/user'\r\n\r\nexport default {\r\n  name: 'auth',\r\n  data() {\r\n    return {\r\n      dialogVisible: false,\r\n      radio: '',\r\n      tenantList: [],\r\n      loginForm: {\r\n        username: '',\r\n        tenantCode: '',\r\n        tenantId: ''\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    doRealLogin() {\r\n      this.$store.dispatch('user/login', this.loginForm)\r\n        .then(() => {\r\n          this.$store.dispatch('ldcode/storageSelect')\r\n          let flag = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)\r\n          if (flag == null) {\r\n            this.$store.dispatch('ruleMessage/storageRuleMessage')\r\n            this.$store.dispatch('ruleCache/storageRuleCache')\r\n            this.$router.push({ path: 'dashboard' }).catch(() => {\r\n            })\r\n          } else {\r\n            this.$router.push({ path: 'weComDashboard' })\r\n          }\r\n        })\r\n        .catch(error => {\r\n          alert(error)\r\n        })\r\n    },\r\n    selectTenant(row) {\r\n      this.loginForm.tenantId = row.tenantId\r\n      this.loginForm.password = row.tenantCode\r\n    },\r\n    submitForm() {\r\n      this.doRealLogin()\r\n    }\r\n  },\r\n  created() {\r\n    setDebug('true')\r\n    //企业微信登录\r\n    auth.getCode().then(res => {\r\n      let weComId = res.data.userId\r\n      let param = { weComId: weComId }\r\n      weComLogin({ 'params': param }).then(response => {\r\n        let data = response.data\r\n        setAesKey(data.aesKey)\r\n        setDebug(data.debug)\r\n        let tenantList = data.tenants\r\n        this.loginForm.username = data.weComId\r\n        this.loginForm.weComFlag = '1'\r\n        if (tenantList.length === 1) {\r\n          this.loginForm.tenantId = tenantList[0].tenantId\r\n          this.loginForm.password = tenantList[0].tenantCode\r\n          this.doRealLogin()\r\n        } else {\r\n          this.tenantList = tenantList\r\n          this.dialogVisible = true\r\n        }\r\n      })\r\n    }).catch(error => {\r\n      alert(error)\r\n    })\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.wrapper {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  height: 100%;\r\n}\r\n</style>\r\n"],"sourceRoot":"src/views/wecom-login"}]}