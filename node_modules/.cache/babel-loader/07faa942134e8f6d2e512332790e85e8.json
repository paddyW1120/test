{"remainingRequest":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\babel-loader\\lib\\index.js!D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\86181\\Desktop\\product\\pcs-product-view\\src\\permission.js","dependencies":[{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\src\\permission.js","mtime":1609847106469},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\babel-loader\\lib\\index.js","mtime":1706753193796},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\eslint-loader\\index.js","mtime":1706753187898}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJEOi84NjE4MS9EZXNrdG9wL3Byb2R1Y3QvcGNzLXByb2R1Y3Qtdmlldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHQiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmRleC1vZi5qcyIpOwoKcmVxdWlyZSgicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIik7Cgp2YXIgX2FzeW5jVG9HZW5lcmF0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJEOi84NjE4MS9EZXNrdG9wL3Byb2R1Y3QvcGNzLXByb2R1Y3Qtdmlldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3luY1RvR2VuZXJhdG9yIikpOwoKdmFyIF9yb3V0ZXIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkAvcm91dGVyIikpOwoKdmFyIF9zdG9yZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiLi9zdG9yZSIpKTsKCnZhciBfZWxlbWVudFVpID0gcmVxdWlyZSgiZWxlbWVudC11aSIpOwoKdmFyIF9ucHJvZ3Jlc3MgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm5wcm9ncmVzcyIpKTsKCnJlcXVpcmUoIm5wcm9ncmVzcy9ucHJvZ3Jlc3MuY3NzIik7Cgp2YXIgX2F1dGggPSByZXF1aXJlKCJAL3V0aWxzL2F1dGgiKTsKCnZhciBfZ2V0UGFnZVRpdGxlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJAL3V0aWxzL2dldC1wYWdlLXRpdGxlIikpOwoKdmFyIF93YXRlcm1hcmsgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkAvdXRpbHMvd2F0ZXJtYXJrIikpOwoKLy8gcHJvZ3Jlc3MgYmFyCi8vIHByb2dyZXNzIGJhciBzdHlsZQovLyBnZXQgdG9rZW4gZnJvbSBjb29raWUKX25wcm9ncmVzcy5kZWZhdWx0LmNvbmZpZ3VyZSh7CiAgc2hvd1NwaW5uZXI6IGZhbHNlCn0pOyAvLyBOUHJvZ3Jlc3MgQ29uZmlndXJhdGlvbgoKCnZhciB3aGl0ZUxpc3QgPSBbJy9sb2dpbicsICcvYXV0aC1yZWRpcmVjdCcsICcvd2VDb21Mb2dpbiddOyAvLyBubyByZWRpcmVjdCB3aGl0ZWxpc3QKCl9yb3V0ZXIuZGVmYXVsdC5iZWZvcmVFYWNoKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIHZhciBfcmVmID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KSggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUodG8sIGZyb20sIG5leHQpIHsKICAgIHZhciBoYXNUb2tlbiwgaGFzSW5pdDsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgLy8gc3RhcnQgcHJvZ3Jlc3MgYmFyCiAgICAgICAgICAgIF9ucHJvZ3Jlc3MuZGVmYXVsdC5zdGFydCgpOyAvLyBzZXQgcGFnZSB0aXRsZQoKCiAgICAgICAgICAgIGRvY3VtZW50LnRpdGxlID0gKDAsIF9nZXRQYWdlVGl0bGUuZGVmYXVsdCkodG8ubWV0YS50aXRsZSk7IC8vIGRldGVybWluZSB3aGV0aGVyIHRoZSB1c2VyIGhhcyBsb2dnZWQgaW4KCiAgICAgICAgICAgIGhhc1Rva2VuID0gKDAsIF9hdXRoLmdldFRva2VuKSgpOwogICAgICAgICAgICBoYXNJbml0ID0gKDAsIF9hdXRoLmdldEluaXQpKCk7CgogICAgICAgICAgICBpZiAoIWhhc1Rva2VuKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIwOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoISh0by5wYXRoID09PSAnL2xvZ2luJykpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9lbGVtZW50VWkuTWVzc2FnZS53YXJuaW5nKCfml6DpnIDph43lpI3nmbvlvZXvvIzkuLrmgqjot7Povazoh7PpppbpobUnKTsgLy8gaWYgaXMgbG9nZ2VkIGluLCByZWRpcmVjdCB0byB0aGUgaG9tZSBwYWdlCgoKICAgICAgICAgICAgbmV4dCh7CiAgICAgICAgICAgICAgcGF0aDogJy8nCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgX25wcm9ncmVzcy5kZWZhdWx0LmRvbmUoKTsKCiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxODsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgaWYgKCEoaGFzSW5pdCA9PT0gImZhbHNlIiB8fCBoYXNJbml0ID09IG51bGwpKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE3OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTQ7CiAgICAgICAgICAgIHJldHVybiBfc3RvcmUuZGVmYXVsdC5kaXNwYXRjaCgncGVybWlzc2lvbi9nZW5lcmF0ZVJvdXRlcycpOwoKICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgIGlmICh0by5yZWRpcmVjdGVkRnJvbSkgewogICAgICAgICAgICAgIG5leHQoewogICAgICAgICAgICAgICAgcGF0aDogdG8ucmVkaXJlY3RlZEZyb20KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxODsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgbmV4dCgpOwoKICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMjsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgX3dhdGVybWFyay5kZWZhdWx0LnJlbW92ZSgpOwoKICAgICAgICAgICAgaWYgKHdoaXRlTGlzdC5pbmRleE9mKHRvLnBhdGgpICE9PSAtMSkgewogICAgICAgICAgICAgIG5leHQoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBfZWxlbWVudFVpLk1lc3NhZ2Uud2FybmluZygn6K+35YWI55m75b2VJyk7CgogICAgICAgICAgICAgIG5leHQoIi9sb2dpbj9yZWRpcmVjdD0vIik7CgogICAgICAgICAgICAgIF9ucHJvZ3Jlc3MuZGVmYXVsdC5kb25lKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICBjYXNlIDIyOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUpOwogIH0pKTsKCiAgcmV0dXJuIGZ1bmN0aW9uIChfeCwgX3gyLCBfeDMpIHsKICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpKTsKCl9yb3V0ZXIuZGVmYXVsdC5hZnRlckVhY2goZnVuY3Rpb24gKCkgewogIC8vIGZpbmlzaCBwcm9ncmVzcyBiYXIKICBpZiAoX3N0b3JlLmRlZmF1bHQuZ2V0dGVycy51c2VybmFtZSkgewogICAgX3dhdGVybWFyay5kZWZhdWx0LnNldChfc3RvcmUuZGVmYXVsdC5nZXR0ZXJzLnVzZXJuYW1lICsgIi0iICsgX3N0b3JlLmRlZmF1bHQuZ2V0dGVycy51c2VyY29kZSk7CiAgfQoKICBfbnByb2dyZXNzLmRlZmF1bHQuZG9uZSgpOwp9KTs="},{"version":3,"sources":["D:/86181/Desktop/product/pcs-product-view/src/permission.js"],"names":["NProgress","configure","showSpinner","whiteList","router","beforeEach","to","from","next","start","document","title","meta","hasToken","hasInit","path","Message","warning","done","store","dispatch","redirectedFrom","watermark","remove","indexOf","afterEach","getters","username","set","usercode"],"mappings":";;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAJkC;AACD;AACc;AAI/CA,mBAAUC,SAAV,CAAoB;AAACC,EAAAA,WAAW,EAAE;AAAd,CAApB,E,CAA0C;;;AAE1C,IAAMC,SAAS,GAAG,CAAC,QAAD,EAAW,gBAAX,EAA4B,aAA5B,CAAlB,C,CAA6D;;AAE7DC,gBAAOC,UAAP;AAAA,mFAAkB,iBAAOC,EAAP,EAAWC,IAAX,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAChB;AACAR,+BAAUS,KAAV,GAFgB,CAIhB;;;AACAC,YAAAA,QAAQ,CAACC,KAAT,GAAiB,2BAAaL,EAAE,CAACM,IAAH,CAAQD,KAArB,CAAjB,CALgB,CAOhB;;AACME,YAAAA,QARU,GAQC,qBARD;AASVC,YAAAA,OATU,GASA,oBATA;;AAAA,iBAWZD,QAXY;AAAA;AAAA;AAAA;;AAAA,kBAYVP,EAAE,CAACS,IAAH,KAAY,QAZF;AAAA;AAAA;AAAA;;AAaZC,+BAAQC,OAAR,CAAgB,gBAAhB,EAbY,CAcZ;;;AACAT,YAAAA,IAAI,CAAC;AAACO,cAAAA,IAAI,EAAE;AAAP,aAAD,CAAJ;;AACAf,+BAAUkB,IAAV;;AAhBY;AAAA;;AAAA;AAAA,kBAmBRJ,OAAO,KAAK,OAAZ,IAAuBA,OAAO,IAAI,IAnB1B;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAoBJK,eAAMC,QAAN,CAAe,2BAAf,CApBI;;AAAA;AAqBV,gBAAId,EAAE,CAACe,cAAP,EAAuB;AACrBb,cAAAA,IAAI,CAAC;AAACO,gBAAAA,IAAI,EAAET,EAAE,CAACe;AAAV,eAAD,CAAJ;AACD,aAFD,MAEO;AACLb,cAAAA,IAAI;AACL;;AAzBS;AAAA;;AAAA;AA2BVA,YAAAA,IAAI;;AA3BM;AAAA;AAAA;;AAAA;AA+Bdc,+BAAUC,MAAV;;AACA,gBAAIpB,SAAS,CAACqB,OAAV,CAAkBlB,EAAE,CAACS,IAArB,MAA+B,CAAC,CAApC,EAAuC;AACrCP,cAAAA,IAAI;AACL,aAFD,MAEO;AACLQ,iCAAQC,OAAR,CAAgB,MAAhB;;AACAT,cAAAA,IAAI,qBAAJ;;AACAR,iCAAUkB,IAAV;AACD;;AAtCa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAlB;;AAAA;AAAA;AAAA;AAAA;;AA0CAd,gBAAOqB,SAAP,CAAiB,YAAM;AACrB;AACA,MAAIN,eAAMO,OAAN,CAAcC,QAAlB,EAA4B;AAC1BL,uBAAUM,GAAV,CAAcT,eAAMO,OAAN,CAAcC,QAAd,GAAyB,GAAzB,GAA+BR,eAAMO,OAAN,CAAcG,QAA3D;AACD;;AACD7B,qBAAUkB,IAAV;AACD,CAND","sourcesContent":["import router from '@/router'\r\nimport store from './store'\r\nimport {Message} from 'element-ui'\r\nimport NProgress from 'nprogress' // progress bar\r\nimport 'nprogress/nprogress.css' // progress bar style\r\nimport {getInit, getToken} from '@/utils/auth' // get token from cookie\r\nimport getPageTitle from '@/utils/get-page-title'\r\nimport watermark from '@/utils/watermark'\r\n\r\nNProgress.configure({showSpinner: false}) // NProgress Configuration\r\n\r\nconst whiteList = ['/login', '/auth-redirect','/weComLogin'] // no redirect whitelist\r\n\r\nrouter.beforeEach(async (to, from, next) => {\r\n  // start progress bar\r\n  NProgress.start()\r\n\r\n  // set page title\r\n  document.title = getPageTitle(to.meta.title)\r\n\r\n  // determine whether the user has logged in\r\n  const hasToken = getToken()\r\n  const hasInit = getInit()\r\n\r\n  if (hasToken) {\r\n    if (to.path === '/login') {\r\n      Message.warning('无需重复登录，为您跳转至首页')\r\n      // if is logged in, redirect to the home page\r\n      next({path: '/'})\r\n      NProgress.done()\r\n    } else {\r\n      // 需要动态组装路由\r\n      if (hasInit === \"false\" || hasInit == null) {\r\n        await store.dispatch('permission/generateRoutes')\r\n        if (to.redirectedFrom) {\r\n          next({path: to.redirectedFrom})\r\n        } else {\r\n          next()\r\n        }\r\n      } else {\r\n        next()\r\n      }\r\n    }\r\n  } else {\r\n    watermark.remove()\r\n    if (whiteList.indexOf(to.path) !== -1) {\r\n      next()\r\n    } else {\r\n      Message.warning('请先登录')\r\n      next(`/login?redirect=/`)\r\n      NProgress.done()\r\n    }\r\n  }\r\n})\r\n\r\nrouter.afterEach(() => {\r\n  // finish progress bar\r\n  if (store.getters.username) {\r\n    watermark.set(store.getters.username + \"-\" + store.getters.usercode);\r\n  }\r\n  NProgress.done()\r\n})\r\n"]}]}