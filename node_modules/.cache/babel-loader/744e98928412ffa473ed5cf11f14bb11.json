{"remainingRequest":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\babel-loader\\lib\\index.js!D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\product-definition\\pd-framework-def\\pd-attr-def\\base-attr-def\\template\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\src\\views\\product-definition\\pd-framework-def\\pd-attr-def\\base-attr-def\\template\\index.vue","mtime":1609847106843},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\babel-loader\\lib\\index.js","mtime":1706753193796},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1706753187435},{"path":"D:\\86181\\Desktop\\product\\pcs-product-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1706753190941}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJEOi84NjE4MS9EZXNrdG9wL3Byb2R1Y3QvcGNzLXByb2R1Y3Qtdmlldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHQiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIik7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDsKCnJlcXVpcmUoInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyIpOwoKdmFyIF9hc3luY1RvR2VuZXJhdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiRDovODYxODEvRGVza3RvcC9wcm9kdWN0L3Bjcy1wcm9kdWN0LXZpZXcvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvciIpKTsKCnZhciBfUHJvZHVjdEF0dHJpYnV0ZURlZmluaXRpb24gPSByZXF1aXJlKCJAL2FwaS9iYXNpY2luZm8vUHJvZHVjdEF0dHJpYnV0ZURlZmluaXRpb24iKTsKCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCnZhciBfZGVmYXVsdCA9IHsKICBuYW1lOiAnY2xhdXNlJywKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZmlsZUxpc3Q6IFtdLAogICAgICBmb3JtOiB7CiAgICAgICAgb3BlcmF0b3I6IHRoaXMuJHN0b3JlLmdldHRlcnMudXNlcmNvZGUsCiAgICAgICAgcGRDb2RlOiBudWxsLAogICAgICAgIHBkTmFtZTogbnVsbCwKICAgICAgICBwcm9kdWN0VHlwZTogbnVsbCwKICAgICAgICBmaWxlTmFtZTogbnVsbCwKICAgICAgICBjb250ZW50OiBudWxsLAogICAgICAgIHR5cGU6IG51bGwKICAgICAgfSwKICAgICAgcnVsZXM6IHsKICAgICAgICBwcm9kdWN0VHlwZTogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogdGhpcy4kdCgnY2xhdXNlLmlucHV0JykgKyB0aGlzLiR0KCdjbGF1c2UucHJvZHVjdFR5cGUnKSwKICAgICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICAgIH1dLAogICAgICAgIGZpbGVOYW1lOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiB0aGlzLiR0KCdjbGF1c2UuaW5wdXRGaWxlJyksCiAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgICB9XQogICAgICB9CiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHZhciBwZHRlbXBQZEluZm8gPSB0aGlzLmdldFBkRGF0YSgpOwogICAgdGhpcy5mb3JtLnBkQ29kZSA9IHBkdGVtcFBkSW5mby5wZENvZGU7CiAgICB0aGlzLmZvcm0ucGROYW1lID0gcGR0ZW1wUGRJbmZvLnBkTmFtZTsKICAgIHRoaXMuZm9ybS5wZEVkaXRpb24gPSBwZHRlbXBQZEluZm8ucGRFZGl0aW9uOwogIH0sCiAgbWV0aG9kczogewogICAgcmVtb3ZlVXBsb2FkOiBmdW5jdGlvbiByZW1vdmVVcGxvYWQoKSB7CiAgICAgIHRoaXMuZm9ybS5maWxlTmFtZSA9IG51bGw7CiAgICAgIHRoaXMuZm9ybS5jb250ZW50ID0gbnVsbDsKICAgICAgdGhpcy5mb3JtLnR5cGUgPSBudWxsOwogICAgfSwKICAgIGNoYW5nZVVwbG9hZDogZnVuY3Rpb24gY2hhbmdlVXBsb2FkKGZpbGUsIGZpbGVMaXN0KSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB0aGlzLmZvcm0uZmlsZU5hbWUgPSBmaWxlLm5hbWU7CiAgICAgIHRoaXMuZm9ybS50eXBlID0gZmlsZS5yYXcudHlwZTsKICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CgogICAgICByZWFkZXIub25sb2FkID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX3JlZiA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKGUpIHsKICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgX3RoaXMuZm9ybS5jb250ZW50ID0gZS50YXJnZXQucmVzdWx0OwoKICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgICB9KSk7CgogICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gpIHsKICAgICAgICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfTsKICAgICAgfSgpOwoKICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZS5yYXcpOwogICAgfSwKICAgIHN1Ym1pdEZvcm06IGZ1bmN0aW9uIHN1Ym1pdEZvcm0oKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIGlzWExTWCA9IHRoaXMuZm9ybS50eXBlID09PSAnYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LnNwcmVhZHNoZWV0bWwuc2hlZXQnOwoKICAgICAgaWYgKHRoaXMuZm9ybS50eXBlICYmICFpc1hMU1gpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfkuIrkvKDmnaHmrL7lj6rog73mmK8geGxzeCDmoLzlvI8hJyk7CiAgICAgIH0KCiAgICAgIHRoaXMuJHJlZnMuZm9ybS52YWxpZGF0ZShmdW5jdGlvbiAodmFsaWQpIHsKICAgICAgICBpZiAodmFsaWQgJiYgaXNYTFNYKSB7CiAgICAgICAgICAoMCwgX1Byb2R1Y3RBdHRyaWJ1dGVEZWZpbml0aW9uLmZpbGV1cGxvYWQpKF90aGlzMi5mb3JtKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICBfdGhpczIubm90aWZ5U3VjY2VzcyhyZXNwb25zZS5tZXNzYWdlKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgZG93bmxvYWQ6IGZ1bmN0aW9uIGRvd25sb2FkKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHRoaXMuJHJlZnMuZm9ybS52YWxpZGF0ZUZpZWxkKCdwcm9kdWN0VHlwZScsIGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIGlmICghZXJyb3IpIHsKICAgICAgICAgICgwLCBfUHJvZHVjdEF0dHJpYnV0ZURlZmluaXRpb24uZG93bmxvYWQpKF90aGlzMy5mb3JtLnByb2R1Y3RUeXBlKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgIGlmICghZGF0YSkgewogICAgICAgICAgICAgIF90aGlzMy5ub3RpZnlFcnJvcign6K+l5Lqn5ZOB57G75Z6L5pqC5peg5qih5p2/77yBJyk7CgogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIGZpbGVOYW1lID0gX3RoaXMzLmdldENvZGVOYW1lKCdQcm9kdWN0VHlwZScsIF90aGlzMy5mb3JtLnByb2R1Y3RUeXBlLCB0cnVlKTsKCiAgICAgICAgICAgIGZpbGVOYW1lID0gX3RoaXMzLmZvcm0ucHJvZHVjdFR5cGUgKyAnLScgKyBmaWxlTmFtZSArICIueGxzeCI7CgogICAgICAgICAgICBfdGhpczMuZG93bmxvYWRSZXNwb25zZUZpbGUoZGF0YSwgZmlsZU5hbWUpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9Cn07CmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0Ow=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <cus-wraper>\r\n      <el-form ref=\"form\" :model=\"form\" :rules=\"rules\" label-width=\"auto\">\r\n        <el-row :gutter=\"10\">\r\n          <el-col :span=\"10\">\r\n            <el-form-item :label=\"$t('template.productType')\" prop=\"productType\">\r\n              <cus-select :codetype=\"'ProductType'\" v-model=\"form.productType\">\r\n              </cus-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <cus-btn-wrapper>\r\n            <el-button  size=\"small\" type=\"primary\" v-auth=\"'template:download'\" class=\"el-icon-download\" @click=\"download\">{{ $t('template.download') }}\r\n            </el-button>\r\n          </cus-btn-wrapper>\r\n        </el-row>\r\n\r\n        <el-row :gutter=\"10\">\r\n          <el-col :span=\"7\">\r\n            <el-form-item :label=\"$t('template.fileUpload')\" prop=\"fileName\">\r\n              <el-upload v-model=\"form.fileName\" action=\"#\" :on-change=\"changeUpload\" accept=\"\" :limit=\"1\"\r\n                         :auto-upload=\"false\" :on-remove=\"removeUpload\" :file-list=\"fileList\" drag>\r\n                <i class=\"el-icon-upload\"></i>\r\n                <div class=\"el-upload__text\">{{$t('i18nView.uploadText1')}}<em>{{$t('i18nView.uploadText2')}}</em></div>\r\n                <div slot=\"tip\" class=\"el-upload__tip\">{{$t('i18nView.onlyUpDownModelFile')}}</div>\r\n              </el-upload>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-form-item>\r\n          <el-button  size=\"small\" v-waves type=\"primary\"  class=\"el-icon-upload\" v-auth=\"'template:upload'\" @click=\"submitForm\" >\r\n            {{$t('table.upload') }}\r\n          </el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n\r\n  </cus-wraper>\r\n</template>\r\n<script>\r\n  import {\r\n    fileupload,\r\n    download,\r\n  } from '@/api/basicinfo/ProductAttributeDefinition'\r\n\r\n  export default {\r\n    name: 'clause',\r\n    data() {\r\n      return {\r\n        fileList: [],\r\n        form: {\r\n          operator: this.$store.getters.usercode,\r\n          pdCode: null,\r\n          pdName: null,\r\n          productType: null,\r\n          fileName: null,\r\n          content: null,\r\n          type: null\r\n        },\r\n        rules: {\r\n          productType: [\r\n            {\r\n              required: true,\r\n              message: this.$t('clause.input') + this.$t('clause.productType'),\r\n              trigger: 'blur'\r\n            }\r\n          ],\r\n          fileName: [\r\n            {\r\n              required: true,\r\n              message: this.$t('clause.inputFile'),\r\n              trigger: 'blur'\r\n            }\r\n          ]\r\n        }\r\n      }\r\n    },\r\n    created() {\r\n      let pdtempPdInfo = this.getPdData()\r\n      this.form.pdCode = pdtempPdInfo.pdCode\r\n      this.form.pdName = pdtempPdInfo.pdName\r\n      this.form.pdEdition = pdtempPdInfo.pdEdition\r\n    },\r\n    methods: {\r\n      removeUpload() {\r\n        this.form.fileName = null\r\n        this.form.content = null\r\n        this.form.type = null\r\n      },\r\n      changeUpload: function(file, fileList) {\r\n        this.form.fileName = file.name\r\n        this.form.type = file.raw.type\r\n        let reader = new FileReader()\r\n        reader.onload = async e => {\r\n          this.form.content = e.target.result\r\n        }\r\n        reader.readAsDataURL(file.raw)\r\n      },\r\n      submitForm() {\r\n        const isXLSX =\r\n          this.form.type ===\r\n          'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\r\n        if (this.form.type && !isXLSX) {\r\n          this.$message.error('上传条款只能是 xlsx 格式!')\r\n        }\r\n        this.$refs.form.validate(valid => {\r\n          if (valid && isXLSX) {\r\n            fileupload(this.form).then(response => {\r\n              this.notifySuccess(response.message)\r\n            })\r\n          }\r\n        })\r\n      },\r\n      download() {\r\n        this.$refs.form.validateField('productType', error => {\r\n          if(!error){\r\n              download(this.form.productType).then(data => {\r\n                if (!data) {\r\n                  this.notifyError('该产品类型暂无模板！')\r\n                  return\r\n                }\r\n                let fileName = this.getCodeName('ProductType',this.form.productType,true)\r\n                fileName = this.form.productType + '-' + fileName + \".xlsx\"\r\n                this.downloadResponseFile(data,fileName)\r\n              })\r\n          }\r\n        })\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n\r\n\r\n</style>\r\n"],"sourceRoot":"src/views/product-definition/pd-framework-def/pd-attr-def/base-attr-def/template"}]}